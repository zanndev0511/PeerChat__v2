var NetlessAppSlide=function(Zn){"use strict";var Lw=Object.defineProperty,Dw=Object.defineProperties;var Fw=Object.getOwnPropertyDescriptors;var Qv=Object.getOwnPropertySymbols;var Bw=Object.prototype.hasOwnProperty,Uw=Object.prototype.propertyIsEnumerable;var $v=(Zn,Dn,Ar)=>Dn in Zn?Lw(Zn,Dn,{enumerable:!0,configurable:!0,writable:!0,value:Ar}):Zn[Dn]=Ar,qc=(Zn,Dn)=>{for(var Ar in Dn||(Dn={}))Bw.call(Dn,Ar)&&$v(Zn,Ar,Dn[Ar]);if(Qv)for(var Ar of Qv(Dn))Uw.call(Dn,Ar)&&$v(Zn,Ar,Dn[Ar]);return Zn},t0=(Zn,Dn)=>Dw(Zn,Fw(Dn));var Dn=function(b){var A={};function v(P){if(A[P])return A[P].exports;var M=A[P]={i:P,l:!1,exports:{}};return b[P].call(M.exports,M,M.exports,v),M.l=!0,M.exports}return v.m=b,v.c=A,v.d=function(P,M,I){v.o(P,M)||Object.defineProperty(P,M,{enumerable:!0,get:I})},v.r=function(P){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(P,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(P,"__esModule",{value:!0})},v.t=function(P,M){if(1&M&&(P=v(P)),8&M||4&M&&typeof P=="object"&&P&&P.__esModule)return P;var I=Object.create(null);if(v.r(I),Object.defineProperty(I,"default",{enumerable:!0,value:P}),2&M&&typeof P!="string")for(var D in P)v.d(I,D,function(k){return P[k]}.bind(null,D));return I},v.n=function(P){var M=P&&P.__esModule?function(){return P.default}:function(){return P};return v.d(M,"a",M),M},v.o=function(P,M){return Object.prototype.hasOwnProperty.call(P,M)},v.p="",v(v.s=229)}([function(b,A,v){/*!
* @pixi/constants - v6.4.2
* Compiled Thu, 02 Jun 2022 15:39:26 UTC
*
* @pixi/constants is licensed under the MIT License.
* http://www.opensource.org/licenses/mit-license
*/var P,M,I,D,k,W,X,V,et,pt,Dt,At,L,R,F,Y,O,H,tt;v.d(A,"a",function(){return L}),v.d(A,"b",function(){return D}),v.d(A,"c",function(){return I}),v.d(A,"d",function(){return tt}),v.d(A,"e",function(){return R}),v.d(A,"f",function(){return k}),v.d(A,"g",function(){return P}),v.d(A,"h",function(){return W}),v.d(A,"i",function(){return F}),v.d(A,"j",function(){return O}),v.d(A,"k",function(){return At}),v.d(A,"l",function(){return H}),v.d(A,"m",function(){return Y}),v.d(A,"n",function(){return M}),v.d(A,"o",function(){return et}),v.d(A,"p",function(){return pt}),v.d(A,"q",function(){return X}),v.d(A,"r",function(){return V}),v.d(A,"s",function(){return Dt}),function(G){G[G.WEBGL_LEGACY=0]="WEBGL_LEGACY",G[G.WEBGL=1]="WEBGL",G[G.WEBGL2=2]="WEBGL2"}(P||(P={})),function(G){G[G.UNKNOWN=0]="UNKNOWN",G[G.WEBGL=1]="WEBGL",G[G.CANVAS=2]="CANVAS"}(M||(M={})),function(G){G[G.COLOR=16384]="COLOR",G[G.DEPTH=256]="DEPTH",G[G.STENCIL=1024]="STENCIL"}(I||(I={})),function(G){G[G.NORMAL=0]="NORMAL",G[G.ADD=1]="ADD",G[G.MULTIPLY=2]="MULTIPLY",G[G.SCREEN=3]="SCREEN",G[G.OVERLAY=4]="OVERLAY",G[G.DARKEN=5]="DARKEN",G[G.LIGHTEN=6]="LIGHTEN",G[G.COLOR_DODGE=7]="COLOR_DODGE",G[G.COLOR_BURN=8]="COLOR_BURN",G[G.HARD_LIGHT=9]="HARD_LIGHT",G[G.SOFT_LIGHT=10]="SOFT_LIGHT",G[G.DIFFERENCE=11]="DIFFERENCE",G[G.EXCLUSION=12]="EXCLUSION",G[G.HUE=13]="HUE",G[G.SATURATION=14]="SATURATION",G[G.COLOR=15]="COLOR",G[G.LUMINOSITY=16]="LUMINOSITY",G[G.NORMAL_NPM=17]="NORMAL_NPM",G[G.ADD_NPM=18]="ADD_NPM",G[G.SCREEN_NPM=19]="SCREEN_NPM",G[G.NONE=20]="NONE",G[G.SRC_OVER=0]="SRC_OVER",G[G.SRC_IN=21]="SRC_IN",G[G.SRC_OUT=22]="SRC_OUT",G[G.SRC_ATOP=23]="SRC_ATOP",G[G.DST_OVER=24]="DST_OVER",G[G.DST_IN=25]="DST_IN",G[G.DST_OUT=26]="DST_OUT",G[G.DST_ATOP=27]="DST_ATOP",G[G.ERASE=26]="ERASE",G[G.SUBTRACT=28]="SUBTRACT",G[G.XOR=29]="XOR"}(D||(D={})),function(G){G[G.POINTS=0]="POINTS",G[G.LINES=1]="LINES",G[G.LINE_LOOP=2]="LINE_LOOP",G[G.LINE_STRIP=3]="LINE_STRIP",G[G.TRIANGLES=4]="TRIANGLES",G[G.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",G[G.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(k||(k={})),function(G){G[G.RGBA=6408]="RGBA",G[G.RGB=6407]="RGB",G[G.RG=33319]="RG",G[G.RED=6403]="RED",G[G.RGBA_INTEGER=36249]="RGBA_INTEGER",G[G.RGB_INTEGER=36248]="RGB_INTEGER",G[G.RG_INTEGER=33320]="RG_INTEGER",G[G.RED_INTEGER=36244]="RED_INTEGER",G[G.ALPHA=6406]="ALPHA",G[G.LUMINANCE=6409]="LUMINANCE",G[G.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",G[G.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",G[G.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(W||(W={})),function(G){G[G.TEXTURE_2D=3553]="TEXTURE_2D",G[G.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",G[G.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",G[G.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",G[G.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",G[G.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",G[G.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",G[G.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",G[G.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(X||(X={})),function(G){G[G.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",G[G.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",G[G.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",G[G.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",G[G.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",G[G.UNSIGNED_INT=5125]="UNSIGNED_INT",G[G.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",G[G.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",G[G.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",G[G.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",G[G.BYTE=5120]="BYTE",G[G.SHORT=5122]="SHORT",G[G.INT=5124]="INT",G[G.FLOAT=5126]="FLOAT",G[G.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",G[G.HALF_FLOAT=36193]="HALF_FLOAT"}(V||(V={})),function(G){G[G.FLOAT=0]="FLOAT",G[G.INT=1]="INT",G[G.UINT=2]="UINT"}(et||(et={})),function(G){G[G.NEAREST=0]="NEAREST",G[G.LINEAR=1]="LINEAR"}(pt||(pt={})),function(G){G[G.CLAMP=33071]="CLAMP",G[G.REPEAT=10497]="REPEAT",G[G.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Dt||(Dt={})),function(G){G[G.OFF=0]="OFF",G[G.POW2=1]="POW2",G[G.ON=2]="ON",G[G.ON_MANUAL=3]="ON_MANUAL"}(At||(At={})),function(G){G[G.NPM=0]="NPM",G[G.UNPACK=1]="UNPACK",G[G.PMA=2]="PMA",G[G.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",G[G.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",G[G.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",G[G.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(L||(L={})),function(G){G[G.NO=0]="NO",G[G.YES=1]="YES",G[G.AUTO=2]="AUTO",G[G.BLEND=0]="BLEND",G[G.CLEAR=1]="CLEAR",G[G.BLIT=2]="BLIT"}(R||(R={})),function(G){G[G.AUTO=0]="AUTO",G[G.MANUAL=1]="MANUAL"}(F||(F={})),function(G){G.LOW="lowp",G.MEDIUM="mediump",G.HIGH="highp"}(Y||(Y={})),function(G){G[G.NONE=0]="NONE",G[G.SCISSOR=1]="SCISSOR",G[G.STENCIL=2]="STENCIL",G[G.SPRITE=3]="SPRITE"}(O||(O={})),function(G){G[G.NONE=0]="NONE",G[G.LOW=2]="LOW",G[G.MEDIUM=4]="MEDIUM",G[G.HIGH=8]="HIGH"}(H||(H={})),function(G){G[G.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",G[G.ARRAY_BUFFER=34962]="ARRAY_BUFFER",G[G.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(tt||(tt={}))},function(b,A,v){v.d(A,"a",function(){return V}),v.d(A,"b",function(){return D}),v.d(A,"c",function(){return et}),v.d(A,"d",function(){return L}),v.d(A,"e",function(){return At}),v.d(A,"f",function(){return M}),v.d(A,"g",function(){return k}),v.d(A,"h",function(){return pt}),v.d(A,"i",function(){return I}),v.d(A,"j",function(){return X}),v.d(A,"k",function(){return Dt}),v.d(A,"l",function(){return P}),v.d(A,"m",function(){return Vt}),v.d(A,"n",function(){return Ot});/*!
 * @pixi/math - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var P,M=2*Math.PI,I=180/Math.PI,D=Math.PI/180;(function(st){st[st.POLY=0]="POLY",st[st.RECT=1]="RECT",st[st.CIRC=2]="CIRC",st[st.ELIP=3]="ELIP",st[st.RREC=4]="RREC"})(P||(P={}));var k=function(){function st(z,U){z===void 0&&(z=0),U===void 0&&(U=0),this.x=0,this.y=0,this.x=z,this.y=U}return st.prototype.clone=function(){return new st(this.x,this.y)},st.prototype.copyFrom=function(z){return this.set(z.x,z.y),this},st.prototype.copyTo=function(z){return z.set(this.x,this.y),z},st.prototype.equals=function(z){return z.x===this.x&&z.y===this.y},st.prototype.set=function(z,U){return z===void 0&&(z=0),U===void 0&&(U=z),this.x=z,this.y=U,this},st.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},st}(),W=[new k,new k,new k,new k],X=function(){function st(z,U,ft,$){z===void 0&&(z=0),U===void 0&&(U=0),ft===void 0&&(ft=0),$===void 0&&($=0),this.x=Number(z),this.y=Number(U),this.width=Number(ft),this.height=Number($),this.type=P.RECT}return Object.defineProperty(st.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(st,"EMPTY",{get:function(){return new st(0,0,0,0)},enumerable:!1,configurable:!0}),st.prototype.clone=function(){return new st(this.x,this.y,this.width,this.height)},st.prototype.copyFrom=function(z){return this.x=z.x,this.y=z.y,this.width=z.width,this.height=z.height,this},st.prototype.copyTo=function(z){return z.x=this.x,z.y=this.y,z.width=this.width,z.height=this.height,z},st.prototype.contains=function(z,U){return!(this.width<=0||this.height<=0)&&z>=this.x&&z<this.x+this.width&&U>=this.y&&U<this.y+this.height},st.prototype.intersects=function(z,U){if(!U){var ft=this.x<z.x?z.x:this.x;if((this.right>z.right?z.right:this.right)<=ft)return!1;var $=this.y<z.y?z.y:this.y;return(this.bottom>z.bottom?z.bottom:this.bottom)>$}var gt=this.left,Lt=this.right,K=this.top,dt=this.bottom;if(Lt<=gt||dt<=K)return!1;var it=W[0].set(z.left,z.top),_t=W[1].set(z.left,z.bottom),St=W[2].set(z.right,z.top),kt=W[3].set(z.right,z.bottom);if(St.x<=it.x||_t.y<=it.y)return!1;var Xt=Math.sign(U.a*U.d-U.b*U.c);if(Xt===0||(U.apply(it,it),U.apply(_t,_t),U.apply(St,St),U.apply(kt,kt),Math.max(it.x,_t.x,St.x,kt.x)<=gt||Math.min(it.x,_t.x,St.x,kt.x)>=Lt||Math.max(it.y,_t.y,St.y,kt.y)<=K||Math.min(it.y,_t.y,St.y,kt.y)>=dt))return!1;var Jt=Xt*(_t.y-it.y),at=Xt*(it.x-_t.x),_e=Jt*gt+at*K,Ue=Jt*Lt+at*K,Oe=Jt*gt+at*dt,Ae=Jt*Lt+at*dt;if(Math.max(_e,Ue,Oe,Ae)<=Jt*it.x+at*it.y||Math.min(_e,Ue,Oe,Ae)>=Jt*kt.x+at*kt.y)return!1;var ze=Xt*(it.y-St.y),$e=Xt*(St.x-it.x),cn=ze*gt+$e*K,ke=ze*Lt+$e*K,Ge=ze*gt+$e*dt,Rn=ze*Lt+$e*dt;return!(Math.max(cn,ke,Ge,Rn)<=ze*it.x+$e*it.y||Math.min(cn,ke,Ge,Rn)>=ze*kt.x+$e*kt.y)},st.prototype.pad=function(z,U){return z===void 0&&(z=0),U===void 0&&(U=z),this.x-=z,this.y-=U,this.width+=2*z,this.height+=2*U,this},st.prototype.fit=function(z){var U=Math.max(this.x,z.x),ft=Math.min(this.x+this.width,z.x+z.width),$=Math.max(this.y,z.y),gt=Math.min(this.y+this.height,z.y+z.height);return this.x=U,this.width=Math.max(ft-U,0),this.y=$,this.height=Math.max(gt-$,0),this},st.prototype.ceil=function(z,U){z===void 0&&(z=1),U===void 0&&(U=.001);var ft=Math.ceil((this.x+this.width-U)*z)/z,$=Math.ceil((this.y+this.height-U)*z)/z;return this.x=Math.floor((this.x+U)*z)/z,this.y=Math.floor((this.y+U)*z)/z,this.width=ft-this.x,this.height=$-this.y,this},st.prototype.enlarge=function(z){var U=Math.min(this.x,z.x),ft=Math.max(this.x+this.width,z.x+z.width),$=Math.min(this.y,z.y),gt=Math.max(this.y+this.height,z.y+z.height);return this.x=U,this.width=ft-U,this.y=$,this.height=gt-$,this},st.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},st}(),V=function(){function st(z,U,ft){z===void 0&&(z=0),U===void 0&&(U=0),ft===void 0&&(ft=0),this.x=z,this.y=U,this.radius=ft,this.type=P.CIRC}return st.prototype.clone=function(){return new st(this.x,this.y,this.radius)},st.prototype.contains=function(z,U){if(this.radius<=0)return!1;var ft=this.radius*this.radius,$=this.x-z,gt=this.y-U;return($*=$)+(gt*=gt)<=ft},st.prototype.getBounds=function(){return new X(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},st.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},st}(),et=function(){function st(z,U,ft,$){z===void 0&&(z=0),U===void 0&&(U=0),ft===void 0&&(ft=0),$===void 0&&($=0),this.x=z,this.y=U,this.width=ft,this.height=$,this.type=P.ELIP}return st.prototype.clone=function(){return new st(this.x,this.y,this.width,this.height)},st.prototype.contains=function(z,U){if(this.width<=0||this.height<=0)return!1;var ft=(z-this.x)/this.width,$=(U-this.y)/this.height;return(ft*=ft)+($*=$)<=1},st.prototype.getBounds=function(){return new X(this.x-this.width,this.y-this.height,this.width,this.height)},st.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},st}(),pt=function(){function st(){for(var z=arguments,U=[],ft=0;ft<arguments.length;ft++)U[ft]=z[ft];var $=Array.isArray(U[0])?U[0]:U;if(typeof $[0]!="number"){for(var gt=[],Lt=0,K=$.length;Lt<K;Lt++)gt.push($[Lt].x,$[Lt].y);$=gt}this.points=$,this.type=P.POLY,this.closeStroke=!0}return st.prototype.clone=function(){var z=new st(this.points.slice());return z.closeStroke=this.closeStroke,z},st.prototype.contains=function(z,U){for(var ft=!1,$=this.points.length/2,gt=0,Lt=$-1;gt<$;Lt=gt++){var K=this.points[2*gt],dt=this.points[2*gt+1],it=this.points[2*Lt],_t=this.points[2*Lt+1];dt>U!=_t>U&&z<(U-dt)/(_t-dt)*(it-K)+K&&(ft=!ft)}return ft},st.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce(function(z,U){return z+", "+U},"")+"]"},st}(),Dt=function(){function st(z,U,ft,$,gt){z===void 0&&(z=0),U===void 0&&(U=0),ft===void 0&&(ft=0),$===void 0&&($=0),gt===void 0&&(gt=20),this.x=z,this.y=U,this.width=ft,this.height=$,this.radius=gt,this.type=P.RREC}return st.prototype.clone=function(){return new st(this.x,this.y,this.width,this.height,this.radius)},st.prototype.contains=function(z,U){if(this.width<=0||this.height<=0)return!1;if(z>=this.x&&z<=this.x+this.width&&U>=this.y&&U<=this.y+this.height){var ft=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(U>=this.y+ft&&U<=this.y+this.height-ft||z>=this.x+ft&&z<=this.x+this.width-ft)return!0;var $=z-(this.x+ft),gt=U-(this.y+ft),Lt=ft*ft;if($*$+gt*gt<=Lt||($=z-(this.x+this.width-ft))*$+gt*gt<=Lt||$*$+(gt=U-(this.y+this.height-ft))*gt<=Lt||($=z-(this.x+ft))*$+gt*gt<=Lt)return!0}return!1},st.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},st}(),At=function(){function st(z,U,ft,$){ft===void 0&&(ft=0),$===void 0&&($=0),this._x=ft,this._y=$,this.cb=z,this.scope=U}return st.prototype.clone=function(z,U){return z===void 0&&(z=this.cb),U===void 0&&(U=this.scope),new st(z,U,this._x,this._y)},st.prototype.set=function(z,U){return z===void 0&&(z=0),U===void 0&&(U=z),this._x===z&&this._y===U||(this._x=z,this._y=U,this.cb.call(this.scope)),this},st.prototype.copyFrom=function(z){return this._x===z.x&&this._y===z.y||(this._x=z.x,this._y=z.y,this.cb.call(this.scope)),this},st.prototype.copyTo=function(z){return z.set(this._x,this._y),z},st.prototype.equals=function(z){return z.x===this._x&&z.y===this._y},st.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(st.prototype,"x",{get:function(){return this._x},set:function(z){this._x!==z&&(this._x=z,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(st.prototype,"y",{get:function(){return this._y},set:function(z){this._y!==z&&(this._y=z,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),st}(),L=function(){function st(z,U,ft,$,gt,Lt){z===void 0&&(z=1),U===void 0&&(U=0),ft===void 0&&(ft=0),$===void 0&&($=1),gt===void 0&&(gt=0),Lt===void 0&&(Lt=0),this.array=null,this.a=z,this.b=U,this.c=ft,this.d=$,this.tx=gt,this.ty=Lt}return st.prototype.fromArray=function(z){this.a=z[0],this.b=z[1],this.c=z[3],this.d=z[4],this.tx=z[2],this.ty=z[5]},st.prototype.set=function(z,U,ft,$,gt,Lt){return this.a=z,this.b=U,this.c=ft,this.d=$,this.tx=gt,this.ty=Lt,this},st.prototype.toArray=function(z,U){this.array||(this.array=new Float32Array(9));var ft=U||this.array;return z?(ft[0]=this.a,ft[1]=this.b,ft[2]=0,ft[3]=this.c,ft[4]=this.d,ft[5]=0,ft[6]=this.tx,ft[7]=this.ty,ft[8]=1):(ft[0]=this.a,ft[1]=this.c,ft[2]=this.tx,ft[3]=this.b,ft[4]=this.d,ft[5]=this.ty,ft[6]=0,ft[7]=0,ft[8]=1),ft},st.prototype.apply=function(z,U){U=U||new k;var ft=z.x,$=z.y;return U.x=this.a*ft+this.c*$+this.tx,U.y=this.b*ft+this.d*$+this.ty,U},st.prototype.applyInverse=function(z,U){U=U||new k;var ft=1/(this.a*this.d+this.c*-this.b),$=z.x,gt=z.y;return U.x=this.d*ft*$+-this.c*ft*gt+(this.ty*this.c-this.tx*this.d)*ft,U.y=this.a*ft*gt+-this.b*ft*$+(-this.ty*this.a+this.tx*this.b)*ft,U},st.prototype.translate=function(z,U){return this.tx+=z,this.ty+=U,this},st.prototype.scale=function(z,U){return this.a*=z,this.d*=U,this.c*=z,this.b*=U,this.tx*=z,this.ty*=U,this},st.prototype.rotate=function(z){var U=Math.cos(z),ft=Math.sin(z),$=this.a,gt=this.c,Lt=this.tx;return this.a=$*U-this.b*ft,this.b=$*ft+this.b*U,this.c=gt*U-this.d*ft,this.d=gt*ft+this.d*U,this.tx=Lt*U-this.ty*ft,this.ty=Lt*ft+this.ty*U,this},st.prototype.append=function(z){var U=this.a,ft=this.b,$=this.c,gt=this.d;return this.a=z.a*U+z.b*$,this.b=z.a*ft+z.b*gt,this.c=z.c*U+z.d*$,this.d=z.c*ft+z.d*gt,this.tx=z.tx*U+z.ty*$+this.tx,this.ty=z.tx*ft+z.ty*gt+this.ty,this},st.prototype.setTransform=function(z,U,ft,$,gt,Lt,K,dt,it){return this.a=Math.cos(K+it)*gt,this.b=Math.sin(K+it)*gt,this.c=-Math.sin(K-dt)*Lt,this.d=Math.cos(K-dt)*Lt,this.tx=z-(ft*this.a+$*this.c),this.ty=U-(ft*this.b+$*this.d),this},st.prototype.prepend=function(z){var U=this.tx;if(z.a!==1||z.b!==0||z.c!==0||z.d!==1){var ft=this.a,$=this.c;this.a=ft*z.a+this.b*z.c,this.b=ft*z.b+this.b*z.d,this.c=$*z.a+this.d*z.c,this.d=$*z.b+this.d*z.d}return this.tx=U*z.a+this.ty*z.c+z.tx,this.ty=U*z.b+this.ty*z.d+z.ty,this},st.prototype.decompose=function(z){var U=this.a,ft=this.b,$=this.c,gt=this.d,Lt=z.pivot,K=-Math.atan2(-$,gt),dt=Math.atan2(ft,U),it=Math.abs(K+dt);return it<1e-5||Math.abs(M-it)<1e-5?(z.rotation=dt,z.skew.x=z.skew.y=0):(z.rotation=0,z.skew.x=K,z.skew.y=dt),z.scale.x=Math.sqrt(U*U+ft*ft),z.scale.y=Math.sqrt($*$+gt*gt),z.position.x=this.tx+(Lt.x*U+Lt.y*$),z.position.y=this.ty+(Lt.x*ft+Lt.y*gt),z},st.prototype.invert=function(){var z=this.a,U=this.b,ft=this.c,$=this.d,gt=this.tx,Lt=z*$-U*ft;return this.a=$/Lt,this.b=-U/Lt,this.c=-ft/Lt,this.d=z/Lt,this.tx=(ft*this.ty-$*gt)/Lt,this.ty=-(z*this.ty-U*gt)/Lt,this},st.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},st.prototype.clone=function(){var z=new st;return z.a=this.a,z.b=this.b,z.c=this.c,z.d=this.d,z.tx=this.tx,z.ty=this.ty,z},st.prototype.copyTo=function(z){return z.a=this.a,z.b=this.b,z.c=this.c,z.d=this.d,z.tx=this.tx,z.ty=this.ty,z},st.prototype.copyFrom=function(z){return this.a=z.a,this.b=z.b,this.c=z.c,this.d=z.d,this.tx=z.tx,this.ty=z.ty,this},st.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(st,"IDENTITY",{get:function(){return new st},enumerable:!1,configurable:!0}),Object.defineProperty(st,"TEMP_MATRIX",{get:function(){return new st},enumerable:!1,configurable:!0}),st}(),R=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],F=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Y=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],O=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],H=[],tt=[],G=Math.sign;(function(){for(var st=0;st<16;st++){var z=[];H.push(z);for(var U=0;U<16;U++)for(var ft=G(R[st]*R[U]+Y[st]*F[U]),$=G(F[st]*R[U]+O[st]*F[U]),gt=G(R[st]*Y[U]+Y[st]*O[U]),Lt=G(F[st]*Y[U]+O[st]*O[U]),K=0;K<16;K++)if(R[K]===ft&&F[K]===$&&Y[K]===gt&&O[K]===Lt){z.push(K);break}}for(st=0;st<16;st++){var dt=new L;dt.set(R[st],F[st],Y[st],O[st],0,0),tt.push(dt)}})();var Ot={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(st){return R[st]},uY:function(st){return F[st]},vX:function(st){return Y[st]},vY:function(st){return O[st]},inv:function(st){return 8&st?15&st:7&-st},add:function(st,z){return H[st][z]},sub:function(st,z){return H[st][Ot.inv(z)]},rotate180:function(st){return 4^st},isVertical:function(st){return(3&st)==2},byDirection:function(st,z){return 2*Math.abs(st)<=Math.abs(z)?z>=0?Ot.S:Ot.N:2*Math.abs(z)<=Math.abs(st)?st>0?Ot.E:Ot.W:z>0?st>0?Ot.SE:Ot.SW:st>0?Ot.NE:Ot.NW},matrixAppendRotationInv:function(st,z,U,ft){U===void 0&&(U=0),ft===void 0&&(ft=0);var $=tt[Ot.inv(z)];$.tx=U,$.ty=ft,st.append($)}},Vt=function(){function st(){this.worldTransform=new L,this.localTransform=new L,this.position=new At(this.onChange,this,0,0),this.scale=new At(this.onChange,this,1,1),this.pivot=new At(this.onChange,this,0,0),this.skew=new At(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return st.prototype.onChange=function(){this._localID++},st.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},st.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},st.prototype.updateLocalTransform=function(){var z=this.localTransform;this._localID!==this._currentLocalID&&(z.a=this._cx*this.scale.x,z.b=this._sx*this.scale.x,z.c=this._cy*this.scale.y,z.d=this._sy*this.scale.y,z.tx=this.position.x-(this.pivot.x*z.a+this.pivot.y*z.c),z.ty=this.position.y-(this.pivot.x*z.b+this.pivot.y*z.d),this._currentLocalID=this._localID,this._parentID=-1)},st.prototype.updateTransform=function(z){var U=this.localTransform;if(this._localID!==this._currentLocalID&&(U.a=this._cx*this.scale.x,U.b=this._sx*this.scale.x,U.c=this._cy*this.scale.y,U.d=this._sy*this.scale.y,U.tx=this.position.x-(this.pivot.x*U.a+this.pivot.y*U.c),U.ty=this.position.y-(this.pivot.x*U.b+this.pivot.y*U.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==z._worldID){var ft=z.worldTransform,$=this.worldTransform;$.a=U.a*ft.a+U.b*ft.c,$.b=U.a*ft.b+U.b*ft.d,$.c=U.c*ft.a+U.d*ft.c,$.d=U.c*ft.b+U.d*ft.d,$.tx=U.tx*ft.a+U.ty*ft.c+ft.tx,$.ty=U.tx*ft.b+U.ty*ft.d+ft.ty,this._parentID=z._worldID,this._worldID++}},st.prototype.setFromMatrix=function(z){z.decompose(this),this._localID++},Object.defineProperty(st.prototype,"rotation",{get:function(){return this._rotation},set:function(z){this._rotation!==z&&(this._rotation=z,this.updateSkew())},enumerable:!1,configurable:!0}),st.IDENTITY=new st,st}()},function(b,A,v){v.d(A,"a",function(){return bi}),v.d(A,"b",function(){return $}),v.d(A,"c",function(){return F}),v.d(A,"d",function(){return Ro}),v.d(A,"e",function(){return sr}),v.d(A,"f",function(){return No}),v.d(A,"g",function(){return Ur}),v.d(A,"h",function(){return Xt}),v.d(A,"i",function(){return L}),v.d(A,"j",function(){return tt}),v.d(A,"k",function(){return Ci}),v.d(A,"l",function(){return Oe}),v.d(A,"m",function(){return pe}),v.d(A,"n",function(){return zn}),v.d(A,"o",function(){return ze}),v.d(A,"p",function(){return it}),v.d(A,"q",function(){return Ni}),v.d(A,"r",function(){return Zi}),v.d(A,"s",function(){return qr}),v.d(A,"t",function(){return dt}),v.d(A,"u",function(){return Fr}),v.d(A,"v",function(){return cn}),v.d(A,"w",function(){return st}),v.d(A,"x",function(){return Io}),v.d(A,"y",function(){return ho}),v.d(A,"z",function(){return Xn}),v.d(A,"A",function(){return mi});var P=v(4),M=v(0),I=v(3),D=v(12),k=v(7),W=v(1);/*!
 * @pixi/core - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */P.b.PREFER_ENV=I.isMobile.any?M.g.WEBGL:M.g.WEBGL2,P.b.STRICT_TEXTURE_CACHE=!1;var X=[];function V(q,g){if(!q)return null;var m="";if(typeof q=="string"){var _=/\.(\w{3,4})(?:$|\?|#)/i.exec(q);_&&(m=_[1].toLowerCase())}for(var N=X.length-1;N>=0;--N){var J=X[N];if(J.test&&J.test(q,m))return new J(q,g)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var et=function(q,g){return(et=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,_){m.__proto__=_}||function(m,_){for(var N in _)_.hasOwnProperty(N)&&(m[N]=_[N])})(q,g)};function pt(q,g){function m(){this.constructor=q}et(q,g),q.prototype=g===null?Object.create(g):(m.prototype=g.prototype,new m)}var Dt=function(){return(Dt=Object.assign||function(q){for(var g,m=arguments,_=1,N=arguments.length;_<N;_++)for(var J in g=m[_])Object.prototype.hasOwnProperty.call(g,J)&&(q[J]=g[J]);return q}).apply(this,arguments)},At=function(){function q(g,m){g===void 0&&(g=0),m===void 0&&(m=0),this._width=g,this._height=m,this.destroyed=!1,this.internal=!1,this.onResize=new D.a("setRealSize"),this.onUpdate=new D.a("update"),this.onError=new D.a("onError")}return q.prototype.bind=function(g){this.onResize.add(g),this.onUpdate.add(g),this.onError.add(g),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},q.prototype.unbind=function(g){this.onResize.remove(g),this.onUpdate.remove(g),this.onError.remove(g)},q.prototype.resize=function(g,m){g===this._width&&m===this._height||(this._width=g,this._height=m,this.onResize.emit(g,m))},Object.defineProperty(q.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),q.prototype.update=function(){this.destroyed||this.onUpdate.emit()},q.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(q.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),q.prototype.style=function(g,m,_){return!1},q.prototype.dispose=function(){},q.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},q.test=function(g,m){return!1},q}(),L=function(q){function g(m,_){var N=this,J=_||{},lt=J.width,xt=J.height;if(!lt||!xt)throw new Error("BufferResource width or height invalid");return(N=q.call(this,lt,xt)||this).data=m,N}return pt(g,q),g.prototype.upload=function(m,_,N){var J=m.gl;J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_.alphaMode===M.a.UNPACK);var lt=_.realWidth,xt=_.realHeight;return N.width===lt&&N.height===xt?J.texSubImage2D(_.target,0,0,0,lt,xt,_.format,N.type,this.data):(N.width=lt,N.height=xt,J.texImage2D(_.target,0,N.internalFormat,lt,xt,0,_.format,N.type,this.data)),!0},g.prototype.dispose=function(){this.data=null},g.test=function(m){return m instanceof Float32Array||m instanceof Uint8Array||m instanceof Uint32Array},g}(At),R={scaleMode:M.p.NEAREST,format:M.h.RGBA,alphaMode:M.a.NPM},F=function(q){function g(m,_){m===void 0&&(m=null),_===void 0&&(_=null);var N=q.call(this)||this,J=(_=_||{}).alphaMode,lt=_.mipmap,xt=_.anisotropicLevel,Tt=_.scaleMode,Zt=_.width,ee=_.height,Fe=_.wrapMode,Te=_.format,Qe=_.type,hn=_.target,vn=_.resolution,un=_.resourceOptions;return!m||m instanceof At||((m=V(m,un)).internal=!0),N.resolution=vn||P.b.RESOLUTION,N.width=Math.round((Zt||0)*N.resolution)/N.resolution,N.height=Math.round((ee||0)*N.resolution)/N.resolution,N._mipmap=lt!==void 0?lt:P.b.MIPMAP_TEXTURES,N.anisotropicLevel=xt!==void 0?xt:P.b.ANISOTROPIC_LEVEL,N._wrapMode=Fe||P.b.WRAP_MODE,N._scaleMode=Tt!==void 0?Tt:P.b.SCALE_MODE,N.format=Te||M.h.RGBA,N.type=Qe||M.r.UNSIGNED_BYTE,N.target=hn||M.q.TEXTURE_2D,N.alphaMode=J!==void 0?J:M.a.UNPACK,N.uid=Object(I.uid)(),N.touched=0,N.isPowerOfTwo=!1,N._refreshPOT(),N._glTextures={},N.dirtyId=0,N.dirtyStyleId=0,N.cacheId=null,N.valid=Zt>0&&ee>0,N.textureCacheIds=[],N.destroyed=!1,N.resource=null,N._batchEnabled=0,N._batchLocation=0,N.parentTextureArray=null,N.setResource(m),N}return pt(g,q),Object.defineProperty(g.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"mipmap",{get:function(){return this._mipmap},set:function(m){this._mipmap!==m&&(this._mipmap=m,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(m){this._scaleMode!==m&&(this._scaleMode=m,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(m){this._wrapMode!==m&&(this._wrapMode=m,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),g.prototype.setStyle=function(m,_){var N;return m!==void 0&&m!==this.scaleMode&&(this.scaleMode=m,N=!0),_!==void 0&&_!==this.mipmap&&(this.mipmap=_,N=!0),N&&this.dirtyStyleId++,this},g.prototype.setSize=function(m,_,N){return N=N||this.resolution,this.setRealSize(m*N,_*N,N)},g.prototype.setRealSize=function(m,_,N){return this.resolution=N||this.resolution,this.width=Math.round(m)/this.resolution,this.height=Math.round(_)/this.resolution,this._refreshPOT(),this.update(),this},g.prototype._refreshPOT=function(){this.isPowerOfTwo=Object(I.isPow2)(this.realWidth)&&Object(I.isPow2)(this.realHeight)},g.prototype.setResolution=function(m){var _=this.resolution;return _===m||(this.resolution=m,this.valid&&(this.width=Math.round(this.width*_)/m,this.height=Math.round(this.height*_)/m,this.emit("update",this)),this._refreshPOT()),this},g.prototype.setResource=function(m){if(this.resource===m)return this;if(this.resource)throw new Error("Resource can be set only once");return m.bind(this),this.resource=m,this},g.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},g.prototype.onError=function(m){this.emit("error",this,m)},g.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete I.BaseTextureCache[this.cacheId],delete I.TextureCache[this.cacheId],this.cacheId=null),this.dispose(),g.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},g.prototype.dispose=function(){this.emit("dispose",this)},g.prototype.castToBaseTexture=function(){return this},g.from=function(m,_,N){N===void 0&&(N=P.b.STRICT_TEXTURE_CACHE);var J=typeof m=="string",lt=null;if(J)lt=m;else{if(!m._pixiId){var xt=_&&_.pixiIdPrefix||"pixiid";m._pixiId=xt+"_"+Object(I.uid)()}lt=m._pixiId}var Tt=I.BaseTextureCache[lt];if(J&&N&&!Tt)throw new Error('The cacheId "'+lt+'" does not exist in BaseTextureCache.');return Tt||((Tt=new g(m,_)).cacheId=lt,g.addToCache(Tt,lt)),Tt},g.fromBuffer=function(m,_,N,J){m=m||new Float32Array(_*N*4);var lt=new L(m,{width:_,height:N}),xt=m instanceof Float32Array?M.r.FLOAT:M.r.UNSIGNED_BYTE;return new g(lt,Object.assign(R,J||{width:_,height:N,type:xt}))},g.addToCache=function(m,_){_&&(m.textureCacheIds.indexOf(_)===-1&&m.textureCacheIds.push(_),I.BaseTextureCache[_]&&console.warn("BaseTexture added to the cache with an id ["+_+"] that already had an entry"),I.BaseTextureCache[_]=m)},g.removeFromCache=function(m){if(typeof m=="string"){var _=I.BaseTextureCache[m];if(_){var N=_.textureCacheIds.indexOf(m);return N>-1&&_.textureCacheIds.splice(N,1),delete I.BaseTextureCache[m],_}}else if(m&&m.textureCacheIds){for(var J=0;J<m.textureCacheIds.length;++J)delete I.BaseTextureCache[m.textureCacheIds[J]];return m.textureCacheIds.length=0,m}return null},g._globalBatch=0,g}(I.EventEmitter),Y=function(q){function g(m,_){var N=this,J=_||{},lt=J.width,xt=J.height;(N=q.call(this,lt,xt)||this).items=[],N.itemDirtyIds=[];for(var Tt=0;Tt<m;Tt++){var Zt=new F;N.items.push(Zt),N.itemDirtyIds.push(-2)}return N.length=m,N._load=null,N.baseTexture=null,N}return pt(g,q),g.prototype.initFromArray=function(m,_){for(var N=0;N<this.length;N++)m[N]&&(m[N].castToBaseTexture?this.addBaseTextureAt(m[N].castToBaseTexture(),N):m[N]instanceof At?this.addResourceAt(m[N],N):this.addResourceAt(V(m[N],_),N))},g.prototype.dispose=function(){for(var m=0,_=this.length;m<_;m++)this.items[m].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},g.prototype.addResourceAt=function(m,_){if(!this.items[_])throw new Error("Index "+_+" is out of bounds");return m.valid&&!this.valid&&this.resize(m.width,m.height),this.items[_].setResource(m),this},g.prototype.bind=function(m){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");q.prototype.bind.call(this,m);for(var _=0;_<this.length;_++)this.items[_].parentTextureArray=m,this.items[_].on("update",m.update,m)},g.prototype.unbind=function(m){q.prototype.unbind.call(this,m);for(var _=0;_<this.length;_++)this.items[_].parentTextureArray=null,this.items[_].off("update",m.update,m)},g.prototype.load=function(){var m=this;if(this._load)return this._load;var _=this.items.map(function(N){return N.resource}).filter(function(N){return N}).map(function(N){return N.load()});return this._load=Promise.all(_).then(function(){var N=m.items[0],J=N.realWidth,lt=N.realHeight;return m.resize(J,lt),Promise.resolve(m)}),this._load},g}(At),O=function(q){function g(m,_){var N,J,lt=this,xt=_||{},Tt=xt.width,Zt=xt.height;return Array.isArray(m)?(N=m,J=m.length):J=m,lt=q.call(this,J,{width:Tt,height:Zt})||this,N&&lt.initFromArray(N,_),lt}return pt(g,q),g.prototype.addBaseTextureAt=function(m,_){if(!m.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(m.resource,_),this},g.prototype.bind=function(m){q.prototype.bind.call(this,m),m.target=M.q.TEXTURE_2D_ARRAY},g.prototype.upload=function(m,_,N){var J=this.length,lt=this.itemDirtyIds,xt=this.items,Tt=m.gl;N.dirtyId<0&&Tt.texImage3D(Tt.TEXTURE_2D_ARRAY,0,N.internalFormat,this._width,this._height,J,0,_.format,N.type,null);for(var Zt=0;Zt<J;Zt++){var ee=xt[Zt];lt[Zt]<ee.dirtyId&&(lt[Zt]=ee.dirtyId,ee.valid&&Tt.texSubImage3D(Tt.TEXTURE_2D_ARRAY,0,0,0,Zt,ee.resource.width,ee.resource.height,1,_.format,N.type,ee.resource.source))}return!0},g}(Y),H=function(q){function g(m){var _=this,N=m,J=N.naturalWidth||N.videoWidth||N.width,lt=N.naturalHeight||N.videoHeight||N.height;return(_=q.call(this,J,lt)||this).source=m,_.noSubImage=!1,_}return pt(g,q),g.crossOrigin=function(m,_,N){N===void 0&&_.indexOf("data:")!==0?m.crossOrigin=Object(I.determineCrossOrigin)(_):N!==!1&&(m.crossOrigin=typeof N=="string"?N:"anonymous")},g.prototype.upload=function(m,_,N,J){var lt=m.gl,xt=_.realWidth,Tt=_.realHeight;if((J=J||this.source)instanceof HTMLImageElement){if(!J.complete||J.naturalWidth===0)return!1}else if(J instanceof HTMLVideoElement&&J.readyState<=1)return!1;return lt.pixelStorei(lt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_.alphaMode===M.a.UNPACK),this.noSubImage||_.target!==lt.TEXTURE_2D||N.width!==xt||N.height!==Tt?(N.width=xt,N.height=Tt,lt.texImage2D(_.target,0,N.internalFormat,_.format,N.type,J)):lt.texSubImage2D(lt.TEXTURE_2D,0,0,0,_.format,N.type,J),!0},g.prototype.update=function(){if(!this.destroyed){var m=this.source,_=m.naturalWidth||m.videoWidth||m.width,N=m.naturalHeight||m.videoHeight||m.height;this.resize(_,N),q.prototype.update.call(this)}},g.prototype.dispose=function(){this.source=null},g}(At),tt=function(q){function g(m){return q.call(this,m)||this}return pt(g,q),g.test=function(m){var _=globalThis.OffscreenCanvas;return!!(_&&m instanceof _)||globalThis.HTMLCanvasElement&&m instanceof HTMLCanvasElement},g}(H),G=function(q){function g(m,_){var N=this,J=_||{},lt=J.width,xt=J.height,Tt=J.autoLoad,Zt=J.linkBaseTexture;if(m&&m.length!==g.SIDES)throw new Error("Invalid length. Got "+m.length+", expected 6");N=q.call(this,6,{width:lt,height:xt})||this;for(var ee=0;ee<g.SIDES;ee++)N.items[ee].target=M.q.TEXTURE_CUBE_MAP_POSITIVE_X+ee;return N.linkBaseTexture=Zt!==!1,m&&N.initFromArray(m,_),Tt!==!1&&N.load(),N}return pt(g,q),g.prototype.bind=function(m){q.prototype.bind.call(this,m),m.target=M.q.TEXTURE_CUBE_MAP},g.prototype.addBaseTextureAt=function(m,_,N){if(!this.items[_])throw new Error("Index "+_+" is out of bounds");if(!this.linkBaseTexture||m.parentTextureArray||Object.keys(m._glTextures).length>0){if(!m.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(m.resource,_)}else m.target=M.q.TEXTURE_CUBE_MAP_POSITIVE_X+_,m.parentTextureArray=this.baseTexture,this.items[_]=m;return m.valid&&!this.valid&&this.resize(m.realWidth,m.realHeight),this.items[_]=m,this},g.prototype.upload=function(m,_,N){for(var J=this.itemDirtyIds,lt=0;lt<g.SIDES;lt++){var xt=this.items[lt];J[lt]<xt.dirtyId&&(xt.valid&&xt.resource?(xt.resource.upload(m,xt,N),J[lt]=xt.dirtyId):J[lt]<-1&&(m.gl.texImage2D(xt.target,0,N.internalFormat,_.realWidth,_.realHeight,0,_.format,N.type,null),J[lt]=-1))}return!0},g.test=function(m){return Array.isArray(m)&&m.length===g.SIDES},g.SIDES=6,g}(Y),Ot=function(q){function g(m,_){var N=this;if(_=_||{},!(m instanceof HTMLImageElement)){var J=new Image;H.crossOrigin(J,m,_.crossorigin),J.src=m,m=J}return N=q.call(this,m)||this,!m.complete&&N._width&&N._height&&(N._width=0,N._height=0),N.url=m.src,N._process=null,N.preserveBitmap=!1,N.createBitmap=(_.createBitmap!==void 0?_.createBitmap:P.b.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,N.alphaMode=typeof _.alphaMode=="number"?_.alphaMode:null,N.bitmap=null,N._load=null,_.autoLoad!==!1&&N.load(),N}return pt(g,q),g.prototype.load=function(m){var _=this;return this._load||(m!==void 0&&(this.createBitmap=m),this._load=new Promise(function(N,J){var lt=_.source;_.url=lt.src;var xt=function(){_.destroyed||(lt.onload=null,lt.onerror=null,_.resize(lt.width,lt.height),_._load=null,_.createBitmap?N(_.process()):N(_))};lt.complete&&lt.src?xt():(lt.onload=xt,lt.onerror=function(Tt){J(Tt),_.onError.emit(Tt)})})),this._load},g.prototype.process=function(){var m=this,_=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var N=globalThis.createImageBitmap,J=!_.crossOrigin||_.crossOrigin==="anonymous";return this._process=fetch(_.src,{mode:J?"cors":"no-cors"}).then(function(lt){return lt.blob()}).then(function(lt){return N(lt,0,0,_.width,_.height,{premultiplyAlpha:m.alphaMode===M.a.UNPACK?"premultiply":"none"})}).then(function(lt){return m.destroyed?Promise.reject():(m.bitmap=lt,m.update(),m._process=null,Promise.resolve(m))}),this._process},g.prototype.upload=function(m,_,N){if(typeof this.alphaMode=="number"&&(_.alphaMode=this.alphaMode),!this.createBitmap)return q.prototype.upload.call(this,m,_,N);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(q.prototype.upload.call(this,m,_,N,this.bitmap),!this.preserveBitmap){var J=!0,lt=_._glTextures;for(var xt in lt){var Tt=lt[xt];if(Tt!==N&&Tt.dirtyId!==_.dirtyId){J=!1;break}}J&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},g.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,q.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},g.test=function(m){return typeof m=="string"||m instanceof HTMLImageElement},g}(H),Vt=function(q){function g(m,_){var N=this;return _=_||{},(N=q.call(this,document.createElement("canvas"))||this)._width=0,N._height=0,N.svg=m,N.scale=_.scale||1,N._overrideWidth=_.width,N._overrideHeight=_.height,N._resolve=null,N._crossorigin=_.crossorigin,N._load=null,_.autoLoad!==!1&&N.load(),N}return pt(g,q),g.prototype.load=function(){var m=this;return this._load||(this._load=new Promise(function(_){if(m._resolve=function(){m.resize(m.source.width,m.source.height),_(m)},g.SVG_XML.test(m.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");m.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(m.svg)))}m._loadSvg()})),this._load},g.prototype._loadSvg=function(){var m=this,_=new Image;H.crossOrigin(_,this.svg,this._crossorigin),_.src=this.svg,_.onerror=function(N){m._resolve&&(_.onerror=null,m.onError.emit(N))},_.onload=function(){if(m._resolve){var N=_.width,J=_.height;if(!N||!J)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var lt=N*m.scale,xt=J*m.scale;(m._overrideWidth||m._overrideHeight)&&(lt=m._overrideWidth||m._overrideHeight/J*N,xt=m._overrideHeight||m._overrideWidth/N*J),lt=Math.round(lt),xt=Math.round(xt);var Tt=m.source;Tt.width=lt,Tt.height=xt,Tt._pixiId="canvas_"+Object(I.uid)(),Tt.getContext("2d").drawImage(_,0,0,N,J,0,0,lt,xt),m._resolve(),m._resolve=null}}},g.getSize=function(m){var _=g.SVG_SIZE.exec(m),N={};return _&&(N[_[1]]=Math.round(parseFloat(_[3])),N[_[5]]=Math.round(parseFloat(_[7]))),N},g.prototype.dispose=function(){q.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},g.test=function(m,_){return _==="svg"||typeof m=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(m)||typeof m=="string"&&g.SVG_XML.test(m)},g.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,g.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,g}(H),st=function(q){function g(m,_){var N=this;if(_=_||{},!(m instanceof HTMLVideoElement)){var J=document.createElement("video");J.setAttribute("preload","auto"),J.setAttribute("webkit-playsinline",""),J.setAttribute("playsinline",""),typeof m=="string"&&(m=[m]);var lt=m[0].src||m[0];H.crossOrigin(J,lt,_.crossorigin);for(var xt=0;xt<m.length;++xt){var Tt=document.createElement("source"),Zt=m[xt],ee=Zt.src,Fe=Zt.mime,Te=(ee=ee||m[xt]).split("?").shift().toLowerCase(),Qe=Te.slice(Te.lastIndexOf(".")+1);Fe=Fe||g.MIME_TYPES[Qe]||"video/"+Qe,Tt.src=ee,Tt.type=Fe,J.appendChild(Tt)}m=J}return(N=q.call(this,m)||this).noSubImage=!0,N._autoUpdate=!0,N._isConnectedToTicker=!1,N._updateFPS=_.updateFPS||0,N._msToNextUpdate=0,N.autoPlay=_.autoPlay!==!1,N._load=null,N._resolve=null,N._onCanPlay=N._onCanPlay.bind(N),N._onError=N._onError.bind(N),_.autoLoad!==!1&&N.load(),N}return pt(g,q),g.prototype.update=function(m){if(!this.destroyed){var _=k.a.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-_),(!this._updateFPS||this._msToNextUpdate<=0)&&(q.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},g.prototype.load=function(){var m=this;if(this._load)return this._load;var _=this.source;return(_.readyState===_.HAVE_ENOUGH_DATA||_.readyState===_.HAVE_FUTURE_DATA)&&_.width&&_.height&&(_.complete=!0),_.addEventListener("play",this._onPlayStart.bind(this)),_.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(_.addEventListener("canplay",this._onCanPlay),_.addEventListener("canplaythrough",this._onCanPlay),_.addEventListener("error",this._onError,!0)),this._load=new Promise(function(N){m.valid?N(m):(m._resolve=N,_.load())}),this._load},g.prototype._onError=function(m){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(m)},g.prototype._isSourcePlaying=function(){var m=this.source;return m.currentTime>0&&m.paused===!1&&m.ended===!1&&m.readyState>2},g.prototype._isSourceReady=function(){var m=this.source;return m.readyState===3||m.readyState===4},g.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(k.a.shared.add(this.update,this),this._isConnectedToTicker=!0)},g.prototype._onPlayStop=function(){this._isConnectedToTicker&&(k.a.shared.remove(this.update,this),this._isConnectedToTicker=!1)},g.prototype._onCanPlay=function(){var m=this.source;m.removeEventListener("canplay",this._onCanPlay),m.removeEventListener("canplaythrough",this._onCanPlay);var _=this.valid;this.resize(m.videoWidth,m.videoHeight),!_&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&m.play()},g.prototype.dispose=function(){this._isConnectedToTicker&&(k.a.shared.remove(this.update,this),this._isConnectedToTicker=!1);var m=this.source;m&&(m.removeEventListener("error",this._onError,!0),m.pause(),m.src="",m.load()),q.prototype.dispose.call(this)},Object.defineProperty(g.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(m){m!==this._autoUpdate&&(this._autoUpdate=m,!this._autoUpdate&&this._isConnectedToTicker?(k.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(k.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(m){m!==this._updateFPS&&(this._updateFPS=m)},enumerable:!1,configurable:!0}),g.test=function(m,_){return globalThis.HTMLVideoElement&&m instanceof HTMLVideoElement||g.TYPES.indexOf(_)>-1},g.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],g.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},g}(H),z=function(q){function g(m){return q.call(this,m)||this}return pt(g,q),g.test=function(m){return!!globalThis.createImageBitmap&&m instanceof ImageBitmap},g}(H);X.push(Ot,z,tt,st,Vt,L,G,O);var U=function(q){function g(){return q!==null&&q.apply(this,arguments)||this}return pt(g,q),g.prototype.upload=function(m,_,N){var J=m.gl;J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_.alphaMode===M.a.UNPACK);var lt=_.realWidth,xt=_.realHeight;return N.width===lt&&N.height===xt?J.texSubImage2D(_.target,0,0,0,lt,xt,_.format,N.type,this.data):(N.width=lt,N.height=xt,J.texImage2D(_.target,0,N.internalFormat,lt,xt,0,_.format,N.type,this.data)),!0},g}(L),ft=function(){function q(g,m){this.width=Math.round(g||100),this.height=Math.round(m||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new D.a("disposeFramebuffer"),this.multisample=M.l.NONE}return Object.defineProperty(q.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),q.prototype.addColorTexture=function(g,m){return g===void 0&&(g=0),this.colorTextures[g]=m||new F(null,{scaleMode:M.p.NEAREST,resolution:1,mipmap:M.k.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},q.prototype.addDepthTexture=function(g){return this.depthTexture=g||new F(new U(null,{width:this.width,height:this.height}),{scaleMode:M.p.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:M.k.OFF,format:M.h.DEPTH_COMPONENT,type:M.r.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},q.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},q.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},q.prototype.resize=function(g,m){if(g=Math.round(g),m=Math.round(m),g!==this.width||m!==this.height){this.width=g,this.height=m,this.dirtyId++,this.dirtySize++;for(var _=0;_<this.colorTextures.length;_++){var N=this.colorTextures[_],J=N.resolution;N.setSize(g/J,m/J)}this.depthTexture&&(J=this.depthTexture.resolution,this.depthTexture.setSize(g/J,m/J))}},q.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},q.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},q}(),$=function(q){function g(m){m===void 0&&(m={});var _=this;if(typeof m=="number"){var N=arguments[0],J=arguments[1],lt=arguments[2],xt=arguments[3];m={width:N,height:J,scaleMode:lt,resolution:xt}}return m.width=m.width||100,m.height=m.height||100,m.multisample=m.multisample!==void 0?m.multisample:M.l.NONE,(_=q.call(this,null,m)||this).mipmap=M.k.OFF,_.valid=!0,_.clearColor=[0,0,0,0],_.framebuffer=new ft(_.realWidth,_.realHeight).addColorTexture(0,_),_.framebuffer.multisample=m.multisample,_.maskStack=[],_.filterStack=[{}],_}return pt(g,q),g.prototype.resize=function(m,_){this.framebuffer.resize(m*this.resolution,_*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},g.prototype.dispose=function(){this.framebuffer.dispose(),q.prototype.dispose.call(this)},g.prototype.destroy=function(){q.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},g}(F),gt=function(){function q(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return q.prototype.set=function(g,m,_){var N=m.width,J=m.height;if(_){var lt=g.width/2/N,xt=g.height/2/J,Tt=g.x/N+lt,Zt=g.y/J+xt;_=W.n.add(_,W.n.NW),this.x0=Tt+lt*W.n.uX(_),this.y0=Zt+xt*W.n.uY(_),_=W.n.add(_,2),this.x1=Tt+lt*W.n.uX(_),this.y1=Zt+xt*W.n.uY(_),_=W.n.add(_,2),this.x2=Tt+lt*W.n.uX(_),this.y2=Zt+xt*W.n.uY(_),_=W.n.add(_,2),this.x3=Tt+lt*W.n.uX(_),this.y3=Zt+xt*W.n.uY(_)}else this.x0=g.x/N,this.y0=g.y/J,this.x1=(g.x+g.width)/N,this.y1=g.y/J,this.x2=(g.x+g.width)/N,this.y2=(g.y+g.height)/J,this.x3=g.x/N,this.y3=(g.y+g.height)/J;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},q.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},q}(),Lt=new gt;function K(q){q.destroy=function(){},q.on=function(){},q.once=function(){},q.emit=function(){}}var dt=function(q){function g(m,_,N,J,lt,xt){var Tt=q.call(this)||this;if(Tt.noFrame=!1,_||(Tt.noFrame=!0,_=new W.j(0,0,1,1)),m instanceof g&&(m=m.baseTexture),Tt.baseTexture=m,Tt._frame=_,Tt.trim=J,Tt.valid=!1,Tt._uvs=Lt,Tt.uvMatrix=null,Tt.orig=N||_,Tt._rotate=Number(lt||0),lt===!0)Tt._rotate=2;else if(Tt._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return Tt.defaultAnchor=xt?new W.g(xt.x,xt.y):new W.g(0,0),Tt._updateID=0,Tt.textureCacheIds=[],m.valid?Tt.noFrame?m.valid&&Tt.onBaseTextureUpdated(m):Tt.frame=_:m.once("loaded",Tt.onBaseTextureUpdated,Tt),Tt.noFrame&&m.on("update",Tt.onBaseTextureUpdated,Tt),Tt}return pt(g,q),g.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},g.prototype.onBaseTextureUpdated=function(m){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=m.width,this._frame.height=m.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},g.prototype.destroy=function(m){if(this.baseTexture){if(m){var _=this.baseTexture.resource;_&&_.url&&I.TextureCache[_.url]&&g.removeFromCache(_.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,g.removeFromCache(this),this.textureCacheIds=null},g.prototype.clone=function(){var m=this._frame.clone(),_=this._frame===this.orig?m:this.orig.clone(),N=new g(this.baseTexture,!this.noFrame&&m,_,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(N._frame=m),N},g.prototype.updateUvs=function(){this._uvs===Lt&&(this._uvs=new gt),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},g.from=function(m,_,N){_===void 0&&(_={}),N===void 0&&(N=P.b.STRICT_TEXTURE_CACHE);var J=typeof m=="string",lt=null;if(J)lt=m;else if(m instanceof F){if(!m.cacheId){var xt=_&&_.pixiIdPrefix||"pixiid";m.cacheId=xt+"-"+Object(I.uid)(),F.addToCache(m,m.cacheId)}lt=m.cacheId}else m._pixiId||(xt=_&&_.pixiIdPrefix||"pixiid",m._pixiId=xt+"_"+Object(I.uid)()),lt=m._pixiId;var Tt=I.TextureCache[lt];if(J&&N&&!Tt)throw new Error('The cacheId "'+lt+'" does not exist in TextureCache.');return Tt||m instanceof F?!Tt&&m instanceof F&&(Tt=new g(m),g.addToCache(Tt,lt)):(_.resolution||(_.resolution=Object(I.getResolutionOfUrl)(m)),(Tt=new g(new F(m,_))).baseTexture.cacheId=lt,F.addToCache(Tt.baseTexture,lt),g.addToCache(Tt,lt)),Tt},g.fromURL=function(m,_){var N=Object.assign({autoLoad:!1},_==null?void 0:_.resourceOptions),J=g.from(m,Object.assign({resourceOptions:N},_),!1),lt=J.baseTexture.resource;return J.baseTexture.valid?Promise.resolve(J):lt.load().then(function(){return Promise.resolve(J)})},g.fromBuffer=function(m,_,N,J){return new g(F.fromBuffer(m,_,N,J))},g.fromLoader=function(m,_,N,J){var lt=new F(m,Object.assign({scaleMode:P.b.SCALE_MODE,resolution:Object(I.getResolutionOfUrl)(_)},J)),xt=lt.resource;xt instanceof Ot&&(xt.url=_);var Tt=new g(lt);return N||(N=_),F.addToCache(Tt.baseTexture,N),g.addToCache(Tt,N),N!==_&&(F.addToCache(Tt.baseTexture,_),g.addToCache(Tt,_)),Tt.baseTexture.valid?Promise.resolve(Tt):new Promise(function(Zt){Tt.baseTexture.once("loaded",function(){return Zt(Tt)})})},g.addToCache=function(m,_){_&&(m.textureCacheIds.indexOf(_)===-1&&m.textureCacheIds.push(_),I.TextureCache[_]&&console.warn("Texture added to the cache with an id ["+_+"] that already had an entry"),I.TextureCache[_]=m)},g.removeFromCache=function(m){if(typeof m=="string"){var _=I.TextureCache[m];if(_){var N=_.textureCacheIds.indexOf(m);return N>-1&&_.textureCacheIds.splice(N,1),delete I.TextureCache[m],_}}else if(m&&m.textureCacheIds){for(var J=0;J<m.textureCacheIds.length;++J)I.TextureCache[m.textureCacheIds[J]]===m&&delete I.TextureCache[m.textureCacheIds[J]];return m.textureCacheIds.length=0,m}return null},Object.defineProperty(g.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"frame",{get:function(){return this._frame},set:function(m){this._frame=m,this.noFrame=!1;var _=m.x,N=m.y,J=m.width,lt=m.height,xt=_+J>this.baseTexture.width,Tt=N+lt>this.baseTexture.height;if(xt||Tt){var Zt=xt&&Tt?"and":"or",ee="X: "+_+" + "+J+" = "+(_+J)+" > "+this.baseTexture.width,Fe="Y: "+N+" + "+lt+" = "+(N+lt)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+ee+" "+Zt+" "+Fe)}this.valid=J&&lt&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=m),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"rotate",{get:function(){return this._rotate},set:function(m){this._rotate=m,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),g.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(g,"EMPTY",{get:function(){return g._EMPTY||(g._EMPTY=new g(new F),K(g._EMPTY),K(g._EMPTY.baseTexture)),g._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(g,"WHITE",{get:function(){if(!g._WHITE){var m=document.createElement("canvas"),_=m.getContext("2d");m.width=16,m.height=16,_.fillStyle="white",_.fillRect(0,0,16,16),g._WHITE=new g(new F(new tt(m))),K(g._WHITE),K(g._WHITE.baseTexture)}return g._WHITE},enumerable:!1,configurable:!0}),g}(I.EventEmitter),it=function(q){function g(m,_){var N=q.call(this,m,_)||this;return N.valid=!0,N.filterFrame=null,N.filterPoolKey=null,N.updateUvs(),N}return pt(g,q),Object.defineProperty(g.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(m){this.framebuffer.multisample=m},enumerable:!1,configurable:!0}),g.prototype.resize=function(m,_,N){N===void 0&&(N=!0);var J=this.baseTexture.resolution,lt=Math.round(m*J)/J,xt=Math.round(_*J)/J;this.valid=lt>0&&xt>0,this._frame.width=this.orig.width=lt,this._frame.height=this.orig.height=xt,N&&this.baseTexture.resize(lt,xt),this.updateUvs()},g.prototype.setResolution=function(m){var _=this.baseTexture;_.resolution!==m&&(_.setResolution(m),this.resize(_.width,_.height,!1))},g.create=function(m){for(var _=arguments,N=[],J=1;J<arguments.length;J++)N[J-1]=_[J];return typeof m=="number"&&(Object(I.deprecation)("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),m={width:m,height:N[0],scaleMode:N[1],resolution:N[2]}),new g(new $(m))},g}(dt),_t=function(){function q(g){this.texturePool={},this.textureOptions=g||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return q.prototype.createTexture=function(g,m,_){_===void 0&&(_=M.l.NONE);var N=new $(Object.assign({width:g,height:m,resolution:1,multisample:_},this.textureOptions));return new it(N)},q.prototype.getOptimalTexture=function(g,m,_,N){var J;_===void 0&&(_=1),N===void 0&&(N=M.l.NONE),g=Math.ceil(g*_-1e-6),m=Math.ceil(m*_-1e-6),this.enableFullScreen&&g===this._pixelsWidth&&m===this._pixelsHeight?J=N>1?-N:-1:(J=((65535&(g=Object(I.nextPow2)(g)))<<16|65535&(m=Object(I.nextPow2)(m)))>>>0,N>1&&(J+=4294967296*N)),this.texturePool[J]||(this.texturePool[J]=[]);var lt=this.texturePool[J].pop();return lt||(lt=this.createTexture(g,m,N)),lt.filterPoolKey=J,lt.setResolution(_),lt},q.prototype.getFilterTexture=function(g,m,_){var N=this.getOptimalTexture(g.width,g.height,m||g.resolution,_||M.l.NONE);return N.filterFrame=g.filterFrame,N},q.prototype.returnTexture=function(g){var m=g.filterPoolKey;g.filterFrame=null,this.texturePool[m].push(g)},q.prototype.returnFilterTexture=function(g){this.returnTexture(g)},q.prototype.clear=function(g){if(g=g!==!1)for(var m in this.texturePool){var _=this.texturePool[m];if(_)for(var N=0;N<_.length;N++)_[N].destroy(!0)}this.texturePool={}},q.prototype.setScreenSize=function(g){if(g.width!==this._pixelsWidth||g.height!==this._pixelsHeight){for(var m in this.enableFullScreen=g.width>0&&g.height>0,this.texturePool)if(Number(m)<0){var _=this.texturePool[m];if(_)for(var N=0;N<_.length;N++)_[N].destroy(!0);this.texturePool[m]=[]}this._pixelsWidth=g.width,this._pixelsHeight=g.height}},q.SCREEN_KEY=-1,q}(),St=function(){function q(g,m,_,N,J,lt,xt){m===void 0&&(m=0),_===void 0&&(_=!1),N===void 0&&(N=M.r.FLOAT),this.buffer=g,this.size=m,this.normalized=_,this.type=N,this.stride=J,this.start=lt,this.instance=xt}return q.prototype.destroy=function(){this.buffer=null},q.from=function(g,m,_,N,J){return new q(g,m,_,N,J)},q}(),kt=0,Xt=function(){function q(g,m,_){m===void 0&&(m=!0),_===void 0&&(_=!1),this.data=g||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=_,this.static=m,this.id=kt++,this.disposeRunner=new D.a("disposeBuffer")}return q.prototype.update=function(g){g instanceof Array&&(g=new Float32Array(g)),this.data=g||this.data,this._updateID++},q.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},q.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(q.prototype,"index",{get:function(){return this.type===M.d.ELEMENT_ARRAY_BUFFER},set:function(g){this.type=g?M.d.ELEMENT_ARRAY_BUFFER:M.d.ARRAY_BUFFER},enumerable:!1,configurable:!0}),q.from=function(g){return g instanceof Array&&(g=new Float32Array(g)),new q(g)},q}(),Jt={Float32Array,Uint32Array,Int32Array,Uint8Array},at={5126:4,5123:2,5121:1},_e=0,Ue={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Oe=function(){function q(g,m){g===void 0&&(g=[]),m===void 0&&(m={}),this.buffers=g,this.indexBuffer=null,this.attributes=m,this.glVertexArrayObjects={},this.id=_e++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new D.a("disposeGeometry"),this.refCount=0}return q.prototype.addAttribute=function(g,m,_,N,J,lt,xt,Tt){if(_===void 0&&(_=0),N===void 0&&(N=!1),Tt===void 0&&(Tt=!1),!m)throw new Error("You must pass a buffer when creating an attribute");m instanceof Xt||(m instanceof Array&&(m=new Float32Array(m)),m=new Xt(m));var Zt=g.split("|");if(Zt.length>1){for(var ee=0;ee<Zt.length;ee++)this.addAttribute(Zt[ee],m,_,N,J);return this}var Fe=this.buffers.indexOf(m);return Fe===-1&&(this.buffers.push(m),Fe=this.buffers.length-1),this.attributes[g]=new St(Fe,_,N,J,lt,xt,Tt),this.instanced=this.instanced||Tt,this},q.prototype.getAttribute=function(g){return this.attributes[g]},q.prototype.getBuffer=function(g){return this.buffers[this.getAttribute(g).buffer]},q.prototype.addIndex=function(g){return g instanceof Xt||(g instanceof Array&&(g=new Uint16Array(g)),g=new Xt(g)),g.type=M.d.ELEMENT_ARRAY_BUFFER,this.indexBuffer=g,this.buffers.indexOf(g)===-1&&this.buffers.push(g),this},q.prototype.getIndex=function(){return this.indexBuffer},q.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var g,m=[],_=[],N=new Xt;for(g in this.attributes){var J=this.attributes[g],lt=this.buffers[J.buffer];m.push(lt.data),_.push(J.size*at[J.type]/4),J.buffer=0}for(N.data=function(xt,Tt){for(var Zt=0,ee=0,Fe={},Te=0;Te<xt.length;Te++)ee+=Tt[Te],Zt+=xt[Te].length;var Qe=new ArrayBuffer(4*Zt),hn=null,vn=0;for(Te=0;Te<xt.length;Te++){var un=Tt[Te],$n=xt[Te],gi=Object(I.getBufferType)($n);Fe[gi]||(Fe[gi]=new Jt[gi](Qe)),hn=Fe[gi];for(var vi=0;vi<$n.length;vi++)hn[(vi/un|0)*ee+vn+vi%un]=$n[vi];vn+=un}return new Float32Array(Qe)}(m,_),g=0;g<this.buffers.length;g++)this.buffers[g]!==this.indexBuffer&&this.buffers[g].destroy();return this.buffers=[N],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},q.prototype.getSize=function(){for(var g in this.attributes){var m=this.attributes[g];return this.buffers[m.buffer].data.length/(m.stride/4||m.size)}return 0},q.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},q.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},q.prototype.clone=function(){for(var g=new q,m=0;m<this.buffers.length;m++)g.buffers[m]=new Xt(this.buffers[m].data.slice(0));for(var m in this.attributes){var _=this.attributes[m];g.attributes[m]=new St(_.buffer,_.size,_.normalized,_.type,_.stride,_.start,_.instance)}return this.indexBuffer&&(g.indexBuffer=g.buffers[this.buffers.indexOf(this.indexBuffer)],g.indexBuffer.type=M.d.ELEMENT_ARRAY_BUFFER),g},q.merge=function(g){for(var m,_=new q,N=[],J=[],lt=[],xt=0;xt<g.length;xt++){m=g[xt];for(var Tt=0;Tt<m.buffers.length;Tt++)J[Tt]=J[Tt]||0,J[Tt]+=m.buffers[Tt].data.length,lt[Tt]=0}for(xt=0;xt<m.buffers.length;xt++)N[xt]=new Ue[Object(I.getBufferType)(m.buffers[xt].data)](J[xt]),_.buffers[xt]=new Xt(N[xt]);for(xt=0;xt<g.length;xt++)for(m=g[xt],Tt=0;Tt<m.buffers.length;Tt++)N[Tt].set(m.buffers[Tt].data,lt[Tt]),lt[Tt]+=m.buffers[Tt].data.length;if(_.attributes=m.attributes,m.indexBuffer){_.indexBuffer=_.buffers[m.buffers.indexOf(m.indexBuffer)],_.indexBuffer.type=M.d.ELEMENT_ARRAY_BUFFER;var Zt=0,ee=0,Fe=0,Te=0;for(xt=0;xt<m.buffers.length;xt++)if(m.buffers[xt]!==m.indexBuffer){Te=xt;break}for(var xt in m.attributes){var Qe=m.attributes[xt];(0|Qe.buffer)===Te&&(ee+=Qe.size*at[Qe.type]/4)}for(xt=0;xt<g.length;xt++){var hn=g[xt].indexBuffer.data;for(Tt=0;Tt<hn.length;Tt++)_.indexBuffer.data[Tt+Fe]+=Zt;Zt+=g[xt].buffers[Te].data.length/ee,Fe+=hn.length}}return _},q}(),Ae=function(q){function g(){var m=q.call(this)||this;return m.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),m}return pt(g,q),g}(Oe),ze=function(q){function g(){var m=q.call(this)||this;return m.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),m.uvs=new Float32Array([0,0,1,0,1,1,0,1]),m.vertexBuffer=new Xt(m.vertices),m.uvBuffer=new Xt(m.uvs),m.addAttribute("aVertexPosition",m.vertexBuffer).addAttribute("aTextureCoord",m.uvBuffer).addIndex([0,1,2,0,2,3]),m}return pt(g,q),g.prototype.map=function(m,_){var N=0,J=0;return this.uvs[0]=N,this.uvs[1]=J,this.uvs[2]=N+_.width/m.width,this.uvs[3]=J,this.uvs[4]=N+_.width/m.width,this.uvs[5]=J+_.height/m.height,this.uvs[6]=N,this.uvs[7]=J+_.height/m.height,N=_.x,J=_.y,this.vertices[0]=N,this.vertices[1]=J,this.vertices[2]=N+_.width,this.vertices[3]=J,this.vertices[4]=N+_.width,this.vertices[5]=J+_.height,this.vertices[6]=N,this.vertices[7]=J+_.height,this.invalidate(),this},g.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},g}(Oe),$e=0,cn=function(){function q(g,m,_){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=$e++,this.static=!!m,this.ubo=!!_,g instanceof Xt?(this.buffer=g,this.buffer.type=M.d.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=g,this.ubo&&(this.buffer=new Xt(new Float32Array(1)),this.buffer.type=M.d.UNIFORM_BUFFER,this.autoManage=!0))}return q.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},q.prototype.add=function(g,m,_){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[g]=new q(m,_)},q.from=function(g,m,_){return new q(g,m,_)},q.uboFrom=function(g,m){return new q(g,m==null||m,!0)},q}(),ke=function(){function q(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=M.l.NONE,this.sourceFrame=new W.j,this.destinationFrame=new W.j,this.bindingSourceFrame=new W.j,this.bindingDestinationFrame=new W.j,this.filters=[],this.transform=null}return q.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},q}(),Ge=[new W.g,new W.g,new W.g,new W.g],Rn=new W.d,re=function(){function q(g){this.renderer=g,this.defaultFilterStack=[{}],this.texturePool=new _t,this.texturePool.setScreenSize(g.view),this.statePool=[],this.quad=new Ae,this.quadUv=new ze,this.tempRect=new W.j,this.activeState={},this.globalUniforms=new cn({outputFrame:new W.j,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return q.prototype.push=function(g,m){for(var _,N,J=this.renderer,lt=this.defaultFilterStack,xt=this.statePool.pop()||new ke,Tt=this.renderer.renderTexture,Zt=m[0].resolution,ee=m[0].multisample,Fe=m[0].padding,Te=m[0].autoFit,Qe=(_=m[0].legacy)===null||_===void 0||_,hn=1;hn<m.length;hn++){var vn=m[hn];Zt=Math.min(Zt,vn.resolution),ee=Math.min(ee,vn.multisample),Fe=this.useMaxPadding?Math.max(Fe,vn.padding):Fe+vn.padding,Te=Te&&vn.autoFit,Qe=Qe||(N=vn.legacy)===null||N===void 0||N}lt.length===1&&(this.defaultFilterStack[0].renderTexture=Tt.current),lt.push(xt),xt.resolution=Zt,xt.multisample=ee,xt.legacy=Qe,xt.target=g,xt.sourceFrame.copyFrom(g.filterArea||g.getBounds(!0)),xt.sourceFrame.pad(Fe);var un=this.tempRect.copyFrom(Tt.sourceFrame);J.projection.transform&&this.transformAABB(Rn.copyFrom(J.projection.transform).invert(),un),Te?(xt.sourceFrame.fit(un),(xt.sourceFrame.width<=0||xt.sourceFrame.height<=0)&&(xt.sourceFrame.width=0,xt.sourceFrame.height=0)):xt.sourceFrame.intersects(un)||(xt.sourceFrame.width=0,xt.sourceFrame.height=0),this.roundFrame(xt.sourceFrame,Tt.current?Tt.current.resolution:J.resolution,Tt.sourceFrame,Tt.destinationFrame,J.projection.transform),xt.renderTexture=this.getOptimalFilterTexture(xt.sourceFrame.width,xt.sourceFrame.height,Zt,ee),xt.filters=m,xt.destinationFrame.width=xt.renderTexture.width,xt.destinationFrame.height=xt.renderTexture.height;var $n=this.tempRect;$n.x=0,$n.y=0,$n.width=xt.sourceFrame.width,$n.height=xt.sourceFrame.height,xt.renderTexture.filterFrame=xt.sourceFrame,xt.bindingSourceFrame.copyFrom(Tt.sourceFrame),xt.bindingDestinationFrame.copyFrom(Tt.destinationFrame),xt.transform=J.projection.transform,J.projection.transform=null,Tt.bind(xt.renderTexture,xt.sourceFrame,$n),J.framebuffer.clear(0,0,0,0)},q.prototype.pop=function(){var g=this.defaultFilterStack,m=g.pop(),_=m.filters;this.activeState=m;var N=this.globalUniforms.uniforms;N.outputFrame=m.sourceFrame,N.resolution=m.resolution;var J=N.inputSize,lt=N.inputPixel,xt=N.inputClamp;if(J[0]=m.destinationFrame.width,J[1]=m.destinationFrame.height,J[2]=1/J[0],J[3]=1/J[1],lt[0]=Math.round(J[0]*m.resolution),lt[1]=Math.round(J[1]*m.resolution),lt[2]=1/lt[0],lt[3]=1/lt[1],xt[0]=.5*lt[2],xt[1]=.5*lt[3],xt[2]=m.sourceFrame.width*J[2]-.5*lt[2],xt[3]=m.sourceFrame.height*J[3]-.5*lt[3],m.legacy){var Tt=N.filterArea;Tt[0]=m.destinationFrame.width,Tt[1]=m.destinationFrame.height,Tt[2]=m.sourceFrame.x,Tt[3]=m.sourceFrame.y,N.filterClamp=N.inputClamp}this.globalUniforms.update();var Zt=g[g.length-1];if(this.renderer.framebuffer.blit(),_.length===1)_[0].apply(this,m.renderTexture,Zt.renderTexture,M.e.BLEND,m),this.returnFilterTexture(m.renderTexture);else{var ee=m.renderTexture,Fe=this.getOptimalFilterTexture(ee.width,ee.height,m.resolution);Fe.filterFrame=ee.filterFrame;var Te=0;for(Te=0;Te<_.length-1;++Te){Te===1&&m.multisample>1&&((Fe=this.getOptimalFilterTexture(ee.width,ee.height,m.resolution)).filterFrame=ee.filterFrame),_[Te].apply(this,ee,Fe,M.e.CLEAR,m);var Qe=ee;ee=Fe,Fe=Qe}_[Te].apply(this,ee,Zt.renderTexture,M.e.BLEND,m),Te>1&&m.multisample>1&&this.returnFilterTexture(m.renderTexture),this.returnFilterTexture(ee),this.returnFilterTexture(Fe)}m.clear(),this.statePool.push(m)},q.prototype.bindAndClear=function(g,m){m===void 0&&(m=M.e.CLEAR);var _=this.renderer,N=_.renderTexture,J=_.state;if(g===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,g&&g.filterFrame){var lt=this.tempRect;lt.x=0,lt.y=0,lt.width=g.filterFrame.width,lt.height=g.filterFrame.height,N.bind(g,g.filterFrame,lt)}else g!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?N.bind(g):this.renderer.renderTexture.bind(g,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var xt=1&J.stateId||this.forceClear;(m===M.e.CLEAR||m===M.e.BLIT&&xt)&&this.renderer.framebuffer.clear(0,0,0,0)},q.prototype.applyFilter=function(g,m,_,N){var J=this.renderer;J.state.set(g.state),this.bindAndClear(_,N),g.uniforms.uSampler=m,g.uniforms.filterGlobals=this.globalUniforms,J.shader.bind(g),g.legacy=!!g.program.attributeData.aTextureCoord,g.legacy?(this.quadUv.map(m._frame,m.filterFrame),J.geometry.bind(this.quadUv),J.geometry.draw(M.f.TRIANGLES)):(J.geometry.bind(this.quad),J.geometry.draw(M.f.TRIANGLE_STRIP))},q.prototype.calculateSpriteMatrix=function(g,m){var _=this.activeState,N=_.sourceFrame,J=_.destinationFrame,lt=m._texture.orig,xt=g.set(J.width,0,0,J.height,N.x,N.y),Tt=m.worldTransform.copyTo(W.d.TEMP_MATRIX);return Tt.invert(),xt.prepend(Tt),xt.scale(1/lt.width,1/lt.height),xt.translate(m.anchor.x,m.anchor.y),xt},q.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},q.prototype.getOptimalFilterTexture=function(g,m,_,N){return _===void 0&&(_=1),N===void 0&&(N=M.l.NONE),this.texturePool.getOptimalTexture(g,m,_,N)},q.prototype.getFilterTexture=function(g,m,_){if(typeof g=="number"){var N=g;g=m,m=N}g=g||this.activeState.renderTexture;var J=this.texturePool.getOptimalTexture(g.width,g.height,m||g.resolution,_||M.l.NONE);return J.filterFrame=g.filterFrame,J},q.prototype.returnFilterTexture=function(g){this.texturePool.returnTexture(g)},q.prototype.emptyPool=function(){this.texturePool.clear(!0)},q.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},q.prototype.transformAABB=function(g,m){var _=Ge[0],N=Ge[1],J=Ge[2],lt=Ge[3];_.set(m.left,m.top),N.set(m.left,m.bottom),J.set(m.right,m.top),lt.set(m.right,m.bottom),g.apply(_,_),g.apply(N,N),g.apply(J,J),g.apply(lt,lt);var xt=Math.min(_.x,N.x,J.x,lt.x),Tt=Math.min(_.y,N.y,J.y,lt.y),Zt=Math.max(_.x,N.x,J.x,lt.x),ee=Math.max(_.y,N.y,J.y,lt.y);m.x=xt,m.y=Tt,m.width=Zt-xt,m.height=ee-Tt},q.prototype.roundFrame=function(g,m,_,N,J){if(!(g.width<=0||g.height<=0||_.width<=0||_.height<=0)){if(J){var lt=J.a,xt=J.b,Tt=J.c,Zt=J.d;if((Math.abs(xt)>1e-4||Math.abs(Tt)>1e-4)&&(Math.abs(lt)>1e-4||Math.abs(Zt)>1e-4))return}(J=J?Rn.copyFrom(J):Rn.identity()).translate(-_.x,-_.y).scale(N.width/_.width,N.height/_.height).translate(N.x,N.y),this.transformAABB(J,g),g.ceil(m),this.transformAABB(J.invert(),g)}},q}(),pe=function(){function q(g){this.renderer=g}return q.prototype.flush=function(){},q.prototype.destroy=function(){this.renderer=null},q.prototype.start=function(){},q.prototype.stop=function(){this.flush()},q.prototype.render=function(g){},q}(),Ee=function(){function q(g){this.renderer=g,this.emptyRenderer=new pe(g),this.currentRenderer=this.emptyRenderer}return q.prototype.setObjectRenderer=function(g){this.currentRenderer!==g&&(this.currentRenderer.stop(),this.currentRenderer=g,this.currentRenderer.start())},q.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},q.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},q.prototype.copyBoundTextures=function(g,m){for(var _=this.renderer.texture.boundTextures,N=m-1;N>=0;--N)g[N]=_[N]||null,g[N]&&(g[N]._batchLocation=N)},q.prototype.boundArray=function(g,m,_,N){for(var J=g.elements,lt=g.ids,xt=g.count,Tt=0,Zt=0;Zt<xt;Zt++){var ee=J[Zt],Fe=ee._batchLocation;if(Fe>=0&&Fe<N&&m[Fe]===ee)lt[Zt]=Fe;else for(;Tt<N;){var Te=m[Tt];if(!Te||Te._batchEnabled!==_||Te._batchLocation!==Tt){lt[Zt]=Tt,ee._batchLocation=Tt,m[Tt]=ee;break}Tt++}}},q.prototype.destroy=function(){this.renderer=null},q}(),ln=0,In=function(){function q(g){this.renderer=g,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),g.view.addEventListener("webglcontextlost",this.handleContextLost,!1),g.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(q.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),q.prototype.contextChange=function(g){this.gl=g,this.renderer.gl=g,this.renderer.CONTEXT_UID=ln++,g.isContextLost()&&g.getExtension("WEBGL_lose_context")&&g.getExtension("WEBGL_lose_context").restoreContext()},q.prototype.initFromContext=function(g){this.gl=g,this.validateContext(g),this.renderer.gl=g,this.renderer.CONTEXT_UID=ln++,this.renderer.runners.contextChange.emit(g)},q.prototype.initFromOptions=function(g){var m=this.createContext(this.renderer.view,g);this.initFromContext(m)},q.prototype.createContext=function(g,m){var _;if(P.b.PREFER_ENV>=M.g.WEBGL2&&(_=g.getContext("webgl2",m)),_)this.webGLVersion=2;else if(this.webGLVersion=1,!(_=g.getContext("webgl",m)||g.getContext("experimental-webgl",m)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=_,this.getExtensions(),this.gl},q.prototype.getExtensions=function(){var g=this.gl,m={anisotropicFiltering:g.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:g.getExtension("OES_texture_float_linear"),s3tc:g.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:g.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:g.getExtension("WEBGL_compressed_texture_etc"),etc1:g.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:g.getExtension("WEBGL_compressed_texture_pvrtc")||g.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:g.getExtension("WEBGL_compressed_texture_atc"),astc:g.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,m,{drawBuffers:g.getExtension("WEBGL_draw_buffers"),depthTexture:g.getExtension("WEBGL_depth_texture"),loseContext:g.getExtension("WEBGL_lose_context"),vertexArrayObject:g.getExtension("OES_vertex_array_object")||g.getExtension("MOZ_OES_vertex_array_object")||g.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:g.getExtension("OES_element_index_uint"),floatTexture:g.getExtension("OES_texture_float"),floatTextureLinear:g.getExtension("OES_texture_float_linear"),textureHalfFloat:g.getExtension("OES_texture_half_float"),textureHalfFloatLinear:g.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,m,{colorBufferFloat:g.getExtension("EXT_color_buffer_float")})},q.prototype.handleContextLost=function(g){g.preventDefault()},q.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},q.prototype.destroy=function(){var g=this.renderer.view;this.renderer=null,g.removeEventListener("webglcontextlost",this.handleContextLost),g.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},q.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},q.prototype.validateContext=function(g){var m=g.getContextAttributes(),_="WebGL2RenderingContext"in globalThis&&g instanceof globalThis.WebGL2RenderingContext;_&&(this.webGLVersion=2),m&&!m.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var N=_||!!g.getExtension("OES_element_index_uint");this.supports.uint32Indices=N,N||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},q}(),Qn=function(q){this.framebuffer=q,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=M.l.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},fi=new W.j,tn=function(){function q(g){this.renderer=g,this.managedFramebuffers=[],this.unknownFramebuffer=new ft(10,10),this.msaaSamples=null}return q.prototype.contextChange=function(){var g=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new W.j,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var m=this.renderer.context.extensions.drawBuffers,_=this.renderer.context.extensions.depthTexture;P.b.PREFER_ENV===M.g.WEBGL_LEGACY&&(m=null,_=null),m?g.drawBuffers=function(N){return m.drawBuffersWEBGL(N)}:(this.hasMRT=!1,g.drawBuffers=function(){}),_||(this.writeDepthTexture=!1)}else this.msaaSamples=g.getInternalformatParameter(g.RENDERBUFFER,g.RGBA8,g.SAMPLES)},q.prototype.bind=function(g,m,_){_===void 0&&(_=0);var N=this.gl;if(g){var J=g.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(g);this.current!==g&&(this.current=g,N.bindFramebuffer(N.FRAMEBUFFER,J.framebuffer)),J.mipLevel!==_&&(g.dirtyId++,g.dirtyFormat++,J.mipLevel=_),J.dirtyId!==g.dirtyId&&(J.dirtyId=g.dirtyId,J.dirtyFormat!==g.dirtyFormat?(J.dirtyFormat=g.dirtyFormat,J.dirtySize=g.dirtySize,this.updateFramebuffer(g,_)):J.dirtySize!==g.dirtySize&&(J.dirtySize=g.dirtySize,this.resizeFramebuffer(g)));for(var lt=0;lt<g.colorTextures.length;lt++){var xt=g.colorTextures[lt];this.renderer.texture.unbind(xt.parentTextureArray||xt)}if(g.depthTexture&&this.renderer.texture.unbind(g.depthTexture),m){var Tt=m.width>>_,Zt=m.height>>_,ee=Tt/m.width;this.setViewport(m.x*ee,m.y*ee,Tt,Zt)}else Tt=g.width>>_,Zt=g.height>>_,this.setViewport(0,0,Tt,Zt)}else this.current&&(this.current=null,N.bindFramebuffer(N.FRAMEBUFFER,null)),m?this.setViewport(m.x,m.y,m.width,m.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},q.prototype.setViewport=function(g,m,_,N){var J=this.viewport;g=Math.round(g),m=Math.round(m),_=Math.round(_),N=Math.round(N),J.width===_&&J.height===N&&J.x===g&&J.y===m||(J.x=g,J.y=m,J.width=_,J.height=N,this.gl.viewport(g,m,_,N))},Object.defineProperty(q.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),q.prototype.clear=function(g,m,_,N,J){J===void 0&&(J=M.c.COLOR|M.c.DEPTH);var lt=this.gl;lt.clearColor(g,m,_,N),lt.clear(J)},q.prototype.initFramebuffer=function(g){var m=this.gl,_=new Qn(m.createFramebuffer());return _.multisample=this.detectSamples(g.multisample),g.glFramebuffers[this.CONTEXT_UID]=_,this.managedFramebuffers.push(g),g.disposeRunner.add(this),_},q.prototype.resizeFramebuffer=function(g){var m=this.gl,_=g.glFramebuffers[this.CONTEXT_UID];_.msaaBuffer&&(m.bindRenderbuffer(m.RENDERBUFFER,_.msaaBuffer),m.renderbufferStorageMultisample(m.RENDERBUFFER,_.multisample,m.RGBA8,g.width,g.height)),_.stencil&&(m.bindRenderbuffer(m.RENDERBUFFER,_.stencil),_.msaaBuffer?m.renderbufferStorageMultisample(m.RENDERBUFFER,_.multisample,m.DEPTH24_STENCIL8,g.width,g.height):m.renderbufferStorage(m.RENDERBUFFER,m.DEPTH_STENCIL,g.width,g.height));var N=g.colorTextures,J=N.length;m.drawBuffers||(J=Math.min(J,1));for(var lt=0;lt<J;lt++){var xt=N[lt],Tt=xt.parentTextureArray||xt;this.renderer.texture.bind(Tt,0)}g.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(g.depthTexture,0)},q.prototype.updateFramebuffer=function(g,m){var _=this.gl,N=g.glFramebuffers[this.CONTEXT_UID],J=g.colorTextures,lt=J.length;_.drawBuffers||(lt=Math.min(lt,1)),N.multisample>1&&this.canMultisampleFramebuffer(g)?(N.msaaBuffer=N.msaaBuffer||_.createRenderbuffer(),_.bindRenderbuffer(_.RENDERBUFFER,N.msaaBuffer),_.renderbufferStorageMultisample(_.RENDERBUFFER,N.multisample,_.RGBA8,g.width,g.height),_.framebufferRenderbuffer(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.RENDERBUFFER,N.msaaBuffer)):N.msaaBuffer&&(_.deleteRenderbuffer(N.msaaBuffer),N.msaaBuffer=null,N.blitFramebuffer&&(N.blitFramebuffer.dispose(),N.blitFramebuffer=null));for(var xt=[],Tt=0;Tt<lt;Tt++){var Zt=J[Tt],ee=Zt.parentTextureArray||Zt;this.renderer.texture.bind(ee,0),Tt===0&&N.msaaBuffer||(_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0+Tt,Zt.target,ee._glTextures[this.CONTEXT_UID].texture,m),xt.push(_.COLOR_ATTACHMENT0+Tt))}if(xt.length>1&&_.drawBuffers(xt),g.depthTexture&&this.writeDepthTexture){var Fe=g.depthTexture;this.renderer.texture.bind(Fe,0),_.framebufferTexture2D(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.TEXTURE_2D,Fe._glTextures[this.CONTEXT_UID].texture,m)}!g.stencil&&!g.depth||g.depthTexture&&this.writeDepthTexture?N.stencil&&(_.deleteRenderbuffer(N.stencil),N.stencil=null):(N.stencil=N.stencil||_.createRenderbuffer(),_.bindRenderbuffer(_.RENDERBUFFER,N.stencil),N.msaaBuffer?_.renderbufferStorageMultisample(_.RENDERBUFFER,N.multisample,_.DEPTH24_STENCIL8,g.width,g.height):_.renderbufferStorage(_.RENDERBUFFER,_.DEPTH_STENCIL,g.width,g.height),_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_STENCIL_ATTACHMENT,_.RENDERBUFFER,N.stencil))},q.prototype.canMultisampleFramebuffer=function(g){return this.renderer.context.webGLVersion!==1&&g.colorTextures.length<=1&&!g.depthTexture},q.prototype.detectSamples=function(g){var m=this.msaaSamples,_=M.l.NONE;if(g<=1||m===null)return _;for(var N=0;N<m.length;N++)if(m[N]<=g){_=m[N];break}return _===1&&(_=M.l.NONE),_},q.prototype.blit=function(g,m,_){var N=this.current,J=this.renderer,lt=this.gl,xt=this.CONTEXT_UID;if(J.context.webGLVersion===2&&N){var Tt=N.glFramebuffers[xt];if(Tt){if(!g){if(!Tt.msaaBuffer)return;var Zt=N.colorTextures[0];if(!Zt)return;Tt.blitFramebuffer||(Tt.blitFramebuffer=new ft(N.width,N.height),Tt.blitFramebuffer.addColorTexture(0,Zt)),(g=Tt.blitFramebuffer).colorTextures[0]!==Zt&&(g.colorTextures[0]=Zt,g.dirtyId++,g.dirtyFormat++),g.width===N.width&&g.height===N.height||(g.width=N.width,g.height=N.height,g.dirtyId++,g.dirtySize++)}m||((m=fi).width=N.width,m.height=N.height),_||(_=m);var ee=m.width===_.width&&m.height===_.height;this.bind(g),lt.bindFramebuffer(lt.READ_FRAMEBUFFER,Tt.framebuffer),lt.blitFramebuffer(m.left,m.top,m.right,m.bottom,_.left,_.top,_.right,_.bottom,lt.COLOR_BUFFER_BIT,ee?lt.NEAREST:lt.LINEAR)}}},q.prototype.disposeFramebuffer=function(g,m){var _=g.glFramebuffers[this.CONTEXT_UID],N=this.gl;if(_){delete g.glFramebuffers[this.CONTEXT_UID];var J=this.managedFramebuffers.indexOf(g);J>=0&&this.managedFramebuffers.splice(J,1),g.disposeRunner.remove(this),m||(N.deleteFramebuffer(_.framebuffer),_.msaaBuffer&&N.deleteRenderbuffer(_.msaaBuffer),_.stencil&&N.deleteRenderbuffer(_.stencil)),_.blitFramebuffer&&_.blitFramebuffer.dispose()}},q.prototype.disposeAll=function(g){var m=this.managedFramebuffers;this.managedFramebuffers=[];for(var _=0;_<m.length;_++)this.disposeFramebuffer(m[_],g)},q.prototype.forceStencil=function(){var g=this.current;if(g){var m=g.glFramebuffers[this.CONTEXT_UID];if(m&&!m.stencil){g.stencil=!0;var _=g.width,N=g.height,J=this.gl,lt=J.createRenderbuffer();J.bindRenderbuffer(J.RENDERBUFFER,lt),m.msaaBuffer?J.renderbufferStorageMultisample(J.RENDERBUFFER,m.multisample,J.DEPTH24_STENCIL8,_,N):J.renderbufferStorage(J.RENDERBUFFER,J.DEPTH_STENCIL,_,N),m.stencil=lt,J.framebufferRenderbuffer(J.FRAMEBUFFER,J.DEPTH_STENCIL_ATTACHMENT,J.RENDERBUFFER,lt)}}},q.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new W.j},q.prototype.destroy=function(){this.renderer=null},q}(),yt={5126:4,5123:2,5121:1},Et=function(){function q(g){this.renderer=g,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return q.prototype.contextChange=function(){this.disposeAll(!0);var g=this.gl=this.renderer.gl,m=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,m.webGLVersion!==2){var _=this.renderer.context.extensions.vertexArrayObject;P.b.PREFER_ENV===M.g.WEBGL_LEGACY&&(_=null),_?(g.createVertexArray=function(){return _.createVertexArrayOES()},g.bindVertexArray=function(J){return _.bindVertexArrayOES(J)},g.deleteVertexArray=function(J){return _.deleteVertexArrayOES(J)}):(this.hasVao=!1,g.createVertexArray=function(){return null},g.bindVertexArray=function(){return null},g.deleteVertexArray=function(){return null})}if(m.webGLVersion!==2){var N=g.getExtension("ANGLE_instanced_arrays");N?(g.vertexAttribDivisor=function(J,lt){return N.vertexAttribDivisorANGLE(J,lt)},g.drawElementsInstanced=function(J,lt,xt,Tt,Zt){return N.drawElementsInstancedANGLE(J,lt,xt,Tt,Zt)},g.drawArraysInstanced=function(J,lt,xt,Tt){return N.drawArraysInstancedANGLE(J,lt,xt,Tt)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=m.webGLVersion===2||!!m.extensions.uint32ElementIndex},q.prototype.bind=function(g,m){m=m||this.renderer.shader.shader;var _=this.gl,N=g.glVertexArrayObjects[this.CONTEXT_UID],J=!1;N||(this.managedGeometries[g.id]=g,g.disposeRunner.add(this),g.glVertexArrayObjects[this.CONTEXT_UID]=N={},J=!0);var lt=N[m.program.id]||this.initGeometryVao(g,m,J);this._activeGeometry=g,this._activeVao!==lt&&(this._activeVao=lt,this.hasVao?_.bindVertexArray(lt):this.activateVao(g,m.program)),this.updateBuffers()},q.prototype.reset=function(){this.unbind()},q.prototype.updateBuffers=function(){for(var g=this._activeGeometry,m=this.renderer.buffer,_=0;_<g.buffers.length;_++){var N=g.buffers[_];m.update(N)}},q.prototype.checkCompatibility=function(g,m){var _=g.attributes,N=m.attributeData;for(var J in N)if(!_[J])throw new Error('shader and geometry incompatible, geometry missing the "'+J+'" attribute')},q.prototype.getSignature=function(g,m){var _=g.attributes,N=m.attributeData,J=["g",g.id];for(var lt in _)N[lt]&&J.push(lt,N[lt].location);return J.join("-")},q.prototype.initGeometryVao=function(g,m,_){_===void 0&&(_=!0);var N=this.gl,J=this.CONTEXT_UID,lt=this.renderer.buffer,xt=m.program;xt.glPrograms[J]||this.renderer.shader.generateProgram(m),this.checkCompatibility(g,xt);var Tt=this.getSignature(g,xt),Zt=g.glVertexArrayObjects[this.CONTEXT_UID],ee=Zt[Tt];if(ee)return Zt[xt.id]=ee,ee;var Fe=g.buffers,Te=g.attributes,Qe={},hn={};for(var vn in Fe)Qe[vn]=0,hn[vn]=0;for(var vn in Te)!Te[vn].size&&xt.attributeData[vn]?Te[vn].size=xt.attributeData[vn].size:Te[vn].size||console.warn("PIXI Geometry attribute '"+vn+"' size cannot be determined (likely the bound shader does not have the attribute)"),Qe[Te[vn].buffer]+=Te[vn].size*yt[Te[vn].type];for(var vn in Te){var un=Te[vn],$n=un.size;un.stride===void 0&&(Qe[un.buffer]===$n*yt[un.type]?un.stride=0:un.stride=Qe[un.buffer]),un.start===void 0&&(un.start=hn[un.buffer],hn[un.buffer]+=$n*yt[un.type])}ee=N.createVertexArray(),N.bindVertexArray(ee);for(var gi=0;gi<Fe.length;gi++){var vi=Fe[gi];lt.bind(vi),_&&vi._glBuffers[J].refCount++}return this.activateVao(g,xt),this._activeVao=ee,Zt[xt.id]=ee,Zt[Tt]=ee,ee},q.prototype.disposeGeometry=function(g,m){var _;if(this.managedGeometries[g.id]){delete this.managedGeometries[g.id];var N=g.glVertexArrayObjects[this.CONTEXT_UID],J=this.gl,lt=g.buffers,xt=(_=this.renderer)===null||_===void 0?void 0:_.buffer;if(g.disposeRunner.remove(this),N){if(xt)for(var Tt=0;Tt<lt.length;Tt++){var Zt=lt[Tt]._glBuffers[this.CONTEXT_UID];Zt&&(Zt.refCount--,Zt.refCount!==0||m||xt.dispose(lt[Tt],m))}if(!m){for(var ee in N)if(ee[0]==="g"){var Fe=N[ee];this._activeVao===Fe&&this.unbind(),J.deleteVertexArray(Fe)}}delete g.glVertexArrayObjects[this.CONTEXT_UID]}}},q.prototype.disposeAll=function(g){for(var m=Object.keys(this.managedGeometries),_=0;_<m.length;_++)this.disposeGeometry(this.managedGeometries[m[_]],g)},q.prototype.activateVao=function(g,m){var _=this.gl,N=this.CONTEXT_UID,J=this.renderer.buffer,lt=g.buffers,xt=g.attributes;g.indexBuffer&&J.bind(g.indexBuffer);var Tt=null;for(var Zt in xt){var ee=xt[Zt],Fe=lt[ee.buffer],Te=Fe._glBuffers[N];if(m.attributeData[Zt]){Tt!==Te&&(J.bind(Fe),Tt=Te);var Qe=m.attributeData[Zt].location;if(_.enableVertexAttribArray(Qe),_.vertexAttribPointer(Qe,ee.size,ee.type||_.FLOAT,ee.normalized,ee.stride,ee.start),ee.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");_.vertexAttribDivisor(Qe,1)}}}},q.prototype.draw=function(g,m,_,N){var J=this.gl,lt=this._activeGeometry;if(lt.indexBuffer){var xt=lt.indexBuffer.data.BYTES_PER_ELEMENT,Tt=xt===2?J.UNSIGNED_SHORT:J.UNSIGNED_INT;xt===2||xt===4&&this.canUseUInt32ElementIndex?lt.instanced?J.drawElementsInstanced(g,m||lt.indexBuffer.data.length,Tt,(_||0)*xt,N||1):J.drawElements(g,m||lt.indexBuffer.data.length,Tt,(_||0)*xt):console.warn("unsupported index buffer type: uint32")}else lt.instanced?J.drawArraysInstanced(g,_,m||lt.getSize(),N||1):J.drawArrays(g,_,m||lt.getSize());return this},q.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},q.prototype.destroy=function(){this.renderer=null},q}(),Rt=function(){function q(g){g===void 0&&(g=null),this.type=M.j.NONE,this.autoDetect=!0,this.maskObject=g||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=P.b.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(q.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(g){g?this._filters?this._filters[0]=g:this._filters=[g]:this._filters=null},enumerable:!1,configurable:!0}),q.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=M.j.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},q.prototype.copyCountersOrReset=function(g){g?(this._stencilCounter=g._stencilCounter,this._scissorCounter=g._scissorCounter,this._scissorRect=g._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},q}();function Qt(q,g,m){var _=q.createShader(g);return q.shaderSource(_,m),q.compileShader(_),_}function Wt(q,g){var m=q.getShaderSource(g).split(`
`).map(function(Zt,ee){return ee+": "+Zt}),_=q.getShaderInfoLog(g),N=_.split(`
`),J={},lt=N.map(function(Zt){return parseFloat(Zt.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(Zt){return!(!Zt||J[Zt])&&(J[Zt]=!0,!0)}),xt=[""];lt.forEach(function(Zt){m[Zt-1]="%c"+m[Zt-1]+"%c",xt.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var Tt=m.join(`
`);xt[0]=Tt,console.error(_),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,xt),console.groupEnd()}function Kt(q){for(var g=new Array(q),m=0;m<g.length;m++)g[m]=!1;return g}function oe(q,g){switch(q){case"float":return 0;case"vec2":return new Float32Array(2*g);case"vec3":return new Float32Array(3*g);case"vec4":return new Float32Array(4*g);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*g);case"ivec3":return new Int32Array(3*g);case"ivec4":return new Int32Array(4*g);case"uvec2":return new Uint32Array(2*g);case"uvec3":return new Uint32Array(3*g);case"uvec4":return new Uint32Array(4*g);case"bool":return!1;case"bvec2":return Kt(2*g);case"bvec3":return Kt(3*g);case"bvec4":return Kt(4*g);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Me,we={},Se=we;function Ve(){if(!Me){Me=M.m.MEDIUM;var q=function(){if(Se===we||Se&&Se.isContextLost()){var m=document.createElement("canvas"),_=void 0;P.b.PREFER_ENV>=M.g.WEBGL2&&(_=m.getContext("webgl2",{})),_||((_=m.getContext("webgl",{})||m.getContext("experimental-webgl",{}))?_.getExtension("WEBGL_draw_buffers"):_=null),Se=_}return Se}();if(q&&q.getShaderPrecisionFormat){var g=q.getShaderPrecisionFormat(q.FRAGMENT_SHADER,q.HIGH_FLOAT);Me=g.precision?M.m.HIGH:M.m.MEDIUM}}return Me}function en(q,g,m){if(q.substring(0,9)!=="precision"){var _=g;return g===M.m.HIGH&&m!==M.m.HIGH&&(_=M.m.MEDIUM),"precision "+_+` float;
`+q}return m!==M.m.HIGH&&q.substring(0,15)==="precision highp"?q.replace("precision highp","precision mediump"):q}var dn={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Tn(q){return dn[q]}var yn=null,Yn={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Pn(q,g){if(!yn){var m=Object.keys(Yn);yn={};for(var _=0;_<m.length;++_){var N=m[_];yn[q[N]]=Yn[N]}}return yn[g]}var Vi=[{test:function(q){return q.type==="float"&&q.size===1},code:function(q){return`
            if(uv["`+q+'"] !== ud["'+q+`"].value)
            {
                ud["`+q+'"].value = uv["'+q+`"]
                gl.uniform1f(ud["`+q+'"].location, uv["'+q+`"])
            }
            `}},{test:function(q){return(q.type==="sampler2D"||q.type==="samplerCube"||q.type==="sampler2DArray")&&q.size===1&&!q.isArray},code:function(q){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+q+`"], t);

            if(ud["`+q+`"].value !== t)
            {
                ud["`+q+`"].value = t;
                gl.uniform1i(ud["`+q+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(q,g){return q.type==="mat3"&&q.size===1&&g.a!==void 0},code:function(q){return`
            gl.uniformMatrix3fv(ud["`+q+'"].location, false, uv["'+q+`"].toArray(true));
            `},codeUbo:function(q){return`
                var `+q+"_matrix = uv."+q+`.toArray(true);

                data[offset] = `+q+`_matrix[0];
                data[offset+1] = `+q+`_matrix[1];
                data[offset+2] = `+q+`_matrix[2];
        
                data[offset + 4] = `+q+`_matrix[3];
                data[offset + 5] = `+q+`_matrix[4];
                data[offset + 6] = `+q+`_matrix[5];
        
                data[offset + 8] = `+q+`_matrix[6];
                data[offset + 9] = `+q+`_matrix[7];
                data[offset + 10] = `+q+`_matrix[8];
            `}},{test:function(q,g){return q.type==="vec2"&&q.size===1&&g.x!==void 0},code:function(q){return`
                cv = ud["`+q+`"].value;
                v = uv["`+q+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+q+`"].location, v.x, v.y);
                }`},codeUbo:function(q){return`
                v = uv.`+q+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(q){return q.type==="vec2"&&q.size===1},code:function(q){return`
                cv = ud["`+q+`"].value;
                v = uv["`+q+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+q+`"].location, v[0], v[1]);
                }
            `}},{test:function(q,g){return q.type==="vec4"&&q.size===1&&g.width!==void 0},code:function(q){return`
                cv = ud["`+q+`"].value;
                v = uv["`+q+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+q+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(q){return`
                    v = uv.`+q+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(q){return q.type==="vec4"&&q.size===1},code:function(q){return`
                cv = ud["`+q+`"].value;
                v = uv["`+q+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+q+`"].location, v[0], v[1], v[2], v[3])
                }`}}],bo={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},so={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},Bn,Qo=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function ao(q){for(var g="",m=0;m<q;++m)m>0&&(g+=`
else `),m<q-1&&(g+="if(test == "+m+".0){}");return g}var To=0,kn={},zn=function(){function q(g,m,_){_===void 0&&(_="pixi-shader"),this.id=To++,this.vertexSrc=g||q.defaultVertexSrc,this.fragmentSrc=m||q.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(_=_.replace(/\s+/g,"-"),kn[_]?(kn[_]++,_+="-"+kn[_]):kn[_]=1,this.vertexSrc="#define SHADER_NAME "+_+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+_+`
`+this.fragmentSrc,this.vertexSrc=en(this.vertexSrc,P.b.PRECISION_VERTEX,M.m.HIGH),this.fragmentSrc=en(this.fragmentSrc,P.b.PRECISION_FRAGMENT,Ve())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(q,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(q,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`},enumerable:!1,configurable:!0}),q.from=function(g,m,_){var N=g+m,J=I.ProgramCache[N];return J||(I.ProgramCache[N]=J=new q(g,m,_)),J},q}(),Zi=function(){function q(g,m){this.uniformBindCount=0,this.program=g,this.uniformGroup=m?m instanceof cn?m:new cn(m):new cn({})}return q.prototype.checkUniformExists=function(g,m){if(m.uniforms[g])return!0;for(var _ in m.uniforms){var N=m.uniforms[_];if(N.group&&this.checkUniformExists(g,N))return!0}return!1},q.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(q.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),q.from=function(g,m,_){return new q(zn.from(g,m),_)},q}(),qr=function(){function q(){this.data=0,this.blendMode=M.b.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(q.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(g){!!(1&this.data)!==g&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(g){!!(2&this.data)!==g&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(g){!!(4&this.data)!==g&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(g){!!(8&this.data)!==g&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(g){!!(32&this.data)!==g&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(g){!!(16&this.data)!==g&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"blendMode",{get:function(){return this._blendMode},set:function(g){this.blend=g!==M.b.NONE,this._blendMode=g},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(g){this.offsets=!!g,this._polygonOffset=g},enumerable:!1,configurable:!0}),q.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},q.for2d=function(){var g=new q;return g.depthTest=!1,g.blend=!0,g},q}(),Ci=function(q){function g(m,_,N){var J=this,lt=zn.from(m||g.defaultVertexSrc,_||g.defaultFragmentSrc);return(J=q.call(this,lt,N)||this).padding=0,J.resolution=P.b.FILTER_RESOLUTION,J.multisample=P.b.FILTER_MULTISAMPLE,J.enabled=!0,J.autoFit=!0,J.state=new qr,J}return pt(g,q),g.prototype.apply=function(m,_,N,J,lt){m.applyFilter(this,_,N,J)},Object.defineProperty(g.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(m){this.state.blendMode=m},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"resolution",{get:function(){return this._resolution},set:function(m){this._resolution=m},enumerable:!1,configurable:!0}),Object.defineProperty(g,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(g,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`},enumerable:!1,configurable:!0}),g}(Zi),Cr=new W.d,Fr=function(){function q(g,m){this._texture=g,this.mapCoord=new W.d,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=m===void 0?.5:m,this.isSimple=!1}return Object.defineProperty(q.prototype,"texture",{get:function(){return this._texture},set:function(g){this._texture=g,this._textureID=-1},enumerable:!1,configurable:!0}),q.prototype.multiplyUvs=function(g,m){m===void 0&&(m=g);for(var _=this.mapCoord,N=0;N<g.length;N+=2){var J=g[N],lt=g[N+1];m[N]=J*_.a+lt*_.c+_.tx,m[N+1]=J*_.b+lt*_.d+_.ty}return m},q.prototype.update=function(g){var m=this._texture;if(!m||!m.valid||!g&&this._textureID===m._updateID)return!1;this._textureID=m._updateID,this._updateID++;var _=m._uvs;this.mapCoord.set(_.x1-_.x0,_.y1-_.y0,_.x3-_.x0,_.y3-_.y0,_.x0,_.y0);var N=m.orig,J=m.trim;J&&(Cr.set(N.width/J.width,0,0,N.height/J.height,-J.x/J.width,-J.y/J.height),this.mapCoord.append(Cr));var lt=m.baseTexture,xt=this.uClampFrame,Tt=this.clampMargin/lt.resolution,Zt=this.clampOffset;return xt[0]=(m._frame.x+Tt+Zt)/lt.width,xt[1]=(m._frame.y+Tt+Zt)/lt.height,xt[2]=(m._frame.x+m._frame.width-Tt+Zt)/lt.width,xt[3]=(m._frame.y+m._frame.height-Tt+Zt)/lt.height,this.uClampOffset[0]=Zt/lt.realWidth,this.uClampOffset[1]=Zt/lt.realHeight,this.isSimple=m._frame.width===lt.width&&m._frame.height===lt.height&&m.rotate===0,!0},q}(),$o=function(q){function g(m,_,N){var J=this,lt=null;return typeof m!="string"&&_===void 0&&N===void 0&&(lt=m,m=void 0,_=void 0,N=void 0),(J=q.call(this,m||`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,_||`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,N)||this).maskSprite=lt,J.maskMatrix=new W.d,J}return pt(g,q),Object.defineProperty(g.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(m){this._maskSprite=m,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),g.prototype.apply=function(m,_,N,J){var lt=this._maskSprite,xt=lt._texture;xt.valid&&(xt.uvMatrix||(xt.uvMatrix=new Fr(xt,0)),xt.uvMatrix.update(),this.uniforms.npmAlpha=xt.baseTexture.alphaMode?0:1,this.uniforms.mask=xt,this.uniforms.otherMatrix=m.calculateSpriteMatrix(this.maskMatrix,lt).prepend(xt.uvMatrix.mapCoord),this.uniforms.alpha=lt.worldAlpha,this.uniforms.maskClamp=xt.uvMatrix.uClampFrame,m.applyFilter(this,_,N,J))},g}(Ci),ts=function(){function q(g){this.renderer=g,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return q.prototype.setMaskStack=function(g){this.maskStack=g,this.renderer.scissor.setMaskStack(g),this.renderer.stencil.setMaskStack(g)},q.prototype.push=function(g,m){var _=m;if(!_.isMaskData){var N=this.maskDataPool.pop()||new Rt;N.pooled=!0,N.maskObject=m,_=N}var J=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(_.copyCountersOrReset(J),_.autoDetect&&this.detect(_),_._target=g,_.type!==M.j.SPRITE&&this.maskStack.push(_),_.enabled)switch(_.type){case M.j.SCISSOR:this.renderer.scissor.push(_);break;case M.j.STENCIL:this.renderer.stencil.push(_);break;case M.j.SPRITE:_.copyCountersOrReset(null),this.pushSpriteMask(_)}_.type===M.j.SPRITE&&this.maskStack.push(_)},q.prototype.pop=function(g){var m=this.maskStack.pop();if(m&&m._target===g){if(m.enabled)switch(m.type){case M.j.SCISSOR:this.renderer.scissor.pop();break;case M.j.STENCIL:this.renderer.stencil.pop(m.maskObject);break;case M.j.SPRITE:this.popSpriteMask(m)}if(m.reset(),m.pooled&&this.maskDataPool.push(m),this.maskStack.length!==0){var _=this.maskStack[this.maskStack.length-1];_.type===M.j.SPRITE&&_._filters&&(_._filters[0].maskSprite=_.maskObject)}}},q.prototype.detect=function(g){g.maskObject.isSprite?g.type=M.j.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(g)?g.type=M.j.SCISSOR:g.type=M.j.STENCIL},q.prototype.pushSpriteMask=function(g){var m,_,N=g.maskObject,J=g._target,lt=g._filters;lt||(lt=this.alphaMaskPool[this.alphaMaskIndex])||(lt=this.alphaMaskPool[this.alphaMaskIndex]=[new $o]);var xt,Tt,Zt=this.renderer,ee=Zt.renderTexture;if(ee.current){var Fe=ee.current;xt=g.resolution||Fe.resolution,Tt=(m=g.multisample)!==null&&m!==void 0?m:Fe.multisample}else xt=g.resolution||Zt.resolution,Tt=(_=g.multisample)!==null&&_!==void 0?_:Zt.multisample;lt[0].resolution=xt,lt[0].multisample=Tt,lt[0].maskSprite=N;var Te=J.filterArea;J.filterArea=N.getBounds(!0),Zt.filter.push(J,lt),J.filterArea=Te,g._filters||this.alphaMaskIndex++},q.prototype.popSpriteMask=function(g){this.renderer.filter.pop(),g._filters?g._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},q.prototype.destroy=function(){this.renderer=null},q}(),Eo=function(){function q(g){this.renderer=g,this.maskStack=[],this.glConst=0}return q.prototype.getStackLength=function(){return this.maskStack.length},q.prototype.setMaskStack=function(g){var m=this.renderer.gl,_=this.getStackLength();this.maskStack=g;var N=this.getStackLength();N!==_&&(N===0?m.disable(this.glConst):(m.enable(this.glConst),this._useCurrent()))},q.prototype._useCurrent=function(){},q.prototype.destroy=function(){this.renderer=null,this.maskStack=null},q}(),So=new W.d,ci=function(q){function g(m){var _=q.call(this,m)||this;return _.glConst=WebGLRenderingContext.SCISSOR_TEST,_}return pt(g,q),g.prototype.getStackLength=function(){var m=this.maskStack[this.maskStack.length-1];return m?m._scissorCounter:0},g.prototype.calcScissorRect=function(m){if(!m._scissorRectLocal){var _=m._scissorRect,N=m.maskObject,J=this.renderer,lt=J.renderTexture;N.renderable=!0;var xt=N.getBounds();this.roundFrameToPixels(xt,lt.current?lt.current.resolution:J.resolution,lt.sourceFrame,lt.destinationFrame,J.projection.transform),N.renderable=!1,_&&xt.fit(_),m._scissorRectLocal=xt}},g.isMatrixRotated=function(m){if(!m)return!1;var _=m.a,N=m.b,J=m.c,lt=m.d;return(Math.abs(N)>1e-4||Math.abs(J)>1e-4)&&(Math.abs(_)>1e-4||Math.abs(lt)>1e-4)},g.prototype.testScissor=function(m){var _=m.maskObject;if(!_.isFastRect||!_.isFastRect()||g.isMatrixRotated(_.worldTransform)||g.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(m);var N=m._scissorRectLocal;return N.width>0&&N.height>0},g.prototype.roundFrameToPixels=function(m,_,N,J,lt){g.isMatrixRotated(lt)||((lt=lt?So.copyFrom(lt):So.identity()).translate(-N.x,-N.y).scale(J.width/N.width,J.height/N.height).translate(J.x,J.y),this.renderer.filter.transformAABB(lt,m),m.fit(J),m.x=Math.round(m.x*_),m.y=Math.round(m.y*_),m.width=Math.round(m.width*_),m.height=Math.round(m.height*_))},g.prototype.push=function(m){m._scissorRectLocal||this.calcScissorRect(m);var _=this.renderer.gl;m._scissorRect||_.enable(_.SCISSOR_TEST),m._scissorCounter++,m._scissorRect=m._scissorRectLocal,this._useCurrent()},g.prototype.pop=function(){var m=this.renderer.gl;this.getStackLength()>0?this._useCurrent():m.disable(m.SCISSOR_TEST)},g.prototype._useCurrent=function(){var m,_=this.maskStack[this.maskStack.length-1]._scissorRect;m=this.renderer.renderTexture.current?_.y:this.renderer.height-_.height-_.y,this.renderer.gl.scissor(_.x,m,_.width,_.height)},g}(Eo),es=function(q){function g(m){var _=q.call(this,m)||this;return _.glConst=WebGLRenderingContext.STENCIL_TEST,_}return pt(g,q),g.prototype.getStackLength=function(){var m=this.maskStack[this.maskStack.length-1];return m?m._stencilCounter:0},g.prototype.push=function(m){var _=m.maskObject,N=this.renderer.gl,J=m._stencilCounter;J===0&&(this.renderer.framebuffer.forceStencil(),N.clearStencil(0),N.clear(N.STENCIL_BUFFER_BIT),N.enable(N.STENCIL_TEST)),m._stencilCounter++,N.colorMask(!1,!1,!1,!1),N.stencilFunc(N.EQUAL,J,4294967295),N.stencilOp(N.KEEP,N.KEEP,N.INCR),_.renderable=!0,_.render(this.renderer),this.renderer.batch.flush(),_.renderable=!1,this._useCurrent()},g.prototype.pop=function(m){var _=this.renderer.gl;this.getStackLength()===0?_.disable(_.STENCIL_TEST):(_.colorMask(!1,!1,!1,!1),_.stencilOp(_.KEEP,_.KEEP,_.DECR),m.renderable=!0,m.render(this.renderer),this.renderer.batch.flush(),m.renderable=!1,this._useCurrent())},g.prototype._useCurrent=function(){var m=this.renderer.gl;m.colorMask(!0,!0,!0,!0),m.stencilFunc(m.EQUAL,this.getStackLength(),4294967295),m.stencilOp(m.KEEP,m.KEEP,m.KEEP)},g}(Eo),Ri=function(){function q(g){this.renderer=g,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new W.d,this.transform=null}return q.prototype.update=function(g,m,_,N){this.destinationFrame=g||this.destinationFrame||this.defaultFrame,this.sourceFrame=m||this.sourceFrame||g,this.calculateProjection(this.destinationFrame,this.sourceFrame,_,N),this.transform&&this.projectionMatrix.append(this.transform);var J=this.renderer;J.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,J.globalUniforms.update(),J.shader.shader&&J.shader.syncUniformGroup(J.shader.shader.uniforms.globals)},q.prototype.calculateProjection=function(g,m,_,N){var J=this.projectionMatrix,lt=N?-1:1;J.identity(),J.a=1/m.width*2,J.d=lt*(1/m.height*2),J.tx=-1-m.x*J.a,J.ty=-lt-m.y*J.d},q.prototype.setTransform=function(g){},q.prototype.destroy=function(){this.renderer=null},q}(),vr=new W.j,Oi=new W.j,Br=function(){function q(g){this.renderer=g,this.clearColor=g._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new W.j,this.destinationFrame=new W.j,this.viewportFrame=new W.j}return q.prototype.bind=function(g,m,_){g===void 0&&(g=null);var N,J,lt,xt=this.renderer;this.current=g,g?(lt=(N=g.baseTexture).resolution,m||(vr.width=g.frame.width,vr.height=g.frame.height,m=vr),_||(Oi.x=g.frame.x,Oi.y=g.frame.y,Oi.width=m.width,Oi.height=m.height,_=Oi),J=N.framebuffer):(lt=xt.resolution,m||(vr.width=xt.screen.width,vr.height=xt.screen.height,m=vr),_||((_=vr).width=m.width,_.height=m.height));var Tt=this.viewportFrame;Tt.x=_.x*lt,Tt.y=_.y*lt,Tt.width=_.width*lt,Tt.height=_.height*lt,g||(Tt.y=xt.view.height-(Tt.y+Tt.height)),Tt.ceil(),this.renderer.framebuffer.bind(J,Tt),this.renderer.projection.update(_,m,lt,!J),g?this.renderer.mask.setMaskStack(N.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(m),this.destinationFrame.copyFrom(_)},q.prototype.clear=function(g,m){g=this.current?g||this.current.baseTexture.clearColor:g||this.clearColor;var _=this.destinationFrame,N=this.current?this.current.baseTexture:this.renderer.screen,J=_.width!==N.width||_.height!==N.height;if(J){var lt=this.viewportFrame,xt=lt.x,Tt=lt.y,Zt=lt.width,ee=lt.height;xt=Math.round(xt),Tt=Math.round(Tt),Zt=Math.round(Zt),ee=Math.round(ee),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(xt,Tt,Zt,ee)}this.renderer.framebuffer.clear(g[0],g[1],g[2],g[3],m),J&&this.renderer.scissor.pop()},q.prototype.resize=function(){this.bind(null)},q.prototype.reset=function(){this.bind(null)},q.prototype.destroy=function(){this.renderer=null},q}();function wo(q,g,m,_,N){m.buffer.update(N)}var lo={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Ao={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function fn(q,g){if(!q.autoManage)return{size:0,syncFunc:wo};for(var m=function(gi){for(var vi=gi.map(function(kr){return{data:kr,offset:0,dataLen:0,dirty:0}}),ii=0,Fi=0,Bi=0,ui=0;ui<vi.length;ui++){var Ti=vi[ui];if(ii=Ao[Ti.data.type],Ti.data.size>1&&(ii=Math.max(ii,16)*Ti.data.size),Ti.dataLen=ii,Fi%ii!=0&&Fi<16){var yr=Fi%ii%16;Fi+=yr,Bi+=yr}Fi+ii>16?(Bi=16*Math.ceil(Bi/16),Ti.offset=Bi,Bi+=ii,Fi=ii):(Ti.offset=Bi,Fi+=ii,Bi+=ii)}return{uboElements:vi,size:Bi=16*Math.ceil(Bi/16)}}(function(gi,vi){var ii=[];for(var Fi in gi)vi[Fi]&&ii.push(vi[Fi]);return ii.sort(function(Bi,ui){return Bi.index-ui.index}),ii}(q.uniforms,g)),_=m.uboElements,N=m.size,J=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],lt=0;lt<_.length;lt++){for(var xt=_[lt],Tt=q.uniforms[xt.data.name],Zt=xt.data.name,ee=!1,Fe=0;Fe<Vi.length;Fe++){var Te=Vi[Fe];if(Te.codeUbo&&Te.test(xt.data,Tt)){J.push("offset = "+xt.offset/4+";",Vi[Fe].codeUbo(xt.data.name,Tt)),ee=!0;break}}if(!ee)if(xt.data.size>1){var Qe=Tn(xt.data.type),hn=Math.max(Ao[xt.data.type]/16,1),vn=Qe/hn,un=(4-vn%4)%4;J.push(`
                cv = ud.`+Zt+`.value;
                v = uv.`+Zt+`;
                offset = `+xt.offset/4+`;

                t = 0;

                for(var i=0; i < `+xt.data.size*hn+`; i++)
                {
                    for(var j = 0; j < `+vn+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+un+`;
                }

                `)}else{var $n=lo[xt.data.type];J.push(`
                cv = ud.`+Zt+`.value;
                v = uv.`+Zt+`;
                offset = `+xt.offset/4+`;
                `+$n+`;
                `)}}return J.push(`
       renderer.buffer.update(buffer);
    `),{size:N,syncFunc:new Function("ud","uv","renderer","syncData","buffer",J.join(`
`))}}var Qi=function(){function q(g,m){this.program=g,this.uniformData=m,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return q.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},q}();function Mn(q,g){var m=Qt(q,q.VERTEX_SHADER,g.vertexSrc),_=Qt(q,q.FRAGMENT_SHADER,g.fragmentSrc),N=q.createProgram();if(q.attachShader(N,m),q.attachShader(N,_),q.linkProgram(N),q.getProgramParameter(N,q.LINK_STATUS)||function(Zt,ee,Fe,Te){Zt.getProgramParameter(ee,Zt.LINK_STATUS)||(Zt.getShaderParameter(Fe,Zt.COMPILE_STATUS)||Wt(Zt,Fe),Zt.getShaderParameter(Te,Zt.COMPILE_STATUS)||Wt(Zt,Te),console.error("PixiJS Error: Could not initialize shader."),Zt.getProgramInfoLog(ee)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",Zt.getProgramInfoLog(ee)))}(q,N,m,_),g.attributeData=function(Zt,ee){for(var Fe={},Te=ee.getProgramParameter(Zt,ee.ACTIVE_ATTRIBUTES),Qe=0;Qe<Te;Qe++){var hn=ee.getActiveAttrib(Zt,Qe);if(hn.name.indexOf("gl_")!==0){var vn=Pn(ee,hn.type),un={type:vn,name:hn.name,size:Tn(vn),location:ee.getAttribLocation(Zt,hn.name)};Fe[hn.name]=un}}return Fe}(N,q),g.uniformData=function(Zt,ee){for(var Fe={},Te=ee.getProgramParameter(Zt,ee.ACTIVE_UNIFORMS),Qe=0;Qe<Te;Qe++){var hn=ee.getActiveUniform(Zt,Qe),vn=hn.name.replace(/\[.*?\]$/,""),un=!!hn.name.match(/\[.*?\]$/),$n=Pn(ee,hn.type);Fe[vn]={name:vn,index:Qe,type:$n,size:hn.size,isArray:un,value:oe($n,hn.size)}}return Fe}(N,q),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(g.vertexSrc)){var J=Object.keys(g.attributeData);J.sort(function(Zt,ee){return Zt>ee?1:-1});for(var lt=0;lt<J.length;lt++)g.attributeData[J[lt]].location=lt,q.bindAttribLocation(N,lt,J[lt]);q.linkProgram(N)}q.deleteShader(m),q.deleteShader(_);var xt={};for(var lt in g.uniformData){var Tt=g.uniformData[lt];xt[lt]={location:q.getUniformLocation(N,lt),value:oe(Tt.type,Tt.size)}}return new Qi(N,xt)}var Mo=0,qn={textureCount:0,uboCount:0},Ts=function(){function q(g){this.destroyed=!1,this.renderer=g,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Mo++}return q.prototype.systemCheck=function(){if(!function(){if(typeof Bn=="boolean")return Bn;try{var g=new Function("param1","param2","param3","return param1[param2] === param3;");Bn=g({a:"b"},"a","b")===!0}catch{Bn=!1}return Bn}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},q.prototype.contextChange=function(g){this.gl=g,this.reset()},q.prototype.bind=function(g,m){g.uniforms.globals=this.renderer.globalUniforms;var _=g.program,N=_.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(g);return this.shader=g,this.program!==_&&(this.program=_,this.gl.useProgram(N.program)),m||(qn.textureCount=0,qn.uboCount=0,this.syncUniformGroup(g.uniformGroup,qn)),N},q.prototype.setUniforms=function(g){var m=this.shader.program,_=m.glPrograms[this.renderer.CONTEXT_UID];m.syncUniforms(_.uniformData,g,this.renderer)},q.prototype.syncUniformGroup=function(g,m){var _=this.getGlProgram();g.static&&g.dirtyId===_.uniformDirtyGroups[g.id]||(_.uniformDirtyGroups[g.id]=g.dirtyId,this.syncUniforms(g,_,m))},q.prototype.syncUniforms=function(g,m,_){(g.syncUniforms[this.shader.program.id]||this.createSyncGroups(g))(m.uniformData,g.uniforms,this.renderer,_)},q.prototype.createSyncGroups=function(g){var m=this.getSignature(g,this.shader.program.uniformData,"u");return this.cache[m]||(this.cache[m]=function(_,N){var J,lt=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var xt in _.uniforms){var Tt=N[xt];if(Tt){for(var Zt=_.uniforms[xt],ee=!1,Fe=0;Fe<Vi.length;Fe++)if(Vi[Fe].test(Tt,Zt)){lt.push(Vi[Fe].code(xt,Zt)),ee=!0;break}if(!ee){var Te=(Tt.size===1?bo:so)[Tt.type].replace("location",'ud["'+xt+'"].location');lt.push(`
            cu = ud["`+xt+`"];
            cv = cu.value;
            v = uv["`+xt+`"];
            `+Te+";")}}else!((J=_.uniforms[xt])===null||J===void 0)&&J.group&&(_.uniforms[xt].ubo?lt.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+xt+", '"+xt+`');
                    `):lt.push(`
                        renderer.shader.syncUniformGroup(uv.`+xt+`, syncData);
                    `))}return new Function("ud","uv","renderer","syncData",lt.join(`
`))}(g,this.shader.program.uniformData)),g.syncUniforms[this.shader.program.id]=this.cache[m],g.syncUniforms[this.shader.program.id]},q.prototype.syncUniformBufferGroup=function(g,m){var _=this.getGlProgram();if(!g.static||g.dirtyId!==0||!_.uniformGroups[g.id]){g.dirtyId=0;var N=_.uniformGroups[g.id]||this.createSyncBufferGroup(g,_,m);g.buffer.update(),N(_.uniformData,g.uniforms,this.renderer,qn,g.buffer)}this.renderer.buffer.bindBufferBase(g.buffer,_.uniformBufferBindings[m])},q.prototype.createSyncBufferGroup=function(g,m,_){var N=this.renderer.gl;this.renderer.buffer.bind(g.buffer);var J=this.gl.getUniformBlockIndex(m.program,_);m.uniformBufferBindings[_]=this.shader.uniformBindCount,N.uniformBlockBinding(m.program,J,this.shader.uniformBindCount),this.shader.uniformBindCount++;var lt=this.getSignature(g,this.shader.program.uniformData,"ubo"),xt=this._uboCache[lt];if(xt||(xt=this._uboCache[lt]=fn(g,this.shader.program.uniformData)),g.autoManage){var Tt=new Float32Array(xt.size/4);g.buffer.update(Tt)}return m.uniformGroups[g.id]=xt.syncFunc,m.uniformGroups[g.id]},q.prototype.getSignature=function(g,m,_){var N=g.uniforms,J=[_+"-"];for(var lt in N)J.push(lt),m[lt]&&J.push(m[lt].type);return J.join("-")},q.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},q.prototype.generateProgram=function(g){var m=this.gl,_=g.program,N=Mn(m,_);return _.glPrograms[this.renderer.CONTEXT_UID]=N,N},q.prototype.reset=function(){this.program=null,this.shader=null},q.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},q}(),da=function(){function q(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=M.b.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new qr,this.defaultState.blend=!0}return q.prototype.contextChange=function(g){this.gl=g,this.blendModes=function(m,_){return _===void 0&&(_=[]),_[M.b.NORMAL]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.ADD]=[m.ONE,m.ONE],_[M.b.MULTIPLY]=[m.DST_COLOR,m.ONE_MINUS_SRC_ALPHA,m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.SCREEN]=[m.ONE,m.ONE_MINUS_SRC_COLOR,m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.OVERLAY]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.DARKEN]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.LIGHTEN]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.COLOR_DODGE]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.COLOR_BURN]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.HARD_LIGHT]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.SOFT_LIGHT]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.DIFFERENCE]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.EXCLUSION]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.HUE]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.SATURATION]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.COLOR]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.LUMINOSITY]=[m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.NONE]=[0,0],_[M.b.NORMAL_NPM]=[m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA,m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.ADD_NPM]=[m.SRC_ALPHA,m.ONE,m.ONE,m.ONE],_[M.b.SCREEN_NPM]=[m.SRC_ALPHA,m.ONE_MINUS_SRC_COLOR,m.ONE,m.ONE_MINUS_SRC_ALPHA],_[M.b.SRC_IN]=[m.DST_ALPHA,m.ZERO],_[M.b.SRC_OUT]=[m.ONE_MINUS_DST_ALPHA,m.ZERO],_[M.b.SRC_ATOP]=[m.DST_ALPHA,m.ONE_MINUS_SRC_ALPHA],_[M.b.DST_OVER]=[m.ONE_MINUS_DST_ALPHA,m.ONE],_[M.b.DST_IN]=[m.ZERO,m.SRC_ALPHA],_[M.b.DST_OUT]=[m.ZERO,m.ONE_MINUS_SRC_ALPHA],_[M.b.DST_ATOP]=[m.ONE_MINUS_DST_ALPHA,m.SRC_ALPHA],_[M.b.XOR]=[m.ONE_MINUS_DST_ALPHA,m.ONE_MINUS_SRC_ALPHA],_[M.b.SUBTRACT]=[m.ONE,m.ONE,m.ONE,m.ONE,m.FUNC_REVERSE_SUBTRACT,m.FUNC_ADD],_}(g),this.set(this.defaultState),this.reset()},q.prototype.set=function(g){if(g=g||this.defaultState,this.stateId!==g.data){for(var m=this.stateId^g.data,_=0;m;)1&m&&this.map[_].call(this,!!(g.data&1<<_)),m>>=1,_++;this.stateId=g.data}for(_=0;_<this.checks.length;_++)this.checks[_](this,g)},q.prototype.forceState=function(g){g=g||this.defaultState;for(var m=0;m<this.map.length;m++)this.map[m].call(this,!!(g.data&1<<m));for(m=0;m<this.checks.length;m++)this.checks[m](this,g);this.stateId=g.data},q.prototype.setBlend=function(g){this.updateCheck(q.checkBlendMode,g),this.gl[g?"enable":"disable"](this.gl.BLEND)},q.prototype.setOffset=function(g){this.updateCheck(q.checkPolygonOffset,g),this.gl[g?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},q.prototype.setDepthTest=function(g){this.gl[g?"enable":"disable"](this.gl.DEPTH_TEST)},q.prototype.setDepthMask=function(g){this.gl.depthMask(g)},q.prototype.setCullFace=function(g){this.gl[g?"enable":"disable"](this.gl.CULL_FACE)},q.prototype.setFrontFace=function(g){this.gl.frontFace(this.gl[g?"CW":"CCW"])},q.prototype.setBlendMode=function(g){if(g!==this.blendMode){this.blendMode=g;var m=this.blendModes[g],_=this.gl;m.length===2?_.blendFunc(m[0],m[1]):_.blendFuncSeparate(m[0],m[1],m[2],m[3]),m.length===6?(this._blendEq=!0,_.blendEquationSeparate(m[4],m[5])):this._blendEq&&(this._blendEq=!1,_.blendEquationSeparate(_.FUNC_ADD,_.FUNC_ADD))}},q.prototype.setPolygonOffset=function(g,m){this.gl.polygonOffset(g,m)},q.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},q.prototype.updateCheck=function(g,m){var _=this.checks.indexOf(g);m&&_===-1?this.checks.push(g):m||_===-1||this.checks.splice(_,1)},q.checkBlendMode=function(g,m){g.setBlendMode(m.blendMode)},q.checkPolygonOffset=function(g,m){g.setPolygonOffset(1,m.polygonOffset)},q.prototype.destroy=function(){this.gl=null},q}(),Co=function(){function q(g){this.renderer=g,this.count=0,this.checkCount=0,this.maxIdle=P.b.GC_MAX_IDLE,this.checkCountMax=P.b.GC_MAX_CHECK_COUNT,this.mode=P.b.GC_MODE}return q.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==M.i.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},q.prototype.run=function(){for(var g=this.renderer.texture,m=g.managedTextures,_=!1,N=0;N<m.length;N++){var J=m[N];!J.framebuffer&&this.count-J.touched>this.maxIdle&&(g.destroyTexture(J,!0),m[N]=null,_=!0)}if(_){var lt=0;for(N=0;N<m.length;N++)m[N]!==null&&(m[lt++]=m[N]);m.length=lt}},q.prototype.unload=function(g){var m=this.renderer.texture,_=g._texture;_&&!_.framebuffer&&m.destroyTexture(_);for(var N=g.children.length-1;N>=0;N--)this.unload(g.children[N])},q.prototype.destroy=function(){this.renderer=null},q}(),An=function(q){this.texture=q,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=M.r.UNSIGNED_BYTE,this.internalFormat=M.h.RGBA,this.samplerType=0},Es=function(){function q(g){this.renderer=g,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new F,this.hasIntegerTextures=!1}return q.prototype.contextChange=function(){var g=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(J){var lt,xt,Tt,Zt,ee,Fe,Te,Qe,hn,vn,un,$n,gi,vi,ii,Fi,Bi,ui,Ti,yr,kr,rs,os;return"WebGL2RenderingContext"in globalThis&&J instanceof globalThis.WebGL2RenderingContext?((lt={})[M.r.UNSIGNED_BYTE]=((xt={})[M.h.RGBA]=J.RGBA8,xt[M.h.RGB]=J.RGB8,xt[M.h.RG]=J.RG8,xt[M.h.RED]=J.R8,xt[M.h.RGBA_INTEGER]=J.RGBA8UI,xt[M.h.RGB_INTEGER]=J.RGB8UI,xt[M.h.RG_INTEGER]=J.RG8UI,xt[M.h.RED_INTEGER]=J.R8UI,xt[M.h.ALPHA]=J.ALPHA,xt[M.h.LUMINANCE]=J.LUMINANCE,xt[M.h.LUMINANCE_ALPHA]=J.LUMINANCE_ALPHA,xt),lt[M.r.BYTE]=((Tt={})[M.h.RGBA]=J.RGBA8_SNORM,Tt[M.h.RGB]=J.RGB8_SNORM,Tt[M.h.RG]=J.RG8_SNORM,Tt[M.h.RED]=J.R8_SNORM,Tt[M.h.RGBA_INTEGER]=J.RGBA8I,Tt[M.h.RGB_INTEGER]=J.RGB8I,Tt[M.h.RG_INTEGER]=J.RG8I,Tt[M.h.RED_INTEGER]=J.R8I,Tt),lt[M.r.UNSIGNED_SHORT]=((Zt={})[M.h.RGBA_INTEGER]=J.RGBA16UI,Zt[M.h.RGB_INTEGER]=J.RGB16UI,Zt[M.h.RG_INTEGER]=J.RG16UI,Zt[M.h.RED_INTEGER]=J.R16UI,Zt[M.h.DEPTH_COMPONENT]=J.DEPTH_COMPONENT16,Zt),lt[M.r.SHORT]=((ee={})[M.h.RGBA_INTEGER]=J.RGBA16I,ee[M.h.RGB_INTEGER]=J.RGB16I,ee[M.h.RG_INTEGER]=J.RG16I,ee[M.h.RED_INTEGER]=J.R16I,ee),lt[M.r.UNSIGNED_INT]=((Fe={})[M.h.RGBA_INTEGER]=J.RGBA32UI,Fe[M.h.RGB_INTEGER]=J.RGB32UI,Fe[M.h.RG_INTEGER]=J.RG32UI,Fe[M.h.RED_INTEGER]=J.R32UI,Fe[M.h.DEPTH_COMPONENT]=J.DEPTH_COMPONENT24,Fe),lt[M.r.INT]=((Te={})[M.h.RGBA_INTEGER]=J.RGBA32I,Te[M.h.RGB_INTEGER]=J.RGB32I,Te[M.h.RG_INTEGER]=J.RG32I,Te[M.h.RED_INTEGER]=J.R32I,Te),lt[M.r.FLOAT]=((Qe={})[M.h.RGBA]=J.RGBA32F,Qe[M.h.RGB]=J.RGB32F,Qe[M.h.RG]=J.RG32F,Qe[M.h.RED]=J.R32F,Qe[M.h.DEPTH_COMPONENT]=J.DEPTH_COMPONENT32F,Qe),lt[M.r.HALF_FLOAT]=((hn={})[M.h.RGBA]=J.RGBA16F,hn[M.h.RGB]=J.RGB16F,hn[M.h.RG]=J.RG16F,hn[M.h.RED]=J.R16F,hn),lt[M.r.UNSIGNED_SHORT_5_6_5]=((vn={})[M.h.RGB]=J.RGB565,vn),lt[M.r.UNSIGNED_SHORT_4_4_4_4]=((un={})[M.h.RGBA]=J.RGBA4,un),lt[M.r.UNSIGNED_SHORT_5_5_5_1]=(($n={})[M.h.RGBA]=J.RGB5_A1,$n),lt[M.r.UNSIGNED_INT_2_10_10_10_REV]=((gi={})[M.h.RGBA]=J.RGB10_A2,gi[M.h.RGBA_INTEGER]=J.RGB10_A2UI,gi),lt[M.r.UNSIGNED_INT_10F_11F_11F_REV]=((vi={})[M.h.RGB]=J.R11F_G11F_B10F,vi),lt[M.r.UNSIGNED_INT_5_9_9_9_REV]=((ii={})[M.h.RGB]=J.RGB9_E5,ii),lt[M.r.UNSIGNED_INT_24_8]=((Fi={})[M.h.DEPTH_STENCIL]=J.DEPTH24_STENCIL8,Fi),lt[M.r.FLOAT_32_UNSIGNED_INT_24_8_REV]=((Bi={})[M.h.DEPTH_STENCIL]=J.DEPTH32F_STENCIL8,Bi),os=lt):((ui={})[M.r.UNSIGNED_BYTE]=((Ti={})[M.h.RGBA]=J.RGBA,Ti[M.h.RGB]=J.RGB,Ti[M.h.ALPHA]=J.ALPHA,Ti[M.h.LUMINANCE]=J.LUMINANCE,Ti[M.h.LUMINANCE_ALPHA]=J.LUMINANCE_ALPHA,Ti),ui[M.r.UNSIGNED_SHORT_5_6_5]=((yr={})[M.h.RGB]=J.RGB,yr),ui[M.r.UNSIGNED_SHORT_4_4_4_4]=((kr={})[M.h.RGBA]=J.RGBA,kr),ui[M.r.UNSIGNED_SHORT_5_5_5_1]=((rs={})[M.h.RGBA]=J.RGBA,rs),os=ui),os}(g);var m=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=m;for(var _=0;_<m;_++)this.boundTextures[_]=null;this.emptyTextures={};var N=new An(g.createTexture());for(g.bindTexture(g.TEXTURE_2D,N.texture),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,1,1,0,g.RGBA,g.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[g.TEXTURE_2D]=N,this.emptyTextures[g.TEXTURE_CUBE_MAP]=new An(g.createTexture()),g.bindTexture(g.TEXTURE_CUBE_MAP,this.emptyTextures[g.TEXTURE_CUBE_MAP].texture),_=0;_<6;_++)g.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,g.RGBA,1,1,0,g.RGBA,g.UNSIGNED_BYTE,null);for(g.texParameteri(g.TEXTURE_CUBE_MAP,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_CUBE_MAP,g.TEXTURE_MIN_FILTER,g.LINEAR),_=0;_<this.boundTextures.length;_++)this.bind(null,_)},q.prototype.bind=function(g,m){m===void 0&&(m=0);var _=this.gl;if((g=g==null?void 0:g.castToBaseTexture())&&g.valid&&!g.parentTextureArray){g.touched=this.renderer.textureGC.count;var N=g._glTextures[this.CONTEXT_UID]||this.initTexture(g);this.boundTextures[m]!==g&&(this.currentLocation!==m&&(this.currentLocation=m,_.activeTexture(_.TEXTURE0+m)),_.bindTexture(g.target,N.texture)),N.dirtyId!==g.dirtyId&&(this.currentLocation!==m&&(this.currentLocation=m,_.activeTexture(_.TEXTURE0+m)),this.updateTexture(g)),this.boundTextures[m]=g}else this.currentLocation!==m&&(this.currentLocation=m,_.activeTexture(_.TEXTURE0+m)),_.bindTexture(_.TEXTURE_2D,this.emptyTextures[_.TEXTURE_2D].texture),this.boundTextures[m]=null},q.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var g=0;g<this.boundTextures.length;g++)this.boundTextures[g]=this.unknownTexture},q.prototype.unbind=function(g){var m=this.gl,_=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var N=0;N<_.length;N++)_[N]===this.unknownTexture&&this.bind(null,N)}for(N=0;N<_.length;N++)_[N]===g&&(this.currentLocation!==N&&(m.activeTexture(m.TEXTURE0+N),this.currentLocation=N),m.bindTexture(g.target,this.emptyTextures[g.target].texture),_[N]=null)},q.prototype.ensureSamplerType=function(g){var m=this.boundTextures,_=this.hasIntegerTextures,N=this.CONTEXT_UID;if(_)for(var J=g-1;J>=0;--J){var lt=m[J];lt&&lt._glTextures[N].samplerType!==M.o.FLOAT&&this.renderer.texture.unbind(lt)}},q.prototype.initTexture=function(g){var m=new An(this.gl.createTexture());return m.dirtyId=-1,g._glTextures[this.CONTEXT_UID]=m,this.managedTextures.push(g),g.on("dispose",this.destroyTexture,this),m},q.prototype.initTextureType=function(g,m){var _,N;m.internalFormat=(N=(_=this.internalFormats[g.type])===null||_===void 0?void 0:_[g.format])!==null&&N!==void 0?N:g.format,this.webGLVersion===2&&g.type===M.r.HALF_FLOAT?m.type=this.gl.HALF_FLOAT:m.type=g.type},q.prototype.updateTexture=function(g){var m=g._glTextures[this.CONTEXT_UID];if(m){var _=this.renderer;if(this.initTextureType(g,m),g.resource&&g.resource.upload(_,g,m))m.samplerType!==M.o.FLOAT&&(this.hasIntegerTextures=!0);else{var N=g.realWidth,J=g.realHeight,lt=_.gl;(m.width!==N||m.height!==J||m.dirtyId<0)&&(m.width=N,m.height=J,lt.texImage2D(g.target,0,m.internalFormat,N,J,0,g.format,m.type,null))}g.dirtyStyleId!==m.dirtyStyleId&&this.updateTextureStyle(g),m.dirtyId=g.dirtyId}},q.prototype.destroyTexture=function(g,m){var _=this.gl;if((g=g.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(g),_.deleteTexture(g._glTextures[this.CONTEXT_UID].texture),g.off("dispose",this.destroyTexture,this),delete g._glTextures[this.CONTEXT_UID],!m)){var N=this.managedTextures.indexOf(g);N!==-1&&Object(I.removeItems)(this.managedTextures,N,1)}},q.prototype.updateTextureStyle=function(g){var m=g._glTextures[this.CONTEXT_UID];m&&(g.mipmap!==M.k.POW2&&this.webGLVersion===2||g.isPowerOfTwo?m.mipmap=g.mipmap>=1:m.mipmap=!1,this.webGLVersion===2||g.isPowerOfTwo?m.wrapMode=g.wrapMode:m.wrapMode=M.s.CLAMP,g.resource&&g.resource.style(this.renderer,g,m)||this.setStyle(g,m),m.dirtyStyleId=g.dirtyStyleId)},q.prototype.setStyle=function(g,m){var _=this.gl;if(m.mipmap&&g.mipmap!==M.k.ON_MANUAL&&_.generateMipmap(g.target),_.texParameteri(g.target,_.TEXTURE_WRAP_S,m.wrapMode),_.texParameteri(g.target,_.TEXTURE_WRAP_T,m.wrapMode),m.mipmap){_.texParameteri(g.target,_.TEXTURE_MIN_FILTER,g.scaleMode===M.p.LINEAR?_.LINEAR_MIPMAP_LINEAR:_.NEAREST_MIPMAP_NEAREST);var N=this.renderer.context.extensions.anisotropicFiltering;if(N&&g.anisotropicLevel>0&&g.scaleMode===M.p.LINEAR){var J=Math.min(g.anisotropicLevel,_.getParameter(N.MAX_TEXTURE_MAX_ANISOTROPY_EXT));_.texParameterf(g.target,N.TEXTURE_MAX_ANISOTROPY_EXT,J)}}else _.texParameteri(g.target,_.TEXTURE_MIN_FILTER,g.scaleMode===M.p.LINEAR?_.LINEAR:_.NEAREST);_.texParameteri(g.target,_.TEXTURE_MAG_FILTER,g.scaleMode===M.p.LINEAR?_.LINEAR:_.NEAREST)},q.prototype.destroy=function(){this.renderer=null},q}(),ns=new W.d,bi=function(q){function g(m,_){m===void 0&&(m=M.n.UNKNOWN);var N=q.call(this)||this;return _=Object.assign({},P.b.RENDER_OPTIONS,_),N.options=_,N.type=m,N.screen=new W.j(0,0,_.width,_.height),N.view=_.view||document.createElement("canvas"),N.resolution=_.resolution||P.b.RESOLUTION,N.useContextAlpha=_.useContextAlpha,N.autoDensity=!!_.autoDensity,N.preserveDrawingBuffer=_.preserveDrawingBuffer,N.clearBeforeRender=_.clearBeforeRender,N._backgroundColor=0,N._backgroundColorRgba=[0,0,0,1],N._backgroundColorString="#000000",N.backgroundColor=_.backgroundColor||N._backgroundColor,N.backgroundAlpha=_.backgroundAlpha,_.transparent!==void 0&&(Object(I.deprecation)("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),N.useContextAlpha=_.transparent,N.backgroundAlpha=_.transparent?0:1),N._lastObjectRendered=null,N.plugins={},N}return pt(g,q),g.prototype.initPlugins=function(m){for(var _ in m)this.plugins[_]=new m[_](this)},Object.defineProperty(g.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),g.prototype.resize=function(m,_){this.view.width=Math.round(m*this.resolution),this.view.height=Math.round(_*this.resolution);var N=this.view.width/this.resolution,J=this.view.height/this.resolution;this.screen.width=N,this.screen.height=J,this.autoDensity&&(this.view.style.width=N+"px",this.view.style.height=J+"px"),this.emit("resize",N,J)},g.prototype.generateTexture=function(m,_,N,J){_===void 0&&(_={}),typeof _=="number"&&(Object(I.deprecation)("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),_={scaleMode:_,resolution:N,region:J});var lt=_.region,xt=function(Zt,ee){var Fe={};for(var Te in Zt)Object.prototype.hasOwnProperty.call(Zt,Te)&&ee.indexOf(Te)<0&&(Fe[Te]=Zt[Te]);if(Zt!=null&&typeof Object.getOwnPropertySymbols=="function"){var Qe=0;for(Te=Object.getOwnPropertySymbols(Zt);Qe<Te.length;Qe++)ee.indexOf(Te[Qe])<0&&(Fe[Te[Qe]]=Zt[Te[Qe]])}return Fe}(_,["region"]);(J=lt||m.getLocalBounds(null,!0)).width===0&&(J.width=1),J.height===0&&(J.height=1);var Tt=it.create(Dt({width:J.width,height:J.height},xt));return ns.tx=-J.x,ns.ty=-J.y,this.render(m,{renderTexture:Tt,clear:!1,transform:ns,skipUpdateTransform:!!m.parent}),Tt},g.prototype.destroy=function(m){for(var _ in this.plugins)this.plugins[_].destroy(),this.plugins[_]=null;m&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=M.n.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(g.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(m){this._backgroundColor=m,this._backgroundColorString=Object(I.hex2string)(m),Object(I.hex2rgb)(m,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(m){this._backgroundColorRgba[3]=m},enumerable:!1,configurable:!0}),g}(I.EventEmitter),is=function(q){this.buffer=q||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},_r=function(){function q(g){this.renderer=g,this.managedBuffers={},this.boundBufferBases={}}return q.prototype.destroy=function(){this.renderer=null},q.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},q.prototype.bind=function(g){var m=this.gl,_=this.CONTEXT_UID,N=g._glBuffers[_]||this.createGLBuffer(g);m.bindBuffer(g.type,N.buffer)},q.prototype.bindBufferBase=function(g,m){var _=this.gl,N=this.CONTEXT_UID;if(this.boundBufferBases[m]!==g){var J=g._glBuffers[N]||this.createGLBuffer(g);this.boundBufferBases[m]=g,_.bindBufferBase(_.UNIFORM_BUFFER,m,J.buffer)}},q.prototype.bindBufferRange=function(g,m,_){var N=this.gl,J=this.CONTEXT_UID;_=_||0;var lt=g._glBuffers[J]||this.createGLBuffer(g);N.bindBufferRange(N.UNIFORM_BUFFER,m||0,lt.buffer,256*_,256)},q.prototype.update=function(g){var m=this.gl,_=this.CONTEXT_UID,N=g._glBuffers[_];if(g._updateID!==N.updateID)if(N.updateID=g._updateID,m.bindBuffer(g.type,N.buffer),N.byteLength>=g.data.byteLength)m.bufferSubData(g.type,0,g.data);else{var J=g.static?m.STATIC_DRAW:m.DYNAMIC_DRAW;N.byteLength=g.data.byteLength,m.bufferData(g.type,g.data,J)}},q.prototype.dispose=function(g,m){if(this.managedBuffers[g.id]){delete this.managedBuffers[g.id];var _=g._glBuffers[this.CONTEXT_UID],N=this.gl;g.disposeRunner.remove(this),_&&(m||N.deleteBuffer(_.buffer),delete g._glBuffers[this.CONTEXT_UID])}},q.prototype.disposeAll=function(g){for(var m=Object.keys(this.managedBuffers),_=0;_<m.length;_++)this.dispose(this.managedBuffers[m[_]],g)},q.prototype.createGLBuffer=function(g){var m=this.CONTEXT_UID,_=this.gl;return g._glBuffers[m]=new is(_.createBuffer()),this.managedBuffers[g.id]=g,g.disposeRunner.add(this),g._glBuffers[m]},q}(),Ni=function(q){function g(m){var _=q.call(this,M.n.WEBGL,m)||this;return m=_.options,_.gl=null,_.CONTEXT_UID=0,_.runners={destroy:new D.a("destroy"),contextChange:new D.a("contextChange"),reset:new D.a("reset"),update:new D.a("update"),postrender:new D.a("postrender"),prerender:new D.a("prerender"),resize:new D.a("resize")},_.runners.contextChange.add(_),_.globalUniforms=new cn({projectionMatrix:new W.d},!0),_.addSystem(ts,"mask").addSystem(In,"context").addSystem(da,"state").addSystem(Ts,"shader").addSystem(Es,"texture").addSystem(_r,"buffer").addSystem(Et,"geometry").addSystem(tn,"framebuffer").addSystem(ci,"scissor").addSystem(es,"stencil").addSystem(Ri,"projection").addSystem(Co,"textureGC").addSystem(re,"filter").addSystem(Br,"renderTexture").addSystem(Ee,"batch"),_.initPlugins(g.__plugins),_.multisample=void 0,m.context?_.context.initFromContext(m.context):_.context.initFromOptions({alpha:!!_.useContextAlpha,antialias:m.antialias,premultipliedAlpha:_.useContextAlpha&&_.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:m.preserveDrawingBuffer,powerPreference:_.options.powerPreference}),_.renderingToScreen=!0,Object(I.sayHello)(_.context.webGLVersion===2?"WebGL 2":"WebGL 1"),_.resize(_.options.width,_.options.height),_}return pt(g,q),g.create=function(m){if(Object(I.isWebGLSupported)())return new g(m);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},g.prototype.contextChange=function(){var m,_=this.gl;if(this.context.webGLVersion===1){var N=_.getParameter(_.FRAMEBUFFER_BINDING);_.bindFramebuffer(_.FRAMEBUFFER,null),m=_.getParameter(_.SAMPLES),_.bindFramebuffer(_.FRAMEBUFFER,N)}else N=_.getParameter(_.DRAW_FRAMEBUFFER_BINDING),_.bindFramebuffer(_.DRAW_FRAMEBUFFER,null),m=_.getParameter(_.SAMPLES),_.bindFramebuffer(_.DRAW_FRAMEBUFFER,N);m>=M.l.HIGH?this.multisample=M.l.HIGH:m>=M.l.MEDIUM?this.multisample=M.l.MEDIUM:m>=M.l.LOW?this.multisample=M.l.LOW:this.multisample=M.l.NONE},g.prototype.addSystem=function(m,_){var N=new m(this);if(this[_])throw new Error('Whoops! The name "'+_+'" is already in use');for(var J in this[_]=N,this.runners)this.runners[J].add(N);return this},g.prototype.render=function(m,_){var N,J,lt,xt;if(_&&(_ instanceof it?(Object(I.deprecation)("6.0.0","Renderer#render arguments changed, use options instead."),N=_,J=arguments[2],lt=arguments[3],xt=arguments[4]):(N=_.renderTexture,J=_.clear,lt=_.transform,xt=_.skipUpdateTransform)),this.renderingToScreen=!N,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=lt,!this.context.isLost){if(N||(this._lastObjectRendered=m),!xt){var Tt=m.enableTempParent();m.updateTransform(),m.disableTempParent(Tt)}this.renderTexture.bind(N),this.batch.currentRenderer.start(),(J!==void 0?J:this.clearBeforeRender)&&this.renderTexture.clear(),m.render(this),this.batch.currentRenderer.flush(),N&&N.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},g.prototype.generateTexture=function(m,_,N,J){_===void 0&&(_={});var lt=q.prototype.generateTexture.call(this,m,_,N,J);return this.framebuffer.blit(),lt},g.prototype.resize=function(m,_){q.prototype.resize.call(this,m,_),this.runners.resize.emit(this.screen.height,this.screen.width)},g.prototype.reset=function(){return this.runners.reset.emit(),this},g.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},g.prototype.destroy=function(m){for(var _ in this.runners.destroy.emit(),this.runners)this.runners[_].destroy();q.prototype.destroy.call(this,m),this.gl=null},Object.defineProperty(g.prototype,"extract",{get:function(){return Object(I.deprecation)("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),g.registerPlugin=function(m,_){g.__plugins=g.__plugins||{},g.__plugins[m]=_},g}(bi);function ho(q){return Ni.create(q)}var mi=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Xn=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Ro=function(){this.texArray=null,this.blend=0,this.type=M.f.TRIANGLES,this.start=0,this.size=0,this.data=null},Ur=function(){function q(){this.elements=[],this.ids=[],this.count=0}return q.prototype.clear=function(){for(var g=0;g<this.count;g++)this.elements[g]=null;this.count=0},q}(),Io=function(){function q(g){typeof g=="number"?this.rawBinaryData=new ArrayBuffer(g):g instanceof Uint8Array?this.rawBinaryData=g.buffer:this.rawBinaryData=g,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(q.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),q.prototype.view=function(g){return this[g+"View"]},q.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},q.sizeOf=function(g){switch(g){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(g+" isn't a valid view type")}},q}(),Rr=function(q){function g(m){var _=q.call(this,m)||this;return _.shaderGenerator=null,_.geometryClass=null,_.vertexSize=null,_.state=qr.for2d(),_.size=4*P.b.SPRITE_BATCH_SIZE,_._vertexCount=0,_._indexCount=0,_._bufferedElements=[],_._bufferedTextures=[],_._bufferSize=0,_._shader=null,_._packedGeometries=[],_._packedGeometryPoolSize=2,_._flushId=0,_._aBuffers={},_._iBuffers={},_.MAX_TEXTURES=1,_.renderer.on("prerender",_.onPrerender,_),m.runners.contextChange.add(_),_._dcIndex=0,_._aIndex=0,_._iIndex=0,_._attributeBuffer=null,_._indexBuffer=null,_._tempBoundTextures=[],_}return pt(g,q),g.prototype.contextChange=function(){var m=this.renderer.gl;P.b.PREFER_ENV===M.g.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(m.getParameter(m.MAX_TEXTURE_IMAGE_UNITS),P.b.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(N,J){if(N===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var lt=J.createShader(J.FRAGMENT_SHADER);;){var xt=Qo.replace(/%forloop%/gi,ao(N));if(J.shaderSource(lt,xt),J.compileShader(lt),J.getShaderParameter(lt,J.COMPILE_STATUS))break;N=N/2|0}return N}(this.MAX_TEXTURES,m)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var _=0;_<this._packedGeometryPoolSize;_++)this._packedGeometries[_]=new this.geometryClass;this.initFlushBuffers()},g.prototype.initFlushBuffers=function(){for(var m=g._drawCallPool,_=g._textureArrayPool,N=this.size/4,J=Math.floor(N/this.MAX_TEXTURES)+1;m.length<N;)m.push(new Ro);for(;_.length<J;)_.push(new Ur);for(var lt=0;lt<this.MAX_TEXTURES;lt++)this._tempBoundTextures[lt]=null},g.prototype.onPrerender=function(){this._flushId=0},g.prototype.render=function(m){m._texture.valid&&(this._vertexCount+m.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=m.vertexData.length/2,this._indexCount+=m.indices.length,this._bufferedTextures[this._bufferSize]=m._texture.baseTexture,this._bufferedElements[this._bufferSize++]=m)},g.prototype.buildTexturesAndDrawCalls=function(){var m=this._bufferedTextures,_=this.MAX_TEXTURES,N=g._textureArrayPool,J=this.renderer.batch,lt=this._tempBoundTextures,xt=this.renderer.textureGC.count,Tt=++F._globalBatch,Zt=0,ee=N[0],Fe=0;J.copyBoundTextures(lt,_);for(var Te=0;Te<this._bufferSize;++Te){var Qe=m[Te];m[Te]=null,Qe._batchEnabled!==Tt&&(ee.count>=_&&(J.boundArray(ee,lt,Tt,_),this.buildDrawCalls(ee,Fe,Te),Fe=Te,ee=N[++Zt],++Tt),Qe._batchEnabled=Tt,Qe.touched=xt,ee.elements[ee.count++]=Qe)}for(ee.count>0&&(J.boundArray(ee,lt,Tt,_),this.buildDrawCalls(ee,Fe,this._bufferSize),++Zt,++Tt),Te=0;Te<lt.length;Te++)lt[Te]=null;F._globalBatch=Tt},g.prototype.buildDrawCalls=function(m,_,N){var J=this._bufferedElements,lt=this._attributeBuffer,xt=this._indexBuffer,Tt=this.vertexSize,Zt=g._drawCallPool,ee=this._dcIndex,Fe=this._aIndex,Te=this._iIndex,Qe=Zt[ee];Qe.start=this._iIndex,Qe.texArray=m;for(var hn=_;hn<N;++hn){var vn=J[hn],un=vn._texture.baseTexture,$n=I.premultiplyBlendMode[un.alphaMode?1:0][vn.blendMode];J[hn]=null,_<hn&&Qe.blend!==$n&&(Qe.size=Te-Qe.start,_=hn,(Qe=Zt[++ee]).texArray=m,Qe.start=Te),this.packInterleavedGeometry(vn,lt,xt,Fe,Te),Fe+=vn.vertexData.length/2*Tt,Te+=vn.indices.length,Qe.blend=$n}_<N&&(Qe.size=Te-Qe.start,++ee),this._dcIndex=ee,this._aIndex=Fe,this._iIndex=Te},g.prototype.bindAndClearTexArray=function(m){for(var _=this.renderer.texture,N=0;N<m.count;N++)_.bind(m.elements[N],m.ids[N]),m.elements[N]=null;m.count=0},g.prototype.updateGeometry=function(){var m=this._packedGeometries,_=this._attributeBuffer,N=this._indexBuffer;P.b.CAN_UPLOAD_SAME_BUFFER?(m[this._flushId]._buffer.update(_.rawBinaryData),m[this._flushId]._indexBuffer.update(N),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,m[this._flushId]=new this.geometryClass),m[this._flushId]._buffer.update(_.rawBinaryData),m[this._flushId]._indexBuffer.update(N),this.renderer.geometry.bind(m[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},g.prototype.drawBatches=function(){for(var m=this._dcIndex,_=this.renderer,N=_.gl,J=_.state,lt=g._drawCallPool,xt=null,Tt=0;Tt<m;Tt++){var Zt=lt[Tt],ee=Zt.texArray,Fe=Zt.type,Te=Zt.size,Qe=Zt.start,hn=Zt.blend;xt!==ee&&(xt=ee,this.bindAndClearTexArray(ee)),this.state.blendMode=hn,J.set(this.state),N.drawElements(Fe,Te,N.UNSIGNED_SHORT,2*Qe)}},g.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},g.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),P.b.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},g.prototype.stop=function(){this.flush()},g.prototype.destroy=function(){for(var m=0;m<this._packedGeometryPoolSize;m++)this._packedGeometries[m]&&this._packedGeometries[m].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),q.prototype.destroy.call(this)},g.prototype.getAttributeBuffer=function(m){var _=Object(I.nextPow2)(Math.ceil(m/8)),N=Object(I.log2)(_),J=8*_;this._aBuffers.length<=N&&(this._iBuffers.length=N+1);var lt=this._aBuffers[J];return lt||(this._aBuffers[J]=lt=new Io(J*this.vertexSize*4)),lt},g.prototype.getIndexBuffer=function(m){var _=Object(I.nextPow2)(Math.ceil(m/12)),N=Object(I.log2)(_),J=12*_;this._iBuffers.length<=N&&(this._iBuffers.length=N+1);var lt=this._iBuffers[N];return lt||(this._iBuffers[N]=lt=new Uint16Array(J)),lt},g.prototype.packInterleavedGeometry=function(m,_,N,J,lt){for(var xt=_.uint32View,Tt=_.float32View,Zt=J/this.vertexSize,ee=m.uvs,Fe=m.indices,Te=m.vertexData,Qe=m._texture.baseTexture._batchLocation,hn=Math.min(m.worldAlpha,1),vn=hn<1&&m._texture.baseTexture.alphaMode?Object(I.premultiplyTint)(m._tintRGB,hn):m._tintRGB+(255*hn<<24),un=0;un<Te.length;un+=2)Tt[J++]=Te[un],Tt[J++]=Te[un+1],Tt[J++]=ee[un],Tt[J++]=ee[un+1],xt[J++]=vn,Tt[J++]=Qe;for(un=0;un<Fe.length;un++)N[lt++]=Zt+Fe[un]},g._drawCallPool=[],g._textureArrayPool=[],g}(pe),Ir=function(){function q(g,m){if(this.vertexSrc=g,this.fragTemplate=m,this.programCache={},this.defaultGroupCache={},m.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(m.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return q.prototype.generateShader=function(g){if(!this.programCache[g]){for(var m=new Int32Array(g),_=0;_<g;_++)m[_]=_;this.defaultGroupCache[g]=cn.from({uSamplers:m},!0);var N=this.fragTemplate;N=(N=N.replace(/%count%/gi,""+g)).replace(/%forloop%/gi,this.generateSampleSrc(g)),this.programCache[g]=new zn(this.vertexSrc,N)}var J={tint:new Float32Array([1,1,1,1]),translationMatrix:new W.d,default:this.defaultGroupCache[g]};return new Zi(this.programCache[g],J)},q.prototype.generateSampleSrc=function(g){var m="";m+=`
`,m+=`
`;for(var _=0;_<g;_++)_>0&&(m+=`
else `),_<g-1&&(m+="if(vTextureId < "+_+".5)"),m+=`
{`,m+=`
	color = texture2D(uSamplers[`+_+"], vTextureCoord);",m+=`
}`;return m+=`
`,m+=`
`},q}(),sr=function(q){function g(m){m===void 0&&(m=!1);var _=q.call(this)||this;return _._buffer=new Xt(null,m,!1),_._indexBuffer=new Xt(null,m,!0),_.addAttribute("aVertexPosition",_._buffer,2,!1,M.r.FLOAT).addAttribute("aTextureCoord",_._buffer,2,!1,M.r.FLOAT).addAttribute("aColor",_._buffer,4,!0,M.r.UNSIGNED_BYTE).addAttribute("aTextureId",_._buffer,1,!0,M.r.FLOAT).addIndex(_._indexBuffer),_}return pt(g,q),g}(Oe),Po=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,Oo=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,No=function(){function q(){}return q.create=function(g){var m=Object.assign({vertex:Po,fragment:Oo,geometryClass:sr,vertexSize:6},g),_=m.vertex,N=m.fragment,J=m.vertexSize,lt=m.geometryClass;return function(xt){function Tt(Zt){var ee=xt.call(this,Zt)||this;return ee.shaderGenerator=new Ir(_,N),ee.geometryClass=lt,ee.vertexSize=J,ee}return pt(Tt,xt),Tt}(Rr)},Object.defineProperty(q,"defaultVertexSrc",{get:function(){return Po},enumerable:!1,configurable:!0}),Object.defineProperty(q,"defaultFragmentTemplate",{get:function(){return Oo},enumerable:!1,configurable:!0}),q}().create()},function(b,A,v){v.r(A),v.d(A,"BaseTextureCache",function(){return _e}),v.d(A,"CanvasRenderTarget",function(){return Ae}),v.d(A,"DATA_URI",function(){return cn}),v.d(A,"ProgramCache",function(){return Jt}),v.d(A,"TextureCache",function(){return at}),v.d(A,"clearTextureCache",function(){return Oe}),v.d(A,"correctBlendMode",function(){return G}),v.d(A,"createIndicesForQuads",function(){return z}),v.d(A,"decomposeDataUri",function(){return ke}),v.d(A,"deprecation",function(){return Xt}),v.d(A,"destroyTextureCache",function(){return Ue}),v.d(A,"determineCrossOrigin",function(){return Ge}),v.d(A,"getBufferType",function(){return U}),v.d(A,"getResolutionOfUrl",function(){return Rn}),v.d(A,"hex2rgb",function(){return F}),v.d(A,"hex2string",function(){return Y}),v.d(A,"interleaveTypedArrays",function(){return $}),v.d(A,"isPow2",function(){return Lt}),v.d(A,"isWebGLSupported",function(){return L}),v.d(A,"log2",function(){return K}),v.d(A,"nextPow2",function(){return gt}),v.d(A,"premultiplyBlendMode",function(){return tt}),v.d(A,"premultiplyRgba",function(){return Ot}),v.d(A,"premultiplyTint",function(){return Vt}),v.d(A,"premultiplyTintToRgba",function(){return st}),v.d(A,"removeItems",function(){return dt}),v.d(A,"rgb2hex",function(){return H}),v.d(A,"sayHello",function(){return At}),v.d(A,"sign",function(){return it}),v.d(A,"skipHello",function(){return Dt}),v.d(A,"string2hex",function(){return O}),v.d(A,"trimCanvas",function(){return ze}),v.d(A,"uid",function(){return St}),v.d(A,"url",function(){return V});var P=v(4);v.d(A,"isMobile",function(){return P.a});var M=v(52),I=v.n(M);v.d(A,"EventEmitter",function(){return I.a});var D=v(53),k=v.n(D);v.d(A,"earcut",function(){return k.a});var W=v(35),X=v(0),V={parse:W.parse,format:W.format,resolve:W.resolve};P.b.RETINA_PREFIX=/@([0-9\.]+)x/,P.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var et,pt=!1;function Dt(){pt=!0}function At(re){var pe;if(!pt){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var Ee=[`
 %c %c %c PixiJS 6.4.2 - \u2730 `+re+` \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(pe=globalThis.console).log.apply(pe,Ee)}else globalThis.console&&globalThis.console.log("PixiJS 6.4.2 - "+re+" - http://www.pixijs.com/");pt=!0}}function L(){return et===void 0&&(et=function(){var re={stencil:!0,failIfMajorPerformanceCaveat:P.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!globalThis.WebGLRenderingContext)return!1;var pe=document.createElement("canvas"),Ee=pe.getContext("webgl",re)||pe.getContext("experimental-webgl",re),ln=!(!Ee||!Ee.getContextAttributes().stencil);if(Ee){var In=Ee.getExtension("WEBGL_lose_context");In&&In.loseContext()}return Ee=null,ln}catch{return!1}}()),et}var R={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function F(re,pe){return pe===void 0&&(pe=[]),pe[0]=(re>>16&255)/255,pe[1]=(re>>8&255)/255,pe[2]=(255&re)/255,pe}function Y(re){var pe=re.toString(16);return"#"+(pe="000000".substring(0,6-pe.length)+pe)}function O(re){return typeof re=="string"&&(re=R[re.toLowerCase()]||re)[0]==="#"&&(re=re.slice(1)),parseInt(re,16)}function H(re){return(255*re[0]<<16)+(255*re[1]<<8)+(255*re[2]|0)}var tt=function(){for(var re=[],pe=[],Ee=0;Ee<32;Ee++)re[Ee]=Ee,pe[Ee]=Ee;re[X.b.NORMAL_NPM]=X.b.NORMAL,re[X.b.ADD_NPM]=X.b.ADD,re[X.b.SCREEN_NPM]=X.b.SCREEN,pe[X.b.NORMAL]=X.b.NORMAL_NPM,pe[X.b.ADD]=X.b.ADD_NPM,pe[X.b.SCREEN]=X.b.SCREEN_NPM;var ln=[];return ln.push(pe),ln.push(re),ln}();function G(re,pe){return tt[pe?1:0][re]}function Ot(re,pe,Ee,ln){return Ee=Ee||new Float32Array(4),ln||ln===void 0?(Ee[0]=re[0]*pe,Ee[1]=re[1]*pe,Ee[2]=re[2]*pe):(Ee[0]=re[0],Ee[1]=re[1],Ee[2]=re[2]),Ee[3]=pe,Ee}function Vt(re,pe){if(pe===1)return(255*pe<<24)+re;if(pe===0)return 0;var Ee=re>>16&255,ln=re>>8&255,In=255&re;return(255*pe<<24)+((Ee=Ee*pe+.5|0)<<16)+((ln=ln*pe+.5|0)<<8)+(In=In*pe+.5|0)}function st(re,pe,Ee,ln){return(Ee=Ee||new Float32Array(4))[0]=(re>>16&255)/255,Ee[1]=(re>>8&255)/255,Ee[2]=(255&re)/255,(ln||ln===void 0)&&(Ee[0]*=pe,Ee[1]*=pe,Ee[2]*=pe),Ee[3]=pe,Ee}function z(re,pe){pe===void 0&&(pe=null);var Ee=6*re;if((pe=pe||new Uint16Array(Ee)).length!==Ee)throw new Error("Out buffer length is incorrect, got "+pe.length+" and expected "+Ee);for(var ln=0,In=0;ln<Ee;ln+=6,In+=4)pe[ln+0]=In+0,pe[ln+1]=In+1,pe[ln+2]=In+2,pe[ln+3]=In+0,pe[ln+4]=In+2,pe[ln+5]=In+3;return pe}function U(re){if(re.BYTES_PER_ELEMENT===4)return re instanceof Float32Array?"Float32Array":re instanceof Uint32Array?"Uint32Array":"Int32Array";if(re.BYTES_PER_ELEMENT===2){if(re instanceof Uint16Array)return"Uint16Array"}else if(re.BYTES_PER_ELEMENT===1&&re instanceof Uint8Array)return"Uint8Array";return null}var ft={Float32Array,Uint32Array,Int32Array,Uint8Array};function $(re,pe){for(var Ee=0,ln=0,In={},Qn=0;Qn<re.length;Qn++)ln+=pe[Qn],Ee+=re[Qn].length;var fi=new ArrayBuffer(4*Ee),tn=null,yt=0;for(Qn=0;Qn<re.length;Qn++){var Et=pe[Qn],Rt=re[Qn],Qt=U(Rt);In[Qt]||(In[Qt]=new ft[Qt](fi)),tn=In[Qt];for(var Wt=0;Wt<Rt.length;Wt++)tn[(Wt/Et|0)*ln+yt+Wt%Et]=Rt[Wt];yt+=Et}return new Float32Array(fi)}function gt(re){return re+=re===0?1:0,--re,re|=re>>>1,re|=re>>>2,re|=re>>>4,re|=re>>>8,(re|=re>>>16)+1}function Lt(re){return!(re&re-1||!re)}function K(re){var pe=(re>65535?1:0)<<4,Ee=((re>>>=pe)>255?1:0)<<3;return pe|=Ee,pe|=Ee=((re>>>=Ee)>15?1:0)<<2,(pe|=Ee=((re>>>=Ee)>3?1:0)<<1)|(re>>>=Ee)>>1}function dt(re,pe,Ee){var ln,In=re.length;if(!(pe>=In||Ee===0)){var Qn=In-(Ee=pe+Ee>In?In-pe:Ee);for(ln=pe;ln<Qn;++ln)re[ln]=re[ln+Ee];re.length=Qn}}function it(re){return re===0?0:re<0?-1:1}var _t=0;function St(){return++_t}var kt={};function Xt(re,pe,Ee){if(Ee===void 0&&(Ee=3),!kt[pe]){var ln=new Error().stack;ln===void 0?console.warn("PixiJS Deprecation Warning: ",pe+`
Deprecated since v`+re):(ln=ln.split(`
`).splice(Ee).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",pe+`
Deprecated since v`+re),console.warn(ln),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",pe+`
Deprecated since v`+re),console.warn(ln))),kt[pe]=!0}}var Jt={},at=Object.create(null),_e=Object.create(null);function Ue(){var re;for(re in at)at[re].destroy();for(re in _e)_e[re].destroy()}function Oe(){var re;for(re in at)delete at[re];for(re in _e)delete _e[re]}var Ae=function(){function re(pe,Ee,ln){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=ln||P.b.RESOLUTION,this.resize(pe,Ee)}return re.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},re.prototype.resize=function(pe,Ee){this.canvas.width=Math.round(pe*this.resolution),this.canvas.height=Math.round(Ee*this.resolution)},re.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(re.prototype,"width",{get:function(){return this.canvas.width},set:function(pe){this.canvas.width=Math.round(pe)},enumerable:!1,configurable:!0}),Object.defineProperty(re.prototype,"height",{get:function(){return this.canvas.height},set:function(pe){this.canvas.height=Math.round(pe)},enumerable:!1,configurable:!0}),re}();function ze(re){var pe,Ee,ln,In=re.width,Qn=re.height,fi=re.getContext("2d"),tn=fi.getImageData(0,0,In,Qn).data,yt=tn.length,Et={top:null,left:null,right:null,bottom:null},Rt=null;for(pe=0;pe<yt;pe+=4)tn[pe+3]!==0&&(Ee=pe/4%In,ln=~~(pe/4/In),Et.top===null&&(Et.top=ln),(Et.left===null||Ee<Et.left)&&(Et.left=Ee),(Et.right===null||Et.right<Ee)&&(Et.right=Ee+1),(Et.bottom===null||Et.bottom<ln)&&(Et.bottom=ln));return Et.top!==null&&(In=Et.right-Et.left,Qn=Et.bottom-Et.top+1,Rt=fi.getImageData(Et.left,Et.top,In,Qn)),{height:Qn,width:In,data:Rt}}var $e,cn=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function ke(re){var pe=cn.exec(re);if(pe)return{mediaType:pe[1]?pe[1].toLowerCase():void 0,subType:pe[2]?pe[2].toLowerCase():void 0,charset:pe[3]?pe[3].toLowerCase():void 0,encoding:pe[4]?pe[4].toLowerCase():void 0,data:pe[5]}}function Ge(re,pe){if(pe===void 0&&(pe=globalThis.location),re.indexOf("data:")===0)return"";pe=pe||globalThis.location,$e||($e=document.createElement("a")),$e.href=re;var Ee=V.parse($e.href),ln=!Ee.port&&pe.port===""||Ee.port===pe.port;return Ee.hostname===pe.hostname&&ln&&Ee.protocol===pe.protocol?"":"anonymous"}function Rn(re,pe){var Ee=P.b.RETINA_PREFIX.exec(re);return Ee?parseFloat(Ee[1]):pe!==void 0?pe:1}},function(b,A,v){v.d(A,"a",function(){return Xt}),v.d(A,"b",function(){return Jt});var P=/iPhone/i,M=/iPod/i,I=/iPad/i,D=/\biOS-universal(?:.+)Mac\b/i,k=/\bAndroid(?:.+)Mobile\b/i,W=/Android/i,X=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,V=/Silk/i,et=/Windows Phone/i,pt=/\bWindows(?:.+)ARM\b/i,Dt=/BlackBerry/i,At=/BB10/i,L=/Opera Mini/i,R=/\b(CriOS|Chrome)(?:.+)Mobile/i,F=/Mobile(?:.+)Firefox\b/i,Y=function(at){return at!==void 0&&at.platform==="MacIntel"&&typeof at.maxTouchPoints=="number"&&at.maxTouchPoints>1&&typeof MSStream=="undefined"};/*!
 * @pixi/settings - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var O,H,tt,G,Ot,Vt,st,z,U,ft,$,gt,Lt,K,dt,it,_t,St,kt,Xt=function(at){var _e={userAgent:"",platform:"",maxTouchPoints:0};at||typeof navigator=="undefined"?typeof at=="string"?_e.userAgent=at:at&&at.userAgent&&(_e={userAgent:at.userAgent,platform:at.platform,maxTouchPoints:at.maxTouchPoints||0}):_e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var Ue=_e.userAgent,Oe=Ue.split("[FBAN");Oe[1]!==void 0&&(Ue=Oe[0]),(Oe=Ue.split("Twitter"))[1]!==void 0&&(Ue=Oe[0]);var Ae=function($e){return function(cn){return cn.test($e)}}(Ue),ze={apple:{phone:Ae(P)&&!Ae(et),ipod:Ae(M),tablet:!Ae(P)&&(Ae(I)||Y(_e))&&!Ae(et),universal:Ae(D),device:(Ae(P)||Ae(M)||Ae(I)||Ae(D)||Y(_e))&&!Ae(et)},amazon:{phone:Ae(X),tablet:!Ae(X)&&Ae(V),device:Ae(X)||Ae(V)},android:{phone:!Ae(et)&&Ae(X)||!Ae(et)&&Ae(k),tablet:!Ae(et)&&!Ae(X)&&!Ae(k)&&(Ae(V)||Ae(W)),device:!Ae(et)&&(Ae(X)||Ae(V)||Ae(k)||Ae(W))||Ae(/\bokhttp\b/i)},windows:{phone:Ae(et),tablet:Ae(pt),device:Ae(et)||Ae(pt)},other:{blackberry:Ae(Dt),blackberry10:Ae(At),opera:Ae(L),firefox:Ae(F),chrome:Ae(R),device:Ae(Dt)||Ae(At)||Ae(L)||Ae(F)||Ae(R)},any:!1,phone:!1,tablet:!1};return ze.any=ze.apple.device||ze.android.device||ze.windows.device||ze.other.device,ze.phone=ze.apple.phone||ze.android.phone||ze.windows.phone,ze.tablet=ze.apple.tablet||ze.android.tablet||ze.windows.tablet,ze}(globalThis.navigator);(function(at){at[at.WEBGL_LEGACY=0]="WEBGL_LEGACY",at[at.WEBGL=1]="WEBGL",at[at.WEBGL2=2]="WEBGL2"})(O||(O={})),function(at){at[at.UNKNOWN=0]="UNKNOWN",at[at.WEBGL=1]="WEBGL",at[at.CANVAS=2]="CANVAS"}(H||(H={})),function(at){at[at.COLOR=16384]="COLOR",at[at.DEPTH=256]="DEPTH",at[at.STENCIL=1024]="STENCIL"}(tt||(tt={})),function(at){at[at.NORMAL=0]="NORMAL",at[at.ADD=1]="ADD",at[at.MULTIPLY=2]="MULTIPLY",at[at.SCREEN=3]="SCREEN",at[at.OVERLAY=4]="OVERLAY",at[at.DARKEN=5]="DARKEN",at[at.LIGHTEN=6]="LIGHTEN",at[at.COLOR_DODGE=7]="COLOR_DODGE",at[at.COLOR_BURN=8]="COLOR_BURN",at[at.HARD_LIGHT=9]="HARD_LIGHT",at[at.SOFT_LIGHT=10]="SOFT_LIGHT",at[at.DIFFERENCE=11]="DIFFERENCE",at[at.EXCLUSION=12]="EXCLUSION",at[at.HUE=13]="HUE",at[at.SATURATION=14]="SATURATION",at[at.COLOR=15]="COLOR",at[at.LUMINOSITY=16]="LUMINOSITY",at[at.NORMAL_NPM=17]="NORMAL_NPM",at[at.ADD_NPM=18]="ADD_NPM",at[at.SCREEN_NPM=19]="SCREEN_NPM",at[at.NONE=20]="NONE",at[at.SRC_OVER=0]="SRC_OVER",at[at.SRC_IN=21]="SRC_IN",at[at.SRC_OUT=22]="SRC_OUT",at[at.SRC_ATOP=23]="SRC_ATOP",at[at.DST_OVER=24]="DST_OVER",at[at.DST_IN=25]="DST_IN",at[at.DST_OUT=26]="DST_OUT",at[at.DST_ATOP=27]="DST_ATOP",at[at.ERASE=26]="ERASE",at[at.SUBTRACT=28]="SUBTRACT",at[at.XOR=29]="XOR"}(G||(G={})),function(at){at[at.POINTS=0]="POINTS",at[at.LINES=1]="LINES",at[at.LINE_LOOP=2]="LINE_LOOP",at[at.LINE_STRIP=3]="LINE_STRIP",at[at.TRIANGLES=4]="TRIANGLES",at[at.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",at[at.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Ot||(Ot={})),function(at){at[at.RGBA=6408]="RGBA",at[at.RGB=6407]="RGB",at[at.RG=33319]="RG",at[at.RED=6403]="RED",at[at.RGBA_INTEGER=36249]="RGBA_INTEGER",at[at.RGB_INTEGER=36248]="RGB_INTEGER",at[at.RG_INTEGER=33320]="RG_INTEGER",at[at.RED_INTEGER=36244]="RED_INTEGER",at[at.ALPHA=6406]="ALPHA",at[at.LUMINANCE=6409]="LUMINANCE",at[at.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",at[at.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",at[at.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Vt||(Vt={})),function(at){at[at.TEXTURE_2D=3553]="TEXTURE_2D",at[at.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",at[at.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",at[at.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",at[at.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",at[at.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",at[at.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",at[at.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",at[at.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(st||(st={})),function(at){at[at.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",at[at.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",at[at.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",at[at.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",at[at.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",at[at.UNSIGNED_INT=5125]="UNSIGNED_INT",at[at.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",at[at.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",at[at.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",at[at.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",at[at.BYTE=5120]="BYTE",at[at.SHORT=5122]="SHORT",at[at.INT=5124]="INT",at[at.FLOAT=5126]="FLOAT",at[at.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",at[at.HALF_FLOAT=36193]="HALF_FLOAT"}(z||(z={})),function(at){at[at.FLOAT=0]="FLOAT",at[at.INT=1]="INT",at[at.UINT=2]="UINT"}(U||(U={})),function(at){at[at.NEAREST=0]="NEAREST",at[at.LINEAR=1]="LINEAR"}(ft||(ft={})),function(at){at[at.CLAMP=33071]="CLAMP",at[at.REPEAT=10497]="REPEAT",at[at.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}($||($={})),function(at){at[at.OFF=0]="OFF",at[at.POW2=1]="POW2",at[at.ON=2]="ON",at[at.ON_MANUAL=3]="ON_MANUAL"}(gt||(gt={})),function(at){at[at.NPM=0]="NPM",at[at.UNPACK=1]="UNPACK",at[at.PMA=2]="PMA",at[at.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",at[at.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",at[at.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",at[at.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Lt||(Lt={})),function(at){at[at.NO=0]="NO",at[at.YES=1]="YES",at[at.AUTO=2]="AUTO",at[at.BLEND=0]="BLEND",at[at.CLEAR=1]="CLEAR",at[at.BLIT=2]="BLIT"}(K||(K={})),function(at){at[at.AUTO=0]="AUTO",at[at.MANUAL=1]="MANUAL"}(dt||(dt={})),function(at){at.LOW="lowp",at.MEDIUM="mediump",at.HIGH="highp"}(it||(it={})),function(at){at[at.NONE=0]="NONE",at[at.SCISSOR=1]="SCISSOR",at[at.STENCIL=2]="STENCIL",at[at.SPRITE=3]="SPRITE"}(_t||(_t={})),function(at){at[at.NONE=0]="NONE",at[at.LOW=2]="LOW",at[at.MEDIUM=4]="MEDIUM",at[at.HIGH=8]="HIGH"}(St||(St={})),function(at){at[at.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",at[at.ARRAY_BUFFER=34962]="ARRAY_BUFFER",at[at.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(kt||(kt={}));var Jt={MIPMAP_TEXTURES:gt.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:St.NONE,SPRITE_MAX_TEXTURES:function(at){var _e=!0;if(Xt.tablet||Xt.phone){var Ue;Xt.apple.device&&(Ue=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(Ue[1],10)<11&&(_e=!1),Xt.android.device&&(Ue=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(Ue[1],10)<7&&(_e=!1)}return _e?at:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:dt.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:$.CLAMP,SCALE_MODE:ft.LINEAR,PRECISION_VERTEX:it.HIGH,PRECISION_FRAGMENT:Xt.apple.device?it.HIGH:it.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!Xt.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1}},function(b,A,v){v.d(A,"a",function(){return D}),v.d(A,"b",function(){return Lt}),v.d(A,"c",function(){return ft}),v.d(A,"d",function(){return $});var P=v(4),M=v(1),I=v(3);/*!
 * @pixi/display - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */P.b.SORTABLE_CHILDREN=!1;var D=function(){function K(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return K.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},K.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},K.prototype.getRectangle=function(dt){return this.minX>this.maxX||this.minY>this.maxY?M.j.EMPTY:((dt=dt||new M.j(0,0,1,1)).x=this.minX,dt.y=this.minY,dt.width=this.maxX-this.minX,dt.height=this.maxY-this.minY,dt)},K.prototype.addPoint=function(dt){this.minX=Math.min(this.minX,dt.x),this.maxX=Math.max(this.maxX,dt.x),this.minY=Math.min(this.minY,dt.y),this.maxY=Math.max(this.maxY,dt.y)},K.prototype.addPointMatrix=function(dt,it){var _t=dt.a,St=dt.b,kt=dt.c,Xt=dt.d,Jt=dt.tx,at=dt.ty,_e=_t*it.x+kt*it.y+Jt,Ue=St*it.x+Xt*it.y+at;this.minX=Math.min(this.minX,_e),this.maxX=Math.max(this.maxX,_e),this.minY=Math.min(this.minY,Ue),this.maxY=Math.max(this.maxY,Ue)},K.prototype.addQuad=function(dt){var it=this.minX,_t=this.minY,St=this.maxX,kt=this.maxY,Xt=dt[0],Jt=dt[1];it=Xt<it?Xt:it,_t=Jt<_t?Jt:_t,St=Xt>St?Xt:St,kt=Jt>kt?Jt:kt,it=(Xt=dt[2])<it?Xt:it,_t=(Jt=dt[3])<_t?Jt:_t,St=Xt>St?Xt:St,kt=Jt>kt?Jt:kt,it=(Xt=dt[4])<it?Xt:it,_t=(Jt=dt[5])<_t?Jt:_t,St=Xt>St?Xt:St,kt=Jt>kt?Jt:kt,it=(Xt=dt[6])<it?Xt:it,_t=(Jt=dt[7])<_t?Jt:_t,St=Xt>St?Xt:St,kt=Jt>kt?Jt:kt,this.minX=it,this.minY=_t,this.maxX=St,this.maxY=kt},K.prototype.addFrame=function(dt,it,_t,St,kt){this.addFrameMatrix(dt.worldTransform,it,_t,St,kt)},K.prototype.addFrameMatrix=function(dt,it,_t,St,kt){var Xt=dt.a,Jt=dt.b,at=dt.c,_e=dt.d,Ue=dt.tx,Oe=dt.ty,Ae=this.minX,ze=this.minY,$e=this.maxX,cn=this.maxY,ke=Xt*it+at*_t+Ue,Ge=Jt*it+_e*_t+Oe;Ae=ke<Ae?ke:Ae,ze=Ge<ze?Ge:ze,$e=ke>$e?ke:$e,cn=Ge>cn?Ge:cn,Ae=(ke=Xt*St+at*_t+Ue)<Ae?ke:Ae,ze=(Ge=Jt*St+_e*_t+Oe)<ze?Ge:ze,$e=ke>$e?ke:$e,cn=Ge>cn?Ge:cn,Ae=(ke=Xt*it+at*kt+Ue)<Ae?ke:Ae,ze=(Ge=Jt*it+_e*kt+Oe)<ze?Ge:ze,$e=ke>$e?ke:$e,cn=Ge>cn?Ge:cn,Ae=(ke=Xt*St+at*kt+Ue)<Ae?ke:Ae,ze=(Ge=Jt*St+_e*kt+Oe)<ze?Ge:ze,$e=ke>$e?ke:$e,cn=Ge>cn?Ge:cn,this.minX=Ae,this.minY=ze,this.maxX=$e,this.maxY=cn},K.prototype.addVertexData=function(dt,it,_t){for(var St=this.minX,kt=this.minY,Xt=this.maxX,Jt=this.maxY,at=it;at<_t;at+=2){var _e=dt[at],Ue=dt[at+1];St=_e<St?_e:St,kt=Ue<kt?Ue:kt,Xt=_e>Xt?_e:Xt,Jt=Ue>Jt?Ue:Jt}this.minX=St,this.minY=kt,this.maxX=Xt,this.maxY=Jt},K.prototype.addVertices=function(dt,it,_t,St){this.addVerticesMatrix(dt.worldTransform,it,_t,St)},K.prototype.addVerticesMatrix=function(dt,it,_t,St,kt,Xt){kt===void 0&&(kt=0),Xt===void 0&&(Xt=kt);for(var Jt=dt.a,at=dt.b,_e=dt.c,Ue=dt.d,Oe=dt.tx,Ae=dt.ty,ze=this.minX,$e=this.minY,cn=this.maxX,ke=this.maxY,Ge=_t;Ge<St;Ge+=2){var Rn=it[Ge],re=it[Ge+1],pe=Jt*Rn+_e*re+Oe,Ee=Ue*re+at*Rn+Ae;ze=Math.min(ze,pe-kt),cn=Math.max(cn,pe+kt),$e=Math.min($e,Ee-Xt),ke=Math.max(ke,Ee+Xt)}this.minX=ze,this.minY=$e,this.maxX=cn,this.maxY=ke},K.prototype.addBounds=function(dt){var it=this.minX,_t=this.minY,St=this.maxX,kt=this.maxY;this.minX=dt.minX<it?dt.minX:it,this.minY=dt.minY<_t?dt.minY:_t,this.maxX=dt.maxX>St?dt.maxX:St,this.maxY=dt.maxY>kt?dt.maxY:kt},K.prototype.addBoundsMask=function(dt,it){var _t=dt.minX>it.minX?dt.minX:it.minX,St=dt.minY>it.minY?dt.minY:it.minY,kt=dt.maxX<it.maxX?dt.maxX:it.maxX,Xt=dt.maxY<it.maxY?dt.maxY:it.maxY;if(_t<=kt&&St<=Xt){var Jt=this.minX,at=this.minY,_e=this.maxX,Ue=this.maxY;this.minX=_t<Jt?_t:Jt,this.minY=St<at?St:at,this.maxX=kt>_e?kt:_e,this.maxY=Xt>Ue?Xt:Ue}},K.prototype.addBoundsMatrix=function(dt,it){this.addFrameMatrix(it,dt.minX,dt.minY,dt.maxX,dt.maxY)},K.prototype.addBoundsArea=function(dt,it){var _t=dt.minX>it.x?dt.minX:it.x,St=dt.minY>it.y?dt.minY:it.y,kt=dt.maxX<it.x+it.width?dt.maxX:it.x+it.width,Xt=dt.maxY<it.y+it.height?dt.maxY:it.y+it.height;if(_t<=kt&&St<=Xt){var Jt=this.minX,at=this.minY,_e=this.maxX,Ue=this.maxY;this.minX=_t<Jt?_t:Jt,this.minY=St<at?St:at,this.maxX=kt>_e?kt:_e,this.maxY=Xt>Ue?Xt:Ue}},K.prototype.pad=function(dt,it){dt===void 0&&(dt=0),it===void 0&&(it=dt),this.isEmpty()||(this.minX-=dt,this.maxX+=dt,this.minY-=it,this.maxY+=it)},K.prototype.addFramePad=function(dt,it,_t,St,kt,Xt){dt-=kt,it-=Xt,_t+=kt,St+=Xt,this.minX=this.minX<dt?this.minX:dt,this.maxX=this.maxX>_t?this.maxX:_t,this.minY=this.minY<it?this.minY:it,this.maxY=this.maxY>St?this.maxY:St},K}(),k=function(K,dt){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(it,_t){it.__proto__=_t}||function(it,_t){for(var St in _t)_t.hasOwnProperty(St)&&(it[St]=_t[St])})(K,dt)};/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */function W(K,dt){function it(){this.constructor=K}k(K,dt),K.prototype=dt===null?Object.create(dt):(it.prototype=dt.prototype,new it)}var X,V,et,pt,Dt,At,L,R,F,Y,O,H,tt,G,Ot,Vt,st,z,U,ft=function(K){function dt(){var it=K.call(this)||this;return it.tempDisplayObjectParent=null,it.transform=new M.m,it.alpha=1,it.visible=!0,it.renderable=!0,it.cullable=!1,it.cullArea=null,it.parent=null,it.worldAlpha=1,it._lastSortedIndex=0,it._zIndex=0,it.filterArea=null,it.filters=null,it._enabledFilters=null,it._bounds=new D,it._localBounds=null,it._boundsID=0,it._boundsRect=null,it._localBoundsRect=null,it._mask=null,it._maskRefCount=0,it._destroyed=!1,it.isSprite=!1,it.isMask=!1,it}return W(dt,K),dt.mixin=function(it){for(var _t=Object.keys(it),St=0;St<_t.length;++St){var kt=_t[St];Object.defineProperty(dt.prototype,kt,Object.getOwnPropertyDescriptor(it,kt))}},Object.defineProperty(dt.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),dt.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},dt.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},dt.prototype.getBounds=function(it,_t){return it||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),_t||(this._boundsRect||(this._boundsRect=new M.j),_t=this._boundsRect),this._bounds.getRectangle(_t)},dt.prototype.getLocalBounds=function(it){it||(this._localBoundsRect||(this._localBoundsRect=new M.j),it=this._localBoundsRect),this._localBounds||(this._localBounds=new D);var _t=this.transform,St=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var kt=this._bounds,Xt=this._boundsID;this._bounds=this._localBounds;var Jt=this.getBounds(!1,it);return this.parent=St,this.transform=_t,this._bounds=kt,this._bounds.updateID+=this._boundsID-Xt,Jt},dt.prototype.toGlobal=function(it,_t,St){return St===void 0&&(St=!1),St||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(it,_t)},dt.prototype.toLocal=function(it,_t,St,kt){return _t&&(it=_t.toGlobal(it,St,kt)),kt||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(it,St)},dt.prototype.setParent=function(it){if(!it||!it.addChild)throw new Error("setParent: Argument must be a Container");return it.addChild(this),it},dt.prototype.setTransform=function(it,_t,St,kt,Xt,Jt,at,_e,Ue){return it===void 0&&(it=0),_t===void 0&&(_t=0),St===void 0&&(St=1),kt===void 0&&(kt=1),Xt===void 0&&(Xt=0),Jt===void 0&&(Jt=0),at===void 0&&(at=0),_e===void 0&&(_e=0),Ue===void 0&&(Ue=0),this.position.x=it,this.position.y=_t,this.scale.x=St||1,this.scale.y=kt||1,this.rotation=Xt,this.skew.x=Jt,this.skew.y=at,this.pivot.x=_e,this.pivot.y=Ue,this},dt.prototype.destroy=function(it){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(dt.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new $),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),dt.prototype.enableTempParent=function(){var it=this.parent;return this.parent=this._tempDisplayObjectParent,it},dt.prototype.disableTempParent=function(it){this.parent=it},Object.defineProperty(dt.prototype,"x",{get:function(){return this.position.x},set:function(it){this.transform.position.x=it},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"y",{get:function(){return this.position.y},set:function(it){this.transform.position.y=it},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"position",{get:function(){return this.transform.position},set:function(it){this.transform.position.copyFrom(it)},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"scale",{get:function(){return this.transform.scale},set:function(it){this.transform.scale.copyFrom(it)},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(it){this.transform.pivot.copyFrom(it)},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"skew",{get:function(){return this.transform.skew},set:function(it){this.transform.skew.copyFrom(it)},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(it){this.transform.rotation=it},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"angle",{get:function(){return this.transform.rotation*M.i},set:function(it){this.transform.rotation=it*M.b},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"zIndex",{get:function(){return this._zIndex},set:function(it){this._zIndex=it,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"worldVisible",{get:function(){var it=this;do{if(!it.visible)return!1;it=it.parent}while(it);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"mask",{get:function(){return this._mask},set:function(it){if(this._mask!==it){var _t;this._mask&&((_t=this._mask.maskObject||this._mask)._maskRefCount--,_t._maskRefCount===0&&(_t.renderable=!0,_t.isMask=!1)),this._mask=it,this._mask&&((_t=this._mask.maskObject||this._mask)._maskRefCount===0&&(_t.renderable=!1,_t.isMask=!0),_t._maskRefCount++)}},enumerable:!1,configurable:!0}),dt}(I.EventEmitter),$=function(K){function dt(){var it=K!==null&&K.apply(this,arguments)||this;return it.sortDirty=null,it}return W(dt,K),dt}(ft);function gt(K,dt){return K.zIndex===dt.zIndex?K._lastSortedIndex-dt._lastSortedIndex:K.zIndex-dt.zIndex}ft.prototype.displayObjectUpdateTransform=ft.prototype.updateTransform,function(K){K[K.WEBGL_LEGACY=0]="WEBGL_LEGACY",K[K.WEBGL=1]="WEBGL",K[K.WEBGL2=2]="WEBGL2"}(X||(X={})),function(K){K[K.UNKNOWN=0]="UNKNOWN",K[K.WEBGL=1]="WEBGL",K[K.CANVAS=2]="CANVAS"}(V||(V={})),function(K){K[K.COLOR=16384]="COLOR",K[K.DEPTH=256]="DEPTH",K[K.STENCIL=1024]="STENCIL"}(et||(et={})),function(K){K[K.NORMAL=0]="NORMAL",K[K.ADD=1]="ADD",K[K.MULTIPLY=2]="MULTIPLY",K[K.SCREEN=3]="SCREEN",K[K.OVERLAY=4]="OVERLAY",K[K.DARKEN=5]="DARKEN",K[K.LIGHTEN=6]="LIGHTEN",K[K.COLOR_DODGE=7]="COLOR_DODGE",K[K.COLOR_BURN=8]="COLOR_BURN",K[K.HARD_LIGHT=9]="HARD_LIGHT",K[K.SOFT_LIGHT=10]="SOFT_LIGHT",K[K.DIFFERENCE=11]="DIFFERENCE",K[K.EXCLUSION=12]="EXCLUSION",K[K.HUE=13]="HUE",K[K.SATURATION=14]="SATURATION",K[K.COLOR=15]="COLOR",K[K.LUMINOSITY=16]="LUMINOSITY",K[K.NORMAL_NPM=17]="NORMAL_NPM",K[K.ADD_NPM=18]="ADD_NPM",K[K.SCREEN_NPM=19]="SCREEN_NPM",K[K.NONE=20]="NONE",K[K.SRC_OVER=0]="SRC_OVER",K[K.SRC_IN=21]="SRC_IN",K[K.SRC_OUT=22]="SRC_OUT",K[K.SRC_ATOP=23]="SRC_ATOP",K[K.DST_OVER=24]="DST_OVER",K[K.DST_IN=25]="DST_IN",K[K.DST_OUT=26]="DST_OUT",K[K.DST_ATOP=27]="DST_ATOP",K[K.ERASE=26]="ERASE",K[K.SUBTRACT=28]="SUBTRACT",K[K.XOR=29]="XOR"}(pt||(pt={})),function(K){K[K.POINTS=0]="POINTS",K[K.LINES=1]="LINES",K[K.LINE_LOOP=2]="LINE_LOOP",K[K.LINE_STRIP=3]="LINE_STRIP",K[K.TRIANGLES=4]="TRIANGLES",K[K.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",K[K.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Dt||(Dt={})),function(K){K[K.RGBA=6408]="RGBA",K[K.RGB=6407]="RGB",K[K.RG=33319]="RG",K[K.RED=6403]="RED",K[K.RGBA_INTEGER=36249]="RGBA_INTEGER",K[K.RGB_INTEGER=36248]="RGB_INTEGER",K[K.RG_INTEGER=33320]="RG_INTEGER",K[K.RED_INTEGER=36244]="RED_INTEGER",K[K.ALPHA=6406]="ALPHA",K[K.LUMINANCE=6409]="LUMINANCE",K[K.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",K[K.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",K[K.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(At||(At={})),function(K){K[K.TEXTURE_2D=3553]="TEXTURE_2D",K[K.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",K[K.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",K[K.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",K[K.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",K[K.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",K[K.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",K[K.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",K[K.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(L||(L={})),function(K){K[K.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",K[K.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",K[K.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",K[K.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",K[K.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",K[K.UNSIGNED_INT=5125]="UNSIGNED_INT",K[K.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",K[K.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",K[K.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",K[K.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",K[K.BYTE=5120]="BYTE",K[K.SHORT=5122]="SHORT",K[K.INT=5124]="INT",K[K.FLOAT=5126]="FLOAT",K[K.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",K[K.HALF_FLOAT=36193]="HALF_FLOAT"}(R||(R={})),function(K){K[K.FLOAT=0]="FLOAT",K[K.INT=1]="INT",K[K.UINT=2]="UINT"}(F||(F={})),function(K){K[K.NEAREST=0]="NEAREST",K[K.LINEAR=1]="LINEAR"}(Y||(Y={})),function(K){K[K.CLAMP=33071]="CLAMP",K[K.REPEAT=10497]="REPEAT",K[K.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(O||(O={})),function(K){K[K.OFF=0]="OFF",K[K.POW2=1]="POW2",K[K.ON=2]="ON",K[K.ON_MANUAL=3]="ON_MANUAL"}(H||(H={})),function(K){K[K.NPM=0]="NPM",K[K.UNPACK=1]="UNPACK",K[K.PMA=2]="PMA",K[K.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",K[K.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",K[K.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",K[K.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(tt||(tt={})),function(K){K[K.NO=0]="NO",K[K.YES=1]="YES",K[K.AUTO=2]="AUTO",K[K.BLEND=0]="BLEND",K[K.CLEAR=1]="CLEAR",K[K.BLIT=2]="BLIT"}(G||(G={})),function(K){K[K.AUTO=0]="AUTO",K[K.MANUAL=1]="MANUAL"}(Ot||(Ot={})),function(K){K.LOW="lowp",K.MEDIUM="mediump",K.HIGH="highp"}(Vt||(Vt={})),function(K){K[K.NONE=0]="NONE",K[K.SCISSOR=1]="SCISSOR",K[K.STENCIL=2]="STENCIL",K[K.SPRITE=3]="SPRITE"}(st||(st={})),function(K){K[K.NONE=0]="NONE",K[K.LOW=2]="LOW",K[K.MEDIUM=4]="MEDIUM",K[K.HIGH=8]="HIGH"}(z||(z={})),function(K){K[K.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",K[K.ARRAY_BUFFER=34962]="ARRAY_BUFFER",K[K.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(U||(U={}));var Lt=function(K){function dt(){var it=K.call(this)||this;return it.children=[],it.sortableChildren=P.b.SORTABLE_CHILDREN,it.sortDirty=!1,it}return W(dt,K),dt.prototype.onChildrenChange=function(it){},dt.prototype.addChild=function(){for(var it=arguments,_t=[],St=0;St<arguments.length;St++)_t[St]=it[St];if(_t.length>1)for(var kt=0;kt<_t.length;kt++)this.addChild(_t[kt]);else{var Xt=_t[0];Xt.parent&&Xt.parent.removeChild(Xt),Xt.parent=this,this.sortDirty=!0,Xt.transform._parentID=-1,this.children.push(Xt),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",Xt,this,this.children.length-1),Xt.emit("added",this)}return _t[0]},dt.prototype.addChildAt=function(it,_t){if(_t<0||_t>this.children.length)throw new Error(it+"addChildAt: The index "+_t+" supplied is out of bounds "+this.children.length);return it.parent&&it.parent.removeChild(it),it.parent=this,this.sortDirty=!0,it.transform._parentID=-1,this.children.splice(_t,0,it),this._boundsID++,this.onChildrenChange(_t),it.emit("added",this),this.emit("childAdded",it,this,_t),it},dt.prototype.swapChildren=function(it,_t){if(it!==_t){var St=this.getChildIndex(it),kt=this.getChildIndex(_t);this.children[St]=_t,this.children[kt]=it,this.onChildrenChange(St<kt?St:kt)}},dt.prototype.getChildIndex=function(it){var _t=this.children.indexOf(it);if(_t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return _t},dt.prototype.setChildIndex=function(it,_t){if(_t<0||_t>=this.children.length)throw new Error("The index "+_t+" supplied is out of bounds "+this.children.length);var St=this.getChildIndex(it);Object(I.removeItems)(this.children,St,1),this.children.splice(_t,0,it),this.onChildrenChange(_t)},dt.prototype.getChildAt=function(it){if(it<0||it>=this.children.length)throw new Error("getChildAt: Index ("+it+") does not exist.");return this.children[it]},dt.prototype.removeChild=function(){for(var it=arguments,_t=[],St=0;St<arguments.length;St++)_t[St]=it[St];if(_t.length>1)for(var kt=0;kt<_t.length;kt++)this.removeChild(_t[kt]);else{var Xt=_t[0],Jt=this.children.indexOf(Xt);if(Jt===-1)return null;Xt.parent=null,Xt.transform._parentID=-1,Object(I.removeItems)(this.children,Jt,1),this._boundsID++,this.onChildrenChange(Jt),Xt.emit("removed",this),this.emit("childRemoved",Xt,this,Jt)}return _t[0]},dt.prototype.removeChildAt=function(it){var _t=this.getChildAt(it);return _t.parent=null,_t.transform._parentID=-1,Object(I.removeItems)(this.children,it,1),this._boundsID++,this.onChildrenChange(it),_t.emit("removed",this),this.emit("childRemoved",_t,this,it),_t},dt.prototype.removeChildren=function(it,_t){it===void 0&&(it=0),_t===void 0&&(_t=this.children.length);var St,kt=it,Xt=_t-kt;if(Xt>0&&Xt<=_t){St=this.children.splice(kt,Xt);for(var Jt=0;Jt<St.length;++Jt)St[Jt].parent=null,St[Jt].transform&&(St[Jt].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(it),Jt=0;Jt<St.length;++Jt)St[Jt].emit("removed",this),this.emit("childRemoved",St[Jt],this,Jt);return St}if(Xt===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},dt.prototype.sortChildren=function(){for(var it=!1,_t=0,St=this.children.length;_t<St;++_t){var kt=this.children[_t];kt._lastSortedIndex=_t,it||kt.zIndex===0||(it=!0)}it&&this.children.length>1&&this.children.sort(gt),this.sortDirty=!1},dt.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var it=0,_t=this.children.length;it<_t;++it){var St=this.children[it];St.visible&&St.updateTransform()}},dt.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var it=0;it<this.children.length;it++){var _t=this.children[it];if(_t.visible&&_t.renderable)if(_t.calculateBounds(),_t._mask){var St=_t._mask.maskObject||_t._mask;St.calculateBounds(),this._bounds.addBoundsMask(_t._bounds,St._bounds)}else _t.filterArea?this._bounds.addBoundsArea(_t._bounds,_t.filterArea):this._bounds.addBounds(_t._bounds)}this._bounds.updateID=this._boundsID},dt.prototype.getLocalBounds=function(it,_t){_t===void 0&&(_t=!1);var St=K.prototype.getLocalBounds.call(this,it);if(!_t)for(var kt=0,Xt=this.children.length;kt<Xt;++kt){var Jt=this.children[kt];Jt.visible&&Jt.updateTransform()}return St},dt.prototype._calculateBounds=function(){},dt.prototype._renderWithCulling=function(it){var _t=it.renderTexture.sourceFrame;if(_t.width>0&&_t.height>0){var St,kt;if(this.cullArea?(St=this.cullArea,kt=this.worldTransform):this._render!==dt.prototype._render&&(St=this.getBounds(!0)),St&&_t.intersects(St,kt))this._render(it);else if(this.cullArea)return;for(var Xt=0,Jt=this.children.length;Xt<Jt;++Xt){var at=this.children[Xt],_e=at.cullable;at.cullable=_e||!this.cullArea,at.render(it),at.cullable=_e}}},dt.prototype.render=function(it){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(it);else if(this.cullable)this._renderWithCulling(it);else{this._render(it);for(var _t=0,St=this.children.length;_t<St;++_t)this.children[_t].render(it)}},dt.prototype.renderAdvanced=function(it){var _t=this.filters,St=this._mask;if(_t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var kt=0;kt<_t.length;kt++)_t[kt].enabled&&this._enabledFilters.push(_t[kt])}var Xt=_t&&this._enabledFilters&&this._enabledFilters.length||St&&(!St.isMaskData||St.enabled&&(St.autoDetect||St.type!==st.NONE));if(Xt&&it.batch.flush(),_t&&this._enabledFilters&&this._enabledFilters.length&&it.filter.push(this,this._enabledFilters),St&&it.mask.push(this,this._mask),this.cullable)this._renderWithCulling(it);else{this._render(it),kt=0;for(var Jt=this.children.length;kt<Jt;++kt)this.children[kt].render(it)}Xt&&it.batch.flush(),St&&it.mask.pop(this),_t&&this._enabledFilters&&this._enabledFilters.length&&it.filter.pop()},dt.prototype._render=function(it){},dt.prototype.destroy=function(it){K.prototype.destroy.call(this),this.sortDirty=!1;var _t=typeof it=="boolean"?it:it&&it.children,St=this.removeChildren(0,this.children.length);if(_t)for(var kt=0;kt<St.length;++kt)St[kt].destroy(it)},Object.defineProperty(dt.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(it){var _t=this.getLocalBounds().width;this.scale.x=_t!==0?it/_t:1,this._width=it},enumerable:!1,configurable:!0}),Object.defineProperty(dt.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(it){var _t=this.getLocalBounds().height;this.scale.y=_t!==0?it/_t:1,this._height=it},enumerable:!1,configurable:!0}),dt}(ft);Lt.prototype.containerUpdateTransform=Lt.prototype.updateTransform},function(b,A,v){var P=Object.prototype.hasOwnProperty,M="~";function I(){}function D(V,et,pt){this.fn=V,this.context=et,this.once=pt||!1}function k(V,et,pt,Dt,At){if(typeof pt!="function")throw new TypeError("The listener must be a function");var L=new D(pt,Dt||V,At),R=M?M+et:et;return V._events[R]?V._events[R].fn?V._events[R]=[V._events[R],L]:V._events[R].push(L):(V._events[R]=L,V._eventsCount++),V}function W(V,et){--V._eventsCount==0?V._events=new I:delete V._events[et]}function X(){this._events=new I,this._eventsCount=0}Object.create&&(I.prototype=Object.create(null),new I().__proto__||(M=!1)),X.prototype.eventNames=function(){var V,et,pt=[];if(this._eventsCount===0)return pt;for(et in V=this._events)P.call(V,et)&&pt.push(M?et.slice(1):et);return Object.getOwnPropertySymbols?pt.concat(Object.getOwnPropertySymbols(V)):pt},X.prototype.listeners=function(V){var et=M?M+V:V,pt=this._events[et];if(!pt)return[];if(pt.fn)return[pt.fn];for(var Dt=0,At=pt.length,L=new Array(At);Dt<At;Dt++)L[Dt]=pt[Dt].fn;return L},X.prototype.listenerCount=function(V){var et=M?M+V:V,pt=this._events[et];return pt?pt.fn?1:pt.length:0},X.prototype.emit=function(V,et,pt,Dt,At,L){var R=M?M+V:V;if(!this._events[R])return!1;var F,Y,O=this._events[R],H=arguments.length;if(O.fn){switch(O.once&&this.removeListener(V,O.fn,void 0,!0),H){case 1:return O.fn.call(O.context),!0;case 2:return O.fn.call(O.context,et),!0;case 3:return O.fn.call(O.context,et,pt),!0;case 4:return O.fn.call(O.context,et,pt,Dt),!0;case 5:return O.fn.call(O.context,et,pt,Dt,At),!0;case 6:return O.fn.call(O.context,et,pt,Dt,At,L),!0}for(Y=1,F=new Array(H-1);Y<H;Y++)F[Y-1]=arguments[Y];O.fn.apply(O.context,F)}else{var tt,G=O.length;for(Y=0;Y<G;Y++)switch(O[Y].once&&this.removeListener(V,O[Y].fn,void 0,!0),H){case 1:O[Y].fn.call(O[Y].context);break;case 2:O[Y].fn.call(O[Y].context,et);break;case 3:O[Y].fn.call(O[Y].context,et,pt);break;case 4:O[Y].fn.call(O[Y].context,et,pt,Dt);break;default:if(!F)for(tt=1,F=new Array(H-1);tt<H;tt++)F[tt-1]=arguments[tt];O[Y].fn.apply(O[Y].context,F)}}return!0},X.prototype.on=function(V,et,pt){return k(this,V,et,pt,!1)},X.prototype.once=function(V,et,pt){return k(this,V,et,pt,!0)},X.prototype.removeListener=function(V,et,pt,Dt){var At=M?M+V:V;if(!this._events[At])return this;if(!et)return W(this,At),this;var L=this._events[At];if(L.fn)L.fn!==et||Dt&&!L.once||pt&&L.context!==pt||W(this,At);else{for(var R=0,F=[],Y=L.length;R<Y;R++)(L[R].fn!==et||Dt&&!L[R].once||pt&&L[R].context!==pt)&&F.push(L[R]);F.length?this._events[At]=F.length===1?F[0]:F:W(this,At)}return this},X.prototype.removeAllListeners=function(V){var et;return V?(et=M?M+V:V,this._events[et]&&W(this,et)):(this._events=new I,this._eventsCount=0),this},X.prototype.off=X.prototype.removeListener,X.prototype.addListener=X.prototype.on,X.prefixed=M,X.EventEmitter=X,b.exports=X},function(b,A,v){v.d(A,"a",function(){return D}),v.d(A,"b",function(){return k}),v.d(A,"c",function(){return P});var P,M=v(4);/*!
 * @pixi/ticker - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */M.b.TARGET_FPMS=.06,function(W){W[W.INTERACTION=50]="INTERACTION",W[W.HIGH=25]="HIGH",W[W.NORMAL=0]="NORMAL",W[W.LOW=-25]="LOW",W[W.UTILITY=-50]="UTILITY"}(P||(P={}));var I=function(){function W(X,V,et,pt){V===void 0&&(V=null),et===void 0&&(et=0),pt===void 0&&(pt=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=X,this.context=V,this.priority=et,this.once=pt}return W.prototype.match=function(X,V){return V===void 0&&(V=null),this.fn===X&&this.context===V},W.prototype.emit=function(X){this.fn&&(this.context?this.fn.call(this.context,X):this.fn(X));var V=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),V},W.prototype.connect=function(X){this.previous=X,X.next&&(X.next.previous=this),this.next=X.next,X.next=this},W.prototype.destroy=function(X){X===void 0&&(X=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var V=this.next;return this.next=X?null:V,this.previous=null,V},W}(),D=function(){function W(){var X=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new I(null,null,1/0),this.deltaMS=1/M.b.TARGET_FPMS,this.elapsedMS=1/M.b.TARGET_FPMS,this._tick=function(V){X._requestId=null,X.started&&(X.update(V),X.started&&X._requestId===null&&X._head.next&&(X._requestId=requestAnimationFrame(X._tick)))}}return W.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},W.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},W.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},W.prototype.add=function(X,V,et){return et===void 0&&(et=P.NORMAL),this._addListener(new I(X,V,et))},W.prototype.addOnce=function(X,V,et){return et===void 0&&(et=P.NORMAL),this._addListener(new I(X,V,et,!0))},W.prototype._addListener=function(X){var V=this._head.next,et=this._head;if(V){for(;V;){if(X.priority>V.priority){X.connect(et);break}et=V,V=V.next}X.previous||X.connect(et)}else X.connect(et);return this._startIfPossible(),this},W.prototype.remove=function(X,V){for(var et=this._head.next;et;)et=et.match(X,V)?et.destroy():et.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(W.prototype,"count",{get:function(){if(!this._head)return 0;for(var X=0,V=this._head;V=V.next;)X++;return X},enumerable:!1,configurable:!0}),W.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},W.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},W.prototype.destroy=function(){if(!this._protected){this.stop();for(var X=this._head.next;X;)X=X.destroy(!0);this._head.destroy(),this._head=null}},W.prototype.update=function(X){var V;if(X===void 0&&(X=performance.now()),X>this.lastTime){if((V=this.elapsedMS=X-this.lastTime)>this._maxElapsedMS&&(V=this._maxElapsedMS),V*=this.speed,this._minElapsedMS){var et=X-this._lastFrame|0;if(et<this._minElapsedMS)return;this._lastFrame=X-et%this._minElapsedMS}this.deltaMS=V,this.deltaTime=this.deltaMS*M.b.TARGET_FPMS;for(var pt=this._head,Dt=pt.next;Dt;)Dt=Dt.emit(this.deltaTime);pt.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=X},Object.defineProperty(W.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(X){var V=Math.min(this.maxFPS,X),et=Math.min(Math.max(0,V)/1e3,M.b.TARGET_FPMS);this._maxElapsedMS=1/et},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(X){if(X===0)this._minElapsedMS=0;else{var V=Math.max(this.minFPS,X);this._minElapsedMS=1/(V/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(W,"shared",{get:function(){if(!W._shared){var X=W._shared=new W;X.autoStart=!0,X._protected=!0}return W._shared},enumerable:!1,configurable:!0}),Object.defineProperty(W,"system",{get:function(){if(!W._system){var X=W._system=new W;X.autoStart=!0,X._protected=!0}return W._system},enumerable:!1,configurable:!0}),W}(),k=function(){function W(){}return W.init=function(X){var V=this;X=Object.assign({autoStart:!0,sharedTicker:!1},X),Object.defineProperty(this,"ticker",{set:function(et){this._ticker&&this._ticker.remove(this.render,this),this._ticker=et,et&&et.add(this.render,this,P.LOW)},get:function(){return this._ticker}}),this.stop=function(){V._ticker.stop()},this.start=function(){V._ticker.start()},this._ticker=null,this.ticker=X.sharedTicker?D.shared:new D,X.autoStart&&this.start()},W.destroy=function(){if(this._ticker){var X=this._ticker;this.ticker=null,X.destroy()}},W}()},function(b,A,v){v.d(A,"a",function(){return At}),v.d(A,"b",function(){return R}),v.d(A,"c",function(){return L});var P=v(2),M=v(1),I=v(0),D=v(5),k=v(4),W=v(3),X=function(F,Y){return(X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,H){O.__proto__=H}||function(O,H){for(var tt in H)H.hasOwnProperty(tt)&&(O[tt]=H[tt])})(F,Y)};function V(F,Y){function O(){this.constructor=F}X(F,Y),F.prototype=Y===null?Object.create(Y):(O.prototype=Y.prototype,new O)}var et=function(){function F(Y,O){this.uvBuffer=Y,this.uvMatrix=O,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return F.prototype.update=function(Y){if(Y||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var O=this.uvBuffer.data;this.data&&this.data.length===O.length||(this.data=new Float32Array(O.length)),this.uvMatrix.multiplyUvs(O,this.data),this._updateID++}},F}(),pt=new M.g,Dt=new M.h,At=function(F){function Y(O,H,tt,G){G===void 0&&(G=I.f.TRIANGLES);var Ot=F.call(this)||this;return Ot.geometry=O,Ot.shader=H,Ot.state=tt||P.s.for2d(),Ot.drawMode=G,Ot.start=0,Ot.size=0,Ot.uvs=null,Ot.indices=null,Ot.vertexData=new Float32Array(1),Ot.vertexDirty=-1,Ot._transformID=-1,Ot._roundPixels=k.b.ROUND_PIXELS,Ot.batchUvs=null,Ot}return V(Y,F),Object.defineProperty(Y.prototype,"geometry",{get:function(){return this._geometry},set:function(O){this._geometry!==O&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=O,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"material",{get:function(){return this.shader},set:function(O){this.shader=O},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(O){this.state.blendMode=O},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(O){this._roundPixels!==O&&(this._transformID=-1),this._roundPixels=O},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(O){this.shader.tint=O},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(O){this.shader.texture=O},enumerable:!1,configurable:!0}),Y.prototype._render=function(O){var H=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===I.f.TRIANGLES&&H.length<2*Y.BATCHABLE_SIZE?this._renderToBatch(O):this._renderDefault(O)},Y.prototype._renderDefault=function(O){var H=this.shader;H.alpha=this.worldAlpha,H.update&&H.update(),O.batch.flush(),H.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),O.shader.bind(H),O.state.set(this.state),O.geometry.bind(this.geometry,H),O.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},Y.prototype._renderToBatch=function(O){var H=this.geometry,tt=this.shader;tt.uvMatrix&&(tt.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=H.indexBuffer.data,this._tintRGB=tt._tintRGB,this._texture=tt.texture;var G=this.material.pluginName;O.batch.setObjectRenderer(O.plugins[G]),O.plugins[G].render(this)},Y.prototype.calculateVertices=function(){var O=this.geometry.buffers[0],H=O.data,tt=O._updateID;if(tt!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==H.length&&(this.vertexData=new Float32Array(H.length));for(var G=this.transform.worldTransform,Ot=G.a,Vt=G.b,st=G.c,z=G.d,U=G.tx,ft=G.ty,$=this.vertexData,gt=0;gt<$.length/2;gt++){var Lt=H[2*gt],K=H[2*gt+1];$[2*gt]=Ot*Lt+st*K+U,$[2*gt+1]=Vt*Lt+z*K+ft}if(this._roundPixels){var dt=k.b.RESOLUTION;for(gt=0;gt<$.length;++gt)$[gt]=Math.round(($[gt]*dt|0)/dt)}this.vertexDirty=tt}},Y.prototype.calculateUvs=function(){var O=this.geometry.buffers[1],H=this.shader;H.uvMatrix.isSimple?this.uvs=O.data:(this.batchUvs||(this.batchUvs=new et(O,H.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},Y.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},Y.prototype.containsPoint=function(O){if(!this.getBounds().contains(O.x,O.y))return!1;this.worldTransform.applyInverse(O,pt);for(var H=this.geometry.getBuffer("aVertexPosition").data,tt=Dt.points,G=this.geometry.getIndex().data,Ot=G.length,Vt=this.drawMode===4?3:1,st=0;st+2<Ot;st+=Vt){var z=2*G[st],U=2*G[st+1],ft=2*G[st+2];if(tt[0]=H[z],tt[1]=H[z+1],tt[2]=H[U],tt[3]=H[U+1],tt[4]=H[ft],tt[5]=H[ft+1],Dt.contains(pt.x,pt.y))return!0}return!1},Y.prototype.destroy=function(O){F.prototype.destroy.call(this,O),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},Y.BATCHABLE_SIZE=100,Y}(D.b),L=function(F){function Y(O,H){var tt=this,G={uSampler:O,alpha:1,uTextureMatrix:M.d.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(H=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},H)).uniforms&&Object.assign(G,H.uniforms),(tt=F.call(this,H.program||P.n.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`),G)||this)._colorDirty=!1,tt.uvMatrix=new P.u(O),tt.batchable=H.program===void 0,tt.pluginName=H.pluginName,tt.tint=H.tint,tt.alpha=H.alpha,tt}return V(Y,F),Object.defineProperty(Y.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(O){this.uniforms.uSampler!==O&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!O.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=O,this.uvMatrix.texture=O)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"alpha",{get:function(){return this._alpha},set:function(O){O!==this._alpha&&(this._alpha=O,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"tint",{get:function(){return this._tint},set:function(O){O!==this._tint&&(this._tint=O,this._tintRGB=(O>>16)+(65280&O)+((255&O)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),Y.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var O=this.texture.baseTexture;Object(W.premultiplyTintToRgba)(this._tint,this._alpha,this.uniforms.uColor,O.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},Y}(P.r),R=function(F){function Y(O,H,tt){var G=F.call(this)||this,Ot=new P.h(O),Vt=new P.h(H,!0),st=new P.h(tt,!0,!0);return G.addAttribute("aVertexPosition",Ot,2,!1,I.r.FLOAT).addAttribute("aTextureCoord",Vt,2,!1,I.r.FLOAT).addIndex(st),G._updateId=-1,G}return V(Y,F),Object.defineProperty(Y.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),Y}(P.l)},function(b,A){b.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	filterCoord = aVertexPosition * outputFrame.zw;
}
`},function(b,A,v){v.d(A,"a",function(){return Dt}),v.d(A,"b",function(){return At});var P=v(2),M=v(3),I=v(1),D=v(0),k=v(4),W=function(R,F){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,O){Y.__proto__=O}||function(Y,O){for(var H in O)O.hasOwnProperty(H)&&(Y[H]=O[H])})(R,F)},X=function(){function R(F){this._foundShapes=[],this.renderer=F}return R.prototype.pushMask=function(F){var Y=this.renderer,O=F.maskObject||F;Y.context.save();var H=this._foundShapes;if(this.recursiveFindShapes(O,H),H.length>0){var tt=Y.context;tt.beginPath();for(var G=0;G<H.length;G++){var Ot=H[G],Vt=Ot.transform.worldTransform;this.renderer.setContextTransform(Vt),this.renderGraphicsShape(Ot)}H.length=0,tt.clip()}},R.prototype.recursiveFindShapes=function(F,Y){F.geometry&&F.geometry.graphicsData&&Y.push(F);var O=F.children;if(O)for(var H=0;H<O.length;H++)this.recursiveFindShapes(O[H],Y)},R.prototype.renderGraphicsShape=function(F){F.finishPoly();var Y=this.renderer.context,O=F.geometry.graphicsData,H=O.length;if(H!==0)for(var tt=0;tt<H;tt++){var G=O[tt],Ot=G.shape;if(Ot.type===I.l.POLY){var Vt=Ot.points,st=G.holes,z=void 0,U=void 0,ft=void 0,$=void 0;Y.moveTo(Vt[0],Vt[1]);for(var gt=1;gt<Vt.length/2;gt++)Y.lineTo(Vt[2*gt],Vt[2*gt+1]);if(st.length>0){for(z=0,ft=Vt[0],$=Vt[1],gt=2;gt+2<Vt.length;gt+=2)z+=(Vt[gt]-ft)*(Vt[gt+3]-$)-(Vt[gt+2]-ft)*(Vt[gt+1]-$);for(var Lt=0;Lt<st.length;Lt++)if(Vt=st[Lt].shape.points){for(U=0,ft=Vt[0],$=Vt[1],gt=2;gt+2<Vt.length;gt+=2)U+=(Vt[gt]-ft)*(Vt[gt+3]-$)-(Vt[gt+2]-ft)*(Vt[gt+1]-$);if(U*z<0)for(Y.moveTo(Vt[0],Vt[1]),gt=2;gt<Vt.length;gt+=2)Y.lineTo(Vt[gt],Vt[gt+1]);else for(Y.moveTo(Vt[Vt.length-2],Vt[Vt.length-1]),gt=Vt.length-4;gt>=0;gt-=2)Y.lineTo(Vt[gt],Vt[gt+1]);st[Lt].shape.closeStroke&&Y.closePath()}}Vt[0]===Vt[Vt.length-2]&&Vt[1]===Vt[Vt.length-1]&&Y.closePath()}else if(Ot.type===I.l.RECT)Y.rect(Ot.x,Ot.y,Ot.width,Ot.height),Y.closePath();else if(Ot.type===I.l.CIRC)Y.arc(Ot.x,Ot.y,Ot.radius,0,2*Math.PI),Y.closePath();else if(Ot.type===I.l.ELIP){var K=2*Ot.width,dt=2*Ot.height,it=Ot.x-K/2,_t=Ot.y-dt/2,St=K/2*.5522848,kt=dt/2*.5522848,Xt=it+K,Jt=_t+dt,at=it+K/2,_e=_t+dt/2;Y.moveTo(it,_e),Y.bezierCurveTo(it,_e-kt,at-St,_t,at,_t),Y.bezierCurveTo(at+St,_t,Xt,_e-kt,Xt,_e),Y.bezierCurveTo(Xt,_e+kt,at+St,Jt,at,Jt),Y.bezierCurveTo(at-St,Jt,it,_e+kt,it,_e),Y.closePath()}else if(Ot.type===I.l.RREC){var Ue=Ot.x,Oe=Ot.y,Ae=Ot.width,ze=Ot.height,$e=Ot.radius,cn=Math.min(Ae,ze)/2;$e=$e>cn?cn:$e,Y.moveTo(Ue,Oe+$e),Y.lineTo(Ue,Oe+ze-$e),Y.quadraticCurveTo(Ue,Oe+ze,Ue+$e,Oe+ze),Y.lineTo(Ue+Ae-$e,Oe+ze),Y.quadraticCurveTo(Ue+Ae,Oe+ze,Ue+Ae,Oe+ze-$e),Y.lineTo(Ue+Ae,Oe+$e),Y.quadraticCurveTo(Ue+Ae,Oe,Ue+Ae-$e,Oe),Y.lineTo(Ue+$e,Oe),Y.quadraticCurveTo(Ue,Oe,Ue,Oe+$e),Y.closePath()}}},R.prototype.popMask=function(F){F.context.restore(),F.invalidateBlendMode()},R.prototype.destroy=function(){},R}();function V(R){var F=document.createElement("canvas");F.width=6,F.height=1;var Y=F.getContext("2d");return Y.fillStyle=R,Y.fillRect(0,0,6,1),F}function et(){if(typeof document=="undefined")return!1;var R=V("#ff00ff"),F=V("#ffff00"),Y=document.createElement("canvas");Y.width=6,Y.height=1;var O=Y.getContext("2d");O.globalCompositeOperation="multiply",O.drawImage(R,0,0),O.drawImage(F,2,0);var H=O.getImageData(2,0,1,1);if(!H)return!1;var tt=H.data;return tt[0]===255&&tt[1]===0&&tt[2]===0}var pt=new I.d,Dt=function(R){function F(Y){var O,H=R.call(this,D.n.CANVAS,Y)||this;if(H.refresh=!0,H.maskManager=new X(H),H.smoothProperty="imageSmoothingEnabled",H.blendModes=(O===void 0&&(O=[]),et()?(O[D.b.NORMAL]="source-over",O[D.b.ADD]="lighter",O[D.b.MULTIPLY]="multiply",O[D.b.SCREEN]="screen",O[D.b.OVERLAY]="overlay",O[D.b.DARKEN]="darken",O[D.b.LIGHTEN]="lighten",O[D.b.COLOR_DODGE]="color-dodge",O[D.b.COLOR_BURN]="color-burn",O[D.b.HARD_LIGHT]="hard-light",O[D.b.SOFT_LIGHT]="soft-light",O[D.b.DIFFERENCE]="difference",O[D.b.EXCLUSION]="exclusion",O[D.b.HUE]="hue",O[D.b.SATURATION]="saturate",O[D.b.COLOR]="color",O[D.b.LUMINOSITY]="luminosity"):(O[D.b.NORMAL]="source-over",O[D.b.ADD]="lighter",O[D.b.MULTIPLY]="source-over",O[D.b.SCREEN]="source-over",O[D.b.OVERLAY]="source-over",O[D.b.DARKEN]="source-over",O[D.b.LIGHTEN]="source-over",O[D.b.COLOR_DODGE]="source-over",O[D.b.COLOR_BURN]="source-over",O[D.b.HARD_LIGHT]="source-over",O[D.b.SOFT_LIGHT]="source-over",O[D.b.DIFFERENCE]="source-over",O[D.b.EXCLUSION]="source-over",O[D.b.HUE]="source-over",O[D.b.SATURATION]="source-over",O[D.b.COLOR]="source-over",O[D.b.LUMINOSITY]="source-over"),O[D.b.NORMAL_NPM]=O[D.b.NORMAL],O[D.b.ADD_NPM]=O[D.b.ADD],O[D.b.SCREEN_NPM]=O[D.b.SCREEN],O[D.b.SRC_IN]="source-in",O[D.b.SRC_OUT]="source-out",O[D.b.SRC_ATOP]="source-atop",O[D.b.DST_OVER]="destination-over",O[D.b.DST_IN]="destination-in",O[D.b.DST_OUT]="destination-out",O[D.b.DST_ATOP]="destination-atop",O[D.b.XOR]="xor",O[D.b.SUBTRACT]="source-over",O),H.renderingToScreen=!1,H._activeBlendMode=null,H._projTransform=null,H._outerBlend=!1,H.rootContext=H.view.getContext("2d",{alpha:H.useContextAlpha}),H.context=H.rootContext,!H.rootContext.imageSmoothingEnabled){var tt=H.rootContext;tt.webkitImageSmoothingEnabled?H.smoothProperty="webkitImageSmoothingEnabled":tt.mozImageSmoothingEnabled?H.smoothProperty="mozImageSmoothingEnabled":tt.oImageSmoothingEnabled?H.smoothProperty="oImageSmoothingEnabled":tt.msImageSmoothingEnabled&&(H.smoothProperty="msImageSmoothingEnabled")}return H.initPlugins(F.__plugins),Object(M.sayHello)("Canvas"),H.resize(H.options.width,H.options.height),H}return function(Y,O){function H(){this.constructor=Y}W(Y,O),Y.prototype=O===null?Object.create(O):(H.prototype=O.prototype,new H)}(F,R),F.prototype.addSystem=function(){return this},F.prototype.render=function(Y,O){if(this.view){var H,tt,G,Ot;O&&(O instanceof P.p||O instanceof P.b?(Object(M.deprecation)("6.0.0","CanvasRenderer#render arguments changed, use options instead."),H=O,tt=arguments[2],G=arguments[3],Ot=arguments[4]):(H=O.renderTexture,tt=O.clear,G=O.transform,Ot=O.skipUpdateTransform)),this.renderingToScreen=!H,this.emit("prerender");var Vt=this.resolution;H?((H=H.castToBaseTexture())._canvasRenderTarget||(H._canvasRenderTarget=new M.CanvasRenderTarget(H.width,H.height,H.resolution),H.resource=new P.j(H._canvasRenderTarget.canvas),H.valid=!0),this.context=H._canvasRenderTarget.context,this.resolution=H._canvasRenderTarget.resolution):this.context=this.rootContext;var st=this.context;if(this._projTransform=G||null,H||(this._lastObjectRendered=Y),!Ot){var z=Y.enableTempParent();Y.updateTransform(),Y.disableTempParent(z)}if(st.save(),st.setTransform(1,0,0,1,0,0),st.globalAlpha=1,this._activeBlendMode=D.b.NORMAL,this._outerBlend=!1,st.globalCompositeOperation=this.blendModes[D.b.NORMAL],tt!==void 0?tt:this.clearBeforeRender)if(this.renderingToScreen)st.clearRect(0,0,this.width,this.height),this.backgroundAlpha>0&&(st.globalAlpha=this.useContextAlpha?this.backgroundAlpha:1,st.fillStyle=this._backgroundColorString,st.fillRect(0,0,this.width,this.height),st.globalAlpha=1);else{(H=H)._canvasRenderTarget.clear();var U=H.clearColor;U[3]>0&&(st.globalAlpha=this.useContextAlpha?U[3]:1,st.fillStyle=Object(M.hex2string)(Object(M.rgb2hex)(U)),st.fillRect(0,0,H.realWidth,H.realHeight),st.globalAlpha=1)}var ft=this.context;this.context=st,Y.renderCanvas(this),this.context=ft,st.restore(),this.resolution=Vt,this._projTransform=null,this.emit("postrender")}},F.prototype.setContextTransform=function(Y,O,H){var tt=Y,G=this._projTransform,Ot=this.resolution;H=H||Ot,G&&((tt=pt).copyFrom(Y),tt.prepend(G)),O?this.context.setTransform(tt.a*H,tt.b*H,tt.c*H,tt.d*H,tt.tx*Ot|0,tt.ty*Ot|0):this.context.setTransform(tt.a*H,tt.b*H,tt.c*H,tt.d*H,tt.tx*Ot,tt.ty*Ot)},F.prototype.clear=function(Y,O){Y===void 0&&(Y=this._backgroundColorString),O===void 0&&(O=this.backgroundAlpha);var H=this.context;H.clearRect(0,0,this.width,this.height),Y&&(H.globalAlpha=this.useContextAlpha?O:1,H.fillStyle=Y,H.fillRect(0,0,this.width,this.height),H.globalAlpha=1)},F.prototype.setBlendMode=function(Y,O){var H=Y===D.b.SRC_IN||Y===D.b.SRC_OUT||Y===D.b.DST_IN||Y===D.b.DST_ATOP;!O&&H&&(Y=D.b.NORMAL),this._activeBlendMode!==Y&&(this._activeBlendMode=Y,this._outerBlend=H,this.context.globalCompositeOperation=this.blendModes[Y])},F.prototype.destroy=function(Y){R.prototype.destroy.call(this,Y),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},F.prototype.resize=function(Y,O){R.prototype.resize.call(this,Y,O),this.smoothProperty&&(this.rootContext[this.smoothProperty]=k.b.SCALE_MODE===D.p.LINEAR)},F.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},F.registerPlugin=function(Y,O){F.__plugins=F.__plugins||{},F.__plugins[Y]=O},F}(P.a),At={canvas:null,getTintedCanvas:function(R,F){var Y=R.texture,O="#"+("00000"+(0|(F=At.roundColor(F))).toString(16)).slice(-6);Y.tintCache=Y.tintCache||{};var H,tt=Y.tintCache[O];if(tt){if(tt.tintId===Y._updateID)return Y.tintCache[O];H=Y.tintCache[O]}else H=document.createElement("canvas");if(At.tintMethod(Y,F,H),H.tintId=Y._updateID,At.convertTintToImage){var G=new Image;G.src=H.toDataURL(),Y.tintCache[O]=G}else Y.tintCache[O]=H;return H},getTintedPattern:function(R,F){var Y="#"+("00000"+(0|(F=At.roundColor(F))).toString(16)).slice(-6);R.patternCache=R.patternCache||{};var O=R.patternCache[Y];return O&&O.tintId===R._updateID||(At.canvas||(At.canvas=document.createElement("canvas")),At.tintMethod(R,F,At.canvas),(O=At.canvas.getContext("2d").createPattern(At.canvas,"repeat")).tintId=R._updateID,R.patternCache[Y]=O),O},tintWithMultiply:function(R,F,Y){var O=Y.getContext("2d"),H=R._frame.clone(),tt=R.baseTexture.resolution;H.x*=tt,H.y*=tt,H.width*=tt,H.height*=tt,Y.width=Math.ceil(H.width),Y.height=Math.ceil(H.height),O.save(),O.fillStyle="#"+("00000"+(0|F).toString(16)).slice(-6),O.fillRect(0,0,H.width,H.height),O.globalCompositeOperation="multiply";var G=R.baseTexture.getDrawableSource();O.drawImage(G,H.x,H.y,H.width,H.height,0,0,H.width,H.height),O.globalCompositeOperation="destination-atop",O.drawImage(G,H.x,H.y,H.width,H.height,0,0,H.width,H.height),O.restore()},tintWithOverlay:function(R,F,Y){var O=Y.getContext("2d"),H=R._frame.clone(),tt=R.baseTexture.resolution;H.x*=tt,H.y*=tt,H.width*=tt,H.height*=tt,Y.width=Math.ceil(H.width),Y.height=Math.ceil(H.height),O.save(),O.globalCompositeOperation="copy",O.fillStyle="#"+("00000"+(0|F).toString(16)).slice(-6),O.fillRect(0,0,H.width,H.height),O.globalCompositeOperation="destination-atop",O.drawImage(R.baseTexture.getDrawableSource(),H.x,H.y,H.width,H.height,0,0,H.width,H.height),O.restore()},tintWithPerPixel:function(R,F,Y){var O=Y.getContext("2d"),H=R._frame.clone(),tt=R.baseTexture.resolution;H.x*=tt,H.y*=tt,H.width*=tt,H.height*=tt,Y.width=Math.ceil(H.width),Y.height=Math.ceil(H.height),O.save(),O.globalCompositeOperation="copy",O.drawImage(R.baseTexture.getDrawableSource(),H.x,H.y,H.width,H.height,0,0,H.width,H.height),O.restore();for(var G=Object(M.hex2rgb)(F),Ot=G[0],Vt=G[1],st=G[2],z=O.getImageData(0,0,H.width,H.height),U=z.data,ft=0;ft<U.length;ft+=4)U[ft+0]*=Ot,U[ft+1]*=Vt,U[ft+2]*=st;O.putImageData(z,0,0)},roundColor:function(R){var F=At.cacheStepsPerColorChannel,Y=Object(M.hex2rgb)(R);return Y[0]=Math.min(255,Y[0]/F*F),Y[1]=Math.min(255,Y[1]/F*F),Y[2]=Math.min(255,Y[2]/F*F),Object(M.rgb2hex)(Y)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:et(),tintMethod:null};At.tintMethod=At.canUseMultiply?At.tintWithMultiply:At.tintWithPerPixel;var L=P.q.create;P.q.create=function(R){if(!(R&&R.forceCanvas))try{return L(R)}catch{}return new Dt(R)},P.c.prototype.getDrawableSource=function(){var R=this.resource;return R?R.bitmap||R.source:null},P.b.prototype._canvasRenderTarget=null,P.t.prototype.patternCache=null,P.t.prototype.tintCache=null},function(b,A){b.exports=function(v){return v===void 0}},function(b,A,v){v.d(A,"a",function(){return P});/*!
 * @pixi/runner - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var P=function(){function M(I){this.items=[],this._name=I,this._aliasCount=0}return M.prototype.emit=function(I,D,k,W,X,V,et,pt){if(arguments.length>8)throw new Error("max arguments reached");var Dt=this,At=Dt.name,L=Dt.items;this._aliasCount++;for(var R=0,F=L.length;R<F;R++)L[R][At](I,D,k,W,X,V,et,pt);return L===this.items&&this._aliasCount--,this},M.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},M.prototype.add=function(I){return I[this._name]&&(this.ensureNonAliasedItems(),this.remove(I),this.items.push(I)),this},M.prototype.remove=function(I){var D=this.items.indexOf(I);return D!==-1&&(this.ensureNonAliasedItems(),this.items.splice(D,1)),this},M.prototype.contains=function(I){return this.items.indexOf(I)!==-1},M.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},M.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(M.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),M}();Object.defineProperties(P.prototype,{dispatch:{value:P.prototype.emit},run:{value:P.prototype.emit}})},function(b,A,v){var P=v(20),M=v(15);b.exports=function(I){return typeof I=="number"||M(I)&&P(I)=="[object Number]"}},function(b,A,v){var P=v(51),M=typeof self=="object"&&self&&self.Object===Object&&self,I=P||M||Function("return this")();b.exports=I},function(b,A){b.exports=function(v){return v!=null&&typeof v=="object"}},function(b,A,v){v.d(A,"a",function(){return Dt}),v.d(A,"b",function(){return pt}),v.d(A,"c",function(){return V});var P=v(8),M=v(0),I=v(2),D=function(At,L){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,F){R.__proto__=F}||function(R,F){for(var Y in F)F.hasOwnProperty(Y)&&(R[Y]=F[Y])})(At,L)};function k(At,L){function R(){this.constructor=At}D(At,L),At.prototype=L===null?Object.create(L):(R.prototype=L.prototype,new R)}var W=function(At){function L(R,F,Y,O){R===void 0&&(R=100),F===void 0&&(F=100),Y===void 0&&(Y=10),O===void 0&&(O=10);var H=At.call(this)||this;return H.segWidth=Y,H.segHeight=O,H.width=R,H.height=F,H.build(),H}return k(L,At),L.prototype.build=function(){for(var R=this.segWidth*this.segHeight,F=[],Y=[],O=[],H=this.segWidth-1,tt=this.segHeight-1,G=this.width/H,Ot=this.height/tt,Vt=0;Vt<R;Vt++){var st=Vt%this.segWidth,z=Vt/this.segWidth|0;F.push(st*G,z*Ot),Y.push(st/H,z/tt)}var U=H*tt;for(Vt=0;Vt<U;Vt++){var ft=Vt%H,$=Vt/H|0,gt=$*this.segWidth+ft,Lt=$*this.segWidth+ft+1,K=($+1)*this.segWidth+ft,dt=($+1)*this.segWidth+ft+1;O.push(gt,Lt,K,Lt,dt,K)}this.buffers[0].data=new Float32Array(F),this.buffers[1].data=new Float32Array(Y),this.indexBuffer.data=new Uint16Array(O),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},L}(P.b),X=function(At){function L(R,F,Y){R===void 0&&(R=200),Y===void 0&&(Y=0);var O=At.call(this,new Float32Array(4*F.length),new Float32Array(4*F.length),new Uint16Array(6*(F.length-1)))||this;return O.points=F,O._width=R,O.textureScale=Y,O.build(),O}return k(L,At),Object.defineProperty(L.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),L.prototype.build=function(){var R=this.points;if(R){var F=this.getBuffer("aVertexPosition"),Y=this.getBuffer("aTextureCoord"),O=this.getIndex();if(!(R.length<1)){F.data.length/4!==R.length&&(F.data=new Float32Array(4*R.length),Y.data=new Float32Array(4*R.length),O.data=new Uint16Array(6*(R.length-1)));var H=Y.data,tt=O.data;H[0]=0,H[1]=0,H[2]=0,H[3]=1;for(var G=0,Ot=R[0],Vt=this._width*this.textureScale,st=R.length,z=0;z<st;z++){var U=4*z;if(this.textureScale>0){var ft=Ot.x-R[z].x,$=Ot.y-R[z].y,gt=Math.sqrt(ft*ft+$*$);Ot=R[z],G+=gt/Vt}else G=z/(st-1);H[U]=G,H[U+1]=0,H[U+2]=G,H[U+3]=1}var Lt=0;for(z=0;z<st-1;z++)U=2*z,tt[Lt++]=U,tt[Lt++]=U+1,tt[Lt++]=U+2,tt[Lt++]=U+2,tt[Lt++]=U+1,tt[Lt++]=U+3;Y.update(),O.update(),this.updateVertices()}}},L.prototype.updateVertices=function(){var R=this.points;if(!(R.length<1)){for(var F,Y=R[0],O=0,H=0,tt=this.buffers[0].data,G=R.length,Ot=0;Ot<G;Ot++){var Vt=R[Ot],st=4*Ot;H=-((F=Ot<R.length-1?R[Ot+1]:Vt).x-Y.x),O=F.y-Y.y;var z=Math.sqrt(O*O+H*H),U=this.textureScale>0?this.textureScale*this._width/2:this._width/2;O/=z,H/=z,O*=U,H*=U,tt[st]=Vt.x+O,tt[st+1]=Vt.y+H,tt[st+2]=Vt.x-O,tt[st+3]=Vt.y-H,Y=Vt}this.buffers[0].update()}},L.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},L}(P.b),V=function(At){function L(R,F,Y){Y===void 0&&(Y=0);var O=this,H=new X(R.height,F,Y),tt=new P.c(R);return Y>0&&(R.baseTexture.wrapMode=M.s.REPEAT),(O=At.call(this,H,tt)||this).autoUpdate=!0,O}return k(L,At),L.prototype._render=function(R){var F=this.geometry;(this.autoUpdate||F._width!==this.shader.texture.height)&&(F._width=this.shader.texture.height,F.update()),At.prototype._render.call(this,R)},L}(P.a),et=function(At){function L(R,F,Y){var O=this,H=new W(R.width,R.height,F,Y),tt=new P.c(I.t.WHITE);return(O=At.call(this,H,tt)||this).texture=R,O.autoResize=!0,O}return k(L,At),L.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var R=this.geometry,F=this.shader.texture,Y=F.width,O=F.height;!this.autoResize||R.width===Y&&R.height===O||(R.width=this.shader.texture.width,R.height=this.shader.texture.height,R.build())},Object.defineProperty(L.prototype,"texture",{get:function(){return this.shader.texture},set:function(R){this.shader.texture!==R&&(this.shader.texture=R,this._textureID=-1,R.baseTexture.valid?this.textureUpdated():R.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),L.prototype._render=function(R){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),At.prototype._render.call(this,R)},L.prototype.destroy=function(R){this.shader.texture.off("update",this.textureUpdated,this),At.prototype.destroy.call(this,R)},L}(P.a),pt=function(At){function L(R,F,Y,O,H){R===void 0&&(R=I.t.EMPTY);var tt=this,G=new P.b(F,Y,O);G.getBuffer("aVertexPosition").static=!1;var Ot=new P.c(R);return(tt=At.call(this,G,Ot,null,H)||this).autoUpdate=!0,tt}return k(L,At),Object.defineProperty(L.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(R){this.geometry.getBuffer("aVertexPosition").data=R},enumerable:!1,configurable:!0}),L.prototype._render=function(R){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),At.prototype._render.call(this,R)},L}(P.a),Dt=function(At){function L(R,F,Y,O,H){F===void 0&&(F=10),Y===void 0&&(Y=10),O===void 0&&(O=10),H===void 0&&(H=10);var tt=At.call(this,I.t.WHITE,4,4)||this;return tt._origWidth=R.orig.width,tt._origHeight=R.orig.height,tt._width=tt._origWidth,tt._height=tt._origHeight,tt._leftWidth=F,tt._rightWidth=O,tt._topHeight=Y,tt._bottomHeight=H,tt.texture=R,tt}return k(L,At),L.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(L.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(R){this.geometry.getBuffer("aVertexPosition").data=R},enumerable:!1,configurable:!0}),L.prototype.updateHorizontalVertices=function(){var R=this.vertices,F=this._getMinScale();R[9]=R[11]=R[13]=R[15]=this._topHeight*F,R[17]=R[19]=R[21]=R[23]=this._height-this._bottomHeight*F,R[25]=R[27]=R[29]=R[31]=this._height},L.prototype.updateVerticalVertices=function(){var R=this.vertices,F=this._getMinScale();R[2]=R[10]=R[18]=R[26]=this._leftWidth*F,R[4]=R[12]=R[20]=R[28]=this._width-this._rightWidth*F,R[6]=R[14]=R[22]=R[30]=this._width},L.prototype._getMinScale=function(){var R=this._leftWidth+this._rightWidth,F=this._width>R?1:this._width/R,Y=this._topHeight+this._bottomHeight,O=this._height>Y?1:this._height/Y;return Math.min(F,O)},Object.defineProperty(L.prototype,"width",{get:function(){return this._width},set:function(R){this._width=R,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"height",{get:function(){return this._height},set:function(R){this._height=R,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(R){this._leftWidth=R,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(R){this._rightWidth=R,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"topHeight",{get:function(){return this._topHeight},set:function(R){this._topHeight=R,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(R){this._bottomHeight=R,this._refresh()},enumerable:!1,configurable:!0}),L.prototype._refresh=function(){var R=this.texture,F=this.geometry.buffers[1].data;this._origWidth=R.orig.width,this._origHeight=R.orig.height;var Y=1/this._origWidth,O=1/this._origHeight;F[0]=F[8]=F[16]=F[24]=0,F[1]=F[3]=F[5]=F[7]=0,F[6]=F[14]=F[22]=F[30]=1,F[25]=F[27]=F[29]=F[31]=1,F[2]=F[10]=F[18]=F[26]=Y*this._leftWidth,F[4]=F[12]=F[20]=F[28]=1-Y*this._rightWidth,F[9]=F[11]=F[13]=F[15]=O*this._topHeight,F[17]=F[19]=F[21]=F[23]=1-O*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},L}(et)},function(b,A){var v;v=function(){return this}();try{v=v||new Function("return this")()}catch{typeof window=="object"&&(v=window)}b.exports=v},function(b,A,v){var P;(function(M){function I(O,H){var tt=(65535&O)+(65535&H);return(O>>16)+(H>>16)+(tt>>16)<<16|65535&tt}function D(O,H,tt,G,Ot,Vt){return I((st=I(I(H,O),I(G,Vt)))<<(z=Ot)|st>>>32-z,tt);var st,z}function k(O,H,tt,G,Ot,Vt,st){return D(H&tt|~H&G,O,H,Ot,Vt,st)}function W(O,H,tt,G,Ot,Vt,st){return D(H&G|tt&~G,O,H,Ot,Vt,st)}function X(O,H,tt,G,Ot,Vt,st){return D(H^tt^G,O,H,Ot,Vt,st)}function V(O,H,tt,G,Ot,Vt,st){return D(tt^(H|~G),O,H,Ot,Vt,st)}function et(O,H){var tt,G,Ot,Vt,st;O[H>>5]|=128<<H%32,O[14+(H+64>>>9<<4)]=H;var z=1732584193,U=-271733879,ft=-1732584194,$=271733878;for(tt=0;tt<O.length;tt+=16)G=z,Ot=U,Vt=ft,st=$,z=k(z,U,ft,$,O[tt],7,-680876936),$=k($,z,U,ft,O[tt+1],12,-389564586),ft=k(ft,$,z,U,O[tt+2],17,606105819),U=k(U,ft,$,z,O[tt+3],22,-1044525330),z=k(z,U,ft,$,O[tt+4],7,-176418897),$=k($,z,U,ft,O[tt+5],12,1200080426),ft=k(ft,$,z,U,O[tt+6],17,-1473231341),U=k(U,ft,$,z,O[tt+7],22,-45705983),z=k(z,U,ft,$,O[tt+8],7,1770035416),$=k($,z,U,ft,O[tt+9],12,-1958414417),ft=k(ft,$,z,U,O[tt+10],17,-42063),U=k(U,ft,$,z,O[tt+11],22,-1990404162),z=k(z,U,ft,$,O[tt+12],7,1804603682),$=k($,z,U,ft,O[tt+13],12,-40341101),ft=k(ft,$,z,U,O[tt+14],17,-1502002290),z=W(z,U=k(U,ft,$,z,O[tt+15],22,1236535329),ft,$,O[tt+1],5,-165796510),$=W($,z,U,ft,O[tt+6],9,-1069501632),ft=W(ft,$,z,U,O[tt+11],14,643717713),U=W(U,ft,$,z,O[tt],20,-373897302),z=W(z,U,ft,$,O[tt+5],5,-701558691),$=W($,z,U,ft,O[tt+10],9,38016083),ft=W(ft,$,z,U,O[tt+15],14,-660478335),U=W(U,ft,$,z,O[tt+4],20,-405537848),z=W(z,U,ft,$,O[tt+9],5,568446438),$=W($,z,U,ft,O[tt+14],9,-1019803690),ft=W(ft,$,z,U,O[tt+3],14,-187363961),U=W(U,ft,$,z,O[tt+8],20,1163531501),z=W(z,U,ft,$,O[tt+13],5,-1444681467),$=W($,z,U,ft,O[tt+2],9,-51403784),ft=W(ft,$,z,U,O[tt+7],14,1735328473),z=X(z,U=W(U,ft,$,z,O[tt+12],20,-1926607734),ft,$,O[tt+5],4,-378558),$=X($,z,U,ft,O[tt+8],11,-2022574463),ft=X(ft,$,z,U,O[tt+11],16,1839030562),U=X(U,ft,$,z,O[tt+14],23,-35309556),z=X(z,U,ft,$,O[tt+1],4,-1530992060),$=X($,z,U,ft,O[tt+4],11,1272893353),ft=X(ft,$,z,U,O[tt+7],16,-155497632),U=X(U,ft,$,z,O[tt+10],23,-1094730640),z=X(z,U,ft,$,O[tt+13],4,681279174),$=X($,z,U,ft,O[tt],11,-358537222),ft=X(ft,$,z,U,O[tt+3],16,-722521979),U=X(U,ft,$,z,O[tt+6],23,76029189),z=X(z,U,ft,$,O[tt+9],4,-640364487),$=X($,z,U,ft,O[tt+12],11,-421815835),ft=X(ft,$,z,U,O[tt+15],16,530742520),z=V(z,U=X(U,ft,$,z,O[tt+2],23,-995338651),ft,$,O[tt],6,-198630844),$=V($,z,U,ft,O[tt+7],10,1126891415),ft=V(ft,$,z,U,O[tt+14],15,-1416354905),U=V(U,ft,$,z,O[tt+5],21,-57434055),z=V(z,U,ft,$,O[tt+12],6,1700485571),$=V($,z,U,ft,O[tt+3],10,-1894986606),ft=V(ft,$,z,U,O[tt+10],15,-1051523),U=V(U,ft,$,z,O[tt+1],21,-2054922799),z=V(z,U,ft,$,O[tt+8],6,1873313359),$=V($,z,U,ft,O[tt+15],10,-30611744),ft=V(ft,$,z,U,O[tt+6],15,-1560198380),U=V(U,ft,$,z,O[tt+13],21,1309151649),z=V(z,U,ft,$,O[tt+4],6,-145523070),$=V($,z,U,ft,O[tt+11],10,-1120210379),ft=V(ft,$,z,U,O[tt+2],15,718787259),U=V(U,ft,$,z,O[tt+9],21,-343485551),z=I(z,G),U=I(U,Ot),ft=I(ft,Vt),$=I($,st);return[z,U,ft,$]}function pt(O){var H,tt="",G=32*O.length;for(H=0;H<G;H+=8)tt+=String.fromCharCode(O[H>>5]>>>H%32&255);return tt}function Dt(O){var H,tt=[];for(tt[(O.length>>2)-1]=void 0,H=0;H<tt.length;H+=1)tt[H]=0;var G=8*O.length;for(H=0;H<G;H+=8)tt[H>>5]|=(255&O.charCodeAt(H/8))<<H%32;return tt}function At(O){var H,tt,G="";for(tt=0;tt<O.length;tt+=1)H=O.charCodeAt(tt),G+="0123456789abcdef".charAt(H>>>4&15)+"0123456789abcdef".charAt(15&H);return G}function L(O){return unescape(encodeURIComponent(O))}function R(O){return function(H){return pt(et(Dt(H),8*H.length))}(L(O))}function F(O,H){return function(tt,G){var Ot,Vt,st=Dt(tt),z=[],U=[];for(z[15]=U[15]=void 0,st.length>16&&(st=et(st,8*tt.length)),Ot=0;Ot<16;Ot+=1)z[Ot]=909522486^st[Ot],U[Ot]=1549556828^st[Ot];return Vt=et(z.concat(Dt(G)),512+8*G.length),pt(et(U.concat(Vt),640))}(L(O),L(H))}function Y(O,H,tt){return H?tt?F(H,O):At(F(H,O)):tt?R(O):At(R(O))}(P=function(){return Y}.call(A,v,A,b))===void 0||(b.exports=P)})()},function(b,A){b.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	filterCoord = aVertexPosition * outputFrame.zw;
}
`},function(b,A,v){var P=v(24),M=v(137),I=v(138),D=P?P.toStringTag:void 0;b.exports=function(k){return k==null?k===void 0?"[object Undefined]":"[object Null]":D&&D in Object(k)?M(k):I(k)}},function(b,A){b.exports=function(v){var P=typeof v;return v!=null&&(P=="object"||P=="function")}},function(b,A,v){var P=v(162),M=v(165);b.exports=function(I,D){var k=M(I,D);return P(k)?k:void 0}},function(b,A,v){(function(P){b.exports=function M(I,D,k){function W(et,pt){if(!D[et]){if(!I[et]){if(X)return X(et,!0);var Dt=new Error("Cannot find module '"+et+"'");throw Dt.code="MODULE_NOT_FOUND",Dt}var At=D[et]={exports:{}};I[et][0].call(At.exports,function(L){var R=I[et][1][L];return W(R||L)},At,At.exports,M,I,D,k)}return D[et].exports}for(var X=!1,V=0;V<k.length;V++)W(k[V]);return W}({1:[function(M,I,D){(function(k){var W,X,V=k.MutationObserver||k.WebKitMutationObserver;if(V){var et=0,pt=new V(R),Dt=k.document.createTextNode("");pt.observe(Dt,{characterData:!0}),W=function(){Dt.data=et=++et%2}}else if(k.setImmediate||k.MessageChannel===void 0)W="document"in k&&"onreadystatechange"in k.document.createElement("script")?function(){var F=k.document.createElement("script");F.onreadystatechange=function(){R(),F.onreadystatechange=null,F.parentNode.removeChild(F),F=null},k.document.documentElement.appendChild(F)}:function(){setTimeout(R,0)};else{var At=new k.MessageChannel;At.port1.onmessage=R,W=function(){At.port2.postMessage(0)}}var L=[];function R(){var F,Y;X=!0;for(var O=L.length;O;){for(Y=L,L=[],F=-1;++F<O;)Y[F]();O=L.length}X=!1}I.exports=function(F){L.push(F)!==1||X||W()}}).call(this,P!==void 0?P:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(M,I,D){var k=M(1);function W(){}var X={},V=["REJECTED"],et=["FULFILLED"],pt=["PENDING"];function Dt(O){if(typeof O!="function")throw new TypeError("resolver must be a function");this.state=pt,this.queue=[],this.outcome=void 0,O!==W&&F(this,O)}function At(O,H,tt){this.promise=O,typeof H=="function"&&(this.onFulfilled=H,this.callFulfilled=this.otherCallFulfilled),typeof tt=="function"&&(this.onRejected=tt,this.callRejected=this.otherCallRejected)}function L(O,H,tt){k(function(){var G;try{G=H(tt)}catch(Ot){return X.reject(O,Ot)}G===O?X.reject(O,new TypeError("Cannot resolve promise with itself")):X.resolve(O,G)})}function R(O){var H=O&&O.then;if(O&&(typeof O=="object"||typeof O=="function")&&typeof H=="function")return function(){H.apply(O,arguments)}}function F(O,H){var tt=!1;function G(st){tt||(tt=!0,X.reject(O,st))}function Ot(st){tt||(tt=!0,X.resolve(O,st))}var Vt=Y(function(){H(Ot,G)});Vt.status==="error"&&G(Vt.value)}function Y(O,H){var tt={};try{tt.value=O(H),tt.status="success"}catch(G){tt.status="error",tt.value=G}return tt}I.exports=Dt,Dt.prototype.catch=function(O){return this.then(null,O)},Dt.prototype.then=function(O,H){if(typeof O!="function"&&this.state===et||typeof H!="function"&&this.state===V)return this;var tt=new this.constructor(W);return this.state!==pt?L(tt,this.state===et?O:H,this.outcome):this.queue.push(new At(tt,O,H)),tt},At.prototype.callFulfilled=function(O){X.resolve(this.promise,O)},At.prototype.otherCallFulfilled=function(O){L(this.promise,this.onFulfilled,O)},At.prototype.callRejected=function(O){X.reject(this.promise,O)},At.prototype.otherCallRejected=function(O){L(this.promise,this.onRejected,O)},X.resolve=function(O,H){var tt=Y(R,H);if(tt.status==="error")return X.reject(O,tt.value);var G=tt.value;if(G)F(O,G);else{O.state=et,O.outcome=H;for(var Ot=-1,Vt=O.queue.length;++Ot<Vt;)O.queue[Ot].callFulfilled(H)}return O},X.reject=function(O,H){O.state=V,O.outcome=H;for(var tt=-1,G=O.queue.length;++tt<G;)O.queue[tt].callRejected(H);return O},Dt.resolve=function(O){return O instanceof this?O:X.resolve(new this(W),O)},Dt.reject=function(O){var H=new this(W);return X.reject(H,O)},Dt.all=function(O){var H=this;if(Object.prototype.toString.call(O)!=="[object Array]")return this.reject(new TypeError("must be an array"));var tt=O.length,G=!1;if(!tt)return this.resolve([]);for(var Ot=new Array(tt),Vt=0,st=-1,z=new this(W);++st<tt;)U(O[st],st);return z;function U(ft,$){H.resolve(ft).then(function(gt){Ot[$]=gt,++Vt!==tt||G||(G=!0,X.resolve(z,Ot))},function(gt){G||(G=!0,X.reject(z,gt))})}},Dt.race=function(O){var H=this;if(Object.prototype.toString.call(O)!=="[object Array]")return this.reject(new TypeError("must be an array"));var tt=O.length,G=!1;if(!tt)return this.resolve([]);for(var Ot,Vt=-1,st=new this(W);++Vt<tt;)Ot=O[Vt],H.resolve(Ot).then(function(z){G||(G=!0,X.resolve(st,z))},function(z){G||(G=!0,X.reject(st,z))});return st}},{1:1}],3:[function(M,I,D){(function(k){typeof k.Promise!="function"&&(k.Promise=M(2))}).call(this,P!==void 0?P:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(M,I,D){var k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(yt){return typeof yt}:function(yt){return yt&&typeof Symbol=="function"&&yt.constructor===Symbol&&yt!==Symbol.prototype?"symbol":typeof yt},W=function(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch{return}}();function X(yt,Et){yt=yt||[],Et=Et||{};try{return new Blob(yt,Et)}catch(Wt){if(Wt.name!=="TypeError")throw Wt;for(var Rt=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder),Qt=0;Qt<yt.length;Qt+=1)Rt.append(yt[Qt]);return Rt.getBlob(Et.type)}}typeof Promise=="undefined"&&M(3);var V=Promise;function et(yt,Et){Et&&yt.then(function(Rt){Et(null,Rt)},function(Rt){Et(Rt)})}function pt(yt,Et,Rt){typeof Et=="function"&&yt.then(Et),typeof Rt=="function"&&yt.catch(Rt)}function Dt(yt){return typeof yt!="string"&&(console.warn(yt+" used as a key, but it is not a string."),yt=String(yt)),yt}function At(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var L=void 0,R={},F=Object.prototype.toString;function Y(yt){return typeof L=="boolean"?V.resolve(L):function(Et){return new V(function(Rt){var Qt=Et.transaction("local-forage-detect-blob-support","readwrite"),Wt=X([""]);Qt.objectStore("local-forage-detect-blob-support").put(Wt,"key"),Qt.onabort=function(Kt){Kt.preventDefault(),Kt.stopPropagation(),Rt(!1)},Qt.oncomplete=function(){var Kt=navigator.userAgent.match(/Chrome\/(\d+)/),oe=navigator.userAgent.match(/Edge\//);Rt(oe||!Kt||parseInt(Kt[1],10)>=43)}}).catch(function(){return!1})}(yt).then(function(Et){return L=Et})}function O(yt){var Et=R[yt.name],Rt={};Rt.promise=new V(function(Qt,Wt){Rt.resolve=Qt,Rt.reject=Wt}),Et.deferredOperations.push(Rt),Et.dbReady?Et.dbReady=Et.dbReady.then(function(){return Rt.promise}):Et.dbReady=Rt.promise}function H(yt){var Et=R[yt.name].deferredOperations.pop();if(Et)return Et.resolve(),Et.promise}function tt(yt,Et){var Rt=R[yt.name].deferredOperations.pop();if(Rt)return Rt.reject(Et),Rt.promise}function G(yt,Et){return new V(function(Rt,Qt){if(R[yt.name]=R[yt.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},yt.db){if(!Et)return Rt(yt.db);O(yt),yt.db.close()}var Wt=[yt.name];Et&&Wt.push(yt.version);var Kt=W.open.apply(W,Wt);Et&&(Kt.onupgradeneeded=function(oe){var Me=Kt.result;try{Me.createObjectStore(yt.storeName),oe.oldVersion<=1&&Me.createObjectStore("local-forage-detect-blob-support")}catch(we){if(we.name!=="ConstraintError")throw we;console.warn('The database "'+yt.name+'" has been upgraded from version '+oe.oldVersion+" to version "+oe.newVersion+', but the storage "'+yt.storeName+'" already exists.')}}),Kt.onerror=function(oe){oe.preventDefault(),Qt(Kt.error)},Kt.onsuccess=function(){var oe=Kt.result;oe.onversionchange=function(Me){Me.target.close()},Rt(oe),H(yt)}})}function Ot(yt){return G(yt,!1)}function Vt(yt){return G(yt,!0)}function st(yt,Et){if(!yt.db)return!0;var Rt=!yt.db.objectStoreNames.contains(yt.storeName),Qt=yt.version<yt.db.version,Wt=yt.version>yt.db.version;if(Qt&&(yt.version!==Et&&console.warn('The database "'+yt.name+`" can't be downgraded from version `+yt.db.version+" to version "+yt.version+"."),yt.version=yt.db.version),Wt||Rt){if(Rt){var Kt=yt.db.version+1;Kt>yt.version&&(yt.version=Kt)}return!0}return!1}function z(yt){return X([function(Et){for(var Rt=Et.length,Qt=new ArrayBuffer(Rt),Wt=new Uint8Array(Qt),Kt=0;Kt<Rt;Kt++)Wt[Kt]=Et.charCodeAt(Kt);return Qt}(atob(yt.data))],{type:yt.type})}function U(yt){return yt&&yt.__local_forage_encoded_blob}function ft(yt){var Et=this,Rt=Et._initReady().then(function(){var Qt=R[Et._dbInfo.name];if(Qt&&Qt.dbReady)return Qt.dbReady});return pt(Rt,yt,yt),Rt}function $(yt,Et,Rt,Qt){Qt===void 0&&(Qt=1);try{var Wt=yt.db.transaction(yt.storeName,Et);Rt(null,Wt)}catch(Kt){if(Qt>0&&(!yt.db||Kt.name==="InvalidStateError"||Kt.name==="NotFoundError"))return V.resolve().then(function(){if(!yt.db||Kt.name==="NotFoundError"&&!yt.db.objectStoreNames.contains(yt.storeName)&&yt.version<=yt.db.version)return yt.db&&(yt.version=yt.db.version+1),Vt(yt)}).then(function(){return function(oe){O(oe);for(var Me=R[oe.name],we=Me.forages,Se=0;Se<we.length;Se++){var Ve=we[Se];Ve._dbInfo.db&&(Ve._dbInfo.db.close(),Ve._dbInfo.db=null)}return oe.db=null,Ot(oe).then(function(en){return oe.db=en,st(oe)?Vt(oe):en}).then(function(en){oe.db=Me.db=en;for(var dn=0;dn<we.length;dn++)we[dn]._dbInfo.db=en}).catch(function(en){throw tt(oe,en),en})}(yt).then(function(){$(yt,Et,Rt,Qt-1)})}).catch(Rt);Rt(Kt)}}var gt={_driver:"asyncStorage",_initStorage:function(yt){var Et=this,Rt={db:null};if(yt)for(var Qt in yt)Rt[Qt]=yt[Qt];var Wt=R[Rt.name];Wt||(Wt={forages:[],db:null,dbReady:null,deferredOperations:[]},R[Rt.name]=Wt),Wt.forages.push(Et),Et._initReady||(Et._initReady=Et.ready,Et.ready=ft);var Kt=[];function oe(){return V.resolve()}for(var Me=0;Me<Wt.forages.length;Me++){var we=Wt.forages[Me];we!==Et&&Kt.push(we._initReady().catch(oe))}var Se=Wt.forages.slice(0);return V.all(Kt).then(function(){return Rt.db=Wt.db,Ot(Rt)}).then(function(Ve){return Rt.db=Ve,st(Rt,Et._defaultConfig.version)?Vt(Rt):Ve}).then(function(Ve){Rt.db=Wt.db=Ve,Et._dbInfo=Rt;for(var en=0;en<Se.length;en++){var dn=Se[en];dn!==Et&&(dn._dbInfo.db=Rt.db,dn._dbInfo.version=Rt.version)}})},_support:function(){try{if(!W||!W.open)return!1;var yt=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Et=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!yt||Et)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch{return!1}}(),iterate:function(yt,Et){var Rt=this,Qt=new V(function(Wt,Kt){Rt.ready().then(function(){$(Rt._dbInfo,"readonly",function(oe,Me){if(oe)return Kt(oe);try{var we=Me.objectStore(Rt._dbInfo.storeName).openCursor(),Se=1;we.onsuccess=function(){var Ve=we.result;if(Ve){var en=Ve.value;U(en)&&(en=z(en));var dn=yt(en,Ve.key,Se++);dn!==void 0?Wt(dn):Ve.continue()}else Wt()},we.onerror=function(){Kt(we.error)}}catch(Ve){Kt(Ve)}})}).catch(Kt)});return et(Qt,Et),Qt},getItem:function(yt,Et){var Rt=this;yt=Dt(yt);var Qt=new V(function(Wt,Kt){Rt.ready().then(function(){$(Rt._dbInfo,"readonly",function(oe,Me){if(oe)return Kt(oe);try{var we=Me.objectStore(Rt._dbInfo.storeName).get(yt);we.onsuccess=function(){var Se=we.result;Se===void 0&&(Se=null),U(Se)&&(Se=z(Se)),Wt(Se)},we.onerror=function(){Kt(we.error)}}catch(Se){Kt(Se)}})}).catch(Kt)});return et(Qt,Et),Qt},setItem:function(yt,Et,Rt){var Qt=this;yt=Dt(yt);var Wt=new V(function(Kt,oe){var Me;Qt.ready().then(function(){return Me=Qt._dbInfo,F.call(Et)==="[object Blob]"?Y(Me.db).then(function(we){return we?Et:(Se=Et,new V(function(Ve,en){var dn=new FileReader;dn.onerror=en,dn.onloadend=function(Tn){var yn=btoa(Tn.target.result||"");Ve({__local_forage_encoded_blob:!0,data:yn,type:Se.type})},dn.readAsBinaryString(Se)}));var Se}):Et}).then(function(we){$(Qt._dbInfo,"readwrite",function(Se,Ve){if(Se)return oe(Se);try{var en=Ve.objectStore(Qt._dbInfo.storeName);we===null&&(we=void 0);var dn=en.put(we,yt);Ve.oncomplete=function(){we===void 0&&(we=null),Kt(we)},Ve.onabort=Ve.onerror=function(){var Tn=dn.error?dn.error:dn.transaction.error;oe(Tn)}}catch(Tn){oe(Tn)}})}).catch(oe)});return et(Wt,Rt),Wt},removeItem:function(yt,Et){var Rt=this;yt=Dt(yt);var Qt=new V(function(Wt,Kt){Rt.ready().then(function(){$(Rt._dbInfo,"readwrite",function(oe,Me){if(oe)return Kt(oe);try{var we=Me.objectStore(Rt._dbInfo.storeName).delete(yt);Me.oncomplete=function(){Wt()},Me.onerror=function(){Kt(we.error)},Me.onabort=function(){var Se=we.error?we.error:we.transaction.error;Kt(Se)}}catch(Se){Kt(Se)}})}).catch(Kt)});return et(Qt,Et),Qt},clear:function(yt){var Et=this,Rt=new V(function(Qt,Wt){Et.ready().then(function(){$(Et._dbInfo,"readwrite",function(Kt,oe){if(Kt)return Wt(Kt);try{var Me=oe.objectStore(Et._dbInfo.storeName).clear();oe.oncomplete=function(){Qt()},oe.onabort=oe.onerror=function(){var we=Me.error?Me.error:Me.transaction.error;Wt(we)}}catch(we){Wt(we)}})}).catch(Wt)});return et(Rt,yt),Rt},length:function(yt){var Et=this,Rt=new V(function(Qt,Wt){Et.ready().then(function(){$(Et._dbInfo,"readonly",function(Kt,oe){if(Kt)return Wt(Kt);try{var Me=oe.objectStore(Et._dbInfo.storeName).count();Me.onsuccess=function(){Qt(Me.result)},Me.onerror=function(){Wt(Me.error)}}catch(we){Wt(we)}})}).catch(Wt)});return et(Rt,yt),Rt},key:function(yt,Et){var Rt=this,Qt=new V(function(Wt,Kt){yt<0?Wt(null):Rt.ready().then(function(){$(Rt._dbInfo,"readonly",function(oe,Me){if(oe)return Kt(oe);try{var we=Me.objectStore(Rt._dbInfo.storeName),Se=!1,Ve=we.openKeyCursor();Ve.onsuccess=function(){var en=Ve.result;en?yt===0||Se?Wt(en.key):(Se=!0,en.advance(yt)):Wt(null)},Ve.onerror=function(){Kt(Ve.error)}}catch(en){Kt(en)}})}).catch(Kt)});return et(Qt,Et),Qt},keys:function(yt){var Et=this,Rt=new V(function(Qt,Wt){Et.ready().then(function(){$(Et._dbInfo,"readonly",function(Kt,oe){if(Kt)return Wt(Kt);try{var Me=oe.objectStore(Et._dbInfo.storeName).openKeyCursor(),we=[];Me.onsuccess=function(){var Se=Me.result;Se?(we.push(Se.key),Se.continue()):Qt(we)},Me.onerror=function(){Wt(Me.error)}}catch(Se){Wt(Se)}})}).catch(Wt)});return et(Rt,yt),Rt},dropInstance:function(yt,Et){Et=At.apply(this,arguments);var Rt=this.config();(yt=typeof yt!="function"&&yt||{}).name||(yt.name=yt.name||Rt.name,yt.storeName=yt.storeName||Rt.storeName);var Qt,Wt=this;if(yt.name){var Kt=yt.name===Rt.name&&Wt._dbInfo.db,oe=Kt?V.resolve(Wt._dbInfo.db):Ot(yt).then(function(Me){var we=R[yt.name],Se=we.forages;we.db=Me;for(var Ve=0;Ve<Se.length;Ve++)Se[Ve]._dbInfo.db=Me;return Me});Qt=yt.storeName?oe.then(function(Me){if(Me.objectStoreNames.contains(yt.storeName)){var we=Me.version+1;O(yt);var Se=R[yt.name],Ve=Se.forages;Me.close();for(var en=0;en<Ve.length;en++){var dn=Ve[en];dn._dbInfo.db=null,dn._dbInfo.version=we}return new V(function(Tn,yn){var Yn=W.open(yt.name,we);Yn.onerror=function(Pn){Yn.result.close(),yn(Pn)},Yn.onupgradeneeded=function(){Yn.result.deleteObjectStore(yt.storeName)},Yn.onsuccess=function(){var Pn=Yn.result;Pn.close(),Tn(Pn)}}).then(function(Tn){Se.db=Tn;for(var yn=0;yn<Ve.length;yn++){var Yn=Ve[yn];Yn._dbInfo.db=Tn,H(Yn._dbInfo)}}).catch(function(Tn){throw(tt(yt,Tn)||V.resolve()).catch(function(){}),Tn})}}):oe.then(function(Me){O(yt);var we=R[yt.name],Se=we.forages;Me.close();for(var Ve=0;Ve<Se.length;Ve++)Se[Ve]._dbInfo.db=null;return new V(function(en,dn){var Tn=W.deleteDatabase(yt.name);Tn.onerror=function(){var yn=Tn.result;yn&&yn.close(),dn(Tn.error)},Tn.onblocked=function(){console.warn('dropInstance blocked for database "'+yt.name+'" until all open connections are closed')},Tn.onsuccess=function(){var yn=Tn.result;yn&&yn.close(),en(yn)}}).then(function(en){we.db=en;for(var dn=0;dn<Se.length;dn++)H(Se[dn]._dbInfo)}).catch(function(en){throw(tt(yt,en)||V.resolve()).catch(function(){}),en})})}else Qt=V.reject("Invalid arguments");return et(Qt,Et),Qt}},Lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K=/^~~local_forage_type~([^~]+)~/,dt=9,it=dt+4,_t=Object.prototype.toString;function St(yt){var Et,Rt,Qt,Wt,Kt,oe=.75*yt.length,Me=yt.length,we=0;yt[yt.length-1]==="="&&(oe--,yt[yt.length-2]==="="&&oe--);var Se=new ArrayBuffer(oe),Ve=new Uint8Array(Se);for(Et=0;Et<Me;Et+=4)Rt=Lt.indexOf(yt[Et]),Qt=Lt.indexOf(yt[Et+1]),Wt=Lt.indexOf(yt[Et+2]),Kt=Lt.indexOf(yt[Et+3]),Ve[we++]=Rt<<2|Qt>>4,Ve[we++]=(15&Qt)<<4|Wt>>2,Ve[we++]=(3&Wt)<<6|63&Kt;return Se}function kt(yt){var Et,Rt=new Uint8Array(yt),Qt="";for(Et=0;Et<Rt.length;Et+=3)Qt+=Lt[Rt[Et]>>2],Qt+=Lt[(3&Rt[Et])<<4|Rt[Et+1]>>4],Qt+=Lt[(15&Rt[Et+1])<<2|Rt[Et+2]>>6],Qt+=Lt[63&Rt[Et+2]];return Rt.length%3==2?Qt=Qt.substring(0,Qt.length-1)+"=":Rt.length%3==1&&(Qt=Qt.substring(0,Qt.length-2)+"=="),Qt}var Xt={serialize:function(yt,Et){var Rt="";if(yt&&(Rt=_t.call(yt)),yt&&(Rt==="[object ArrayBuffer]"||yt.buffer&&_t.call(yt.buffer)==="[object ArrayBuffer]")){var Qt,Wt="__lfsc__:";yt instanceof ArrayBuffer?(Qt=yt,Wt+="arbf"):(Qt=yt.buffer,Rt==="[object Int8Array]"?Wt+="si08":Rt==="[object Uint8Array]"?Wt+="ui08":Rt==="[object Uint8ClampedArray]"?Wt+="uic8":Rt==="[object Int16Array]"?Wt+="si16":Rt==="[object Uint16Array]"?Wt+="ur16":Rt==="[object Int32Array]"?Wt+="si32":Rt==="[object Uint32Array]"?Wt+="ui32":Rt==="[object Float32Array]"?Wt+="fl32":Rt==="[object Float64Array]"?Wt+="fl64":Et(new Error("Failed to get type for BinaryArray"))),Et(Wt+kt(Qt))}else if(Rt==="[object Blob]"){var Kt=new FileReader;Kt.onload=function(){var oe="~~local_forage_type~"+yt.type+"~"+kt(this.result);Et("__lfsc__:blob"+oe)},Kt.readAsArrayBuffer(yt)}else try{Et(JSON.stringify(yt))}catch(oe){console.error("Couldn't convert value into a JSON string: ",yt),Et(null,oe)}},deserialize:function(yt){if(yt.substring(0,dt)!=="__lfsc__:")return JSON.parse(yt);var Et,Rt=yt.substring(it),Qt=yt.substring(dt,it);if(Qt==="blob"&&K.test(Rt)){var Wt=Rt.match(K);Et=Wt[1],Rt=Rt.substring(Wt[0].length)}var Kt=St(Rt);switch(Qt){case"arbf":return Kt;case"blob":return X([Kt],{type:Et});case"si08":return new Int8Array(Kt);case"ui08":return new Uint8Array(Kt);case"uic8":return new Uint8ClampedArray(Kt);case"si16":return new Int16Array(Kt);case"ur16":return new Uint16Array(Kt);case"si32":return new Int32Array(Kt);case"ui32":return new Uint32Array(Kt);case"fl32":return new Float32Array(Kt);case"fl64":return new Float64Array(Kt);default:throw new Error("Unkown type: "+Qt)}},stringToBuffer:St,bufferToString:kt};function Jt(yt,Et,Rt,Qt){yt.executeSql("CREATE TABLE IF NOT EXISTS "+Et.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],Rt,Qt)}function at(yt,Et,Rt,Qt,Wt,Kt){yt.executeSql(Rt,Qt,Wt,function(oe,Me){Me.code===Me.SYNTAX_ERR?oe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Et.storeName],function(we,Se){Se.rows.length?Kt(we,Me):Jt(we,Et,function(){we.executeSql(Rt,Qt,Wt,Kt)},Kt)},Kt):Kt(oe,Me)},Kt)}function _e(yt,Et,Rt,Qt){var Wt=this;yt=Dt(yt);var Kt=new V(function(oe,Me){Wt.ready().then(function(){Et===void 0&&(Et=null);var we=Et,Se=Wt._dbInfo;Se.serializer.serialize(Et,function(Ve,en){en?Me(en):Se.db.transaction(function(dn){at(dn,Se,"INSERT OR REPLACE INTO "+Se.storeName+" (key, value) VALUES (?, ?)",[yt,Ve],function(){oe(we)},function(Tn,yn){Me(yn)})},function(dn){if(dn.code===dn.QUOTA_ERR){if(Qt>0)return void oe(_e.apply(Wt,[yt,we,Rt,Qt-1]));Me(dn)}})})}).catch(Me)});return et(Kt,Rt),Kt}function Ue(yt){return new V(function(Et,Rt){yt.transaction(function(Qt){Qt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Wt,Kt){for(var oe=[],Me=0;Me<Kt.rows.length;Me++)oe.push(Kt.rows.item(Me).name);Et({db:yt,storeNames:oe})},function(Wt,Kt){Rt(Kt)})},function(Qt){Rt(Qt)})})}var Oe={_driver:"webSQLStorage",_initStorage:function(yt){var Et=this,Rt={db:null};if(yt)for(var Qt in yt)Rt[Qt]=typeof yt[Qt]!="string"?yt[Qt].toString():yt[Qt];var Wt=new V(function(Kt,oe){try{Rt.db=openDatabase(Rt.name,String(Rt.version),Rt.description,Rt.size)}catch(Me){return oe(Me)}Rt.db.transaction(function(Me){Jt(Me,Rt,function(){Et._dbInfo=Rt,Kt()},function(we,Se){oe(Se)})},oe)});return Rt.serializer=Xt,Wt},_support:typeof openDatabase=="function",iterate:function(yt,Et){var Rt=this,Qt=new V(function(Wt,Kt){Rt.ready().then(function(){var oe=Rt._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"SELECT * FROM "+oe.storeName,[],function(we,Se){for(var Ve=Se.rows,en=Ve.length,dn=0;dn<en;dn++){var Tn=Ve.item(dn),yn=Tn.value;if(yn&&(yn=oe.serializer.deserialize(yn)),(yn=yt(yn,Tn.key,dn+1))!==void 0)return void Wt(yn)}Wt()},function(we,Se){Kt(Se)})})}).catch(Kt)});return et(Qt,Et),Qt},getItem:function(yt,Et){var Rt=this;yt=Dt(yt);var Qt=new V(function(Wt,Kt){Rt.ready().then(function(){var oe=Rt._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"SELECT * FROM "+oe.storeName+" WHERE key = ? LIMIT 1",[yt],function(we,Se){var Ve=Se.rows.length?Se.rows.item(0).value:null;Ve&&(Ve=oe.serializer.deserialize(Ve)),Wt(Ve)},function(we,Se){Kt(Se)})})}).catch(Kt)});return et(Qt,Et),Qt},setItem:function(yt,Et,Rt){return _e.apply(this,[yt,Et,Rt,1])},removeItem:function(yt,Et){var Rt=this;yt=Dt(yt);var Qt=new V(function(Wt,Kt){Rt.ready().then(function(){var oe=Rt._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"DELETE FROM "+oe.storeName+" WHERE key = ?",[yt],function(){Wt()},function(we,Se){Kt(Se)})})}).catch(Kt)});return et(Qt,Et),Qt},clear:function(yt){var Et=this,Rt=new V(function(Qt,Wt){Et.ready().then(function(){var Kt=Et._dbInfo;Kt.db.transaction(function(oe){at(oe,Kt,"DELETE FROM "+Kt.storeName,[],function(){Qt()},function(Me,we){Wt(we)})})}).catch(Wt)});return et(Rt,yt),Rt},length:function(yt){var Et=this,Rt=new V(function(Qt,Wt){Et.ready().then(function(){var Kt=Et._dbInfo;Kt.db.transaction(function(oe){at(oe,Kt,"SELECT COUNT(key) as c FROM "+Kt.storeName,[],function(Me,we){var Se=we.rows.item(0).c;Qt(Se)},function(Me,we){Wt(we)})})}).catch(Wt)});return et(Rt,yt),Rt},key:function(yt,Et){var Rt=this,Qt=new V(function(Wt,Kt){Rt.ready().then(function(){var oe=Rt._dbInfo;oe.db.transaction(function(Me){at(Me,oe,"SELECT key FROM "+oe.storeName+" WHERE id = ? LIMIT 1",[yt+1],function(we,Se){var Ve=Se.rows.length?Se.rows.item(0).key:null;Wt(Ve)},function(we,Se){Kt(Se)})})}).catch(Kt)});return et(Qt,Et),Qt},keys:function(yt){var Et=this,Rt=new V(function(Qt,Wt){Et.ready().then(function(){var Kt=Et._dbInfo;Kt.db.transaction(function(oe){at(oe,Kt,"SELECT key FROM "+Kt.storeName,[],function(Me,we){for(var Se=[],Ve=0;Ve<we.rows.length;Ve++)Se.push(we.rows.item(Ve).key);Qt(Se)},function(Me,we){Wt(we)})})}).catch(Wt)});return et(Rt,yt),Rt},dropInstance:function(yt,Et){Et=At.apply(this,arguments);var Rt=this.config();(yt=typeof yt!="function"&&yt||{}).name||(yt.name=yt.name||Rt.name,yt.storeName=yt.storeName||Rt.storeName);var Qt,Wt=this;return et(Qt=yt.name?new V(function(Kt){var oe;oe=yt.name===Rt.name?Wt._dbInfo.db:openDatabase(yt.name,"","",0),yt.storeName?Kt({db:oe,storeNames:[yt.storeName]}):Kt(Ue(oe))}).then(function(Kt){return new V(function(oe,Me){Kt.db.transaction(function(we){function Se(Tn){return new V(function(yn,Yn){we.executeSql("DROP TABLE IF EXISTS "+Tn,[],function(){yn()},function(Pn,Vi){Yn(Vi)})})}for(var Ve=[],en=0,dn=Kt.storeNames.length;en<dn;en++)Ve.push(Se(Kt.storeNames[en]));V.all(Ve).then(function(){oe()}).catch(function(Tn){Me(Tn)})},function(we){Me(we)})})}):V.reject("Invalid arguments"),Et),Qt}};function Ae(yt,Et){var Rt=yt.name+"/";return yt.storeName!==Et.storeName&&(Rt+=yt.storeName+"/"),Rt}function ze(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch{return!0}}()||localStorage.length>0}var $e={_driver:"localStorageWrapper",_initStorage:function(yt){var Et={};if(yt)for(var Rt in yt)Et[Rt]=yt[Rt];return Et.keyPrefix=Ae(yt,this._defaultConfig),ze()?(this._dbInfo=Et,Et.serializer=Xt,V.resolve()):V.reject()},_support:function(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function(yt,Et){var Rt=this,Qt=Rt.ready().then(function(){for(var Wt=Rt._dbInfo,Kt=Wt.keyPrefix,oe=Kt.length,Me=localStorage.length,we=1,Se=0;Se<Me;Se++){var Ve=localStorage.key(Se);if(Ve.indexOf(Kt)===0){var en=localStorage.getItem(Ve);if(en&&(en=Wt.serializer.deserialize(en)),(en=yt(en,Ve.substring(oe),we++))!==void 0)return en}}});return et(Qt,Et),Qt},getItem:function(yt,Et){var Rt=this;yt=Dt(yt);var Qt=Rt.ready().then(function(){var Wt=Rt._dbInfo,Kt=localStorage.getItem(Wt.keyPrefix+yt);return Kt&&(Kt=Wt.serializer.deserialize(Kt)),Kt});return et(Qt,Et),Qt},setItem:function(yt,Et,Rt){var Qt=this;yt=Dt(yt);var Wt=Qt.ready().then(function(){Et===void 0&&(Et=null);var Kt=Et;return new V(function(oe,Me){var we=Qt._dbInfo;we.serializer.serialize(Et,function(Se,Ve){if(Ve)Me(Ve);else try{localStorage.setItem(we.keyPrefix+yt,Se),oe(Kt)}catch(en){en.name!=="QuotaExceededError"&&en.name!=="NS_ERROR_DOM_QUOTA_REACHED"||Me(en),Me(en)}})})});return et(Wt,Rt),Wt},removeItem:function(yt,Et){var Rt=this;yt=Dt(yt);var Qt=Rt.ready().then(function(){var Wt=Rt._dbInfo;localStorage.removeItem(Wt.keyPrefix+yt)});return et(Qt,Et),Qt},clear:function(yt){var Et=this,Rt=Et.ready().then(function(){for(var Qt=Et._dbInfo.keyPrefix,Wt=localStorage.length-1;Wt>=0;Wt--){var Kt=localStorage.key(Wt);Kt.indexOf(Qt)===0&&localStorage.removeItem(Kt)}});return et(Rt,yt),Rt},length:function(yt){var Et=this.keys().then(function(Rt){return Rt.length});return et(Et,yt),Et},key:function(yt,Et){var Rt=this,Qt=Rt.ready().then(function(){var Wt,Kt=Rt._dbInfo;try{Wt=localStorage.key(yt)}catch{Wt=null}return Wt&&(Wt=Wt.substring(Kt.keyPrefix.length)),Wt});return et(Qt,Et),Qt},keys:function(yt){var Et=this,Rt=Et.ready().then(function(){for(var Qt=Et._dbInfo,Wt=localStorage.length,Kt=[],oe=0;oe<Wt;oe++){var Me=localStorage.key(oe);Me.indexOf(Qt.keyPrefix)===0&&Kt.push(Me.substring(Qt.keyPrefix.length))}return Kt});return et(Rt,yt),Rt},dropInstance:function(yt,Et){if(Et=At.apply(this,arguments),!(yt=typeof yt!="function"&&yt||{}).name){var Rt=this.config();yt.name=yt.name||Rt.name,yt.storeName=yt.storeName||Rt.storeName}var Qt,Wt=this;return et(Qt=yt.name?new V(function(Kt){yt.storeName?Kt(Ae(yt,Wt._defaultConfig)):Kt(yt.name+"/")}).then(function(Kt){for(var oe=localStorage.length-1;oe>=0;oe--){var Me=localStorage.key(oe);Me.indexOf(Kt)===0&&localStorage.removeItem(Me)}}):V.reject("Invalid arguments"),Et),Qt}},cn=function(yt,Et){for(var Rt,Qt,Wt=yt.length,Kt=0;Kt<Wt;){if((Rt=yt[Kt])===(Qt=Et)||typeof Rt=="number"&&typeof Qt=="number"&&isNaN(Rt)&&isNaN(Qt))return!0;Kt++}return!1},ke=Array.isArray||function(yt){return Object.prototype.toString.call(yt)==="[object Array]"},Ge={},Rn={},re={INDEXEDDB:gt,WEBSQL:Oe,LOCALSTORAGE:$e},pe=[re.INDEXEDDB._driver,re.WEBSQL._driver,re.LOCALSTORAGE._driver],Ee=["dropInstance"],ln=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ee),In={description:"",driver:pe.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Qn(yt,Et){yt[Et]=function(){var Rt=arguments;return yt.ready().then(function(){return yt[Et].apply(yt,Rt)})}}function fi(){for(var yt=1;yt<arguments.length;yt++){var Et=arguments[yt];if(Et)for(var Rt in Et)Et.hasOwnProperty(Rt)&&(ke(Et[Rt])?arguments[0][Rt]=Et[Rt].slice():arguments[0][Rt]=Et[Rt])}return arguments[0]}var tn=new(function(){function yt(Et){for(var Rt in function(Kt,oe){if(!(Kt instanceof oe))throw new TypeError("Cannot call a class as a function")}(this,yt),re)if(re.hasOwnProperty(Rt)){var Qt=re[Rt],Wt=Qt._driver;this[Rt]=Wt,Ge[Wt]||this.defineDriver(Qt)}this._defaultConfig=fi({},In),this._config=fi({},this._defaultConfig,Et),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return yt.prototype.config=function(Et){if((Et===void 0?"undefined":k(Et))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var Rt in Et){if(Rt==="storeName"&&(Et[Rt]=Et[Rt].replace(/\W/g,"_")),Rt==="version"&&typeof Et[Rt]!="number")return new Error("Database version must be a number.");this._config[Rt]=Et[Rt]}return!("driver"in Et)||!Et.driver||this.setDriver(this._config.driver)}return typeof Et=="string"?this._config[Et]:this._config},yt.prototype.defineDriver=function(Et,Rt,Qt){var Wt=new V(function(Kt,oe){try{var Me=Et._driver,we=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!Et._driver)return void oe(we);for(var Se=ln.concat("_initStorage"),Ve=0,en=Se.length;Ve<en;Ve++){var dn=Se[Ve];if((!cn(Ee,dn)||Et[dn])&&typeof Et[dn]!="function")return void oe(we)}(function(){for(var yn=function(bo){return function(){var so=new Error("Method "+bo+" is not implemented by the current driver"),Bn=V.reject(so);return et(Bn,arguments[arguments.length-1]),Bn}},Yn=0,Pn=Ee.length;Yn<Pn;Yn++){var Vi=Ee[Yn];Et[Vi]||(Et[Vi]=yn(Vi))}})();var Tn=function(yn){Ge[Me]&&console.info("Redefining LocalForage driver: "+Me),Ge[Me]=Et,Rn[Me]=yn,Kt()};"_support"in Et?Et._support&&typeof Et._support=="function"?Et._support().then(Tn,oe):Tn(!!Et._support):Tn(!0)}catch(yn){oe(yn)}});return pt(Wt,Rt,Qt),Wt},yt.prototype.driver=function(){return this._driver||null},yt.prototype.getDriver=function(Et,Rt,Qt){var Wt=Ge[Et]?V.resolve(Ge[Et]):V.reject(new Error("Driver not found."));return pt(Wt,Rt,Qt),Wt},yt.prototype.getSerializer=function(Et){var Rt=V.resolve(Xt);return pt(Rt,Et),Rt},yt.prototype.ready=function(Et){var Rt=this,Qt=Rt._driverSet.then(function(){return Rt._ready===null&&(Rt._ready=Rt._initDriver()),Rt._ready});return pt(Qt,Et,Et),Qt},yt.prototype.setDriver=function(Et,Rt,Qt){var Wt=this;ke(Et)||(Et=[Et]);var Kt=this._getSupportedDrivers(Et);function oe(){Wt._config.driver=Wt.driver()}function Me(Se){return Wt._extend(Se),oe(),Wt._ready=Wt._initStorage(Wt._config),Wt._ready}var we=this._driverSet!==null?this._driverSet.catch(function(){return V.resolve()}):V.resolve();return this._driverSet=we.then(function(){var Se=Kt[0];return Wt._dbInfo=null,Wt._ready=null,Wt.getDriver(Se).then(function(Ve){Wt._driver=Ve._driver,oe(),Wt._wrapLibraryMethodsWithReady(),Wt._initDriver=function(en){return function(){var dn=0;return function Tn(){for(;dn<en.length;){var yn=en[dn];return dn++,Wt._dbInfo=null,Wt._ready=null,Wt.getDriver(yn).then(Me).catch(Tn)}oe();var Yn=new Error("No available storage method found.");return Wt._driverSet=V.reject(Yn),Wt._driverSet}()}}(Kt)})}).catch(function(){oe();var Se=new Error("No available storage method found.");return Wt._driverSet=V.reject(Se),Wt._driverSet}),pt(this._driverSet,Rt,Qt),this._driverSet},yt.prototype.supports=function(Et){return!!Rn[Et]},yt.prototype._extend=function(Et){fi(this,Et)},yt.prototype._getSupportedDrivers=function(Et){for(var Rt=[],Qt=0,Wt=Et.length;Qt<Wt;Qt++){var Kt=Et[Qt];this.supports(Kt)&&Rt.push(Kt)}return Rt},yt.prototype._wrapLibraryMethodsWithReady=function(){for(var Et=0,Rt=ln.length;Et<Rt;Et++)Qn(this,ln[Et])},yt.prototype.createInstance=function(Et){return new yt(Et)},yt}());I.exports=tn},{3:3}]},{},[4])(4)}).call(this,v(17))},function(b,A,v){var P=v(14).Symbol;b.exports=P},function(b,A){b.exports=function(v){return v.webpackPolyfill||(v.deprecate=function(){},v.paths=[],v.children||(v.children=[]),Object.defineProperty(v,"loaded",{enumerable:!0,get:function(){return v.l}}),Object.defineProperty(v,"id",{enumerable:!0,get:function(){return v.i}}),v.webpackPolyfill=1),v}},function(b,A,v){var P=v(152),M=v(153),I=v(154),D=v(155),k=v(156);function W(X){var V=-1,et=X==null?0:X.length;for(this.clear();++V<et;){var pt=X[V];this.set(pt[0],pt[1])}}W.prototype.clear=P,W.prototype.delete=M,W.prototype.get=I,W.prototype.has=D,W.prototype.set=k,b.exports=W},function(b,A,v){var P=v(36);b.exports=function(M,I){for(var D=M.length;D--;)if(P(M[D][0],I))return D;return-1}},function(b,A,v){var P=v(22)(Object,"create");b.exports=P},function(b,A,v){var P=v(174);b.exports=function(M,I){var D=M.__data__;return P(I)?D[typeof I=="string"?"string":"hash"]:D.map}},function(b,A){var v=Array.isArray;b.exports=v},function(b,A,v){var P=v(196),M=v(37),I=v(197),D=v(198),k=v(199),W=v(20),X=v(55),V=X(P),et=X(M),pt=X(I),Dt=X(D),At=X(k),L=W;(P&&L(new P(new ArrayBuffer(1)))!="[object DataView]"||M&&L(new M)!="[object Map]"||I&&L(I.resolve())!="[object Promise]"||D&&L(new D)!="[object Set]"||k&&L(new k)!="[object WeakMap]")&&(L=function(R){var F=W(R),Y=F=="[object Object]"?R.constructor:void 0,O=Y?X(Y):"";if(O)switch(O){case V:return"[object DataView]";case et:return"[object Map]";case pt:return"[object Promise]";case Dt:return"[object Set]";case At:return"[object WeakMap]"}return F}),b.exports=L},function(b,A,v){var P=v(68),M=v(69);b.exports=function(I,D,k,W){var X=!k;k||(k={});for(var V=-1,et=D.length;++V<et;){var pt=D[V],Dt=W?W(k[pt],I[pt],pt,k,I):void 0;Dt===void 0&&(Dt=I[pt]),X?M(k,pt,Dt):P(k,pt,Dt)}return k}},function(b,A,v){var P=v(20),M=v(21);b.exports=function(I){if(!M(I))return!1;var D=P(I);return D=="[object Function]"||D=="[object GeneratorFunction]"||D=="[object AsyncFunction]"||D=="[object Proxy]"}},function(b,A,v){(function(P){v.d(A,"a",function(){return su});var M=v(4),I=v(0),D=v(10),k=v(8),W=v(16),X=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:P!==void 0?P:typeof self!="undefined"?self:{};function V(T,d,c){return T(c={path:d,exports:{},require:function(f,S){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(S==null&&c.path)}},c.exports),c.exports}var et=V(function(T){var d=Object.prototype.hasOwnProperty,c="~";function f(){}function S(ut,It,Ut){this.fn=ut,this.context=It,this.once=Ut||!1}function B(ut,It,Ut,he,te){if(typeof Ut!="function")throw new TypeError("The listener must be a function");var me=new S(Ut,he||ut,te),xe=c?c+It:It;return ut._events[xe]?ut._events[xe].fn?ut._events[xe]=[ut._events[xe],me]:ut._events[xe].push(me):(ut._events[xe]=me,ut._eventsCount++),ut}function Q(ut,It){--ut._eventsCount==0?ut._events=new f:delete ut._events[It]}function ot(){this._events=new f,this._eventsCount=0}Object.create&&(f.prototype=Object.create(null),new f().__proto__||(c=!1)),ot.prototype.eventNames=function(){var ut,It,Ut=[];if(this._eventsCount===0)return Ut;for(It in ut=this._events)d.call(ut,It)&&Ut.push(c?It.slice(1):It);return Object.getOwnPropertySymbols?Ut.concat(Object.getOwnPropertySymbols(ut)):Ut},ot.prototype.listeners=function(ut){var It=c?c+ut:ut,Ut=this._events[It];if(!Ut)return[];if(Ut.fn)return[Ut.fn];for(var he=0,te=Ut.length,me=new Array(te);he<te;he++)me[he]=Ut[he].fn;return me},ot.prototype.listenerCount=function(ut){var It=c?c+ut:ut,Ut=this._events[It];return Ut?Ut.fn?1:Ut.length:0},ot.prototype.emit=function(ut,It,Ut,he,te,me){var xe=arguments,Be=c?c+ut:ut;if(!this._events[Be])return!1;var qe,Ye,Je=this._events[Be],je=arguments.length;if(Je.fn){switch(Je.once&&this.removeListener(ut,Je.fn,void 0,!0),je){case 1:return Je.fn.call(Je.context),!0;case 2:return Je.fn.call(Je.context,It),!0;case 3:return Je.fn.call(Je.context,It,Ut),!0;case 4:return Je.fn.call(Je.context,It,Ut,he),!0;case 5:return Je.fn.call(Je.context,It,Ut,he,te),!0;case 6:return Je.fn.call(Je.context,It,Ut,he,te,me),!0}for(Ye=1,qe=new Array(je-1);Ye<je;Ye++)qe[Ye-1]=xe[Ye];Je.fn.apply(Je.context,qe)}else{var pn,_n=Je.length;for(Ye=0;Ye<_n;Ye++)switch(Je[Ye].once&&this.removeListener(ut,Je[Ye].fn,void 0,!0),je){case 1:Je[Ye].fn.call(Je[Ye].context);break;case 2:Je[Ye].fn.call(Je[Ye].context,It);break;case 3:Je[Ye].fn.call(Je[Ye].context,It,Ut);break;case 4:Je[Ye].fn.call(Je[Ye].context,It,Ut,he);break;default:if(!qe)for(pn=1,qe=new Array(je-1);pn<je;pn++)qe[pn-1]=xe[pn];Je[Ye].fn.apply(Je[Ye].context,qe)}}return!0},ot.prototype.on=function(ut,It,Ut){return B(this,ut,It,Ut,!1)},ot.prototype.once=function(ut,It,Ut){return B(this,ut,It,Ut,!0)},ot.prototype.removeListener=function(ut,It,Ut,he){var te=c?c+ut:ut;if(!this._events[te])return this;if(!It)return Q(this,te),this;var me=this._events[te];if(me.fn)me.fn!==It||he&&!me.once||Ut&&me.context!==Ut||Q(this,te);else{for(var xe=0,Be=[],qe=me.length;xe<qe;xe++)(me[xe].fn!==It||he&&!me[xe].once||Ut&&me[xe].context!==Ut)&&Be.push(me[xe]);Be.length?this._events[te]=Be.length===1?Be[0]:Be:Q(this,te)}return this},ot.prototype.removeAllListeners=function(ut){var It;return ut?(It=c?c+ut:ut,this._events[It]&&Q(this,It)):(this._events=new f,this._eventsCount=0),this},ot.prototype.off=ot.prototype.removeListener,ot.prototype.addListener=ot.prototype.on,ot.prefixed=c,ot.EventEmitter=ot,T.exports=ot}),pt=V(function(T,d){(function(c){var f=d&&!d.nodeType&&d,S=T&&!T.nodeType&&T,B=typeof X=="object"&&X;B.global!==B&&B.window!==B&&B.self!==B||(c=B);var Q,ot,ut=2147483647,It=/^xn--/,Ut=/[^\x20-\x7E]/,he=/[\x2E\u3002\uFF0E\uFF61]/g,te={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},me=Math.floor,xe=String.fromCharCode;function Be(Xe){throw RangeError(te[Xe])}function qe(Xe,an){for(var bn=Xe.length,Hn=[];bn--;)Hn[bn]=an(Xe[bn]);return Hn}function Ye(Xe,an){var bn=Xe.split("@"),Hn="";return bn.length>1&&(Hn=bn[0]+"@",Xe=bn[1]),Hn+qe((Xe=Xe.replace(he,".")).split("."),an).join(".")}function Je(Xe){for(var an,bn,Hn=[],Jn=0,Ei=Xe.length;Jn<Ei;)(an=Xe.charCodeAt(Jn++))>=55296&&an<=56319&&Jn<Ei?(64512&(bn=Xe.charCodeAt(Jn++)))==56320?Hn.push(((1023&an)<<10)+(1023&bn)+65536):(Hn.push(an),Jn--):Hn.push(an);return Hn}function je(Xe){return qe(Xe,function(an){var bn="";return an>65535&&(bn+=xe((an-=65536)>>>10&1023|55296),an=56320|1023&an),bn+=xe(an)}).join("")}function pn(Xe,an){return Xe+22+75*(Xe<26)-((an!=0)<<5)}function _n(Xe,an,bn){var Hn=0;for(Xe=bn?me(Xe/700):Xe>>1,Xe+=me(Xe/an);Xe>455;Hn+=36)Xe=me(Xe/35);return me(Hn+36*Xe/(Xe+38))}function Gn(Xe){var an,bn,Hn,Jn,Ei,ei,_i,Ii,Yi,ki,ri,Si=[],Gi=Xe.length,Hi=0,$i=128,oi=72;for((bn=Xe.lastIndexOf("-"))<0&&(bn=0),Hn=0;Hn<bn;++Hn)Xe.charCodeAt(Hn)>=128&&Be("not-basic"),Si.push(Xe.charCodeAt(Hn));for(Jn=bn>0?bn+1:0;Jn<Gi;){for(Ei=Hi,ei=1,_i=36;Jn>=Gi&&Be("invalid-input"),((Ii=(ri=Xe.charCodeAt(Jn++))-48<10?ri-22:ri-65<26?ri-65:ri-97<26?ri-97:36)>=36||Ii>me((ut-Hi)/ei))&&Be("overflow"),Hi+=Ii*ei,!(Ii<(Yi=_i<=oi?1:_i>=oi+26?26:_i-oi));_i+=36)ei>me(ut/(ki=36-Yi))&&Be("overflow"),ei*=ki;oi=_n(Hi-Ei,an=Si.length+1,Ei==0),me(Hi/an)>ut-$i&&Be("overflow"),$i+=me(Hi/an),Hi%=an,Si.splice(Hi++,0,$i)}return je(Si)}function Fn(Xe){var an,bn,Hn,Jn,Ei,ei,_i,Ii,Yi,ki,ri,Si,Gi,Hi,$i,oi=[];for(Si=(Xe=Je(Xe)).length,an=128,bn=0,Ei=72,ei=0;ei<Si;++ei)(ri=Xe[ei])<128&&oi.push(xe(ri));for(Hn=Jn=oi.length,Jn&&oi.push("-");Hn<Si;){for(_i=ut,ei=0;ei<Si;++ei)(ri=Xe[ei])>=an&&ri<_i&&(_i=ri);for(_i-an>me((ut-bn)/(Gi=Hn+1))&&Be("overflow"),bn+=(_i-an)*Gi,an=_i,ei=0;ei<Si;++ei)if((ri=Xe[ei])<an&&++bn>ut&&Be("overflow"),ri==an){for(Ii=bn,Yi=36;!(Ii<(ki=Yi<=Ei?1:Yi>=Ei+26?26:Yi-Ei));Yi+=36)$i=Ii-ki,Hi=36-ki,oi.push(xe(pn(ki+$i%Hi,0))),Ii=me($i/Hi);oi.push(xe(pn(Ii,0))),Ei=_n(bn,Gi,Hn==Jn),bn=0,++Hn}++bn,++an}return oi.join("")}if(Q={version:"1.3.2",ucs2:{decode:Je,encode:je},decode:Gn,encode:Fn,toASCII:function(Xe){return Ye(Xe,function(an){return Ut.test(an)?"xn--"+Fn(an):an})},toUnicode:function(Xe){return Ye(Xe,function(an){return It.test(an)?Gn(an.slice(4).toLowerCase()):an})}},f&&S)if(T.exports==f)S.exports=Q;else for(ot in Q)Q.hasOwnProperty(ot)&&(f[ot]=Q[ot]);else c.punycode=Q})(X)}),Dt=function(T){return typeof T=="string"},At=function(T){return typeof T=="object"&&T!==null},L=function(T){return T===null},R=function(T){return T==null};function F(T,d){return Object.prototype.hasOwnProperty.call(T,d)}var Y=function(T,d,c,f){d=d||"&",c=c||"=";var S={};if(typeof T!="string"||T.length===0)return S;var B=/\+/g;T=T.split(d);var Q=1e3;f&&typeof f.maxKeys=="number"&&(Q=f.maxKeys);var ot=T.length;Q>0&&ot>Q&&(ot=Q);for(var ut=0;ut<ot;++ut){var It,Ut,he,te,me=T[ut].replace(B,"%20"),xe=me.indexOf(c);xe>=0?(It=me.substr(0,xe),Ut=me.substr(xe+1)):(It=me,Ut=""),he=decodeURIComponent(It),te=decodeURIComponent(Ut),F(S,he)?Array.isArray(S[he])?S[he].push(te):S[he]=[S[he],te]:S[he]=te}return S},O=function(T){switch(typeof T){case"string":return T;case"boolean":return T?"true":"false";case"number":return isFinite(T)?T:"";default:return""}},H=function(T,d,c,f){return d=d||"&",c=c||"=",T===null&&(T=void 0),typeof T=="object"?Object.keys(T).map(function(S){var B=encodeURIComponent(O(S))+c;return Array.isArray(T[S])?T[S].map(function(Q){return B+encodeURIComponent(O(Q))}).join(d):B+encodeURIComponent(O(T[S]))}).join(d):f?encodeURIComponent(O(f))+c+encodeURIComponent(O(T)):""},tt=V(function(T,d){d.decode=d.parse=Y,d.encode=d.stringify=H}),G=Xt,Ot=function(T,d){return Xt(T,!1,!0).resolve(d)},Vt=function(T){return Dt(T)&&(T=Xt(T)),T instanceof st?T.format():st.prototype.format.call(T)};function st(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var z=/^([a-z0-9.+-]+:)/i,U=/:[0-9]*$/,ft=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,$=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),gt=["'"].concat($),Lt=["%","/","?",";","#"].concat(gt),K=["/","?","#"],dt=/^[+a-z0-9A-Z_-]{0,63}$/,it=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_t={javascript:!0,"javascript:":!0},St={javascript:!0,"javascript:":!0},kt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Xt(T,d,c){if(T&&At(T)&&T instanceof st)return T;var f=new st;return f.parse(T,d,c),f}st.prototype.parse=function(T,d,c){if(!Dt(T))throw new TypeError("Parameter 'url' must be a string, not "+typeof T);var f=T.indexOf("?"),S=f!==-1&&f<T.indexOf("#")?"?":"#",B=T.split(S);B[0]=B[0].replace(/\\/g,"/");var Q=T=B.join(S);if(Q=Q.trim(),!c&&T.split("#").length===1){var ot=ft.exec(Q);if(ot)return this.path=Q,this.href=Q,this.pathname=ot[1],ot[2]?(this.search=ot[2],this.query=d?tt.parse(this.search.substr(1)):this.search.substr(1)):d&&(this.search="",this.query={}),this}var ut=z.exec(Q);if(ut){var It=(ut=ut[0]).toLowerCase();this.protocol=It,Q=Q.substr(ut.length)}if(c||ut||Q.match(/^\/\/[^@\/]+@[^@\/]+/)){var Ut=Q.substr(0,2)==="//";!Ut||ut&&St[ut]||(Q=Q.substr(2),this.slashes=!0)}if(!St[ut]&&(Ut||ut&&!kt[ut])){for(var he,te,me=-1,xe=0;xe<K.length;xe++)(Be=Q.indexOf(K[xe]))!==-1&&(me===-1||Be<me)&&(me=Be);for((te=me===-1?Q.lastIndexOf("@"):Q.lastIndexOf("@",me))!==-1&&(he=Q.slice(0,te),Q=Q.slice(te+1),this.auth=decodeURIComponent(he)),me=-1,xe=0;xe<Lt.length;xe++){var Be;(Be=Q.indexOf(Lt[xe]))!==-1&&(me===-1||Be<me)&&(me=Be)}me===-1&&(me=Q.length),this.host=Q.slice(0,me),Q=Q.slice(me),this.parseHost(),this.hostname=this.hostname||"";var qe=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!qe)for(var Ye=this.hostname.split(/\./),Je=(xe=0,Ye.length);xe<Je;xe++){var je=Ye[xe];if(je&&!je.match(dt)){for(var pn="",_n=0,Gn=je.length;_n<Gn;_n++)je.charCodeAt(_n)>127?pn+="x":pn+=je[_n];if(!pn.match(dt)){var Fn=Ye.slice(0,xe),Xe=Ye.slice(xe+1),an=je.match(it);an&&(Fn.push(an[1]),Xe.unshift(an[2])),Xe.length&&(Q="/"+Xe.join(".")+Q),this.hostname=Fn.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),qe||(this.hostname=pt.toASCII(this.hostname));var bn=this.port?":"+this.port:"",Hn=this.hostname||"";this.host=Hn+bn,this.href+=this.host,qe&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),Q[0]!=="/"&&(Q="/"+Q))}if(!_t[It])for(xe=0,Je=gt.length;xe<Je;xe++){var Jn=gt[xe];if(Q.indexOf(Jn)!==-1){var Ei=encodeURIComponent(Jn);Ei===Jn&&(Ei=escape(Jn)),Q=Q.split(Jn).join(Ei)}}var ei=Q.indexOf("#");ei!==-1&&(this.hash=Q.substr(ei),Q=Q.slice(0,ei));var _i=Q.indexOf("?");if(_i!==-1?(this.search=Q.substr(_i),this.query=Q.substr(_i+1),d&&(this.query=tt.parse(this.query)),Q=Q.slice(0,_i)):d&&(this.search="",this.query={}),Q&&(this.pathname=Q),kt[It]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){bn=this.pathname||"";var Ii=this.search||"";this.path=bn+Ii}return this.href=this.format(),this},st.prototype.format=function(){var T=this.auth||"";T&&(T=(T=encodeURIComponent(T)).replace(/%3A/i,":"),T+="@");var d=this.protocol||"",c=this.pathname||"",f=this.hash||"",S=!1,B="";this.host?S=T+this.host:this.hostname&&(S=T+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(S+=":"+this.port)),this.query&&At(this.query)&&Object.keys(this.query).length&&(B=tt.stringify(this.query));var Q=this.search||B&&"?"+B||"";return d&&d.substr(-1)!==":"&&(d+=":"),this.slashes||(!d||kt[d])&&S!==!1?(S="//"+(S||""),c&&c.charAt(0)!=="/"&&(c="/"+c)):S||(S=""),f&&f.charAt(0)!=="#"&&(f="#"+f),Q&&Q.charAt(0)!=="?"&&(Q="?"+Q),d+S+(c=c.replace(/[?#]/g,function(ot){return encodeURIComponent(ot)}))+(Q=Q.replace("#","%23"))+f},st.prototype.resolve=function(T){return this.resolveObject(Xt(T,!1,!0)).format()},st.prototype.resolveObject=function(T){if(Dt(T)){var d=new st;d.parse(T,!1,!0),T=d}for(var c=new st,f=Object.keys(this),S=0;S<f.length;S++){var B=f[S];c[B]=this[B]}if(c.hash=T.hash,T.href==="")return c.href=c.format(),c;if(T.slashes&&!T.protocol){for(var Q=Object.keys(T),ot=0;ot<Q.length;ot++){var ut=Q[ot];ut!=="protocol"&&(c[ut]=T[ut])}return kt[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c}if(T.protocol&&T.protocol!==c.protocol){if(!kt[T.protocol]){for(var It=Object.keys(T),Ut=0;Ut<It.length;Ut++){var he=It[Ut];c[he]=T[he]}return c.href=c.format(),c}if(c.protocol=T.protocol,T.host||St[T.protocol])c.pathname=T.pathname;else{for(var te=(T.pathname||"").split("/");te.length&&!(T.host=te.shift()););T.host||(T.host=""),T.hostname||(T.hostname=""),te[0]!==""&&te.unshift(""),te.length<2&&te.unshift(""),c.pathname=te.join("/")}if(c.search=T.search,c.query=T.query,c.host=T.host||"",c.auth=T.auth,c.hostname=T.hostname||T.host,c.port=T.port,c.pathname||c.search){var me=c.pathname||"",xe=c.search||"";c.path=me+xe}return c.slashes=c.slashes||T.slashes,c.href=c.format(),c}var Be=c.pathname&&c.pathname.charAt(0)==="/",qe=T.host||T.pathname&&T.pathname.charAt(0)==="/",Ye=qe||Be||c.host&&T.pathname,Je=Ye,je=c.pathname&&c.pathname.split("/")||[],pn=(te=T.pathname&&T.pathname.split("/")||[],c.protocol&&!kt[c.protocol]);if(pn&&(c.hostname="",c.port=null,c.host&&(je[0]===""?je[0]=c.host:je.unshift(c.host)),c.host="",T.protocol&&(T.hostname=null,T.port=null,T.host&&(te[0]===""?te[0]=T.host:te.unshift(T.host)),T.host=null),Ye=Ye&&(te[0]===""||je[0]==="")),qe)c.host=T.host||T.host===""?T.host:c.host,c.hostname=T.hostname||T.hostname===""?T.hostname:c.hostname,c.search=T.search,c.query=T.query,je=te;else if(te.length)je||(je=[]),je.pop(),je=je.concat(te),c.search=T.search,c.query=T.query;else if(!R(T.search))return pn&&(c.hostname=c.host=je.shift(),(an=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@"))&&(c.auth=an.shift(),c.host=c.hostname=an.shift())),c.search=T.search,c.query=T.query,L(c.pathname)&&L(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c;if(!je.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var _n=je.slice(-1)[0],Gn=(c.host||T.host||je.length>1)&&(_n==="."||_n==="..")||_n==="",Fn=0,Xe=je.length;Xe>=0;Xe--)(_n=je[Xe])==="."?je.splice(Xe,1):_n===".."?(je.splice(Xe,1),Fn++):Fn&&(je.splice(Xe,1),Fn--);if(!Ye&&!Je)for(;Fn--;Fn)je.unshift("..");!Ye||je[0]===""||je[0]&&je[0].charAt(0)==="/"||je.unshift(""),Gn&&je.join("/").substr(-1)!=="/"&&je.push("");var an,bn=je[0]===""||je[0]&&je[0].charAt(0)==="/";return pn&&(c.hostname=c.host=bn?"":je.length?je.shift():"",(an=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@"))&&(c.auth=an.shift(),c.host=c.hostname=an.shift())),(Ye=Ye||c.host&&je.length)&&!bn&&je.unshift(""),je.length?c.pathname=je.join("/"):(c.pathname=null,c.path=null),L(c.pathname)&&L(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=T.auth||c.auth,c.slashes=c.slashes||T.slashes,c.href=c.format(),c},st.prototype.parseHost=function(){var T=this.host,d=U.exec(T);d&&((d=d[0])!==":"&&(this.port=d.substr(1)),T=T.substr(0,T.length-d.length)),T&&(this.hostname=T)};/*!
 * @pixi/utils - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Jt={parse:G,format:Vt,resolve:Ot};M.b.RETINA_PREFIX=/@([0-9\.]+)x/,M.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var at,_e=!1,Ue=function(){for(var T=[],d=[],c=0;c<32;c++)T[c]=c,d[c]=c;T[I.b.NORMAL_NPM]=I.b.NORMAL,T[I.b.ADD_NPM]=I.b.ADD,T[I.b.SCREEN_NPM]=I.b.SCREEN,d[I.b.NORMAL]=I.b.NORMAL_NPM,d[I.b.ADD]=I.b.ADD_NPM,d[I.b.SCREEN]=I.b.SCREEN_NPM;var f=[];return f.push(d),f.push(T),f}();function Oe(T){if(T.BYTES_PER_ELEMENT===4)return T instanceof Float32Array?"Float32Array":T instanceof Uint32Array?"Uint32Array":"Int32Array";if(T.BYTES_PER_ELEMENT===2){if(T instanceof Uint16Array)return"Uint16Array"}else if(T.BYTES_PER_ELEMENT===1&&T instanceof Uint8Array)return"Uint8Array";return null}function Ae(T){return T+=T===0?1:0,--T,T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,(T|=T>>>16)+1}function ze(T){return!(T&T-1||!T)}function $e(T){var d=(T>65535?1:0)<<4,c=((T>>>=d)>255?1:0)<<3;return d|=c,d|=c=((T>>>=c)>15?1:0)<<2,(d|=c=((T>>>=c)>3?1:0)<<1)|(T>>>=c)>>1}var cn=0;function ke(){return++cn}var Ge={};function Rn(T,d,c){if(c===void 0&&(c=3),!Ge[d]){var f=new Error().stack;f===void 0?console.warn("PixiJS Deprecation Warning: ",d+`
Deprecated since v`+T):(f=f.split(`
`).splice(c).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",d+`
Deprecated since v`+T),console.warn(f),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",d+`
Deprecated since v`+T),console.warn(f))),Ge[d]=!0}}var re,pe={},Ee=Object.create(null),ln=Object.create(null);function In(T,d){if(d===void 0&&(d=globalThis.location),T.indexOf("data:")===0)return"";d=d||globalThis.location,re||(re=document.createElement("a")),re.href=T;var c=Jt.parse(re.href),f=!c.port&&d.port===""||c.port===d.port;return c.hostname===d.hostname&&f&&c.protocol===d.protocol?"":"anonymous"}function Qn(T,d){var c=M.b.RETINA_PREFIX.exec(T);return c?parseFloat(c[1]):d!==void 0?d:1}/*!
 * @pixi/runner - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */(function(){function T(d,c,f){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=f||M.b.RESOLUTION,this.resize(d,c)}T.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},T.prototype.resize=function(d,c){this.canvas.width=Math.round(d*this.resolution),this.canvas.height=Math.round(c*this.resolution)},T.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(T.prototype,"width",{get:function(){return this.canvas.width},set:function(d){this.canvas.width=Math.round(d)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"height",{get:function(){return this.canvas.height},set:function(d){this.canvas.height=Math.round(d)},enumerable:!1,configurable:!0})})();var fi,tn=function(){function T(d){this.items=[],this._name=d,this._aliasCount=0}return T.prototype.emit=function(d,c,f,S,B,Q,ot,ut){if(arguments.length>8)throw new Error("max arguments reached");var It=this,Ut=It.name,he=It.items;this._aliasCount++;for(var te=0,me=he.length;te<me;te++)he[te][Ut](d,c,f,S,B,Q,ot,ut);return he===this.items&&this._aliasCount--,this},T.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},T.prototype.add=function(d){return d[this._name]&&(this.ensureNonAliasedItems(),this.remove(d),this.items.push(d)),this},T.prototype.remove=function(d){var c=this.items.indexOf(d);return c!==-1&&(this.ensureNonAliasedItems(),this.items.splice(c,1)),this},T.prototype.contains=function(d){return this.items.indexOf(d)!==-1},T.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},T.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(T.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),T}();Object.defineProperties(tn.prototype,{dispatch:{value:tn.prototype.emit},run:{value:tn.prototype.emit}}),M.b.TARGET_FPMS=.06,function(T){T[T.INTERACTION=50]="INTERACTION",T[T.HIGH=25]="HIGH",T[T.NORMAL=0]="NORMAL",T[T.LOW=-25]="LOW",T[T.UTILITY=-50]="UTILITY"}(fi||(fi={}));var yt,Et=function(){function T(d,c,f,S){c===void 0&&(c=null),f===void 0&&(f=0),S===void 0&&(S=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=d,this.context=c,this.priority=f,this.once=S}return T.prototype.match=function(d,c){return c===void 0&&(c=null),this.fn===d&&this.context===c},T.prototype.emit=function(d){this.fn&&(this.context?this.fn.call(this.context,d):this.fn(d));var c=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),c},T.prototype.connect=function(d){this.previous=d,d.next&&(d.next.previous=this),this.next=d.next,d.next=this},T.prototype.destroy=function(d){d===void 0&&(d=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var c=this.next;return this.next=d?null:c,this.previous=null,c},T}(),Rt=function(){function T(){var d=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Et(null,null,1/0),this.deltaMS=1/M.b.TARGET_FPMS,this.elapsedMS=1/M.b.TARGET_FPMS,this._tick=function(c){d._requestId=null,d.started&&(d.update(c),d.started&&d._requestId===null&&d._head.next&&(d._requestId=requestAnimationFrame(d._tick)))}}return T.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},T.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},T.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},T.prototype.add=function(d,c,f){return f===void 0&&(f=fi.NORMAL),this._addListener(new Et(d,c,f))},T.prototype.addOnce=function(d,c,f){return f===void 0&&(f=fi.NORMAL),this._addListener(new Et(d,c,f,!0))},T.prototype._addListener=function(d){var c=this._head.next,f=this._head;if(c){for(;c;){if(d.priority>c.priority){d.connect(f);break}f=c,c=c.next}d.previous||d.connect(f)}else d.connect(f);return this._startIfPossible(),this},T.prototype.remove=function(d,c){for(var f=this._head.next;f;)f=f.match(d,c)?f.destroy():f.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(T.prototype,"count",{get:function(){if(!this._head)return 0;for(var d=0,c=this._head;c=c.next;)d++;return d},enumerable:!1,configurable:!0}),T.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},T.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},T.prototype.destroy=function(){if(!this._protected){this.stop();for(var d=this._head.next;d;)d=d.destroy(!0);this._head.destroy(),this._head=null}},T.prototype.update=function(d){var c;if(d===void 0&&(d=performance.now()),d>this.lastTime){if((c=this.elapsedMS=d-this.lastTime)>this._maxElapsedMS&&(c=this._maxElapsedMS),c*=this.speed,this._minElapsedMS){var f=d-this._lastFrame|0;if(f<this._minElapsedMS)return;this._lastFrame=d-f%this._minElapsedMS}this.deltaMS=c,this.deltaTime=this.deltaMS*M.b.TARGET_FPMS;for(var S=this._head,B=S.next;B;)B=B.emit(this.deltaTime);S.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=d},Object.defineProperty(T.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(d){var c=Math.min(this.maxFPS,d),f=Math.min(Math.max(0,c)/1e3,M.b.TARGET_FPMS);this._maxElapsedMS=1/f},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(d){if(d===0)this._minElapsedMS=0;else{var c=Math.max(this.minFPS,d);this._minElapsedMS=1/(c/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(T,"shared",{get:function(){if(!T._shared){var d=T._shared=new T;d.autoStart=!0,d._protected=!0}return T._shared},enumerable:!1,configurable:!0}),Object.defineProperty(T,"system",{get:function(){if(!T._system){var d=T._system=new T;d.autoStart=!0,d._protected=!0}return T._system},enumerable:!1,configurable:!0}),T}(),Qt=2*Math.PI;(function(T){T[T.POLY=0]="POLY",T[T.RECT=1]="RECT",T[T.CIRC=2]="CIRC",T[T.ELIP=3]="ELIP",T[T.RREC=4]="RREC"})(yt||(yt={}));var Wt=function(){function T(d,c){d===void 0&&(d=0),c===void 0&&(c=0),this.x=0,this.y=0,this.x=d,this.y=c}return T.prototype.clone=function(){return new T(this.x,this.y)},T.prototype.copyFrom=function(d){return this.set(d.x,d.y),this},T.prototype.copyTo=function(d){return d.set(this.x,this.y),d},T.prototype.equals=function(d){return d.x===this.x&&d.y===this.y},T.prototype.set=function(d,c){return d===void 0&&(d=0),c===void 0&&(c=d),this.x=d,this.y=c,this},T.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},T}(),Kt=[new Wt,new Wt,new Wt,new Wt],oe=function(){function T(d,c,f,S){d===void 0&&(d=0),c===void 0&&(c=0),f===void 0&&(f=0),S===void 0&&(S=0),this.x=Number(d),this.y=Number(c),this.width=Number(f),this.height=Number(S),this.type=yt.RECT}return Object.defineProperty(T.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(T,"EMPTY",{get:function(){return new T(0,0,0,0)},enumerable:!1,configurable:!0}),T.prototype.clone=function(){return new T(this.x,this.y,this.width,this.height)},T.prototype.copyFrom=function(d){return this.x=d.x,this.y=d.y,this.width=d.width,this.height=d.height,this},T.prototype.copyTo=function(d){return d.x=this.x,d.y=this.y,d.width=this.width,d.height=this.height,d},T.prototype.contains=function(d,c){return!(this.width<=0||this.height<=0)&&d>=this.x&&d<this.x+this.width&&c>=this.y&&c<this.y+this.height},T.prototype.intersects=function(d,c){if(!c){var f=this.x<d.x?d.x:this.x;if((this.right>d.right?d.right:this.right)<=f)return!1;var S=this.y<d.y?d.y:this.y;return(this.bottom>d.bottom?d.bottom:this.bottom)>S}var B=this.left,Q=this.right,ot=this.top,ut=this.bottom;if(Q<=B||ut<=ot)return!1;var It=Kt[0].set(d.left,d.top),Ut=Kt[1].set(d.left,d.bottom),he=Kt[2].set(d.right,d.top),te=Kt[3].set(d.right,d.bottom);if(he.x<=It.x||Ut.y<=It.y)return!1;var me=Math.sign(c.a*c.d-c.b*c.c);if(me===0||(c.apply(It,It),c.apply(Ut,Ut),c.apply(he,he),c.apply(te,te),Math.max(It.x,Ut.x,he.x,te.x)<=B||Math.min(It.x,Ut.x,he.x,te.x)>=Q||Math.max(It.y,Ut.y,he.y,te.y)<=ot||Math.min(It.y,Ut.y,he.y,te.y)>=ut))return!1;var xe=me*(Ut.y-It.y),Be=me*(It.x-Ut.x),qe=xe*B+Be*ot,Ye=xe*Q+Be*ot,Je=xe*B+Be*ut,je=xe*Q+Be*ut;if(Math.max(qe,Ye,Je,je)<=xe*It.x+Be*It.y||Math.min(qe,Ye,Je,je)>=xe*te.x+Be*te.y)return!1;var pn=me*(It.y-he.y),_n=me*(he.x-It.x),Gn=pn*B+_n*ot,Fn=pn*Q+_n*ot,Xe=pn*B+_n*ut,an=pn*Q+_n*ut;return!(Math.max(Gn,Fn,Xe,an)<=pn*It.x+_n*It.y||Math.min(Gn,Fn,Xe,an)>=pn*te.x+_n*te.y)},T.prototype.pad=function(d,c){return d===void 0&&(d=0),c===void 0&&(c=d),this.x-=d,this.y-=c,this.width+=2*d,this.height+=2*c,this},T.prototype.fit=function(d){var c=Math.max(this.x,d.x),f=Math.min(this.x+this.width,d.x+d.width),S=Math.max(this.y,d.y),B=Math.min(this.y+this.height,d.y+d.height);return this.x=c,this.width=Math.max(f-c,0),this.y=S,this.height=Math.max(B-S,0),this},T.prototype.ceil=function(d,c){d===void 0&&(d=1),c===void 0&&(c=.001);var f=Math.ceil((this.x+this.width-c)*d)/d,S=Math.ceil((this.y+this.height-c)*d)/d;return this.x=Math.floor((this.x+c)*d)/d,this.y=Math.floor((this.y+c)*d)/d,this.width=f-this.x,this.height=S-this.y,this},T.prototype.enlarge=function(d){var c=Math.min(this.x,d.x),f=Math.max(this.x+this.width,d.x+d.width),S=Math.min(this.y,d.y),B=Math.max(this.y+this.height,d.y+d.height);return this.x=c,this.width=f-c,this.y=S,this.height=B-S,this},T.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},T}(),Me=function(){function T(d,c,f,S){f===void 0&&(f=0),S===void 0&&(S=0),this._x=f,this._y=S,this.cb=d,this.scope=c}return T.prototype.clone=function(d,c){return d===void 0&&(d=this.cb),c===void 0&&(c=this.scope),new T(d,c,this._x,this._y)},T.prototype.set=function(d,c){return d===void 0&&(d=0),c===void 0&&(c=d),this._x===d&&this._y===c||(this._x=d,this._y=c,this.cb.call(this.scope)),this},T.prototype.copyFrom=function(d){return this._x===d.x&&this._y===d.y||(this._x=d.x,this._y=d.y,this.cb.call(this.scope)),this},T.prototype.copyTo=function(d){return d.set(this._x,this._y),d},T.prototype.equals=function(d){return d.x===this._x&&d.y===this._y},T.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(T.prototype,"x",{get:function(){return this._x},set:function(d){this._x!==d&&(this._x=d,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"y",{get:function(){return this._y},set:function(d){this._y!==d&&(this._y=d,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),T}(),we=function(){function T(d,c,f,S,B,Q){d===void 0&&(d=1),c===void 0&&(c=0),f===void 0&&(f=0),S===void 0&&(S=1),B===void 0&&(B=0),Q===void 0&&(Q=0),this.array=null,this.a=d,this.b=c,this.c=f,this.d=S,this.tx=B,this.ty=Q}return T.prototype.fromArray=function(d){this.a=d[0],this.b=d[1],this.c=d[3],this.d=d[4],this.tx=d[2],this.ty=d[5]},T.prototype.set=function(d,c,f,S,B,Q){return this.a=d,this.b=c,this.c=f,this.d=S,this.tx=B,this.ty=Q,this},T.prototype.toArray=function(d,c){this.array||(this.array=new Float32Array(9));var f=c||this.array;return d?(f[0]=this.a,f[1]=this.b,f[2]=0,f[3]=this.c,f[4]=this.d,f[5]=0,f[6]=this.tx,f[7]=this.ty,f[8]=1):(f[0]=this.a,f[1]=this.c,f[2]=this.tx,f[3]=this.b,f[4]=this.d,f[5]=this.ty,f[6]=0,f[7]=0,f[8]=1),f},T.prototype.apply=function(d,c){c=c||new Wt;var f=d.x,S=d.y;return c.x=this.a*f+this.c*S+this.tx,c.y=this.b*f+this.d*S+this.ty,c},T.prototype.applyInverse=function(d,c){c=c||new Wt;var f=1/(this.a*this.d+this.c*-this.b),S=d.x,B=d.y;return c.x=this.d*f*S+-this.c*f*B+(this.ty*this.c-this.tx*this.d)*f,c.y=this.a*f*B+-this.b*f*S+(-this.ty*this.a+this.tx*this.b)*f,c},T.prototype.translate=function(d,c){return this.tx+=d,this.ty+=c,this},T.prototype.scale=function(d,c){return this.a*=d,this.d*=c,this.c*=d,this.b*=c,this.tx*=d,this.ty*=c,this},T.prototype.rotate=function(d){var c=Math.cos(d),f=Math.sin(d),S=this.a,B=this.c,Q=this.tx;return this.a=S*c-this.b*f,this.b=S*f+this.b*c,this.c=B*c-this.d*f,this.d=B*f+this.d*c,this.tx=Q*c-this.ty*f,this.ty=Q*f+this.ty*c,this},T.prototype.append=function(d){var c=this.a,f=this.b,S=this.c,B=this.d;return this.a=d.a*c+d.b*S,this.b=d.a*f+d.b*B,this.c=d.c*c+d.d*S,this.d=d.c*f+d.d*B,this.tx=d.tx*c+d.ty*S+this.tx,this.ty=d.tx*f+d.ty*B+this.ty,this},T.prototype.setTransform=function(d,c,f,S,B,Q,ot,ut,It){return this.a=Math.cos(ot+It)*B,this.b=Math.sin(ot+It)*B,this.c=-Math.sin(ot-ut)*Q,this.d=Math.cos(ot-ut)*Q,this.tx=d-(f*this.a+S*this.c),this.ty=c-(f*this.b+S*this.d),this},T.prototype.prepend=function(d){var c=this.tx;if(d.a!==1||d.b!==0||d.c!==0||d.d!==1){var f=this.a,S=this.c;this.a=f*d.a+this.b*d.c,this.b=f*d.b+this.b*d.d,this.c=S*d.a+this.d*d.c,this.d=S*d.b+this.d*d.d}return this.tx=c*d.a+this.ty*d.c+d.tx,this.ty=c*d.b+this.ty*d.d+d.ty,this},T.prototype.decompose=function(d){var c=this.a,f=this.b,S=this.c,B=this.d,Q=d.pivot,ot=-Math.atan2(-S,B),ut=Math.atan2(f,c),It=Math.abs(ot+ut);return It<1e-5||Math.abs(Qt-It)<1e-5?(d.rotation=ut,d.skew.x=d.skew.y=0):(d.rotation=0,d.skew.x=ot,d.skew.y=ut),d.scale.x=Math.sqrt(c*c+f*f),d.scale.y=Math.sqrt(S*S+B*B),d.position.x=this.tx+(Q.x*c+Q.y*S),d.position.y=this.ty+(Q.x*f+Q.y*B),d},T.prototype.invert=function(){var d=this.a,c=this.b,f=this.c,S=this.d,B=this.tx,Q=d*S-c*f;return this.a=S/Q,this.b=-c/Q,this.c=-f/Q,this.d=d/Q,this.tx=(f*this.ty-S*B)/Q,this.ty=-(d*this.ty-c*B)/Q,this},T.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},T.prototype.clone=function(){var d=new T;return d.a=this.a,d.b=this.b,d.c=this.c,d.d=this.d,d.tx=this.tx,d.ty=this.ty,d},T.prototype.copyTo=function(d){return d.a=this.a,d.b=this.b,d.c=this.c,d.d=this.d,d.tx=this.tx,d.ty=this.ty,d},T.prototype.copyFrom=function(d){return this.a=d.a,this.b=d.b,this.c=d.c,this.d=d.d,this.tx=d.tx,this.ty=d.ty,this},T.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(T,"IDENTITY",{get:function(){return new T},enumerable:!1,configurable:!0}),Object.defineProperty(T,"TEMP_MATRIX",{get:function(){return new T},enumerable:!1,configurable:!0}),T}(),Se=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ve=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],en=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],dn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Tn=[],yn=[],Yn=Math.sign;(function(){for(var T=0;T<16;T++){var d=[];Tn.push(d);for(var c=0;c<16;c++)for(var f=Yn(Se[T]*Se[c]+en[T]*Ve[c]),S=Yn(Ve[T]*Se[c]+dn[T]*Ve[c]),B=Yn(Se[T]*en[c]+en[T]*dn[c]),Q=Yn(Ve[T]*en[c]+dn[T]*dn[c]),ot=0;ot<16;ot++)if(Se[ot]===f&&Ve[ot]===S&&en[ot]===B&&dn[ot]===Q){d.push(ot);break}}for(T=0;T<16;T++){var ut=new we;ut.set(Se[T],Ve[T],en[T],dn[T],0,0),yn.push(ut)}})();var Pn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(T){return Se[T]},uY:function(T){return Ve[T]},vX:function(T){return en[T]},vY:function(T){return dn[T]},inv:function(T){return 8&T?15&T:7&-T},add:function(T,d){return Tn[T][d]},sub:function(T,d){return Tn[T][Pn.inv(d)]},rotate180:function(T){return 4^T},isVertical:function(T){return(3&T)==2},byDirection:function(T,d){return 2*Math.abs(T)<=Math.abs(d)?d>=0?Pn.S:Pn.N:2*Math.abs(d)<=Math.abs(T)?T>0?Pn.E:Pn.W:d>0?T>0?Pn.SE:Pn.SW:T>0?Pn.NE:Pn.NW},matrixAppendRotationInv:function(T,d,c,f){c===void 0&&(c=0),f===void 0&&(f=0);var S=yn[Pn.inv(d)];S.tx=c,S.ty=f,T.append(S)}};(function(){function T(){this.worldTransform=new we,this.localTransform=new we,this.position=new Me(this.onChange,this,0,0),this.scale=new Me(this.onChange,this,1,1),this.pivot=new Me(this.onChange,this,0,0),this.skew=new Me(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}T.prototype.onChange=function(){this._localID++},T.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},T.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},T.prototype.updateLocalTransform=function(){var d=this.localTransform;this._localID!==this._currentLocalID&&(d.a=this._cx*this.scale.x,d.b=this._sx*this.scale.x,d.c=this._cy*this.scale.y,d.d=this._sy*this.scale.y,d.tx=this.position.x-(this.pivot.x*d.a+this.pivot.y*d.c),d.ty=this.position.y-(this.pivot.x*d.b+this.pivot.y*d.d),this._currentLocalID=this._localID,this._parentID=-1)},T.prototype.updateTransform=function(d){var c=this.localTransform;if(this._localID!==this._currentLocalID&&(c.a=this._cx*this.scale.x,c.b=this._sx*this.scale.x,c.c=this._cy*this.scale.y,c.d=this._sy*this.scale.y,c.tx=this.position.x-(this.pivot.x*c.a+this.pivot.y*c.c),c.ty=this.position.y-(this.pivot.x*c.b+this.pivot.y*c.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==d._worldID){var f=d.worldTransform,S=this.worldTransform;S.a=c.a*f.a+c.b*f.c,S.b=c.a*f.b+c.b*f.d,S.c=c.c*f.a+c.d*f.c,S.d=c.c*f.b+c.d*f.d,S.tx=c.tx*f.a+c.ty*f.c+f.tx,S.ty=c.tx*f.b+c.ty*f.d+f.ty,this._parentID=d._worldID,this._worldID++}},T.prototype.setFromMatrix=function(d){d.decompose(this),this._localID++},Object.defineProperty(T.prototype,"rotation",{get:function(){return this._rotation},set:function(d){this._rotation!==d&&(this._rotation=d,this.updateSkew())},enumerable:!1,configurable:!0}),T.IDENTITY=new T})(),M.b.PREFER_ENV=M.a.any?I.g.WEBGL:I.g.WEBGL2,M.b.STRICT_TEXTURE_CACHE=!1;var Vi=[];function bo(T,d){if(!T)return null;var c="";if(typeof T=="string"){var f=/\.(\w{3,4})(?:$|\?|#)/i.exec(T);f&&(c=f[1].toLowerCase())}for(var S=Vi.length-1;S>=0;--S){var B=Vi[S];if(B.test&&B.test(T,c))return new B(T,d)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var so=function(T,d){return(so=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var S in f)f.hasOwnProperty(S)&&(c[S]=f[S])})(T,d)};function Bn(T,d){function c(){this.constructor=T}so(T,d),T.prototype=d===null?Object.create(d):(c.prototype=d.prototype,new c)}var Qo=function(){return(Qo=Object.assign||function(T){for(var d,c=arguments,f=1,S=arguments.length;f<S;f++)for(var B in d=c[f])Object.prototype.hasOwnProperty.call(d,B)&&(T[B]=d[B]);return T}).apply(this,arguments)},ao=function(){function T(d,c){d===void 0&&(d=0),c===void 0&&(c=0),this._width=d,this._height=c,this.destroyed=!1,this.internal=!1,this.onResize=new tn("setRealSize"),this.onUpdate=new tn("update"),this.onError=new tn("onError")}return T.prototype.bind=function(d){this.onResize.add(d),this.onUpdate.add(d),this.onError.add(d),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},T.prototype.unbind=function(d){this.onResize.remove(d),this.onUpdate.remove(d),this.onError.remove(d)},T.prototype.resize=function(d,c){d===this._width&&c===this._height||(this._width=d,this._height=c,this.onResize.emit(d,c))},Object.defineProperty(T.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),T.prototype.update=function(){this.destroyed||this.onUpdate.emit()},T.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(T.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),T.prototype.style=function(d,c,f){return!1},T.prototype.dispose=function(){},T.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},T.test=function(d,c){return!1},T}(),To=function(T){function d(c,f){var S=this,B=f||{},Q=B.width,ot=B.height;if(!Q||!ot)throw new Error("BufferResource width or height invalid");return(S=T.call(this,Q,ot)||this).data=c,S}return Bn(d,T),d.prototype.upload=function(c,f,S){var B=c.gl;B.pixelStorei(B.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===I.a.UNPACK);var Q=f.realWidth,ot=f.realHeight;return S.width===Q&&S.height===ot?B.texSubImage2D(f.target,0,0,0,Q,ot,f.format,S.type,this.data):(S.width=Q,S.height=ot,B.texImage2D(f.target,0,S.internalFormat,Q,ot,0,f.format,S.type,this.data)),!0},d.prototype.dispose=function(){this.data=null},d.test=function(c){return c instanceof Float32Array||c instanceof Uint8Array||c instanceof Uint32Array},d}(ao),kn={scaleMode:I.p.NEAREST,format:I.h.RGBA,alphaMode:I.a.NPM},zn=function(T){function d(c,f){c===void 0&&(c=null),f===void 0&&(f=null);var S=T.call(this)||this,B=(f=f||{}).alphaMode,Q=f.mipmap,ot=f.anisotropicLevel,ut=f.scaleMode,It=f.width,Ut=f.height,he=f.wrapMode,te=f.format,me=f.type,xe=f.target,Be=f.resolution,qe=f.resourceOptions;return!c||c instanceof ao||((c=bo(c,qe)).internal=!0),S.resolution=Be||M.b.RESOLUTION,S.width=Math.round((It||0)*S.resolution)/S.resolution,S.height=Math.round((Ut||0)*S.resolution)/S.resolution,S._mipmap=Q!==void 0?Q:M.b.MIPMAP_TEXTURES,S.anisotropicLevel=ot!==void 0?ot:M.b.ANISOTROPIC_LEVEL,S._wrapMode=he||M.b.WRAP_MODE,S._scaleMode=ut!==void 0?ut:M.b.SCALE_MODE,S.format=te||I.h.RGBA,S.type=me||I.r.UNSIGNED_BYTE,S.target=xe||I.q.TEXTURE_2D,S.alphaMode=B!==void 0?B:I.a.UNPACK,S.uid=ke(),S.touched=0,S.isPowerOfTwo=!1,S._refreshPOT(),S._glTextures={},S.dirtyId=0,S.dirtyStyleId=0,S.cacheId=null,S.valid=It>0&&Ut>0,S.textureCacheIds=[],S.destroyed=!1,S.resource=null,S._batchEnabled=0,S._batchLocation=0,S.parentTextureArray=null,S.setResource(c),S}return Bn(d,T),Object.defineProperty(d.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"mipmap",{get:function(){return this._mipmap},set:function(c){this._mipmap!==c&&(this._mipmap=c,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(c){this._scaleMode!==c&&(this._scaleMode=c,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(c){this._wrapMode!==c&&(this._wrapMode=c,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),d.prototype.setStyle=function(c,f){var S;return c!==void 0&&c!==this.scaleMode&&(this.scaleMode=c,S=!0),f!==void 0&&f!==this.mipmap&&(this.mipmap=f,S=!0),S&&this.dirtyStyleId++,this},d.prototype.setSize=function(c,f,S){return S=S||this.resolution,this.setRealSize(c*S,f*S,S)},d.prototype.setRealSize=function(c,f,S){return this.resolution=S||this.resolution,this.width=Math.round(c)/this.resolution,this.height=Math.round(f)/this.resolution,this._refreshPOT(),this.update(),this},d.prototype._refreshPOT=function(){this.isPowerOfTwo=ze(this.realWidth)&&ze(this.realHeight)},d.prototype.setResolution=function(c){var f=this.resolution;return f===c||(this.resolution=c,this.valid&&(this.width=Math.round(this.width*f)/c,this.height=Math.round(this.height*f)/c,this.emit("update",this)),this._refreshPOT()),this},d.prototype.setResource=function(c){if(this.resource===c)return this;if(this.resource)throw new Error("Resource can be set only once");return c.bind(this),this.resource=c,this},d.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},d.prototype.onError=function(c){this.emit("error",this,c)},d.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ln[this.cacheId],delete Ee[this.cacheId],this.cacheId=null),this.dispose(),d.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},d.prototype.dispose=function(){this.emit("dispose",this)},d.prototype.castToBaseTexture=function(){return this},d.from=function(c,f,S){S===void 0&&(S=M.b.STRICT_TEXTURE_CACHE);var B=typeof c=="string",Q=null;if(B)Q=c;else{if(!c._pixiId){var ot=f&&f.pixiIdPrefix||"pixiid";c._pixiId=ot+"_"+ke()}Q=c._pixiId}var ut=ln[Q];if(B&&S&&!ut)throw new Error('The cacheId "'+Q+'" does not exist in BaseTextureCache.');return ut||((ut=new d(c,f)).cacheId=Q,d.addToCache(ut,Q)),ut},d.fromBuffer=function(c,f,S,B){c=c||new Float32Array(f*S*4);var Q=new To(c,{width:f,height:S}),ot=c instanceof Float32Array?I.r.FLOAT:I.r.UNSIGNED_BYTE;return new d(Q,Object.assign(kn,B||{width:f,height:S,type:ot}))},d.addToCache=function(c,f){f&&(c.textureCacheIds.indexOf(f)===-1&&c.textureCacheIds.push(f),ln[f]&&console.warn("BaseTexture added to the cache with an id ["+f+"] that already had an entry"),ln[f]=c)},d.removeFromCache=function(c){if(typeof c=="string"){var f=ln[c];if(f){var S=f.textureCacheIds.indexOf(c);return S>-1&&f.textureCacheIds.splice(S,1),delete ln[c],f}}else if(c&&c.textureCacheIds){for(var B=0;B<c.textureCacheIds.length;++B)delete ln[c.textureCacheIds[B]];return c.textureCacheIds.length=0,c}return null},d._globalBatch=0,d}(et),Zi=function(T){function d(c,f){var S=this,B=f||{},Q=B.width,ot=B.height;(S=T.call(this,Q,ot)||this).items=[],S.itemDirtyIds=[];for(var ut=0;ut<c;ut++){var It=new zn;S.items.push(It),S.itemDirtyIds.push(-2)}return S.length=c,S._load=null,S.baseTexture=null,S}return Bn(d,T),d.prototype.initFromArray=function(c,f){for(var S=0;S<this.length;S++)c[S]&&(c[S].castToBaseTexture?this.addBaseTextureAt(c[S].castToBaseTexture(),S):c[S]instanceof ao?this.addResourceAt(c[S],S):this.addResourceAt(bo(c[S],f),S))},d.prototype.dispose=function(){for(var c=0,f=this.length;c<f;c++)this.items[c].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},d.prototype.addResourceAt=function(c,f){if(!this.items[f])throw new Error("Index "+f+" is out of bounds");return c.valid&&!this.valid&&this.resize(c.width,c.height),this.items[f].setResource(c),this},d.prototype.bind=function(c){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");T.prototype.bind.call(this,c);for(var f=0;f<this.length;f++)this.items[f].parentTextureArray=c,this.items[f].on("update",c.update,c)},d.prototype.unbind=function(c){T.prototype.unbind.call(this,c);for(var f=0;f<this.length;f++)this.items[f].parentTextureArray=null,this.items[f].off("update",c.update,c)},d.prototype.load=function(){var c=this;if(this._load)return this._load;var f=this.items.map(function(S){return S.resource}).filter(function(S){return S}).map(function(S){return S.load()});return this._load=Promise.all(f).then(function(){var S=c.items[0],B=S.realWidth,Q=S.realHeight;return c.resize(B,Q),Promise.resolve(c)}),this._load},d}(ao),qr=function(T){function d(c,f){var S,B,Q=this,ot=f||{},ut=ot.width,It=ot.height;return Array.isArray(c)?(S=c,B=c.length):B=c,Q=T.call(this,B,{width:ut,height:It})||this,S&&Q.initFromArray(S,f),Q}return Bn(d,T),d.prototype.addBaseTextureAt=function(c,f){if(!c.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(c.resource,f),this},d.prototype.bind=function(c){T.prototype.bind.call(this,c),c.target=I.q.TEXTURE_2D_ARRAY},d.prototype.upload=function(c,f,S){var B=this.length,Q=this.itemDirtyIds,ot=this.items,ut=c.gl;S.dirtyId<0&&ut.texImage3D(ut.TEXTURE_2D_ARRAY,0,S.internalFormat,this._width,this._height,B,0,f.format,S.type,null);for(var It=0;It<B;It++){var Ut=ot[It];Q[It]<Ut.dirtyId&&(Q[It]=Ut.dirtyId,Ut.valid&&ut.texSubImage3D(ut.TEXTURE_2D_ARRAY,0,0,0,It,Ut.resource.width,Ut.resource.height,1,f.format,S.type,Ut.resource.source))}return!0},d}(Zi),Ci=function(T){function d(c){var f=this,S=c,B=S.naturalWidth||S.videoWidth||S.width,Q=S.naturalHeight||S.videoHeight||S.height;return(f=T.call(this,B,Q)||this).source=c,f.noSubImage=!1,f}return Bn(d,T),d.crossOrigin=function(c,f,S){S===void 0&&f.indexOf("data:")!==0?c.crossOrigin=In(f):S!==!1&&(c.crossOrigin=typeof S=="string"?S:"anonymous")},d.prototype.upload=function(c,f,S,B){var Q=c.gl,ot=f.realWidth,ut=f.realHeight;if((B=B||this.source)instanceof HTMLImageElement){if(!B.complete||B.naturalWidth===0)return!1}else if(B instanceof HTMLVideoElement&&B.readyState<=1)return!1;return Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===I.a.UNPACK),this.noSubImage||f.target!==Q.TEXTURE_2D||S.width!==ot||S.height!==ut?(S.width=ot,S.height=ut,Q.texImage2D(f.target,0,S.internalFormat,f.format,S.type,B)):Q.texSubImage2D(Q.TEXTURE_2D,0,0,0,f.format,S.type,B),!0},d.prototype.update=function(){if(!this.destroyed){var c=this.source,f=c.naturalWidth||c.videoWidth||c.width,S=c.naturalHeight||c.videoHeight||c.height;this.resize(f,S),T.prototype.update.call(this)}},d.prototype.dispose=function(){this.source=null},d}(ao),Cr=function(T){function d(c){return T.call(this,c)||this}return Bn(d,T),d.test=function(c){var f=globalThis.OffscreenCanvas;return!!(f&&c instanceof f)||globalThis.HTMLCanvasElement&&c instanceof HTMLCanvasElement},d}(Ci),Fr=function(T){function d(c,f){var S=this,B=f||{},Q=B.width,ot=B.height,ut=B.autoLoad,It=B.linkBaseTexture;if(c&&c.length!==d.SIDES)throw new Error("Invalid length. Got "+c.length+", expected 6");S=T.call(this,6,{width:Q,height:ot})||this;for(var Ut=0;Ut<d.SIDES;Ut++)S.items[Ut].target=I.q.TEXTURE_CUBE_MAP_POSITIVE_X+Ut;return S.linkBaseTexture=It!==!1,c&&S.initFromArray(c,f),ut!==!1&&S.load(),S}return Bn(d,T),d.prototype.bind=function(c){T.prototype.bind.call(this,c),c.target=I.q.TEXTURE_CUBE_MAP},d.prototype.addBaseTextureAt=function(c,f,S){if(!this.items[f])throw new Error("Index "+f+" is out of bounds");if(!this.linkBaseTexture||c.parentTextureArray||Object.keys(c._glTextures).length>0){if(!c.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(c.resource,f)}else c.target=I.q.TEXTURE_CUBE_MAP_POSITIVE_X+f,c.parentTextureArray=this.baseTexture,this.items[f]=c;return c.valid&&!this.valid&&this.resize(c.realWidth,c.realHeight),this.items[f]=c,this},d.prototype.upload=function(c,f,S){for(var B=this.itemDirtyIds,Q=0;Q<d.SIDES;Q++){var ot=this.items[Q];B[Q]<ot.dirtyId&&(ot.valid&&ot.resource?(ot.resource.upload(c,ot,S),B[Q]=ot.dirtyId):B[Q]<-1&&(c.gl.texImage2D(ot.target,0,S.internalFormat,f.realWidth,f.realHeight,0,f.format,S.type,null),B[Q]=-1))}return!0},d.test=function(c){return Array.isArray(c)&&c.length===d.SIDES},d.SIDES=6,d}(Zi),$o=function(T){function d(c,f){var S=this;if(f=f||{},!(c instanceof HTMLImageElement)){var B=new Image;Ci.crossOrigin(B,c,f.crossorigin),B.src=c,c=B}return S=T.call(this,c)||this,!c.complete&&S._width&&S._height&&(S._width=0,S._height=0),S.url=c.src,S._process=null,S.preserveBitmap=!1,S.createBitmap=(f.createBitmap!==void 0?f.createBitmap:M.b.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,S.alphaMode=typeof f.alphaMode=="number"?f.alphaMode:null,S.bitmap=null,S._load=null,f.autoLoad!==!1&&S.load(),S}return Bn(d,T),d.prototype.load=function(c){var f=this;return this._load||(c!==void 0&&(this.createBitmap=c),this._load=new Promise(function(S,B){var Q=f.source;f.url=Q.src;var ot=function(){f.destroyed||(Q.onload=null,Q.onerror=null,f.resize(Q.width,Q.height),f._load=null,f.createBitmap?S(f.process()):S(f))};Q.complete&&Q.src?ot():(Q.onload=ot,Q.onerror=function(ut){B(ut),f.onError.emit(ut)})})),this._load},d.prototype.process=function(){var c=this,f=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var S=globalThis.createImageBitmap,B=!f.crossOrigin||f.crossOrigin==="anonymous";return this._process=fetch(f.src,{mode:B?"cors":"no-cors"}).then(function(Q){return Q.blob()}).then(function(Q){return S(Q,0,0,f.width,f.height,{premultiplyAlpha:c.alphaMode===I.a.UNPACK?"premultiply":"none"})}).then(function(Q){return c.destroyed?Promise.reject():(c.bitmap=Q,c.update(),c._process=null,Promise.resolve(c))}),this._process},d.prototype.upload=function(c,f,S){if(typeof this.alphaMode=="number"&&(f.alphaMode=this.alphaMode),!this.createBitmap)return T.prototype.upload.call(this,c,f,S);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(T.prototype.upload.call(this,c,f,S,this.bitmap),!this.preserveBitmap){var B=!0,Q=f._glTextures;for(var ot in Q){var ut=Q[ot];if(ut!==S&&ut.dirtyId!==f.dirtyId){B=!1;break}}B&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},d.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,T.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},d.test=function(c){return typeof c=="string"||c instanceof HTMLImageElement},d}(Ci),ts=function(T){function d(c,f){var S=this;return f=f||{},(S=T.call(this,document.createElement("canvas"))||this)._width=0,S._height=0,S.svg=c,S.scale=f.scale||1,S._overrideWidth=f.width,S._overrideHeight=f.height,S._resolve=null,S._crossorigin=f.crossorigin,S._load=null,f.autoLoad!==!1&&S.load(),S}return Bn(d,T),d.prototype.load=function(){var c=this;return this._load||(this._load=new Promise(function(f){if(c._resolve=function(){c.resize(c.source.width,c.source.height),f(c)},d.SVG_XML.test(c.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");c.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(c.svg)))}c._loadSvg()})),this._load},d.prototype._loadSvg=function(){var c=this,f=new Image;Ci.crossOrigin(f,this.svg,this._crossorigin),f.src=this.svg,f.onerror=function(S){c._resolve&&(f.onerror=null,c.onError.emit(S))},f.onload=function(){if(c._resolve){var S=f.width,B=f.height;if(!S||!B)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var Q=S*c.scale,ot=B*c.scale;(c._overrideWidth||c._overrideHeight)&&(Q=c._overrideWidth||c._overrideHeight/B*S,ot=c._overrideHeight||c._overrideWidth/S*B),Q=Math.round(Q),ot=Math.round(ot);var ut=c.source;ut.width=Q,ut.height=ot,ut._pixiId="canvas_"+ke(),ut.getContext("2d").drawImage(f,0,0,S,B,0,0,Q,ot),c._resolve(),c._resolve=null}}},d.getSize=function(c){var f=d.SVG_SIZE.exec(c),S={};return f&&(S[f[1]]=Math.round(parseFloat(f[3])),S[f[5]]=Math.round(parseFloat(f[7]))),S},d.prototype.dispose=function(){T.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},d.test=function(c,f){return f==="svg"||typeof c=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(c)||typeof c=="string"&&d.SVG_XML.test(c)},d.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,d.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,d}(Ci),Eo=function(T){function d(c,f){var S=this;if(f=f||{},!(c instanceof HTMLVideoElement)){var B=document.createElement("video");B.setAttribute("preload","auto"),B.setAttribute("webkit-playsinline",""),B.setAttribute("playsinline",""),typeof c=="string"&&(c=[c]);var Q=c[0].src||c[0];Ci.crossOrigin(B,Q,f.crossorigin);for(var ot=0;ot<c.length;++ot){var ut=document.createElement("source"),It=c[ot],Ut=It.src,he=It.mime,te=(Ut=Ut||c[ot]).split("?").shift().toLowerCase(),me=te.slice(te.lastIndexOf(".")+1);he=he||d.MIME_TYPES[me]||"video/"+me,ut.src=Ut,ut.type=he,B.appendChild(ut)}c=B}return(S=T.call(this,c)||this).noSubImage=!0,S._autoUpdate=!0,S._isConnectedToTicker=!1,S._updateFPS=f.updateFPS||0,S._msToNextUpdate=0,S.autoPlay=f.autoPlay!==!1,S._load=null,S._resolve=null,S._onCanPlay=S._onCanPlay.bind(S),S._onError=S._onError.bind(S),f.autoLoad!==!1&&S.load(),S}return Bn(d,T),d.prototype.update=function(c){if(!this.destroyed){var f=Rt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-f),(!this._updateFPS||this._msToNextUpdate<=0)&&(T.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},d.prototype.load=function(){var c=this;if(this._load)return this._load;var f=this.source;return(f.readyState===f.HAVE_ENOUGH_DATA||f.readyState===f.HAVE_FUTURE_DATA)&&f.width&&f.height&&(f.complete=!0),f.addEventListener("play",this._onPlayStart.bind(this)),f.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(f.addEventListener("canplay",this._onCanPlay),f.addEventListener("canplaythrough",this._onCanPlay),f.addEventListener("error",this._onError,!0)),this._load=new Promise(function(S){c.valid?S(c):(c._resolve=S,f.load())}),this._load},d.prototype._onError=function(c){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(c)},d.prototype._isSourcePlaying=function(){var c=this.source;return c.currentTime>0&&c.paused===!1&&c.ended===!1&&c.readyState>2},d.prototype._isSourceReady=function(){var c=this.source;return c.readyState===3||c.readyState===4},d.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Rt.shared.add(this.update,this),this._isConnectedToTicker=!0)},d.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Rt.shared.remove(this.update,this),this._isConnectedToTicker=!1)},d.prototype._onCanPlay=function(){var c=this.source;c.removeEventListener("canplay",this._onCanPlay),c.removeEventListener("canplaythrough",this._onCanPlay);var f=this.valid;this.resize(c.videoWidth,c.videoHeight),!f&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&c.play()},d.prototype.dispose=function(){this._isConnectedToTicker&&(Rt.shared.remove(this.update,this),this._isConnectedToTicker=!1);var c=this.source;c&&(c.removeEventListener("error",this._onError,!0),c.pause(),c.src="",c.load()),T.prototype.dispose.call(this)},Object.defineProperty(d.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(c){c!==this._autoUpdate&&(this._autoUpdate=c,!this._autoUpdate&&this._isConnectedToTicker?(Rt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Rt.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(c){c!==this._updateFPS&&(this._updateFPS=c)},enumerable:!1,configurable:!0}),d.test=function(c,f){return globalThis.HTMLVideoElement&&c instanceof HTMLVideoElement||d.TYPES.indexOf(f)>-1},d.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],d.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},d}(Ci),So=function(T){function d(c){return T.call(this,c)||this}return Bn(d,T),d.test=function(c){return!!globalThis.createImageBitmap&&c instanceof ImageBitmap},d}(Ci);Vi.push($o,So,Cr,Eo,ts,To,Fr,qr);var ci=function(T){function d(){return T!==null&&T.apply(this,arguments)||this}return Bn(d,T),d.prototype.upload=function(c,f,S){var B=c.gl;B.pixelStorei(B.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f.alphaMode===I.a.UNPACK);var Q=f.realWidth,ot=f.realHeight;return S.width===Q&&S.height===ot?B.texSubImage2D(f.target,0,0,0,Q,ot,f.format,S.type,this.data):(S.width=Q,S.height=ot,B.texImage2D(f.target,0,S.internalFormat,Q,ot,0,f.format,S.type,this.data)),!0},d}(To),es=function(){function T(d,c){this.width=Math.round(d||100),this.height=Math.round(c||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new tn("disposeFramebuffer"),this.multisample=I.l.NONE}return Object.defineProperty(T.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),T.prototype.addColorTexture=function(d,c){return d===void 0&&(d=0),this.colorTextures[d]=c||new zn(null,{scaleMode:I.p.NEAREST,resolution:1,mipmap:I.k.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},T.prototype.addDepthTexture=function(d){return this.depthTexture=d||new zn(new ci(null,{width:this.width,height:this.height}),{scaleMode:I.p.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:I.k.OFF,format:I.h.DEPTH_COMPONENT,type:I.r.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},T.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},T.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},T.prototype.resize=function(d,c){if(d=Math.round(d),c=Math.round(c),d!==this.width||c!==this.height){this.width=d,this.height=c,this.dirtyId++,this.dirtySize++;for(var f=0;f<this.colorTextures.length;f++){var S=this.colorTextures[f],B=S.resolution;S.setSize(d/B,c/B)}this.depthTexture&&(B=this.depthTexture.resolution,this.depthTexture.setSize(d/B,c/B))}},T.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},T.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},T}(),Ri=function(T){function d(c){c===void 0&&(c={});var f=this;if(typeof c=="number"){var S=arguments[0],B=arguments[1],Q=arguments[2],ot=arguments[3];c={width:S,height:B,scaleMode:Q,resolution:ot}}return c.width=c.width||100,c.height=c.height||100,c.multisample=c.multisample!==void 0?c.multisample:I.l.NONE,(f=T.call(this,null,c)||this).mipmap=I.k.OFF,f.valid=!0,f.clearColor=[0,0,0,0],f.framebuffer=new es(f.realWidth,f.realHeight).addColorTexture(0,f),f.framebuffer.multisample=c.multisample,f.maskStack=[],f.filterStack=[{}],f}return Bn(d,T),d.prototype.resize=function(c,f){this.framebuffer.resize(c*this.resolution,f*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},d.prototype.dispose=function(){this.framebuffer.dispose(),T.prototype.dispose.call(this)},d.prototype.destroy=function(){T.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},d}(zn),vr=function(){function T(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return T.prototype.set=function(d,c,f){var S=c.width,B=c.height;if(f){var Q=d.width/2/S,ot=d.height/2/B,ut=d.x/S+Q,It=d.y/B+ot;f=Pn.add(f,Pn.NW),this.x0=ut+Q*Pn.uX(f),this.y0=It+ot*Pn.uY(f),f=Pn.add(f,2),this.x1=ut+Q*Pn.uX(f),this.y1=It+ot*Pn.uY(f),f=Pn.add(f,2),this.x2=ut+Q*Pn.uX(f),this.y2=It+ot*Pn.uY(f),f=Pn.add(f,2),this.x3=ut+Q*Pn.uX(f),this.y3=It+ot*Pn.uY(f)}else this.x0=d.x/S,this.y0=d.y/B,this.x1=(d.x+d.width)/S,this.y1=d.y/B,this.x2=(d.x+d.width)/S,this.y2=(d.y+d.height)/B,this.x3=d.x/S,this.y3=(d.y+d.height)/B;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},T.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},T}(),Oi=new vr;function Br(T){T.destroy=function(){},T.on=function(){},T.once=function(){},T.emit=function(){}}var wo=function(T){function d(c,f,S,B,Q,ot){var ut=T.call(this)||this;if(ut.noFrame=!1,f||(ut.noFrame=!0,f=new oe(0,0,1,1)),c instanceof d&&(c=c.baseTexture),ut.baseTexture=c,ut._frame=f,ut.trim=B,ut.valid=!1,ut._uvs=Oi,ut.uvMatrix=null,ut.orig=S||f,ut._rotate=Number(Q||0),Q===!0)ut._rotate=2;else if(ut._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return ut.defaultAnchor=ot?new Wt(ot.x,ot.y):new Wt(0,0),ut._updateID=0,ut.textureCacheIds=[],c.valid?ut.noFrame?c.valid&&ut.onBaseTextureUpdated(c):ut.frame=f:c.once("loaded",ut.onBaseTextureUpdated,ut),ut.noFrame&&c.on("update",ut.onBaseTextureUpdated,ut),ut}return Bn(d,T),d.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},d.prototype.onBaseTextureUpdated=function(c){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=c.width,this._frame.height=c.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},d.prototype.destroy=function(c){if(this.baseTexture){if(c){var f=this.baseTexture.resource;f&&f.url&&Ee[f.url]&&d.removeFromCache(f.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,d.removeFromCache(this),this.textureCacheIds=null},d.prototype.clone=function(){var c=this._frame.clone(),f=this._frame===this.orig?c:this.orig.clone(),S=new d(this.baseTexture,!this.noFrame&&c,f,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(S._frame=c),S},d.prototype.updateUvs=function(){this._uvs===Oi&&(this._uvs=new vr),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},d.from=function(c,f,S){f===void 0&&(f={}),S===void 0&&(S=M.b.STRICT_TEXTURE_CACHE);var B=typeof c=="string",Q=null;if(B)Q=c;else if(c instanceof zn){if(!c.cacheId){var ot=f&&f.pixiIdPrefix||"pixiid";c.cacheId=ot+"-"+ke(),zn.addToCache(c,c.cacheId)}Q=c.cacheId}else c._pixiId||(ot=f&&f.pixiIdPrefix||"pixiid",c._pixiId=ot+"_"+ke()),Q=c._pixiId;var ut=Ee[Q];if(B&&S&&!ut)throw new Error('The cacheId "'+Q+'" does not exist in TextureCache.');return ut||c instanceof zn?!ut&&c instanceof zn&&(ut=new d(c),d.addToCache(ut,Q)):(f.resolution||(f.resolution=Qn(c)),(ut=new d(new zn(c,f))).baseTexture.cacheId=Q,zn.addToCache(ut.baseTexture,Q),d.addToCache(ut,Q)),ut},d.fromURL=function(c,f){var S=Object.assign({autoLoad:!1},f==null?void 0:f.resourceOptions),B=d.from(c,Object.assign({resourceOptions:S},f),!1),Q=B.baseTexture.resource;return B.baseTexture.valid?Promise.resolve(B):Q.load().then(function(){return Promise.resolve(B)})},d.fromBuffer=function(c,f,S,B){return new d(zn.fromBuffer(c,f,S,B))},d.fromLoader=function(c,f,S,B){var Q=new zn(c,Object.assign({scaleMode:M.b.SCALE_MODE,resolution:Qn(f)},B)),ot=Q.resource;ot instanceof $o&&(ot.url=f);var ut=new d(Q);return S||(S=f),zn.addToCache(ut.baseTexture,S),d.addToCache(ut,S),S!==f&&(zn.addToCache(ut.baseTexture,f),d.addToCache(ut,f)),ut.baseTexture.valid?Promise.resolve(ut):new Promise(function(It){ut.baseTexture.once("loaded",function(){return It(ut)})})},d.addToCache=function(c,f){f&&(c.textureCacheIds.indexOf(f)===-1&&c.textureCacheIds.push(f),Ee[f]&&console.warn("Texture added to the cache with an id ["+f+"] that already had an entry"),Ee[f]=c)},d.removeFromCache=function(c){if(typeof c=="string"){var f=Ee[c];if(f){var S=f.textureCacheIds.indexOf(c);return S>-1&&f.textureCacheIds.splice(S,1),delete Ee[c],f}}else if(c&&c.textureCacheIds){for(var B=0;B<c.textureCacheIds.length;++B)Ee[c.textureCacheIds[B]]===c&&delete Ee[c.textureCacheIds[B]];return c.textureCacheIds.length=0,c}return null},Object.defineProperty(d.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"frame",{get:function(){return this._frame},set:function(c){this._frame=c,this.noFrame=!1;var f=c.x,S=c.y,B=c.width,Q=c.height,ot=f+B>this.baseTexture.width,ut=S+Q>this.baseTexture.height;if(ot||ut){var It=ot&&ut?"and":"or",Ut="X: "+f+" + "+B+" = "+(f+B)+" > "+this.baseTexture.width,he="Y: "+S+" + "+Q+" = "+(S+Q)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+Ut+" "+It+" "+he)}this.valid=B&&Q&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=c),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"rotate",{get:function(){return this._rotate},set:function(c){this._rotate=c,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),d.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(d,"EMPTY",{get:function(){return d._EMPTY||(d._EMPTY=new d(new zn),Br(d._EMPTY),Br(d._EMPTY.baseTexture)),d._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(d,"WHITE",{get:function(){if(!d._WHITE){var c=document.createElement("canvas"),f=c.getContext("2d");c.width=16,c.height=16,f.fillStyle="white",f.fillRect(0,0,16,16),d._WHITE=new d(new zn(new Cr(c))),Br(d._WHITE),Br(d._WHITE.baseTexture)}return d._WHITE},enumerable:!1,configurable:!0}),d}(et),lo=function(T){function d(c,f){var S=T.call(this,c,f)||this;return S.valid=!0,S.filterFrame=null,S.filterPoolKey=null,S.updateUvs(),S}return Bn(d,T),Object.defineProperty(d.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(c){this.framebuffer.multisample=c},enumerable:!1,configurable:!0}),d.prototype.resize=function(c,f,S){S===void 0&&(S=!0);var B=this.baseTexture.resolution,Q=Math.round(c*B)/B,ot=Math.round(f*B)/B;this.valid=Q>0&&ot>0,this._frame.width=this.orig.width=Q,this._frame.height=this.orig.height=ot,S&&this.baseTexture.resize(Q,ot),this.updateUvs()},d.prototype.setResolution=function(c){var f=this.baseTexture;f.resolution!==c&&(f.setResolution(c),this.resize(f.width,f.height,!1))},d.create=function(c){for(var f=arguments,S=[],B=1;B<arguments.length;B++)S[B-1]=f[B];return typeof c=="number"&&(Rn("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),c={width:c,height:S[0],scaleMode:S[1],resolution:S[2]}),new d(new Ri(c))},d}(wo),Ao=function(){function T(d){this.texturePool={},this.textureOptions=d||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return T.prototype.createTexture=function(d,c,f){f===void 0&&(f=I.l.NONE);var S=new Ri(Object.assign({width:d,height:c,resolution:1,multisample:f},this.textureOptions));return new lo(S)},T.prototype.getOptimalTexture=function(d,c,f,S){var B;f===void 0&&(f=1),S===void 0&&(S=I.l.NONE),d=Math.ceil(d*f-1e-6),c=Math.ceil(c*f-1e-6),this.enableFullScreen&&d===this._pixelsWidth&&c===this._pixelsHeight?B=S>1?-S:-1:(B=((65535&(d=Ae(d)))<<16|65535&(c=Ae(c)))>>>0,S>1&&(B+=4294967296*S)),this.texturePool[B]||(this.texturePool[B]=[]);var Q=this.texturePool[B].pop();return Q||(Q=this.createTexture(d,c,S)),Q.filterPoolKey=B,Q.setResolution(f),Q},T.prototype.getFilterTexture=function(d,c,f){var S=this.getOptimalTexture(d.width,d.height,c||d.resolution,f||I.l.NONE);return S.filterFrame=d.filterFrame,S},T.prototype.returnTexture=function(d){var c=d.filterPoolKey;d.filterFrame=null,this.texturePool[c].push(d)},T.prototype.returnFilterTexture=function(d){this.returnTexture(d)},T.prototype.clear=function(d){if(d=d!==!1)for(var c in this.texturePool){var f=this.texturePool[c];if(f)for(var S=0;S<f.length;S++)f[S].destroy(!0)}this.texturePool={}},T.prototype.setScreenSize=function(d){if(d.width!==this._pixelsWidth||d.height!==this._pixelsHeight){for(var c in this.enableFullScreen=d.width>0&&d.height>0,this.texturePool)if(Number(c)<0){var f=this.texturePool[c];if(f)for(var S=0;S<f.length;S++)f[S].destroy(!0);this.texturePool[c]=[]}this._pixelsWidth=d.width,this._pixelsHeight=d.height}},T.SCREEN_KEY=-1,T}(),fn=function(){function T(d,c,f,S,B,Q,ot){c===void 0&&(c=0),f===void 0&&(f=!1),S===void 0&&(S=I.r.FLOAT),this.buffer=d,this.size=c,this.normalized=f,this.type=S,this.stride=B,this.start=Q,this.instance=ot}return T.prototype.destroy=function(){this.buffer=null},T.from=function(d,c,f,S,B){return new T(d,c,f,S,B)},T}(),Qi=0,Mn=function(){function T(d,c,f){c===void 0&&(c=!0),f===void 0&&(f=!1),this.data=d||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=f,this.static=c,this.id=Qi++,this.disposeRunner=new tn("disposeBuffer")}return T.prototype.update=function(d){d instanceof Array&&(d=new Float32Array(d)),this.data=d||this.data,this._updateID++},T.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},T.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(T.prototype,"index",{get:function(){return this.type===I.d.ELEMENT_ARRAY_BUFFER},set:function(d){this.type=d?I.d.ELEMENT_ARRAY_BUFFER:I.d.ARRAY_BUFFER},enumerable:!1,configurable:!0}),T.from=function(d){return d instanceof Array&&(d=new Float32Array(d)),new T(d)},T}(),Mo={Float32Array,Uint32Array,Int32Array,Uint8Array},qn={5126:4,5123:2,5121:1},Ts=0,da={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Co=function(){function T(d,c){d===void 0&&(d=[]),c===void 0&&(c={}),this.buffers=d,this.indexBuffer=null,this.attributes=c,this.glVertexArrayObjects={},this.id=Ts++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new tn("disposeGeometry"),this.refCount=0}return T.prototype.addAttribute=function(d,c,f,S,B,Q,ot,ut){if(f===void 0&&(f=0),S===void 0&&(S=!1),ut===void 0&&(ut=!1),!c)throw new Error("You must pass a buffer when creating an attribute");c instanceof Mn||(c instanceof Array&&(c=new Float32Array(c)),c=new Mn(c));var It=d.split("|");if(It.length>1){for(var Ut=0;Ut<It.length;Ut++)this.addAttribute(It[Ut],c,f,S,B);return this}var he=this.buffers.indexOf(c);return he===-1&&(this.buffers.push(c),he=this.buffers.length-1),this.attributes[d]=new fn(he,f,S,B,Q,ot,ut),this.instanced=this.instanced||ut,this},T.prototype.getAttribute=function(d){return this.attributes[d]},T.prototype.getBuffer=function(d){return this.buffers[this.getAttribute(d).buffer]},T.prototype.addIndex=function(d){return d instanceof Mn||(d instanceof Array&&(d=new Uint16Array(d)),d=new Mn(d)),d.type=I.d.ELEMENT_ARRAY_BUFFER,this.indexBuffer=d,this.buffers.indexOf(d)===-1&&this.buffers.push(d),this},T.prototype.getIndex=function(){return this.indexBuffer},T.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var d,c=[],f=[],S=new Mn;for(d in this.attributes){var B=this.attributes[d],Q=this.buffers[B.buffer];c.push(Q.data),f.push(B.size*qn[B.type]/4),B.buffer=0}for(S.data=function(ot,ut){for(var It=0,Ut=0,he={},te=0;te<ot.length;te++)Ut+=ut[te],It+=ot[te].length;var me=new ArrayBuffer(4*It),xe=null,Be=0;for(te=0;te<ot.length;te++){var qe=ut[te],Ye=ot[te],Je=Oe(Ye);he[Je]||(he[Je]=new Mo[Je](me)),xe=he[Je];for(var je=0;je<Ye.length;je++)xe[(je/qe|0)*Ut+Be+je%qe]=Ye[je];Be+=qe}return new Float32Array(me)}(c,f),d=0;d<this.buffers.length;d++)this.buffers[d]!==this.indexBuffer&&this.buffers[d].destroy();return this.buffers=[S],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},T.prototype.getSize=function(){for(var d in this.attributes){var c=this.attributes[d];return this.buffers[c.buffer].data.length/(c.stride/4||c.size)}return 0},T.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},T.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},T.prototype.clone=function(){for(var d=new T,c=0;c<this.buffers.length;c++)d.buffers[c]=new Mn(this.buffers[c].data.slice(0));for(var c in this.attributes){var f=this.attributes[c];d.attributes[c]=new fn(f.buffer,f.size,f.normalized,f.type,f.stride,f.start,f.instance)}return this.indexBuffer&&(d.indexBuffer=d.buffers[this.buffers.indexOf(this.indexBuffer)],d.indexBuffer.type=I.d.ELEMENT_ARRAY_BUFFER),d},T.merge=function(d){for(var c,f=new T,S=[],B=[],Q=[],ot=0;ot<d.length;ot++){c=d[ot];for(var ut=0;ut<c.buffers.length;ut++)B[ut]=B[ut]||0,B[ut]+=c.buffers[ut].data.length,Q[ut]=0}for(ot=0;ot<c.buffers.length;ot++)S[ot]=new da[Oe(c.buffers[ot].data)](B[ot]),f.buffers[ot]=new Mn(S[ot]);for(ot=0;ot<d.length;ot++)for(c=d[ot],ut=0;ut<c.buffers.length;ut++)S[ut].set(c.buffers[ut].data,Q[ut]),Q[ut]+=c.buffers[ut].data.length;if(f.attributes=c.attributes,c.indexBuffer){f.indexBuffer=f.buffers[c.buffers.indexOf(c.indexBuffer)],f.indexBuffer.type=I.d.ELEMENT_ARRAY_BUFFER;var It=0,Ut=0,he=0,te=0;for(ot=0;ot<c.buffers.length;ot++)if(c.buffers[ot]!==c.indexBuffer){te=ot;break}for(var ot in c.attributes){var me=c.attributes[ot];(0|me.buffer)===te&&(Ut+=me.size*qn[me.type]/4)}for(ot=0;ot<d.length;ot++){var xe=d[ot].indexBuffer.data;for(ut=0;ut<xe.length;ut++)f.indexBuffer.data[ut+he]+=It;It+=d[ot].buffers[te].data.length/Ut,he+=xe.length}}return f},T}(),An=function(T){function d(){var c=T.call(this)||this;return c.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),c}return Bn(d,T),d}(Co),Es=function(T){function d(){var c=T.call(this)||this;return c.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),c.uvs=new Float32Array([0,0,1,0,1,1,0,1]),c.vertexBuffer=new Mn(c.vertices),c.uvBuffer=new Mn(c.uvs),c.addAttribute("aVertexPosition",c.vertexBuffer).addAttribute("aTextureCoord",c.uvBuffer).addIndex([0,1,2,0,2,3]),c}return Bn(d,T),d.prototype.map=function(c,f){var S=0,B=0;return this.uvs[0]=S,this.uvs[1]=B,this.uvs[2]=S+f.width/c.width,this.uvs[3]=B,this.uvs[4]=S+f.width/c.width,this.uvs[5]=B+f.height/c.height,this.uvs[6]=S,this.uvs[7]=B+f.height/c.height,S=f.x,B=f.y,this.vertices[0]=S,this.vertices[1]=B,this.vertices[2]=S+f.width,this.vertices[3]=B,this.vertices[4]=S+f.width,this.vertices[5]=B+f.height,this.vertices[6]=S,this.vertices[7]=B+f.height,this.invalidate(),this},d.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},d}(Co),ns=0,bi=function(){function T(d,c,f){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=ns++,this.static=!!c,this.ubo=!!f,d instanceof Mn?(this.buffer=d,this.buffer.type=I.d.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=d,this.ubo&&(this.buffer=new Mn(new Float32Array(1)),this.buffer.type=I.d.UNIFORM_BUFFER,this.autoManage=!0))}return T.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},T.prototype.add=function(d,c,f){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[d]=new T(c,f)},T.from=function(d,c,f){return new T(d,c,f)},T.uboFrom=function(d,c){return new T(d,c==null||c,!0)},T}(),is=function(){function T(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=I.l.NONE,this.sourceFrame=new oe,this.destinationFrame=new oe,this.bindingSourceFrame=new oe,this.bindingDestinationFrame=new oe,this.filters=[],this.transform=null}return T.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},T}(),_r=[new Wt,new Wt,new Wt,new Wt],Ni=new we,ho=function(){function T(d){this.renderer=d,this.defaultFilterStack=[{}],this.texturePool=new Ao,this.texturePool.setScreenSize(d.view),this.statePool=[],this.quad=new An,this.quadUv=new Es,this.tempRect=new oe,this.activeState={},this.globalUniforms=new bi({outputFrame:new oe,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return T.prototype.push=function(d,c){for(var f,S,B=this.renderer,Q=this.defaultFilterStack,ot=this.statePool.pop()||new is,ut=this.renderer.renderTexture,It=c[0].resolution,Ut=c[0].multisample,he=c[0].padding,te=c[0].autoFit,me=(f=c[0].legacy)===null||f===void 0||f,xe=1;xe<c.length;xe++){var Be=c[xe];It=Math.min(It,Be.resolution),Ut=Math.min(Ut,Be.multisample),he=this.useMaxPadding?Math.max(he,Be.padding):he+Be.padding,te=te&&Be.autoFit,me=me||(S=Be.legacy)===null||S===void 0||S}Q.length===1&&(this.defaultFilterStack[0].renderTexture=ut.current),Q.push(ot),ot.resolution=It,ot.multisample=Ut,ot.legacy=me,ot.target=d,ot.sourceFrame.copyFrom(d.filterArea||d.getBounds(!0)),ot.sourceFrame.pad(he);var qe=this.tempRect.copyFrom(ut.sourceFrame);B.projection.transform&&this.transformAABB(Ni.copyFrom(B.projection.transform).invert(),qe),te?(ot.sourceFrame.fit(qe),(ot.sourceFrame.width<=0||ot.sourceFrame.height<=0)&&(ot.sourceFrame.width=0,ot.sourceFrame.height=0)):ot.sourceFrame.intersects(qe)||(ot.sourceFrame.width=0,ot.sourceFrame.height=0),this.roundFrame(ot.sourceFrame,ut.current?ut.current.resolution:B.resolution,ut.sourceFrame,ut.destinationFrame,B.projection.transform),ot.renderTexture=this.getOptimalFilterTexture(ot.sourceFrame.width,ot.sourceFrame.height,It,Ut),ot.filters=c,ot.destinationFrame.width=ot.renderTexture.width,ot.destinationFrame.height=ot.renderTexture.height;var Ye=this.tempRect;Ye.x=0,Ye.y=0,Ye.width=ot.sourceFrame.width,Ye.height=ot.sourceFrame.height,ot.renderTexture.filterFrame=ot.sourceFrame,ot.bindingSourceFrame.copyFrom(ut.sourceFrame),ot.bindingDestinationFrame.copyFrom(ut.destinationFrame),ot.transform=B.projection.transform,B.projection.transform=null,ut.bind(ot.renderTexture,ot.sourceFrame,Ye),B.framebuffer.clear(0,0,0,0)},T.prototype.pop=function(){var d=this.defaultFilterStack,c=d.pop(),f=c.filters;this.activeState=c;var S=this.globalUniforms.uniforms;S.outputFrame=c.sourceFrame,S.resolution=c.resolution;var B=S.inputSize,Q=S.inputPixel,ot=S.inputClamp;if(B[0]=c.destinationFrame.width,B[1]=c.destinationFrame.height,B[2]=1/B[0],B[3]=1/B[1],Q[0]=Math.round(B[0]*c.resolution),Q[1]=Math.round(B[1]*c.resolution),Q[2]=1/Q[0],Q[3]=1/Q[1],ot[0]=.5*Q[2],ot[1]=.5*Q[3],ot[2]=c.sourceFrame.width*B[2]-.5*Q[2],ot[3]=c.sourceFrame.height*B[3]-.5*Q[3],c.legacy){var ut=S.filterArea;ut[0]=c.destinationFrame.width,ut[1]=c.destinationFrame.height,ut[2]=c.sourceFrame.x,ut[3]=c.sourceFrame.y,S.filterClamp=S.inputClamp}this.globalUniforms.update();var It=d[d.length-1];if(this.renderer.framebuffer.blit(),f.length===1)f[0].apply(this,c.renderTexture,It.renderTexture,I.e.BLEND,c),this.returnFilterTexture(c.renderTexture);else{var Ut=c.renderTexture,he=this.getOptimalFilterTexture(Ut.width,Ut.height,c.resolution);he.filterFrame=Ut.filterFrame;var te=0;for(te=0;te<f.length-1;++te){te===1&&c.multisample>1&&((he=this.getOptimalFilterTexture(Ut.width,Ut.height,c.resolution)).filterFrame=Ut.filterFrame),f[te].apply(this,Ut,he,I.e.CLEAR,c);var me=Ut;Ut=he,he=me}f[te].apply(this,Ut,It.renderTexture,I.e.BLEND,c),te>1&&c.multisample>1&&this.returnFilterTexture(c.renderTexture),this.returnFilterTexture(Ut),this.returnFilterTexture(he)}c.clear(),this.statePool.push(c)},T.prototype.bindAndClear=function(d,c){c===void 0&&(c=I.e.CLEAR);var f=this.renderer,S=f.renderTexture,B=f.state;if(d===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,d&&d.filterFrame){var Q=this.tempRect;Q.x=0,Q.y=0,Q.width=d.filterFrame.width,Q.height=d.filterFrame.height,S.bind(d,d.filterFrame,Q)}else d!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?S.bind(d):this.renderer.renderTexture.bind(d,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var ot=1&B.stateId||this.forceClear;(c===I.e.CLEAR||c===I.e.BLIT&&ot)&&this.renderer.framebuffer.clear(0,0,0,0)},T.prototype.applyFilter=function(d,c,f,S){var B=this.renderer;B.state.set(d.state),this.bindAndClear(f,S),d.uniforms.uSampler=c,d.uniforms.filterGlobals=this.globalUniforms,B.shader.bind(d),d.legacy=!!d.program.attributeData.aTextureCoord,d.legacy?(this.quadUv.map(c._frame,c.filterFrame),B.geometry.bind(this.quadUv),B.geometry.draw(I.f.TRIANGLES)):(B.geometry.bind(this.quad),B.geometry.draw(I.f.TRIANGLE_STRIP))},T.prototype.calculateSpriteMatrix=function(d,c){var f=this.activeState,S=f.sourceFrame,B=f.destinationFrame,Q=c._texture.orig,ot=d.set(B.width,0,0,B.height,S.x,S.y),ut=c.worldTransform.copyTo(we.TEMP_MATRIX);return ut.invert(),ot.prepend(ut),ot.scale(1/Q.width,1/Q.height),ot.translate(c.anchor.x,c.anchor.y),ot},T.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},T.prototype.getOptimalFilterTexture=function(d,c,f,S){return f===void 0&&(f=1),S===void 0&&(S=I.l.NONE),this.texturePool.getOptimalTexture(d,c,f,S)},T.prototype.getFilterTexture=function(d,c,f){if(typeof d=="number"){var S=d;d=c,c=S}d=d||this.activeState.renderTexture;var B=this.texturePool.getOptimalTexture(d.width,d.height,c||d.resolution,f||I.l.NONE);return B.filterFrame=d.filterFrame,B},T.prototype.returnFilterTexture=function(d){this.texturePool.returnTexture(d)},T.prototype.emptyPool=function(){this.texturePool.clear(!0)},T.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},T.prototype.transformAABB=function(d,c){var f=_r[0],S=_r[1],B=_r[2],Q=_r[3];f.set(c.left,c.top),S.set(c.left,c.bottom),B.set(c.right,c.top),Q.set(c.right,c.bottom),d.apply(f,f),d.apply(S,S),d.apply(B,B),d.apply(Q,Q);var ot=Math.min(f.x,S.x,B.x,Q.x),ut=Math.min(f.y,S.y,B.y,Q.y),It=Math.max(f.x,S.x,B.x,Q.x),Ut=Math.max(f.y,S.y,B.y,Q.y);c.x=ot,c.y=ut,c.width=It-ot,c.height=Ut-ut},T.prototype.roundFrame=function(d,c,f,S,B){if(!(d.width<=0||d.height<=0||f.width<=0||f.height<=0)){if(B){var Q=B.a,ot=B.b,ut=B.c,It=B.d;if((Math.abs(ot)>1e-4||Math.abs(ut)>1e-4)&&(Math.abs(Q)>1e-4||Math.abs(It)>1e-4))return}(B=B?Ni.copyFrom(B):Ni.identity()).translate(-f.x,-f.y).scale(S.width/f.width,S.height/f.height).translate(S.x,S.y),this.transformAABB(B,d),d.ceil(c),this.transformAABB(B.invert(),d)}},T}(),mi=function(){function T(d){this.renderer=d}return T.prototype.flush=function(){},T.prototype.destroy=function(){this.renderer=null},T.prototype.start=function(){},T.prototype.stop=function(){this.flush()},T.prototype.render=function(d){},T}(),Xn=function(){function T(d){this.renderer=d,this.emptyRenderer=new mi(d),this.currentRenderer=this.emptyRenderer}return T.prototype.setObjectRenderer=function(d){this.currentRenderer!==d&&(this.currentRenderer.stop(),this.currentRenderer=d,this.currentRenderer.start())},T.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},T.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},T.prototype.copyBoundTextures=function(d,c){for(var f=this.renderer.texture.boundTextures,S=c-1;S>=0;--S)d[S]=f[S]||null,d[S]&&(d[S]._batchLocation=S)},T.prototype.boundArray=function(d,c,f,S){for(var B=d.elements,Q=d.ids,ot=d.count,ut=0,It=0;It<ot;It++){var Ut=B[It],he=Ut._batchLocation;if(he>=0&&he<S&&c[he]===Ut)Q[It]=he;else for(;ut<S;){var te=c[ut];if(!te||te._batchEnabled!==f||te._batchLocation!==ut){Q[It]=ut,Ut._batchLocation=ut,c[ut]=Ut;break}ut++}}},T.prototype.destroy=function(){this.renderer=null},T}(),Ro=0,Ur=function(){function T(d){this.renderer=d,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),d.view.addEventListener("webglcontextlost",this.handleContextLost,!1),d.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(T.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),T.prototype.contextChange=function(d){this.gl=d,this.renderer.gl=d,this.renderer.CONTEXT_UID=Ro++,d.isContextLost()&&d.getExtension("WEBGL_lose_context")&&d.getExtension("WEBGL_lose_context").restoreContext()},T.prototype.initFromContext=function(d){this.gl=d,this.validateContext(d),this.renderer.gl=d,this.renderer.CONTEXT_UID=Ro++,this.renderer.runners.contextChange.emit(d)},T.prototype.initFromOptions=function(d){var c=this.createContext(this.renderer.view,d);this.initFromContext(c)},T.prototype.createContext=function(d,c){var f;if(M.b.PREFER_ENV>=I.g.WEBGL2&&(f=d.getContext("webgl2",c)),f)this.webGLVersion=2;else if(this.webGLVersion=1,!(f=d.getContext("webgl",c)||d.getContext("experimental-webgl",c)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=f,this.getExtensions(),this.gl},T.prototype.getExtensions=function(){var d=this.gl,c={anisotropicFiltering:d.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:d.getExtension("OES_texture_float_linear"),s3tc:d.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:d.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:d.getExtension("WEBGL_compressed_texture_etc"),etc1:d.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:d.getExtension("WEBGL_compressed_texture_pvrtc")||d.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:d.getExtension("WEBGL_compressed_texture_atc"),astc:d.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,c,{drawBuffers:d.getExtension("WEBGL_draw_buffers"),depthTexture:d.getExtension("WEBGL_depth_texture"),loseContext:d.getExtension("WEBGL_lose_context"),vertexArrayObject:d.getExtension("OES_vertex_array_object")||d.getExtension("MOZ_OES_vertex_array_object")||d.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:d.getExtension("OES_element_index_uint"),floatTexture:d.getExtension("OES_texture_float"),floatTextureLinear:d.getExtension("OES_texture_float_linear"),textureHalfFloat:d.getExtension("OES_texture_half_float"),textureHalfFloatLinear:d.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,c,{colorBufferFloat:d.getExtension("EXT_color_buffer_float")})},T.prototype.handleContextLost=function(d){d.preventDefault()},T.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},T.prototype.destroy=function(){var d=this.renderer.view;this.renderer=null,d.removeEventListener("webglcontextlost",this.handleContextLost),d.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},T.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},T.prototype.validateContext=function(d){var c=d.getContextAttributes(),f="WebGL2RenderingContext"in globalThis&&d instanceof globalThis.WebGL2RenderingContext;f&&(this.webGLVersion=2),c&&!c.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var S=f||!!d.getExtension("OES_element_index_uint");this.supports.uint32Indices=S,S||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},T}(),Io=function(T){this.framebuffer=T,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=I.l.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},Rr=new oe,Ir=function(){function T(d){this.renderer=d,this.managedFramebuffers=[],this.unknownFramebuffer=new es(10,10),this.msaaSamples=null}return T.prototype.contextChange=function(){var d=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new oe,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var c=this.renderer.context.extensions.drawBuffers,f=this.renderer.context.extensions.depthTexture;M.b.PREFER_ENV===I.g.WEBGL_LEGACY&&(c=null,f=null),c?d.drawBuffers=function(S){return c.drawBuffersWEBGL(S)}:(this.hasMRT=!1,d.drawBuffers=function(){}),f||(this.writeDepthTexture=!1)}else this.msaaSamples=d.getInternalformatParameter(d.RENDERBUFFER,d.RGBA8,d.SAMPLES)},T.prototype.bind=function(d,c,f){f===void 0&&(f=0);var S=this.gl;if(d){var B=d.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(d);this.current!==d&&(this.current=d,S.bindFramebuffer(S.FRAMEBUFFER,B.framebuffer)),B.mipLevel!==f&&(d.dirtyId++,d.dirtyFormat++,B.mipLevel=f),B.dirtyId!==d.dirtyId&&(B.dirtyId=d.dirtyId,B.dirtyFormat!==d.dirtyFormat?(B.dirtyFormat=d.dirtyFormat,B.dirtySize=d.dirtySize,this.updateFramebuffer(d,f)):B.dirtySize!==d.dirtySize&&(B.dirtySize=d.dirtySize,this.resizeFramebuffer(d)));for(var Q=0;Q<d.colorTextures.length;Q++){var ot=d.colorTextures[Q];this.renderer.texture.unbind(ot.parentTextureArray||ot)}if(d.depthTexture&&this.renderer.texture.unbind(d.depthTexture),c){var ut=c.width>>f,It=c.height>>f,Ut=ut/c.width;this.setViewport(c.x*Ut,c.y*Ut,ut,It)}else ut=d.width>>f,It=d.height>>f,this.setViewport(0,0,ut,It)}else this.current&&(this.current=null,S.bindFramebuffer(S.FRAMEBUFFER,null)),c?this.setViewport(c.x,c.y,c.width,c.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},T.prototype.setViewport=function(d,c,f,S){var B=this.viewport;d=Math.round(d),c=Math.round(c),f=Math.round(f),S=Math.round(S),B.width===f&&B.height===S&&B.x===d&&B.y===c||(B.x=d,B.y=c,B.width=f,B.height=S,this.gl.viewport(d,c,f,S))},Object.defineProperty(T.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),T.prototype.clear=function(d,c,f,S,B){B===void 0&&(B=I.c.COLOR|I.c.DEPTH);var Q=this.gl;Q.clearColor(d,c,f,S),Q.clear(B)},T.prototype.initFramebuffer=function(d){var c=this.gl,f=new Io(c.createFramebuffer());return f.multisample=this.detectSamples(d.multisample),d.glFramebuffers[this.CONTEXT_UID]=f,this.managedFramebuffers.push(d),d.disposeRunner.add(this),f},T.prototype.resizeFramebuffer=function(d){var c=this.gl,f=d.glFramebuffers[this.CONTEXT_UID];f.msaaBuffer&&(c.bindRenderbuffer(c.RENDERBUFFER,f.msaaBuffer),c.renderbufferStorageMultisample(c.RENDERBUFFER,f.multisample,c.RGBA8,d.width,d.height)),f.stencil&&(c.bindRenderbuffer(c.RENDERBUFFER,f.stencil),f.msaaBuffer?c.renderbufferStorageMultisample(c.RENDERBUFFER,f.multisample,c.DEPTH24_STENCIL8,d.width,d.height):c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,d.width,d.height));var S=d.colorTextures,B=S.length;c.drawBuffers||(B=Math.min(B,1));for(var Q=0;Q<B;Q++){var ot=S[Q],ut=ot.parentTextureArray||ot;this.renderer.texture.bind(ut,0)}d.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(d.depthTexture,0)},T.prototype.updateFramebuffer=function(d,c){var f=this.gl,S=d.glFramebuffers[this.CONTEXT_UID],B=d.colorTextures,Q=B.length;f.drawBuffers||(Q=Math.min(Q,1)),S.multisample>1&&this.canMultisampleFramebuffer(d)?(S.msaaBuffer=S.msaaBuffer||f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,S.msaaBuffer),f.renderbufferStorageMultisample(f.RENDERBUFFER,S.multisample,f.RGBA8,d.width,d.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.RENDERBUFFER,S.msaaBuffer)):S.msaaBuffer&&(f.deleteRenderbuffer(S.msaaBuffer),S.msaaBuffer=null,S.blitFramebuffer&&(S.blitFramebuffer.dispose(),S.blitFramebuffer=null));for(var ot=[],ut=0;ut<Q;ut++){var It=B[ut],Ut=It.parentTextureArray||It;this.renderer.texture.bind(Ut,0),ut===0&&S.msaaBuffer||(f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0+ut,It.target,Ut._glTextures[this.CONTEXT_UID].texture,c),ot.push(f.COLOR_ATTACHMENT0+ut))}if(ot.length>1&&f.drawBuffers(ot),d.depthTexture&&this.writeDepthTexture){var he=d.depthTexture;this.renderer.texture.bind(he,0),f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.TEXTURE_2D,he._glTextures[this.CONTEXT_UID].texture,c)}!d.stencil&&!d.depth||d.depthTexture&&this.writeDepthTexture?S.stencil&&(f.deleteRenderbuffer(S.stencil),S.stencil=null):(S.stencil=S.stencil||f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,S.stencil),S.msaaBuffer?f.renderbufferStorageMultisample(f.RENDERBUFFER,S.multisample,f.DEPTH24_STENCIL8,d.width,d.height):f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_STENCIL,d.width,d.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,S.stencil))},T.prototype.canMultisampleFramebuffer=function(d){return this.renderer.context.webGLVersion!==1&&d.colorTextures.length<=1&&!d.depthTexture},T.prototype.detectSamples=function(d){var c=this.msaaSamples,f=I.l.NONE;if(d<=1||c===null)return f;for(var S=0;S<c.length;S++)if(c[S]<=d){f=c[S];break}return f===1&&(f=I.l.NONE),f},T.prototype.blit=function(d,c,f){var S=this.current,B=this.renderer,Q=this.gl,ot=this.CONTEXT_UID;if(B.context.webGLVersion===2&&S){var ut=S.glFramebuffers[ot];if(ut){if(!d){if(!ut.msaaBuffer)return;var It=S.colorTextures[0];if(!It)return;ut.blitFramebuffer||(ut.blitFramebuffer=new es(S.width,S.height),ut.blitFramebuffer.addColorTexture(0,It)),(d=ut.blitFramebuffer).colorTextures[0]!==It&&(d.colorTextures[0]=It,d.dirtyId++,d.dirtyFormat++),d.width===S.width&&d.height===S.height||(d.width=S.width,d.height=S.height,d.dirtyId++,d.dirtySize++)}c||((c=Rr).width=S.width,c.height=S.height),f||(f=c);var Ut=c.width===f.width&&c.height===f.height;this.bind(d),Q.bindFramebuffer(Q.READ_FRAMEBUFFER,ut.framebuffer),Q.blitFramebuffer(c.left,c.top,c.right,c.bottom,f.left,f.top,f.right,f.bottom,Q.COLOR_BUFFER_BIT,Ut?Q.NEAREST:Q.LINEAR)}}},T.prototype.disposeFramebuffer=function(d,c){var f=d.glFramebuffers[this.CONTEXT_UID],S=this.gl;if(f){delete d.glFramebuffers[this.CONTEXT_UID];var B=this.managedFramebuffers.indexOf(d);B>=0&&this.managedFramebuffers.splice(B,1),d.disposeRunner.remove(this),c||(S.deleteFramebuffer(f.framebuffer),f.msaaBuffer&&S.deleteRenderbuffer(f.msaaBuffer),f.stencil&&S.deleteRenderbuffer(f.stencil)),f.blitFramebuffer&&f.blitFramebuffer.dispose()}},T.prototype.disposeAll=function(d){var c=this.managedFramebuffers;this.managedFramebuffers=[];for(var f=0;f<c.length;f++)this.disposeFramebuffer(c[f],d)},T.prototype.forceStencil=function(){var d=this.current;if(d){var c=d.glFramebuffers[this.CONTEXT_UID];if(c&&!c.stencil){d.stencil=!0;var f=d.width,S=d.height,B=this.gl,Q=B.createRenderbuffer();B.bindRenderbuffer(B.RENDERBUFFER,Q),c.msaaBuffer?B.renderbufferStorageMultisample(B.RENDERBUFFER,c.multisample,B.DEPTH24_STENCIL8,f,S):B.renderbufferStorage(B.RENDERBUFFER,B.DEPTH_STENCIL,f,S),c.stencil=Q,B.framebufferRenderbuffer(B.FRAMEBUFFER,B.DEPTH_STENCIL_ATTACHMENT,B.RENDERBUFFER,Q)}}},T.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new oe},T.prototype.destroy=function(){this.renderer=null},T}(),sr={5126:4,5123:2,5121:1},Po=function(){function T(d){this.renderer=d,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return T.prototype.contextChange=function(){this.disposeAll(!0);var d=this.gl=this.renderer.gl,c=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,c.webGLVersion!==2){var f=this.renderer.context.extensions.vertexArrayObject;M.b.PREFER_ENV===I.g.WEBGL_LEGACY&&(f=null),f?(d.createVertexArray=function(){return f.createVertexArrayOES()},d.bindVertexArray=function(B){return f.bindVertexArrayOES(B)},d.deleteVertexArray=function(B){return f.deleteVertexArrayOES(B)}):(this.hasVao=!1,d.createVertexArray=function(){return null},d.bindVertexArray=function(){return null},d.deleteVertexArray=function(){return null})}if(c.webGLVersion!==2){var S=d.getExtension("ANGLE_instanced_arrays");S?(d.vertexAttribDivisor=function(B,Q){return S.vertexAttribDivisorANGLE(B,Q)},d.drawElementsInstanced=function(B,Q,ot,ut,It){return S.drawElementsInstancedANGLE(B,Q,ot,ut,It)},d.drawArraysInstanced=function(B,Q,ot,ut){return S.drawArraysInstancedANGLE(B,Q,ot,ut)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=c.webGLVersion===2||!!c.extensions.uint32ElementIndex},T.prototype.bind=function(d,c){c=c||this.renderer.shader.shader;var f=this.gl,S=d.glVertexArrayObjects[this.CONTEXT_UID],B=!1;S||(this.managedGeometries[d.id]=d,d.disposeRunner.add(this),d.glVertexArrayObjects[this.CONTEXT_UID]=S={},B=!0);var Q=S[c.program.id]||this.initGeometryVao(d,c,B);this._activeGeometry=d,this._activeVao!==Q&&(this._activeVao=Q,this.hasVao?f.bindVertexArray(Q):this.activateVao(d,c.program)),this.updateBuffers()},T.prototype.reset=function(){this.unbind()},T.prototype.updateBuffers=function(){for(var d=this._activeGeometry,c=this.renderer.buffer,f=0;f<d.buffers.length;f++){var S=d.buffers[f];c.update(S)}},T.prototype.checkCompatibility=function(d,c){var f=d.attributes,S=c.attributeData;for(var B in S)if(!f[B])throw new Error('shader and geometry incompatible, geometry missing the "'+B+'" attribute')},T.prototype.getSignature=function(d,c){var f=d.attributes,S=c.attributeData,B=["g",d.id];for(var Q in f)S[Q]&&B.push(Q,S[Q].location);return B.join("-")},T.prototype.initGeometryVao=function(d,c,f){f===void 0&&(f=!0);var S=this.gl,B=this.CONTEXT_UID,Q=this.renderer.buffer,ot=c.program;ot.glPrograms[B]||this.renderer.shader.generateProgram(c),this.checkCompatibility(d,ot);var ut=this.getSignature(d,ot),It=d.glVertexArrayObjects[this.CONTEXT_UID],Ut=It[ut];if(Ut)return It[ot.id]=Ut,Ut;var he=d.buffers,te=d.attributes,me={},xe={};for(var Be in he)me[Be]=0,xe[Be]=0;for(var Be in te)!te[Be].size&&ot.attributeData[Be]?te[Be].size=ot.attributeData[Be].size:te[Be].size||console.warn("PIXI Geometry attribute '"+Be+"' size cannot be determined (likely the bound shader does not have the attribute)"),me[te[Be].buffer]+=te[Be].size*sr[te[Be].type];for(var Be in te){var qe=te[Be],Ye=qe.size;qe.stride===void 0&&(me[qe.buffer]===Ye*sr[qe.type]?qe.stride=0:qe.stride=me[qe.buffer]),qe.start===void 0&&(qe.start=xe[qe.buffer],xe[qe.buffer]+=Ye*sr[qe.type])}Ut=S.createVertexArray(),S.bindVertexArray(Ut);for(var Je=0;Je<he.length;Je++){var je=he[Je];Q.bind(je),f&&je._glBuffers[B].refCount++}return this.activateVao(d,ot),this._activeVao=Ut,It[ot.id]=Ut,It[ut]=Ut,Ut},T.prototype.disposeGeometry=function(d,c){var f;if(this.managedGeometries[d.id]){delete this.managedGeometries[d.id];var S=d.glVertexArrayObjects[this.CONTEXT_UID],B=this.gl,Q=d.buffers,ot=(f=this.renderer)===null||f===void 0?void 0:f.buffer;if(d.disposeRunner.remove(this),S){if(ot)for(var ut=0;ut<Q.length;ut++){var It=Q[ut]._glBuffers[this.CONTEXT_UID];It&&(It.refCount--,It.refCount!==0||c||ot.dispose(Q[ut],c))}if(!c){for(var Ut in S)if(Ut[0]==="g"){var he=S[Ut];this._activeVao===he&&this.unbind(),B.deleteVertexArray(he)}}delete d.glVertexArrayObjects[this.CONTEXT_UID]}}},T.prototype.disposeAll=function(d){for(var c=Object.keys(this.managedGeometries),f=0;f<c.length;f++)this.disposeGeometry(this.managedGeometries[c[f]],d)},T.prototype.activateVao=function(d,c){var f=this.gl,S=this.CONTEXT_UID,B=this.renderer.buffer,Q=d.buffers,ot=d.attributes;d.indexBuffer&&B.bind(d.indexBuffer);var ut=null;for(var It in ot){var Ut=ot[It],he=Q[Ut.buffer],te=he._glBuffers[S];if(c.attributeData[It]){ut!==te&&(B.bind(he),ut=te);var me=c.attributeData[It].location;if(f.enableVertexAttribArray(me),f.vertexAttribPointer(me,Ut.size,Ut.type||f.FLOAT,Ut.normalized,Ut.stride,Ut.start),Ut.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");f.vertexAttribDivisor(me,1)}}}},T.prototype.draw=function(d,c,f,S){var B=this.gl,Q=this._activeGeometry;if(Q.indexBuffer){var ot=Q.indexBuffer.data.BYTES_PER_ELEMENT,ut=ot===2?B.UNSIGNED_SHORT:B.UNSIGNED_INT;ot===2||ot===4&&this.canUseUInt32ElementIndex?Q.instanced?B.drawElementsInstanced(d,c||Q.indexBuffer.data.length,ut,(f||0)*ot,S||1):B.drawElements(d,c||Q.indexBuffer.data.length,ut,(f||0)*ot):console.warn("unsupported index buffer type: uint32")}else Q.instanced?B.drawArraysInstanced(d,f,c||Q.getSize(),S||1):B.drawArrays(d,f,c||Q.getSize());return this},T.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},T.prototype.destroy=function(){this.renderer=null},T}(),Oo=function(){function T(d){d===void 0&&(d=null),this.type=I.j.NONE,this.autoDetect=!0,this.maskObject=d||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=M.b.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(T.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(d){d?this._filters?this._filters[0]=d:this._filters=[d]:this._filters=null},enumerable:!1,configurable:!0}),T.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=I.j.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},T.prototype.copyCountersOrReset=function(d){d?(this._stencilCounter=d._stencilCounter,this._scissorCounter=d._scissorCounter,this._scissorRect=d._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},T}();function No(T,d,c){var f=T.createShader(d);return T.shaderSource(f,c),T.compileShader(f),f}function q(T,d){var c=T.getShaderSource(d).split(`
`).map(function(It,Ut){return Ut+": "+It}),f=T.getShaderInfoLog(d),S=f.split(`
`),B={},Q=S.map(function(It){return parseFloat(It.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(It){return!(!It||B[It])&&(B[It]=!0,!0)}),ot=[""];Q.forEach(function(It){c[It-1]="%c"+c[It-1]+"%c",ot.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var ut=c.join(`
`);ot[0]=ut,console.error(f),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,ot),console.groupEnd()}function g(T){for(var d=new Array(T),c=0;c<d.length;c++)d[c]=!1;return d}function m(T,d){switch(T){case"float":return 0;case"vec2":return new Float32Array(2*d);case"vec3":return new Float32Array(3*d);case"vec4":return new Float32Array(4*d);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*d);case"ivec3":return new Int32Array(3*d);case"ivec4":return new Int32Array(4*d);case"uvec2":return new Uint32Array(2*d);case"uvec3":return new Uint32Array(3*d);case"uvec4":return new Uint32Array(4*d);case"bool":return!1;case"bvec2":return g(2*d);case"bvec3":return g(3*d);case"bvec4":return g(4*d);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var _,N={},J=N;function lt(){if(!_){_=I.m.MEDIUM;var T=function(){if(J===N||J&&J.isContextLost()){var c=document.createElement("canvas"),f=void 0;M.b.PREFER_ENV>=I.g.WEBGL2&&(f=c.getContext("webgl2",{})),f||((f=c.getContext("webgl",{})||c.getContext("experimental-webgl",{}))?f.getExtension("WEBGL_draw_buffers"):f=null),J=f}return J}();if(T&&T.getShaderPrecisionFormat){var d=T.getShaderPrecisionFormat(T.FRAGMENT_SHADER,T.HIGH_FLOAT);_=d.precision?I.m.HIGH:I.m.MEDIUM}}return _}function xt(T,d,c){if(T.substring(0,9)!=="precision"){var f=d;return d===I.m.HIGH&&c!==I.m.HIGH&&(f=I.m.MEDIUM),"precision "+f+` float;
`+T}return c!==I.m.HIGH&&T.substring(0,15)==="precision highp"?T.replace("precision highp","precision mediump"):T}var Tt={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Zt(T){return Tt[T]}var ee=null,Fe={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Te(T,d){if(!ee){var c=Object.keys(Fe);ee={};for(var f=0;f<c.length;++f){var S=c[f];ee[T[S]]=Fe[S]}}return ee[d]}var Qe=[{test:function(T){return T.type==="float"&&T.size===1},code:function(T){return`
            if(uv["`+T+'"] !== ud["'+T+`"].value)
            {
                ud["`+T+'"].value = uv["'+T+`"]
                gl.uniform1f(ud["`+T+'"].location, uv["'+T+`"])
            }
            `}},{test:function(T){return(T.type==="sampler2D"||T.type==="samplerCube"||T.type==="sampler2DArray")&&T.size===1&&!T.isArray},code:function(T){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+T+`"], t);

            if(ud["`+T+`"].value !== t)
            {
                ud["`+T+`"].value = t;
                gl.uniform1i(ud["`+T+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(T,d){return T.type==="mat3"&&T.size===1&&d.a!==void 0},code:function(T){return`
            gl.uniformMatrix3fv(ud["`+T+'"].location, false, uv["'+T+`"].toArray(true));
            `},codeUbo:function(T){return`
                var `+T+"_matrix = uv."+T+`.toArray(true);

                data[offset] = `+T+`_matrix[0];
                data[offset+1] = `+T+`_matrix[1];
                data[offset+2] = `+T+`_matrix[2];
        
                data[offset + 4] = `+T+`_matrix[3];
                data[offset + 5] = `+T+`_matrix[4];
                data[offset + 6] = `+T+`_matrix[5];
        
                data[offset + 8] = `+T+`_matrix[6];
                data[offset + 9] = `+T+`_matrix[7];
                data[offset + 10] = `+T+`_matrix[8];
            `}},{test:function(T,d){return T.type==="vec2"&&T.size===1&&d.x!==void 0},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+T+`"].location, v.x, v.y);
                }`},codeUbo:function(T){return`
                v = uv.`+T+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(T){return T.type==="vec2"&&T.size===1},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+T+`"].location, v[0], v[1]);
                }
            `}},{test:function(T,d){return T.type==="vec4"&&T.size===1&&d.width!==void 0},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+T+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(T){return`
                    v = uv.`+T+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(T){return T.type==="vec4"&&T.size===1},code:function(T){return`
                cv = ud["`+T+`"].value;
                v = uv["`+T+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+T+`"].location, v[0], v[1], v[2], v[3])
                }`}}],hn={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},vn={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},un,$n=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function gi(T){for(var d="",c=0;c<T;++c)c>0&&(d+=`
else `),c<T-1&&(d+="if(test == "+c+".0){}");return d}var vi=0,ii={},Fi=function(){function T(d,c,f){f===void 0&&(f="pixi-shader"),this.id=vi++,this.vertexSrc=d||T.defaultVertexSrc,this.fragmentSrc=c||T.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(f=f.replace(/\s+/g,"-"),ii[f]?(ii[f]++,f+="-"+ii[f]):ii[f]=1,this.vertexSrc="#define SHADER_NAME "+f+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+f+`
`+this.fragmentSrc,this.vertexSrc=xt(this.vertexSrc,M.b.PRECISION_VERTEX,I.m.HIGH),this.fragmentSrc=xt(this.fragmentSrc,M.b.PRECISION_FRAGMENT,lt())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(T,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(T,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`},enumerable:!1,configurable:!0}),T.from=function(d,c,f){var S=d+c,B=pe[S];return B||(pe[S]=B=new T(d,c,f)),B},T}(),Bi=function(){function T(d,c){this.uniformBindCount=0,this.program=d,this.uniformGroup=c?c instanceof bi?c:new bi(c):new bi({})}return T.prototype.checkUniformExists=function(d,c){if(c.uniforms[d])return!0;for(var f in c.uniforms){var S=c.uniforms[f];if(S.group&&this.checkUniformExists(d,S))return!0}return!1},T.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(T.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),T.from=function(d,c,f){return new T(Fi.from(d,c),f)},T}(),ui=function(){function T(){this.data=0,this.blendMode=I.b.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(T.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(d){!!(1&this.data)!==d&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(d){!!(2&this.data)!==d&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(d){!!(4&this.data)!==d&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(d){!!(8&this.data)!==d&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(d){!!(32&this.data)!==d&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(d){!!(16&this.data)!==d&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"blendMode",{get:function(){return this._blendMode},set:function(d){this.blend=d!==I.b.NONE,this._blendMode=d},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(d){this.offsets=!!d,this._polygonOffset=d},enumerable:!1,configurable:!0}),T.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},T.for2d=function(){var d=new T;return d.depthTest=!1,d.blend=!0,d},T}(),Ti=function(T){function d(c,f,S){var B=this,Q=Fi.from(c||d.defaultVertexSrc,f||d.defaultFragmentSrc);return(B=T.call(this,Q,S)||this).padding=0,B.resolution=M.b.FILTER_RESOLUTION,B.multisample=M.b.FILTER_MULTISAMPLE,B.enabled=!0,B.autoFit=!0,B.state=new ui,B}return Bn(d,T),d.prototype.apply=function(c,f,S,B,Q){c.applyFilter(this,f,S,B)},Object.defineProperty(d.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(c){this.state.blendMode=c},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"resolution",{get:function(){return this._resolution},set:function(c){this._resolution=c},enumerable:!1,configurable:!0}),Object.defineProperty(d,"defaultVertexSrc",{get:function(){return`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`},enumerable:!1,configurable:!0}),Object.defineProperty(d,"defaultFragmentSrc",{get:function(){return`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`},enumerable:!1,configurable:!0}),d}(Bi),yr=new we,kr=function(){function T(d,c){this._texture=d,this.mapCoord=new we,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=c===void 0?.5:c,this.isSimple=!1}return Object.defineProperty(T.prototype,"texture",{get:function(){return this._texture},set:function(d){this._texture=d,this._textureID=-1},enumerable:!1,configurable:!0}),T.prototype.multiplyUvs=function(d,c){c===void 0&&(c=d);for(var f=this.mapCoord,S=0;S<d.length;S+=2){var B=d[S],Q=d[S+1];c[S]=B*f.a+Q*f.c+f.tx,c[S+1]=B*f.b+Q*f.d+f.ty}return c},T.prototype.update=function(d){var c=this._texture;if(!c||!c.valid||!d&&this._textureID===c._updateID)return!1;this._textureID=c._updateID,this._updateID++;var f=c._uvs;this.mapCoord.set(f.x1-f.x0,f.y1-f.y0,f.x3-f.x0,f.y3-f.y0,f.x0,f.y0);var S=c.orig,B=c.trim;B&&(yr.set(S.width/B.width,0,0,S.height/B.height,-B.x/B.width,-B.y/B.height),this.mapCoord.append(yr));var Q=c.baseTexture,ot=this.uClampFrame,ut=this.clampMargin/Q.resolution,It=this.clampOffset;return ot[0]=(c._frame.x+ut+It)/Q.width,ot[1]=(c._frame.y+ut+It)/Q.height,ot[2]=(c._frame.x+c._frame.width-ut+It)/Q.width,ot[3]=(c._frame.y+c._frame.height-ut+It)/Q.height,this.uClampOffset[0]=It/Q.realWidth,this.uClampOffset[1]=It/Q.realHeight,this.isSimple=c._frame.width===Q.width&&c._frame.height===Q.height&&c.rotate===0,!0},T}(),rs=function(T){function d(c,f,S){var B=this,Q=null;return typeof c!="string"&&f===void 0&&S===void 0&&(Q=c,c=void 0,f=void 0,S=void 0),(B=T.call(this,c||`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,f||`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,S)||this).maskSprite=Q,B.maskMatrix=new we,B}return Bn(d,T),Object.defineProperty(d.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(c){this._maskSprite=c,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),d.prototype.apply=function(c,f,S,B){var Q=this._maskSprite,ot=Q._texture;ot.valid&&(ot.uvMatrix||(ot.uvMatrix=new kr(ot,0)),ot.uvMatrix.update(),this.uniforms.npmAlpha=ot.baseTexture.alphaMode?0:1,this.uniforms.mask=ot,this.uniforms.otherMatrix=c.calculateSpriteMatrix(this.maskMatrix,Q).prepend(ot.uvMatrix.mapCoord),this.uniforms.alpha=Q.worldAlpha,this.uniforms.maskClamp=ot.uvMatrix.uClampFrame,c.applyFilter(this,f,S,B))},d}(Ti),os=function(){function T(d){this.renderer=d,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return T.prototype.setMaskStack=function(d){this.maskStack=d,this.renderer.scissor.setMaskStack(d),this.renderer.stencil.setMaskStack(d)},T.prototype.push=function(d,c){var f=c;if(!f.isMaskData){var S=this.maskDataPool.pop()||new Oo;S.pooled=!0,S.maskObject=c,f=S}var B=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(f.copyCountersOrReset(B),f.autoDetect&&this.detect(f),f._target=d,f.type!==I.j.SPRITE&&this.maskStack.push(f),f.enabled)switch(f.type){case I.j.SCISSOR:this.renderer.scissor.push(f);break;case I.j.STENCIL:this.renderer.stencil.push(f);break;case I.j.SPRITE:f.copyCountersOrReset(null),this.pushSpriteMask(f)}f.type===I.j.SPRITE&&this.maskStack.push(f)},T.prototype.pop=function(d){var c=this.maskStack.pop();if(c&&c._target===d){if(c.enabled)switch(c.type){case I.j.SCISSOR:this.renderer.scissor.pop();break;case I.j.STENCIL:this.renderer.stencil.pop(c.maskObject);break;case I.j.SPRITE:this.popSpriteMask(c)}if(c.reset(),c.pooled&&this.maskDataPool.push(c),this.maskStack.length!==0){var f=this.maskStack[this.maskStack.length-1];f.type===I.j.SPRITE&&f._filters&&(f._filters[0].maskSprite=f.maskObject)}}},T.prototype.detect=function(d){d.maskObject.isSprite?d.type=I.j.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(d)?d.type=I.j.SCISSOR:d.type=I.j.STENCIL},T.prototype.pushSpriteMask=function(d){var c,f,S=d.maskObject,B=d._target,Q=d._filters;Q||(Q=this.alphaMaskPool[this.alphaMaskIndex])||(Q=this.alphaMaskPool[this.alphaMaskIndex]=[new rs]);var ot,ut,It=this.renderer,Ut=It.renderTexture;if(Ut.current){var he=Ut.current;ot=d.resolution||he.resolution,ut=(c=d.multisample)!==null&&c!==void 0?c:he.multisample}else ot=d.resolution||It.resolution,ut=(f=d.multisample)!==null&&f!==void 0?f:It.multisample;Q[0].resolution=ot,Q[0].multisample=ut,Q[0].maskSprite=S;var te=B.filterArea;B.filterArea=S.getBounds(!0),It.filter.push(B,Q),B.filterArea=te,d._filters||this.alphaMaskIndex++},T.prototype.popSpriteMask=function(d){this.renderer.filter.pop(),d._filters?d._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},T.prototype.destroy=function(){this.renderer=null},T}(),Pr=function(){function T(d){this.renderer=d,this.maskStack=[],this.glConst=0}return T.prototype.getStackLength=function(){return this.maskStack.length},T.prototype.setMaskStack=function(d){var c=this.renderer.gl,f=this.getStackLength();this.maskStack=d;var S=this.getStackLength();S!==f&&(S===0?c.disable(this.glConst):(c.enable(this.glConst),this._useCurrent()))},T.prototype._useCurrent=function(){},T.prototype.destroy=function(){this.renderer=null,this.maskStack=null},T}(),On=new we,sn=function(T){function d(c){var f=T.call(this,c)||this;return f.glConst=WebGLRenderingContext.SCISSOR_TEST,f}return Bn(d,T),d.prototype.getStackLength=function(){var c=this.maskStack[this.maskStack.length-1];return c?c._scissorCounter:0},d.prototype.calcScissorRect=function(c){if(!c._scissorRectLocal){var f=c._scissorRect,S=c.maskObject,B=this.renderer,Q=B.renderTexture;S.renderable=!0;var ot=S.getBounds();this.roundFrameToPixels(ot,Q.current?Q.current.resolution:B.resolution,Q.sourceFrame,Q.destinationFrame,B.projection.transform),S.renderable=!1,f&&ot.fit(f),c._scissorRectLocal=ot}},d.isMatrixRotated=function(c){if(!c)return!1;var f=c.a,S=c.b,B=c.c,Q=c.d;return(Math.abs(S)>1e-4||Math.abs(B)>1e-4)&&(Math.abs(f)>1e-4||Math.abs(Q)>1e-4)},d.prototype.testScissor=function(c){var f=c.maskObject;if(!f.isFastRect||!f.isFastRect()||d.isMatrixRotated(f.worldTransform)||d.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(c);var S=c._scissorRectLocal;return S.width>0&&S.height>0},d.prototype.roundFrameToPixels=function(c,f,S,B,Q){d.isMatrixRotated(Q)||((Q=Q?On.copyFrom(Q):On.identity()).translate(-S.x,-S.y).scale(B.width/S.width,B.height/S.height).translate(B.x,B.y),this.renderer.filter.transformAABB(Q,c),c.fit(B),c.x=Math.round(c.x*f),c.y=Math.round(c.y*f),c.width=Math.round(c.width*f),c.height=Math.round(c.height*f))},d.prototype.push=function(c){c._scissorRectLocal||this.calcScissorRect(c);var f=this.renderer.gl;c._scissorRect||f.enable(f.SCISSOR_TEST),c._scissorCounter++,c._scissorRect=c._scissorRectLocal,this._useCurrent()},d.prototype.pop=function(){var c=this.renderer.gl;this.getStackLength()>0?this._useCurrent():c.disable(c.SCISSOR_TEST)},d.prototype._useCurrent=function(){var c,f=this.maskStack[this.maskStack.length-1]._scissorRect;c=this.renderer.renderTexture.current?f.y:this.renderer.height-f.height-f.y,this.renderer.gl.scissor(f.x,c,f.width,f.height)},d}(Pr),Or=function(T){function d(c){var f=T.call(this,c)||this;return f.glConst=WebGLRenderingContext.STENCIL_TEST,f}return Bn(d,T),d.prototype.getStackLength=function(){var c=this.maskStack[this.maskStack.length-1];return c?c._stencilCounter:0},d.prototype.push=function(c){var f=c.maskObject,S=this.renderer.gl,B=c._stencilCounter;B===0&&(this.renderer.framebuffer.forceStencil(),S.clearStencil(0),S.clear(S.STENCIL_BUFFER_BIT),S.enable(S.STENCIL_TEST)),c._stencilCounter++,S.colorMask(!1,!1,!1,!1),S.stencilFunc(S.EQUAL,B,4294967295),S.stencilOp(S.KEEP,S.KEEP,S.INCR),f.renderable=!0,f.render(this.renderer),this.renderer.batch.flush(),f.renderable=!1,this._useCurrent()},d.prototype.pop=function(c){var f=this.renderer.gl;this.getStackLength()===0?f.disable(f.STENCIL_TEST):(f.colorMask(!1,!1,!1,!1),f.stencilOp(f.KEEP,f.KEEP,f.DECR),c.renderable=!0,c.render(this.renderer),this.renderer.batch.flush(),c.renderable=!1,this._useCurrent())},d.prototype._useCurrent=function(){var c=this.renderer.gl;c.colorMask(!0,!0,!0,!0),c.stencilFunc(c.EQUAL,this.getStackLength(),4294967295),c.stencilOp(c.KEEP,c.KEEP,c.KEEP)},d}(Pr),Jh=function(){function T(d){this.renderer=d,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new we,this.transform=null}return T.prototype.update=function(d,c,f,S){this.destinationFrame=d||this.destinationFrame||this.defaultFrame,this.sourceFrame=c||this.sourceFrame||d,this.calculateProjection(this.destinationFrame,this.sourceFrame,f,S),this.transform&&this.projectionMatrix.append(this.transform);var B=this.renderer;B.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,B.globalUniforms.update(),B.shader.shader&&B.shader.syncUniformGroup(B.shader.shader.uniforms.globals)},T.prototype.calculateProjection=function(d,c,f,S){var B=this.projectionMatrix,Q=S?-1:1;B.identity(),B.a=1/c.width*2,B.d=Q*(1/c.height*2),B.tx=-1-c.x*B.a,B.ty=-Q-c.y*B.d},T.prototype.setTransform=function(d){},T.prototype.destroy=function(){this.renderer=null},T}(),uo=new oe,ss=new oe,Kh=function(){function T(d){this.renderer=d,this.clearColor=d._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new oe,this.destinationFrame=new oe,this.viewportFrame=new oe}return T.prototype.bind=function(d,c,f){d===void 0&&(d=null);var S,B,Q,ot=this.renderer;this.current=d,d?(Q=(S=d.baseTexture).resolution,c||(uo.width=d.frame.width,uo.height=d.frame.height,c=uo),f||(ss.x=d.frame.x,ss.y=d.frame.y,ss.width=c.width,ss.height=c.height,f=ss),B=S.framebuffer):(Q=ot.resolution,c||(uo.width=ot.screen.width,uo.height=ot.screen.height,c=uo),f||((f=uo).width=c.width,f.height=c.height));var ut=this.viewportFrame;ut.x=f.x*Q,ut.y=f.y*Q,ut.width=f.width*Q,ut.height=f.height*Q,d||(ut.y=ot.view.height-(ut.y+ut.height)),ut.ceil(),this.renderer.framebuffer.bind(B,ut),this.renderer.projection.update(f,c,Q,!B),d?this.renderer.mask.setMaskStack(S.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(c),this.destinationFrame.copyFrom(f)},T.prototype.clear=function(d,c){d=this.current?d||this.current.baseTexture.clearColor:d||this.clearColor;var f=this.destinationFrame,S=this.current?this.current.baseTexture:this.renderer.screen,B=f.width!==S.width||f.height!==S.height;if(B){var Q=this.viewportFrame,ot=Q.x,ut=Q.y,It=Q.width,Ut=Q.height;ot=Math.round(ot),ut=Math.round(ut),It=Math.round(It),Ut=Math.round(Ut),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(ot,ut,It,Ut)}this.renderer.framebuffer.clear(d[0],d[1],d[2],d[3],c),B&&this.renderer.scissor.pop()},T.prototype.resize=function(){this.bind(null)},T.prototype.reset=function(){this.bind(null)},T.prototype.destroy=function(){this.renderer=null},T}();function Zh(T,d,c,f,S){c.buffer.update(S)}var Qh={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},dl={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function $h(T,d){if(!T.autoManage)return{size:0,syncFunc:Zh};for(var c=function(Je){for(var je=Je.map(function(bn){return{data:bn,offset:0,dataLen:0,dirty:0}}),pn=0,_n=0,Gn=0,Fn=0;Fn<je.length;Fn++){var Xe=je[Fn];if(pn=dl[Xe.data.type],Xe.data.size>1&&(pn=Math.max(pn,16)*Xe.data.size),Xe.dataLen=pn,_n%pn!=0&&_n<16){var an=_n%pn%16;_n+=an,Gn+=an}_n+pn>16?(Gn=16*Math.ceil(Gn/16),Xe.offset=Gn,Gn+=pn,_n=pn):(Xe.offset=Gn,_n+=pn,Gn+=pn)}return{uboElements:je,size:Gn=16*Math.ceil(Gn/16)}}(function(Je,je){var pn=[];for(var _n in Je)je[_n]&&pn.push(je[_n]);return pn.sort(function(Gn,Fn){return Gn.index-Fn.index}),pn}(T.uniforms,d)),f=c.uboElements,S=c.size,B=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],Q=0;Q<f.length;Q++){for(var ot=f[Q],ut=T.uniforms[ot.data.name],It=ot.data.name,Ut=!1,he=0;he<Qe.length;he++){var te=Qe[he];if(te.codeUbo&&te.test(ot.data,ut)){B.push("offset = "+ot.offset/4+";",Qe[he].codeUbo(ot.data.name,ut)),Ut=!0;break}}if(!Ut)if(ot.data.size>1){var me=Zt(ot.data.type),xe=Math.max(dl[ot.data.type]/16,1),Be=me/xe,qe=(4-Be%4)%4;B.push(`
                cv = ud.`+It+`.value;
                v = uv.`+It+`;
                offset = `+ot.offset/4+`;

                t = 0;

                for(var i=0; i < `+ot.data.size*xe+`; i++)
                {
                    for(var j = 0; j < `+Be+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+qe+`;
                }

                `)}else{var Ye=Qh[ot.data.type];B.push(`
                cv = ud.`+It+`.value;
                v = uv.`+It+`;
                offset = `+ot.offset/4+`;
                `+Ye+`;
                `)}}return B.push(`
       renderer.buffer.update(buffer);
    `),{size:S,syncFunc:new Function("ud","uv","renderer","syncData","buffer",B.join(`
`))}}var tu=function(){function T(d,c){this.program=d,this.uniformData=c,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return T.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},T}();function eu(T,d){var c=No(T,T.VERTEX_SHADER,d.vertexSrc),f=No(T,T.FRAGMENT_SHADER,d.fragmentSrc),S=T.createProgram();if(T.attachShader(S,c),T.attachShader(S,f),T.linkProgram(S),T.getProgramParameter(S,T.LINK_STATUS)||function(It,Ut,he,te){It.getProgramParameter(Ut,It.LINK_STATUS)||(It.getShaderParameter(he,It.COMPILE_STATUS)||q(It,he),It.getShaderParameter(te,It.COMPILE_STATUS)||q(It,te),console.error("PixiJS Error: Could not initialize shader."),It.getProgramInfoLog(Ut)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",It.getProgramInfoLog(Ut)))}(T,S,c,f),d.attributeData=function(It,Ut){for(var he={},te=Ut.getProgramParameter(It,Ut.ACTIVE_ATTRIBUTES),me=0;me<te;me++){var xe=Ut.getActiveAttrib(It,me);if(xe.name.indexOf("gl_")!==0){var Be=Te(Ut,xe.type),qe={type:Be,name:xe.name,size:Zt(Be),location:Ut.getAttribLocation(It,xe.name)};he[xe.name]=qe}}return he}(S,T),d.uniformData=function(It,Ut){for(var he={},te=Ut.getProgramParameter(It,Ut.ACTIVE_UNIFORMS),me=0;me<te;me++){var xe=Ut.getActiveUniform(It,me),Be=xe.name.replace(/\[.*?\]$/,""),qe=!!xe.name.match(/\[.*?\]$/),Ye=Te(Ut,xe.type);he[Be]={name:Be,index:me,type:Ye,size:xe.size,isArray:qe,value:m(Ye,xe.size)}}return he}(S,T),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(d.vertexSrc)){var B=Object.keys(d.attributeData);B.sort(function(It,Ut){return It>Ut?1:-1});for(var Q=0;Q<B.length;Q++)d.attributeData[B[Q]].location=Q,T.bindAttribLocation(S,Q,B[Q]);T.linkProgram(S)}T.deleteShader(c),T.deleteShader(f);var ot={};for(var Q in d.uniformData){var ut=d.uniformData[Q];ot[Q]={location:T.getUniformLocation(S,Q),value:m(ut.type,ut.size)}}return new tu(S,ot)}var nu=0,Ss={textureCount:0,uboCount:0},iu=function(){function T(d){this.destroyed=!1,this.renderer=d,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=nu++}return T.prototype.systemCheck=function(){if(!function(){if(typeof un=="boolean")return un;try{var d=new Function("param1","param2","param3","return param1[param2] === param3;");un=d({a:"b"},"a","b")===!0}catch{un=!1}return un}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},T.prototype.contextChange=function(d){this.gl=d,this.reset()},T.prototype.bind=function(d,c){d.uniforms.globals=this.renderer.globalUniforms;var f=d.program,S=f.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(d);return this.shader=d,this.program!==f&&(this.program=f,this.gl.useProgram(S.program)),c||(Ss.textureCount=0,Ss.uboCount=0,this.syncUniformGroup(d.uniformGroup,Ss)),S},T.prototype.setUniforms=function(d){var c=this.shader.program,f=c.glPrograms[this.renderer.CONTEXT_UID];c.syncUniforms(f.uniformData,d,this.renderer)},T.prototype.syncUniformGroup=function(d,c){var f=this.getGlProgram();d.static&&d.dirtyId===f.uniformDirtyGroups[d.id]||(f.uniformDirtyGroups[d.id]=d.dirtyId,this.syncUniforms(d,f,c))},T.prototype.syncUniforms=function(d,c,f){(d.syncUniforms[this.shader.program.id]||this.createSyncGroups(d))(c.uniformData,d.uniforms,this.renderer,f)},T.prototype.createSyncGroups=function(d){var c=this.getSignature(d,this.shader.program.uniformData,"u");return this.cache[c]||(this.cache[c]=function(f,S){var B,Q=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var ot in f.uniforms){var ut=S[ot];if(ut){for(var It=f.uniforms[ot],Ut=!1,he=0;he<Qe.length;he++)if(Qe[he].test(ut,It)){Q.push(Qe[he].code(ot,It)),Ut=!0;break}if(!Ut){var te=(ut.size===1?hn:vn)[ut.type].replace("location",'ud["'+ot+'"].location');Q.push(`
            cu = ud["`+ot+`"];
            cv = cu.value;
            v = uv["`+ot+`"];
            `+te+";")}}else!((B=f.uniforms[ot])===null||B===void 0)&&B.group&&(f.uniforms[ot].ubo?Q.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+ot+", '"+ot+`');
                    `):Q.push(`
                        renderer.shader.syncUniformGroup(uv.`+ot+`, syncData);
                    `))}return new Function("ud","uv","renderer","syncData",Q.join(`
`))}(d,this.shader.program.uniformData)),d.syncUniforms[this.shader.program.id]=this.cache[c],d.syncUniforms[this.shader.program.id]},T.prototype.syncUniformBufferGroup=function(d,c){var f=this.getGlProgram();if(!d.static||d.dirtyId!==0||!f.uniformGroups[d.id]){d.dirtyId=0;var S=f.uniformGroups[d.id]||this.createSyncBufferGroup(d,f,c);d.buffer.update(),S(f.uniformData,d.uniforms,this.renderer,Ss,d.buffer)}this.renderer.buffer.bindBufferBase(d.buffer,f.uniformBufferBindings[c])},T.prototype.createSyncBufferGroup=function(d,c,f){var S=this.renderer.gl;this.renderer.buffer.bind(d.buffer);var B=this.gl.getUniformBlockIndex(c.program,f);c.uniformBufferBindings[f]=this.shader.uniformBindCount,S.uniformBlockBinding(c.program,B,this.shader.uniformBindCount),this.shader.uniformBindCount++;var Q=this.getSignature(d,this.shader.program.uniformData,"ubo"),ot=this._uboCache[Q];if(ot||(ot=this._uboCache[Q]=$h(d,this.shader.program.uniformData)),d.autoManage){var ut=new Float32Array(ot.size/4);d.buffer.update(ut)}return c.uniformGroups[d.id]=ot.syncFunc,c.uniformGroups[d.id]},T.prototype.getSignature=function(d,c,f){var S=d.uniforms,B=[f+"-"];for(var Q in S)B.push(Q),c[Q]&&B.push(c[Q].type);return B.join("-")},T.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},T.prototype.generateProgram=function(d){var c=this.gl,f=d.program,S=eu(c,f);return f.glPrograms[this.renderer.CONTEXT_UID]=S,S},T.prototype.reset=function(){this.program=null,this.shader=null},T.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},T}(),ru=function(){function T(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=I.b.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new ui,this.defaultState.blend=!0}return T.prototype.contextChange=function(d){this.gl=d,this.blendModes=function(c,f){return f===void 0&&(f=[]),f[I.b.NORMAL]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.ADD]=[c.ONE,c.ONE],f[I.b.MULTIPLY]=[c.DST_COLOR,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.SCREEN]=[c.ONE,c.ONE_MINUS_SRC_COLOR,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.OVERLAY]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.DARKEN]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.LIGHTEN]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.COLOR_DODGE]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.COLOR_BURN]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.HARD_LIGHT]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.SOFT_LIGHT]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.DIFFERENCE]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.EXCLUSION]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.HUE]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.SATURATION]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.COLOR]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.LUMINOSITY]=[c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.NONE]=[0,0],f[I.b.NORMAL_NPM]=[c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.ADD_NPM]=[c.SRC_ALPHA,c.ONE,c.ONE,c.ONE],f[I.b.SCREEN_NPM]=[c.SRC_ALPHA,c.ONE_MINUS_SRC_COLOR,c.ONE,c.ONE_MINUS_SRC_ALPHA],f[I.b.SRC_IN]=[c.DST_ALPHA,c.ZERO],f[I.b.SRC_OUT]=[c.ONE_MINUS_DST_ALPHA,c.ZERO],f[I.b.SRC_ATOP]=[c.DST_ALPHA,c.ONE_MINUS_SRC_ALPHA],f[I.b.DST_OVER]=[c.ONE_MINUS_DST_ALPHA,c.ONE],f[I.b.DST_IN]=[c.ZERO,c.SRC_ALPHA],f[I.b.DST_OUT]=[c.ZERO,c.ONE_MINUS_SRC_ALPHA],f[I.b.DST_ATOP]=[c.ONE_MINUS_DST_ALPHA,c.SRC_ALPHA],f[I.b.XOR]=[c.ONE_MINUS_DST_ALPHA,c.ONE_MINUS_SRC_ALPHA],f[I.b.SUBTRACT]=[c.ONE,c.ONE,c.ONE,c.ONE,c.FUNC_REVERSE_SUBTRACT,c.FUNC_ADD],f}(d),this.set(this.defaultState),this.reset()},T.prototype.set=function(d){if(d=d||this.defaultState,this.stateId!==d.data){for(var c=this.stateId^d.data,f=0;c;)1&c&&this.map[f].call(this,!!(d.data&1<<f)),c>>=1,f++;this.stateId=d.data}for(f=0;f<this.checks.length;f++)this.checks[f](this,d)},T.prototype.forceState=function(d){d=d||this.defaultState;for(var c=0;c<this.map.length;c++)this.map[c].call(this,!!(d.data&1<<c));for(c=0;c<this.checks.length;c++)this.checks[c](this,d);this.stateId=d.data},T.prototype.setBlend=function(d){this.updateCheck(T.checkBlendMode,d),this.gl[d?"enable":"disable"](this.gl.BLEND)},T.prototype.setOffset=function(d){this.updateCheck(T.checkPolygonOffset,d),this.gl[d?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},T.prototype.setDepthTest=function(d){this.gl[d?"enable":"disable"](this.gl.DEPTH_TEST)},T.prototype.setDepthMask=function(d){this.gl.depthMask(d)},T.prototype.setCullFace=function(d){this.gl[d?"enable":"disable"](this.gl.CULL_FACE)},T.prototype.setFrontFace=function(d){this.gl.frontFace(this.gl[d?"CW":"CCW"])},T.prototype.setBlendMode=function(d){if(d!==this.blendMode){this.blendMode=d;var c=this.blendModes[d],f=this.gl;c.length===2?f.blendFunc(c[0],c[1]):f.blendFuncSeparate(c[0],c[1],c[2],c[3]),c.length===6?(this._blendEq=!0,f.blendEquationSeparate(c[4],c[5])):this._blendEq&&(this._blendEq=!1,f.blendEquationSeparate(f.FUNC_ADD,f.FUNC_ADD))}},T.prototype.setPolygonOffset=function(d,c){this.gl.polygonOffset(d,c)},T.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},T.prototype.updateCheck=function(d,c){var f=this.checks.indexOf(d);c&&f===-1?this.checks.push(d):c||f===-1||this.checks.splice(f,1)},T.checkBlendMode=function(d,c){d.setBlendMode(c.blendMode)},T.checkPolygonOffset=function(d,c){d.setPolygonOffset(1,c.polygonOffset)},T.prototype.destroy=function(){this.gl=null},T}(),pl=function(){function T(d){this.renderer=d,this.count=0,this.checkCount=0,this.maxIdle=M.b.GC_MAX_IDLE,this.checkCountMax=M.b.GC_MAX_CHECK_COUNT,this.mode=M.b.GC_MODE}return T.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==I.i.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},T.prototype.run=function(){for(var d=this.renderer.texture,c=d.managedTextures,f=!1,S=0;S<c.length;S++){var B=c[S];!B.framebuffer&&this.count-B.touched>this.maxIdle&&(d.destroyTexture(B,!0),c[S]=null,f=!0)}if(f){var Q=0;for(S=0;S<c.length;S++)c[S]!==null&&(c[Q++]=c[S]);c.length=Q}},T.prototype.unload=function(d){var c=this.renderer.texture,f=d._texture;f&&!f.framebuffer&&c.destroyTexture(f);for(var S=d.children.length-1;S>=0;S--)this.unload(d.children[S])},T.prototype.destroy=function(){this.renderer=null},T}(),ws=function(T){this.texture=T,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=I.r.UNSIGNED_BYTE,this.internalFormat=I.h.RGBA,this.samplerType=0},fl=function(){function T(d){this.renderer=d,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new zn,this.hasIntegerTextures=!1}return T.prototype.contextChange=function(){var d=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(B){var Q,ot,ut,It,Ut,he,te,me,xe,Be,qe,Ye,Je,je,pn,_n,Gn,Fn,Xe,an,bn,Hn,Jn;return"WebGL2RenderingContext"in globalThis&&B instanceof globalThis.WebGL2RenderingContext?((Q={})[I.r.UNSIGNED_BYTE]=((ot={})[I.h.RGBA]=B.RGBA8,ot[I.h.RGB]=B.RGB8,ot[I.h.RG]=B.RG8,ot[I.h.RED]=B.R8,ot[I.h.RGBA_INTEGER]=B.RGBA8UI,ot[I.h.RGB_INTEGER]=B.RGB8UI,ot[I.h.RG_INTEGER]=B.RG8UI,ot[I.h.RED_INTEGER]=B.R8UI,ot[I.h.ALPHA]=B.ALPHA,ot[I.h.LUMINANCE]=B.LUMINANCE,ot[I.h.LUMINANCE_ALPHA]=B.LUMINANCE_ALPHA,ot),Q[I.r.BYTE]=((ut={})[I.h.RGBA]=B.RGBA8_SNORM,ut[I.h.RGB]=B.RGB8_SNORM,ut[I.h.RG]=B.RG8_SNORM,ut[I.h.RED]=B.R8_SNORM,ut[I.h.RGBA_INTEGER]=B.RGBA8I,ut[I.h.RGB_INTEGER]=B.RGB8I,ut[I.h.RG_INTEGER]=B.RG8I,ut[I.h.RED_INTEGER]=B.R8I,ut),Q[I.r.UNSIGNED_SHORT]=((It={})[I.h.RGBA_INTEGER]=B.RGBA16UI,It[I.h.RGB_INTEGER]=B.RGB16UI,It[I.h.RG_INTEGER]=B.RG16UI,It[I.h.RED_INTEGER]=B.R16UI,It[I.h.DEPTH_COMPONENT]=B.DEPTH_COMPONENT16,It),Q[I.r.SHORT]=((Ut={})[I.h.RGBA_INTEGER]=B.RGBA16I,Ut[I.h.RGB_INTEGER]=B.RGB16I,Ut[I.h.RG_INTEGER]=B.RG16I,Ut[I.h.RED_INTEGER]=B.R16I,Ut),Q[I.r.UNSIGNED_INT]=((he={})[I.h.RGBA_INTEGER]=B.RGBA32UI,he[I.h.RGB_INTEGER]=B.RGB32UI,he[I.h.RG_INTEGER]=B.RG32UI,he[I.h.RED_INTEGER]=B.R32UI,he[I.h.DEPTH_COMPONENT]=B.DEPTH_COMPONENT24,he),Q[I.r.INT]=((te={})[I.h.RGBA_INTEGER]=B.RGBA32I,te[I.h.RGB_INTEGER]=B.RGB32I,te[I.h.RG_INTEGER]=B.RG32I,te[I.h.RED_INTEGER]=B.R32I,te),Q[I.r.FLOAT]=((me={})[I.h.RGBA]=B.RGBA32F,me[I.h.RGB]=B.RGB32F,me[I.h.RG]=B.RG32F,me[I.h.RED]=B.R32F,me[I.h.DEPTH_COMPONENT]=B.DEPTH_COMPONENT32F,me),Q[I.r.HALF_FLOAT]=((xe={})[I.h.RGBA]=B.RGBA16F,xe[I.h.RGB]=B.RGB16F,xe[I.h.RG]=B.RG16F,xe[I.h.RED]=B.R16F,xe),Q[I.r.UNSIGNED_SHORT_5_6_5]=((Be={})[I.h.RGB]=B.RGB565,Be),Q[I.r.UNSIGNED_SHORT_4_4_4_4]=((qe={})[I.h.RGBA]=B.RGBA4,qe),Q[I.r.UNSIGNED_SHORT_5_5_5_1]=((Ye={})[I.h.RGBA]=B.RGB5_A1,Ye),Q[I.r.UNSIGNED_INT_2_10_10_10_REV]=((Je={})[I.h.RGBA]=B.RGB10_A2,Je[I.h.RGBA_INTEGER]=B.RGB10_A2UI,Je),Q[I.r.UNSIGNED_INT_10F_11F_11F_REV]=((je={})[I.h.RGB]=B.R11F_G11F_B10F,je),Q[I.r.UNSIGNED_INT_5_9_9_9_REV]=((pn={})[I.h.RGB]=B.RGB9_E5,pn),Q[I.r.UNSIGNED_INT_24_8]=((_n={})[I.h.DEPTH_STENCIL]=B.DEPTH24_STENCIL8,_n),Q[I.r.FLOAT_32_UNSIGNED_INT_24_8_REV]=((Gn={})[I.h.DEPTH_STENCIL]=B.DEPTH32F_STENCIL8,Gn),Jn=Q):((Fn={})[I.r.UNSIGNED_BYTE]=((Xe={})[I.h.RGBA]=B.RGBA,Xe[I.h.RGB]=B.RGB,Xe[I.h.ALPHA]=B.ALPHA,Xe[I.h.LUMINANCE]=B.LUMINANCE,Xe[I.h.LUMINANCE_ALPHA]=B.LUMINANCE_ALPHA,Xe),Fn[I.r.UNSIGNED_SHORT_5_6_5]=((an={})[I.h.RGB]=B.RGB,an),Fn[I.r.UNSIGNED_SHORT_4_4_4_4]=((bn={})[I.h.RGBA]=B.RGBA,bn),Fn[I.r.UNSIGNED_SHORT_5_5_5_1]=((Hn={})[I.h.RGBA]=B.RGBA,Hn),Jn=Fn),Jn}(d);var c=d.getParameter(d.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=c;for(var f=0;f<c;f++)this.boundTextures[f]=null;this.emptyTextures={};var S=new ws(d.createTexture());for(d.bindTexture(d.TEXTURE_2D,S.texture),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[d.TEXTURE_2D]=S,this.emptyTextures[d.TEXTURE_CUBE_MAP]=new ws(d.createTexture()),d.bindTexture(d.TEXTURE_CUBE_MAP,this.emptyTextures[d.TEXTURE_CUBE_MAP].texture),f=0;f<6;f++)d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,null);for(d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MIN_FILTER,d.LINEAR),f=0;f<this.boundTextures.length;f++)this.bind(null,f)},T.prototype.bind=function(d,c){c===void 0&&(c=0);var f=this.gl;if((d=d==null?void 0:d.castToBaseTexture())&&d.valid&&!d.parentTextureArray){d.touched=this.renderer.textureGC.count;var S=d._glTextures[this.CONTEXT_UID]||this.initTexture(d);this.boundTextures[c]!==d&&(this.currentLocation!==c&&(this.currentLocation=c,f.activeTexture(f.TEXTURE0+c)),f.bindTexture(d.target,S.texture)),S.dirtyId!==d.dirtyId&&(this.currentLocation!==c&&(this.currentLocation=c,f.activeTexture(f.TEXTURE0+c)),this.updateTexture(d)),this.boundTextures[c]=d}else this.currentLocation!==c&&(this.currentLocation=c,f.activeTexture(f.TEXTURE0+c)),f.bindTexture(f.TEXTURE_2D,this.emptyTextures[f.TEXTURE_2D].texture),this.boundTextures[c]=null},T.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var d=0;d<this.boundTextures.length;d++)this.boundTextures[d]=this.unknownTexture},T.prototype.unbind=function(d){var c=this.gl,f=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var S=0;S<f.length;S++)f[S]===this.unknownTexture&&this.bind(null,S)}for(S=0;S<f.length;S++)f[S]===d&&(this.currentLocation!==S&&(c.activeTexture(c.TEXTURE0+S),this.currentLocation=S),c.bindTexture(d.target,this.emptyTextures[d.target].texture),f[S]=null)},T.prototype.ensureSamplerType=function(d){var c=this.boundTextures,f=this.hasIntegerTextures,S=this.CONTEXT_UID;if(f)for(var B=d-1;B>=0;--B){var Q=c[B];Q&&Q._glTextures[S].samplerType!==I.o.FLOAT&&this.renderer.texture.unbind(Q)}},T.prototype.initTexture=function(d){var c=new ws(this.gl.createTexture());return c.dirtyId=-1,d._glTextures[this.CONTEXT_UID]=c,this.managedTextures.push(d),d.on("dispose",this.destroyTexture,this),c},T.prototype.initTextureType=function(d,c){var f,S;c.internalFormat=(S=(f=this.internalFormats[d.type])===null||f===void 0?void 0:f[d.format])!==null&&S!==void 0?S:d.format,this.webGLVersion===2&&d.type===I.r.HALF_FLOAT?c.type=this.gl.HALF_FLOAT:c.type=d.type},T.prototype.updateTexture=function(d){var c=d._glTextures[this.CONTEXT_UID];if(c){var f=this.renderer;if(this.initTextureType(d,c),d.resource&&d.resource.upload(f,d,c))c.samplerType!==I.o.FLOAT&&(this.hasIntegerTextures=!0);else{var S=d.realWidth,B=d.realHeight,Q=f.gl;(c.width!==S||c.height!==B||c.dirtyId<0)&&(c.width=S,c.height=B,Q.texImage2D(d.target,0,c.internalFormat,S,B,0,d.format,c.type,null))}d.dirtyStyleId!==c.dirtyStyleId&&this.updateTextureStyle(d),c.dirtyId=d.dirtyId}},T.prototype.destroyTexture=function(d,c){var f=this.gl;if((d=d.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(d),f.deleteTexture(d._glTextures[this.CONTEXT_UID].texture),d.off("dispose",this.destroyTexture,this),delete d._glTextures[this.CONTEXT_UID],!c)){var S=this.managedTextures.indexOf(d);S!==-1&&function(B,Q,ot){var ut,It=B.length;if(!(Q>=It||ot===0)){var Ut=It-(ot=Q+ot>It?It-Q:ot);for(ut=Q;ut<Ut;++ut)B[ut]=B[ut+ot];B.length=Ut}}(this.managedTextures,S,1)}},T.prototype.updateTextureStyle=function(d){var c=d._glTextures[this.CONTEXT_UID];c&&(d.mipmap!==I.k.POW2&&this.webGLVersion===2||d.isPowerOfTwo?c.mipmap=d.mipmap>=1:c.mipmap=!1,this.webGLVersion===2||d.isPowerOfTwo?c.wrapMode=d.wrapMode:c.wrapMode=I.s.CLAMP,d.resource&&d.resource.style(this.renderer,d,c)||this.setStyle(d,c),c.dirtyStyleId=d.dirtyStyleId)},T.prototype.setStyle=function(d,c){var f=this.gl;if(c.mipmap&&d.mipmap!==I.k.ON_MANUAL&&f.generateMipmap(d.target),f.texParameteri(d.target,f.TEXTURE_WRAP_S,c.wrapMode),f.texParameteri(d.target,f.TEXTURE_WRAP_T,c.wrapMode),c.mipmap){f.texParameteri(d.target,f.TEXTURE_MIN_FILTER,d.scaleMode===I.p.LINEAR?f.LINEAR_MIPMAP_LINEAR:f.NEAREST_MIPMAP_NEAREST);var S=this.renderer.context.extensions.anisotropicFiltering;if(S&&d.anisotropicLevel>0&&d.scaleMode===I.p.LINEAR){var B=Math.min(d.anisotropicLevel,f.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT));f.texParameterf(d.target,S.TEXTURE_MAX_ANISOTROPY_EXT,B)}}else f.texParameteri(d.target,f.TEXTURE_MIN_FILTER,d.scaleMode===I.p.LINEAR?f.LINEAR:f.NEAREST);f.texParameteri(d.target,f.TEXTURE_MAG_FILTER,d.scaleMode===I.p.LINEAR?f.LINEAR:f.NEAREST)},T.prototype.destroy=function(){this.renderer=null},T}(),pa=new we,ou=function(T){function d(c,f){c===void 0&&(c=I.n.UNKNOWN);var S=T.call(this)||this;return f=Object.assign({},M.b.RENDER_OPTIONS,f),S.options=f,S.type=c,S.screen=new oe(0,0,f.width,f.height),S.view=f.view||document.createElement("canvas"),S.resolution=f.resolution||M.b.RESOLUTION,S.useContextAlpha=f.useContextAlpha,S.autoDensity=!!f.autoDensity,S.preserveDrawingBuffer=f.preserveDrawingBuffer,S.clearBeforeRender=f.clearBeforeRender,S._backgroundColor=0,S._backgroundColorRgba=[0,0,0,1],S._backgroundColorString="#000000",S.backgroundColor=f.backgroundColor||S._backgroundColor,S.backgroundAlpha=f.backgroundAlpha,f.transparent!==void 0&&(Rn("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),S.useContextAlpha=f.transparent,S.backgroundAlpha=f.transparent?0:1),S._lastObjectRendered=null,S.plugins={},S}return Bn(d,T),d.prototype.initPlugins=function(c){for(var f in c)this.plugins[f]=new c[f](this)},Object.defineProperty(d.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),d.prototype.resize=function(c,f){this.view.width=Math.round(c*this.resolution),this.view.height=Math.round(f*this.resolution);var S=this.view.width/this.resolution,B=this.view.height/this.resolution;this.screen.width=S,this.screen.height=B,this.autoDensity&&(this.view.style.width=S+"px",this.view.style.height=B+"px"),this.emit("resize",S,B)},d.prototype.generateTexture=function(c,f,S,B){f===void 0&&(f={}),typeof f=="number"&&(Rn("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),f={scaleMode:f,resolution:S,region:B});var Q=f.region,ot=function(It,Ut){var he={};for(var te in It)Object.prototype.hasOwnProperty.call(It,te)&&Ut.indexOf(te)<0&&(he[te]=It[te]);if(It!=null&&typeof Object.getOwnPropertySymbols=="function"){var me=0;for(te=Object.getOwnPropertySymbols(It);me<te.length;me++)Ut.indexOf(te[me])<0&&(he[te[me]]=It[te[me]])}return he}(f,["region"]);(B=Q||c.getLocalBounds(null,!0)).width===0&&(B.width=1),B.height===0&&(B.height=1);var ut=lo.create(Qo({width:B.width,height:B.height},ot));return pa.tx=-B.x,pa.ty=-B.y,this.render(c,{renderTexture:ut,clear:!1,transform:pa,skipUpdateTransform:!!c.parent}),ut},d.prototype.destroy=function(c){for(var f in this.plugins)this.plugins[f].destroy(),this.plugins[f]=null;c&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=I.n.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(d.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(c){var f;this._backgroundColor=c,this._backgroundColorString=(f=c.toString(16),"#"+(f="000000".substring(0,6-f.length)+f)),function(S,B){B===void 0&&(B=[]),B[0]=(S>>16&255)/255,B[1]=(S>>8&255)/255,B[2]=(255&S)/255}(c,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(c){this._backgroundColorRgba[3]=c},enumerable:!1,configurable:!0}),d}(et),ml=function(T){this.buffer=T||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},gl=function(){function T(d){this.renderer=d,this.managedBuffers={},this.boundBufferBases={}}return T.prototype.destroy=function(){this.renderer=null},T.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},T.prototype.bind=function(d){var c=this.gl,f=this.CONTEXT_UID,S=d._glBuffers[f]||this.createGLBuffer(d);c.bindBuffer(d.type,S.buffer)},T.prototype.bindBufferBase=function(d,c){var f=this.gl,S=this.CONTEXT_UID;if(this.boundBufferBases[c]!==d){var B=d._glBuffers[S]||this.createGLBuffer(d);this.boundBufferBases[c]=d,f.bindBufferBase(f.UNIFORM_BUFFER,c,B.buffer)}},T.prototype.bindBufferRange=function(d,c,f){var S=this.gl,B=this.CONTEXT_UID;f=f||0;var Q=d._glBuffers[B]||this.createGLBuffer(d);S.bindBufferRange(S.UNIFORM_BUFFER,c||0,Q.buffer,256*f,256)},T.prototype.update=function(d){var c=this.gl,f=this.CONTEXT_UID,S=d._glBuffers[f];if(d._updateID!==S.updateID)if(S.updateID=d._updateID,c.bindBuffer(d.type,S.buffer),S.byteLength>=d.data.byteLength)c.bufferSubData(d.type,0,d.data);else{var B=d.static?c.STATIC_DRAW:c.DYNAMIC_DRAW;S.byteLength=d.data.byteLength,c.bufferData(d.type,d.data,B)}},T.prototype.dispose=function(d,c){if(this.managedBuffers[d.id]){delete this.managedBuffers[d.id];var f=d._glBuffers[this.CONTEXT_UID],S=this.gl;d.disposeRunner.remove(this),f&&(c||S.deleteBuffer(f.buffer),delete d._glBuffers[this.CONTEXT_UID])}},T.prototype.disposeAll=function(d){for(var c=Object.keys(this.managedBuffers),f=0;f<c.length;f++)this.dispose(this.managedBuffers[c[f]],d)},T.prototype.createGLBuffer=function(d){var c=this.CONTEXT_UID,f=this.gl;return d._glBuffers[c]=new ml(f.createBuffer()),this.managedBuffers[d.id]=d,d.disposeRunner.add(this),d._glBuffers[c]},T}();(function(T){function d(c){var f=T.call(this,I.n.WEBGL,c)||this;return c=f.options,f.gl=null,f.CONTEXT_UID=0,f.runners={destroy:new tn("destroy"),contextChange:new tn("contextChange"),reset:new tn("reset"),update:new tn("update"),postrender:new tn("postrender"),prerender:new tn("prerender"),resize:new tn("resize")},f.runners.contextChange.add(f),f.globalUniforms=new bi({projectionMatrix:new we},!0),f.addSystem(os,"mask").addSystem(Ur,"context").addSystem(ru,"state").addSystem(iu,"shader").addSystem(fl,"texture").addSystem(gl,"buffer").addSystem(Po,"geometry").addSystem(Ir,"framebuffer").addSystem(sn,"scissor").addSystem(Or,"stencil").addSystem(Jh,"projection").addSystem(pl,"textureGC").addSystem(ho,"filter").addSystem(Kh,"renderTexture").addSystem(Xn,"batch"),f.initPlugins(d.__plugins),f.multisample=void 0,c.context?f.context.initFromContext(c.context):f.context.initFromOptions({alpha:!!f.useContextAlpha,antialias:c.antialias,premultipliedAlpha:f.useContextAlpha&&f.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:c.preserveDrawingBuffer,powerPreference:f.options.powerPreference}),f.renderingToScreen=!0,function(S){var B;if(!_e){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var Q=[`
 %c %c %c PixiJS 6.4.2 - \u2730 `+S+` \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(B=globalThis.console).log.apply(B,Q)}else globalThis.console&&globalThis.console.log("PixiJS 6.4.2 - "+S+" - http://www.pixijs.com/");_e=!0}}(f.context.webGLVersion===2?"WebGL 2":"WebGL 1"),f.resize(f.options.width,f.options.height),f}Bn(d,T),d.create=function(c){if(at===void 0&&(at=function(){var f={stencil:!0,failIfMajorPerformanceCaveat:M.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!globalThis.WebGLRenderingContext)return!1;var S=document.createElement("canvas"),B=S.getContext("webgl",f)||S.getContext("experimental-webgl",f),Q=!(!B||!B.getContextAttributes().stencil);if(B){var ot=B.getExtension("WEBGL_lose_context");ot&&ot.loseContext()}return B=null,Q}catch{return!1}}()),at)return new d(c);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},d.prototype.contextChange=function(){var c,f=this.gl;if(this.context.webGLVersion===1){var S=f.getParameter(f.FRAMEBUFFER_BINDING);f.bindFramebuffer(f.FRAMEBUFFER,null),c=f.getParameter(f.SAMPLES),f.bindFramebuffer(f.FRAMEBUFFER,S)}else S=f.getParameter(f.DRAW_FRAMEBUFFER_BINDING),f.bindFramebuffer(f.DRAW_FRAMEBUFFER,null),c=f.getParameter(f.SAMPLES),f.bindFramebuffer(f.DRAW_FRAMEBUFFER,S);c>=I.l.HIGH?this.multisample=I.l.HIGH:c>=I.l.MEDIUM?this.multisample=I.l.MEDIUM:c>=I.l.LOW?this.multisample=I.l.LOW:this.multisample=I.l.NONE},d.prototype.addSystem=function(c,f){var S=new c(this);if(this[f])throw new Error('Whoops! The name "'+f+'" is already in use');for(var B in this[f]=S,this.runners)this.runners[B].add(S);return this},d.prototype.render=function(c,f){var S,B,Q,ot;if(f&&(f instanceof lo?(Rn("6.0.0","Renderer#render arguments changed, use options instead."),S=f,B=arguments[2],Q=arguments[3],ot=arguments[4]):(S=f.renderTexture,B=f.clear,Q=f.transform,ot=f.skipUpdateTransform)),this.renderingToScreen=!S,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=Q,!this.context.isLost){if(S||(this._lastObjectRendered=c),!ot){var ut=c.enableTempParent();c.updateTransform(),c.disableTempParent(ut)}this.renderTexture.bind(S),this.batch.currentRenderer.start(),(B!==void 0?B:this.clearBeforeRender)&&this.renderTexture.clear(),c.render(this),this.batch.currentRenderer.flush(),S&&S.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},d.prototype.generateTexture=function(c,f,S,B){f===void 0&&(f={});var Q=T.prototype.generateTexture.call(this,c,f,S,B);return this.framebuffer.blit(),Q},d.prototype.resize=function(c,f){T.prototype.resize.call(this,c,f),this.runners.resize.emit(this.screen.height,this.screen.width)},d.prototype.reset=function(){return this.runners.reset.emit(),this},d.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},d.prototype.destroy=function(c){for(var f in this.runners.destroy.emit(),this.runners)this.runners[f].destroy();T.prototype.destroy.call(this,c),this.gl=null},Object.defineProperty(d.prototype,"extract",{get:function(){return Rn("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),d.registerPlugin=function(c,f){d.__plugins=d.__plugins||{},d.__plugins[c]=f}})(ou);var vl=function(){this.texArray=null,this.blend=0,this.type=I.f.TRIANGLES,this.start=0,this.size=0,this.data=null},_l=function(){function T(){this.elements=[],this.ids=[],this.count=0}return T.prototype.clear=function(){for(var d=0;d<this.count;d++)this.elements[d]=null;this.count=0},T}(),yl=function(){function T(d){typeof d=="number"?this.rawBinaryData=new ArrayBuffer(d):d instanceof Uint8Array?this.rawBinaryData=d.buffer:this.rawBinaryData=d,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(T.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),T.prototype.view=function(d){return this[d+"View"]},T.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},T.sizeOf=function(d){switch(d){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(d+" isn't a valid view type")}},T}(),xl=function(T){function d(c){var f=T.call(this,c)||this;return f.shaderGenerator=null,f.geometryClass=null,f.vertexSize=null,f.state=ui.for2d(),f.size=4*M.b.SPRITE_BATCH_SIZE,f._vertexCount=0,f._indexCount=0,f._bufferedElements=[],f._bufferedTextures=[],f._bufferSize=0,f._shader=null,f._packedGeometries=[],f._packedGeometryPoolSize=2,f._flushId=0,f._aBuffers={},f._iBuffers={},f.MAX_TEXTURES=1,f.renderer.on("prerender",f.onPrerender,f),c.runners.contextChange.add(f),f._dcIndex=0,f._aIndex=0,f._iIndex=0,f._attributeBuffer=null,f._indexBuffer=null,f._tempBoundTextures=[],f}return Bn(d,T),d.prototype.contextChange=function(){var c=this.renderer.gl;M.b.PREFER_ENV===I.g.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),M.b.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(S,B){if(S===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var Q=B.createShader(B.FRAGMENT_SHADER);;){var ot=$n.replace(/%forloop%/gi,gi(S));if(B.shaderSource(Q,ot),B.compileShader(Q),B.getShaderParameter(Q,B.COMPILE_STATUS))break;S=S/2|0}return S}(this.MAX_TEXTURES,c)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var f=0;f<this._packedGeometryPoolSize;f++)this._packedGeometries[f]=new this.geometryClass;this.initFlushBuffers()},d.prototype.initFlushBuffers=function(){for(var c=d._drawCallPool,f=d._textureArrayPool,S=this.size/4,B=Math.floor(S/this.MAX_TEXTURES)+1;c.length<S;)c.push(new vl);for(;f.length<B;)f.push(new _l);for(var Q=0;Q<this.MAX_TEXTURES;Q++)this._tempBoundTextures[Q]=null},d.prototype.onPrerender=function(){this._flushId=0},d.prototype.render=function(c){c._texture.valid&&(this._vertexCount+c.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=c.vertexData.length/2,this._indexCount+=c.indices.length,this._bufferedTextures[this._bufferSize]=c._texture.baseTexture,this._bufferedElements[this._bufferSize++]=c)},d.prototype.buildTexturesAndDrawCalls=function(){var c=this._bufferedTextures,f=this.MAX_TEXTURES,S=d._textureArrayPool,B=this.renderer.batch,Q=this._tempBoundTextures,ot=this.renderer.textureGC.count,ut=++zn._globalBatch,It=0,Ut=S[0],he=0;B.copyBoundTextures(Q,f);for(var te=0;te<this._bufferSize;++te){var me=c[te];c[te]=null,me._batchEnabled!==ut&&(Ut.count>=f&&(B.boundArray(Ut,Q,ut,f),this.buildDrawCalls(Ut,he,te),he=te,Ut=S[++It],++ut),me._batchEnabled=ut,me.touched=ot,Ut.elements[Ut.count++]=me)}for(Ut.count>0&&(B.boundArray(Ut,Q,ut,f),this.buildDrawCalls(Ut,he,this._bufferSize),++It,++ut),te=0;te<Q.length;te++)Q[te]=null;zn._globalBatch=ut},d.prototype.buildDrawCalls=function(c,f,S){var B=this._bufferedElements,Q=this._attributeBuffer,ot=this._indexBuffer,ut=this.vertexSize,It=d._drawCallPool,Ut=this._dcIndex,he=this._aIndex,te=this._iIndex,me=It[Ut];me.start=this._iIndex,me.texArray=c;for(var xe=f;xe<S;++xe){var Be=B[xe],qe=Be._texture.baseTexture,Ye=Ue[qe.alphaMode?1:0][Be.blendMode];B[xe]=null,f<xe&&me.blend!==Ye&&(me.size=te-me.start,f=xe,(me=It[++Ut]).texArray=c,me.start=te),this.packInterleavedGeometry(Be,Q,ot,he,te),he+=Be.vertexData.length/2*ut,te+=Be.indices.length,me.blend=Ye}f<S&&(me.size=te-me.start,++Ut),this._dcIndex=Ut,this._aIndex=he,this._iIndex=te},d.prototype.bindAndClearTexArray=function(c){for(var f=this.renderer.texture,S=0;S<c.count;S++)f.bind(c.elements[S],c.ids[S]),c.elements[S]=null;c.count=0},d.prototype.updateGeometry=function(){var c=this._packedGeometries,f=this._attributeBuffer,S=this._indexBuffer;M.b.CAN_UPLOAD_SAME_BUFFER?(c[this._flushId]._buffer.update(f.rawBinaryData),c[this._flushId]._indexBuffer.update(S),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,c[this._flushId]=new this.geometryClass),c[this._flushId]._buffer.update(f.rawBinaryData),c[this._flushId]._indexBuffer.update(S),this.renderer.geometry.bind(c[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},d.prototype.drawBatches=function(){for(var c=this._dcIndex,f=this.renderer,S=f.gl,B=f.state,Q=d._drawCallPool,ot=null,ut=0;ut<c;ut++){var It=Q[ut],Ut=It.texArray,he=It.type,te=It.size,me=It.start,xe=It.blend;ot!==Ut&&(ot=Ut,this.bindAndClearTexArray(Ut)),this.state.blendMode=xe,B.set(this.state),S.drawElements(he,te,S.UNSIGNED_SHORT,2*me)}},d.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},d.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),M.b.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},d.prototype.stop=function(){this.flush()},d.prototype.destroy=function(){for(var c=0;c<this._packedGeometryPoolSize;c++)this._packedGeometries[c]&&this._packedGeometries[c].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),T.prototype.destroy.call(this)},d.prototype.getAttributeBuffer=function(c){var f=Ae(Math.ceil(c/8)),S=$e(f),B=8*f;this._aBuffers.length<=S&&(this._iBuffers.length=S+1);var Q=this._aBuffers[B];return Q||(this._aBuffers[B]=Q=new yl(B*this.vertexSize*4)),Q},d.prototype.getIndexBuffer=function(c){var f=Ae(Math.ceil(c/12)),S=$e(f),B=12*f;this._iBuffers.length<=S&&(this._iBuffers.length=S+1);var Q=this._iBuffers[S];return Q||(this._iBuffers[S]=Q=new Uint16Array(B)),Q},d.prototype.packInterleavedGeometry=function(c,f,S,B,Q){for(var ot=f.uint32View,ut=f.float32View,It=B/this.vertexSize,Ut=c.uvs,he=c.indices,te=c.vertexData,me=c._texture.baseTexture._batchLocation,xe=Math.min(c.worldAlpha,1),Be=xe<1&&c._texture.baseTexture.alphaMode?function(Ye,Je){if(Je===1)return(255*Je<<24)+Ye;if(Je===0)return 0;var je=Ye>>16&255,pn=Ye>>8&255,_n=255&Ye;return(255*Je<<24)+((je=je*Je+.5|0)<<16)+((pn=pn*Je+.5|0)<<8)+(_n=_n*Je+.5|0)}(c._tintRGB,xe):c._tintRGB+(255*xe<<24),qe=0;qe<te.length;qe+=2)ut[B++]=te[qe],ut[B++]=te[qe+1],ut[B++]=Ut[qe],ut[B++]=Ut[qe+1],ot[B++]=Be,ut[B++]=me;for(qe=0;qe<he.length;qe++)S[Q++]=It+he[qe]},d._drawCallPool=[],d._textureArrayPool=[],d}(mi),Lo=function(){function T(d,c){if(this.vertexSrc=d,this.fragTemplate=c,this.programCache={},this.defaultGroupCache={},c.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(c.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return T.prototype.generateShader=function(d){if(!this.programCache[d]){for(var c=new Int32Array(d),f=0;f<d;f++)c[f]=f;this.defaultGroupCache[d]=bi.from({uSamplers:c},!0);var S=this.fragTemplate;S=(S=S.replace(/%count%/gi,""+d)).replace(/%forloop%/gi,this.generateSampleSrc(d)),this.programCache[d]=new Fi(this.vertexSrc,S)}var B={tint:new Float32Array([1,1,1,1]),translationMatrix:new we,default:this.defaultGroupCache[d]};return new Bi(this.programCache[d],B)},T.prototype.generateSampleSrc=function(d){var c="";c+=`
`,c+=`
`;for(var f=0;f<d;f++)f>0&&(c+=`
else `),f<d-1&&(c+="if(vTextureId < "+f+".5)"),c+=`
{`,c+=`
	color = texture2D(uSamplers[`+f+"], vTextureCoord);",c+=`
}`;return c+=`
`,c+=`
`},T}(),Xi=function(T){function d(c){c===void 0&&(c=!1);var f=T.call(this)||this;return f._buffer=new Mn(null,c,!1),f._indexBuffer=new Mn(null,c,!0),f.addAttribute("aVertexPosition",f._buffer,2,!1,I.r.FLOAT).addAttribute("aTextureCoord",f._buffer,2,!1,I.r.FLOAT).addAttribute("aColor",f._buffer,4,!0,I.r.UNSIGNED_BYTE).addAttribute("aTextureId",f._buffer,1,!0,I.r.FLOAT).addIndex(f._indexBuffer),f}return Bn(d,T),d}(Co),Ui=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,fa=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;(function(){function T(){}return T.create=function(d){var c=Object.assign({vertex:Ui,fragment:fa,geometryClass:Xi,vertexSize:6},d),f=c.vertex,S=c.fragment,B=c.vertexSize,Q=c.geometryClass;return function(ot){function ut(It){var Ut=ot.call(this,It)||this;return Ut.shaderGenerator=new Lo(f,S),Ut.geometryClass=Q,Ut.vertexSize=B,Ut}return Bn(ut,ot),ut}(xl)},Object.defineProperty(T,"defaultVertexSrc",{get:function(){return Ui},enumerable:!1,configurable:!0}),Object.defineProperty(T,"defaultFragmentTemplate",{get:function(){return fa},enumerable:!1,configurable:!0}),T})().create();var su=function(){function T(d){this.renderer=d}return T.prototype.render=function(d){var c=this.renderer,f=d.worldTransform;c.context.globalAlpha=d.worldAlpha,c.setBlendMode(d.blendMode),c.setContextTransform(f,d.roundPixels),d.drawMode!==I.f.TRIANGLES?this._renderTriangleMesh(d):this._renderTriangles(d)},T.prototype._renderTriangleMesh=function(d){for(var c=d.geometry.buffers[0].data.length,f=0;f<c-2;f++){var S=2*f;this._renderDrawTriangle(d,S,S+2,S+4)}},T.prototype._renderTriangles=function(d){for(var c=d.geometry.getIndex().data,f=c.length,S=0;S<f;S+=3){var B=2*c[S],Q=2*c[S+1],ot=2*c[S+2];this._renderDrawTriangle(d,B,Q,ot)}},T.prototype._renderDrawTriangle=function(d,c,f,S){var B=this.renderer.context,Q=d.geometry.buffers[0].data,ot=d.uvs,ut=d.texture;if(ut.valid){var It=d.tint!==16777215,Ut=ut.baseTexture,he=Ut.width,te=Ut.height;It&&d._cachedTint!==d.tint&&(d._cachedTint=d.tint,d._cachedTexture=d._cachedTexture||new wo(Ut),d._tintedCanvas=D.b.getTintedCanvas({texture:d._cachedTexture},d.tint));var me=It?d._tintedCanvas:Ut.getDrawableSource(),xe=ot[c]*Ut.width,Be=ot[f]*Ut.width,qe=ot[S]*Ut.width,Ye=ot[c+1]*Ut.height,Je=ot[f+1]*Ut.height,je=ot[S+1]*Ut.height,pn=Q[c],_n=Q[f],Gn=Q[S],Fn=Q[c+1],Xe=Q[f+1],an=Q[S+1],bn=d.canvasPadding/this.renderer.resolution;if(bn>0){var Hn=d.worldTransform,Jn=Hn.a,Ei=Hn.b,ei=Hn.c,_i=Hn.d,Ii=(pn+_n+Gn)/3,Yi=(Fn+Xe+an)/3,ki=pn-Ii,ri=Fn-Yi,Si=Jn*ki+ei*ri,Gi=Ei*ki+_i*ri,Hi=Math.sqrt(Si*Si+Gi*Gi),$i=1+bn/Hi;pn=Ii+ki*$i,Fn=Yi+ri*$i,Si=Jn*(ki=_n-Ii)+ei*(ri=Xe-Yi),Gi=Ei*ki+_i*ri,_n=Ii+ki*($i=1+bn/(Hi=Math.sqrt(Si*Si+Gi*Gi))),Xe=Yi+ri*$i,Si=Jn*(ki=Gn-Ii)+ei*(ri=an-Yi),Gi=Ei*ki+_i*ri,Gn=Ii+ki*($i=1+bn/(Hi=Math.sqrt(Si*Si+Gi*Gi))),an=Yi+ri*$i}B.save(),B.beginPath(),B.moveTo(pn,Fn),B.lineTo(_n,Xe),B.lineTo(Gn,an),B.closePath(),B.clip();var oi=xe*Je+Ye*qe+Be*je-Je*qe-Ye*Be-xe*je,Tl=pn*Je+Ye*Gn+_n*je-Je*Gn-Ye*_n-pn*je,au=xe*_n+pn*qe+Be*Gn-_n*qe-pn*Be-xe*Gn,El=xe*Je*Gn+Ye*_n*qe+pn*Be*je-pn*Je*qe-Ye*Be*Gn-xe*_n*je,Sl=Fn*Je+Ye*an+Xe*je-Je*an-Ye*Xe-Fn*je,as=xe*Xe+Fn*qe+Be*an-Xe*qe-Fn*Be-xe*an,lu=xe*Je*an+Ye*Xe*qe+Fn*Be*je-Fn*Je*qe-Ye*Be*an-xe*Xe*je;B.transform(Tl/oi,Sl/oi,au/oi,as/oi,El/oi,lu/oi),B.drawImage(me,0,0,he*Ut.resolution,te*Ut.resolution,0,0,he,te),B.restore(),this.renderer.invalidateBlendMode()}},T.prototype.renderMeshFlat=function(d){var c=this.renderer.context,f=d.geometry.getBuffer("aVertexPosition").data,S=f.length/2;c.beginPath();for(var B=1;B<S-2;++B){var Q=2*B,ot=f[Q],ut=f[Q+1],It=f[Q+2],Ut=f[Q+3],he=f[Q+4],te=f[Q+5];c.moveTo(ot,ut),c.lineTo(It,Ut),c.lineTo(he,te)}c.fillStyle="#FF0000",c.fill(),c.closePath()},T.prototype.destroy=function(){this.renderer=null},T}();M.b.MESH_CANVAS_PADDING=0,k.c.prototype._renderCanvas=function(T,d){T.plugins.mesh.render(d)},W.a.prototype._cachedTint=16777215,W.a.prototype._tintedCanvas=null,W.a.prototype._canvasUvs=null,W.a.prototype._renderCanvas=function(T){var d=T.context,c=this.worldTransform,f=this.tint!==16777215,S=this.texture;if(S.valid){f&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedCanvas=D.b.getTintedCanvas(this,this.tint));var B=f?this._tintedCanvas:S.baseTexture.getDrawableSource();this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var Q=this.vertices,ot=this._canvasUvs,ut=f?0:S.frame.x,It=f?0:S.frame.y,Ut=ut+S.frame.width,he=It+S.frame.height;ot[0]=ut,ot[1]=ut+this._leftWidth,ot[2]=Ut-this._rightWidth,ot[3]=Ut,ot[4]=It,ot[5]=It+this._topHeight,ot[6]=he-this._bottomHeight,ot[7]=he;for(var te=0;te<8;te++)ot[te]*=S.baseTexture.resolution;d.globalAlpha=this.worldAlpha,T.setBlendMode(this.blendMode),T.setContextTransform(c,this.roundPixels);for(var me=0;me<3;me++)for(var xe=0;xe<3;xe++){var Be=2*xe+8*me,qe=Math.max(1,ot[xe+1]-ot[xe]),Ye=Math.max(1,ot[me+5]-ot[me+4]),Je=Math.max(1,Q[Be+10]-Q[Be]),je=Math.max(1,Q[Be+11]-Q[Be+1]);d.drawImage(B,ot[xe],ot[me+4],qe,Ye,Q[Be],Q[Be+1],Je,je)}}};var bl=!1;k.a.prototype._cachedTint=16777215,k.a.prototype._tintedCanvas=null,k.a.prototype._cachedTexture=null,k.a.prototype._renderCanvas=function(T){this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.material._renderCanvas?this.material._renderCanvas(T,this):bl||(bl=!0,globalThis.console&&console.warn("Mesh with custom shaders are not supported in CanvasRenderer."))},k.a.prototype._canvasPadding=null,Object.defineProperty(k.a.prototype,"canvasPadding",{get:function(){return this._canvasPadding!==null?this._canvasPadding:M.b.MESH_CANVAS_PADDING},set:function(T){this._canvasPadding=T}}),W.b.prototype._renderCanvas=function(T){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(T,this)},W.c.prototype._renderCanvas=function(T){(this.autoUpdate||this.geometry._width!==this.shader.texture.height)&&(this.geometry._width=this.shader.texture.height,this.geometry.update()),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(T,this)}}).call(this,v(17))},function(b,A,v){var P=v(143),M=v(144);function I(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}A.parse=O,A.resolve=function(H,tt){return O(H,!1,!0).resolve(tt)},A.resolveObject=function(H,tt){return H?O(H,!1,!0).resolveObject(tt):tt},A.format=function(H){return M.isString(H)&&(H=O(H)),H instanceof I?H.format():I.prototype.format.call(H)},A.Url=I;var D=/^([a-z0-9.+-]+:)/i,k=/:[0-9]*$/,W=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,X=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),V=["'"].concat(X),et=["%","/","?",";","#"].concat(V),pt=["/","?","#"],Dt=/^[+a-z0-9A-Z_-]{0,63}$/,At=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,L={javascript:!0,"javascript:":!0},R={javascript:!0,"javascript:":!0},F={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Y=v(145);function O(H,tt,G){if(H&&M.isObject(H)&&H instanceof I)return H;var Ot=new I;return Ot.parse(H,tt,G),Ot}I.prototype.parse=function(H,tt,G){if(!M.isString(H))throw new TypeError("Parameter 'url' must be a string, not "+typeof H);var Ot=H.indexOf("?"),Vt=Ot!==-1&&Ot<H.indexOf("#")?"?":"#",st=H.split(Vt);st[0]=st[0].replace(/\\/g,"/");var z=H=st.join(Vt);if(z=z.trim(),!G&&H.split("#").length===1){var U=W.exec(z);if(U)return this.path=z,this.href=z,this.pathname=U[1],U[2]?(this.search=U[2],this.query=tt?Y.parse(this.search.substr(1)):this.search.substr(1)):tt&&(this.search="",this.query={}),this}var ft=D.exec(z);if(ft){var $=(ft=ft[0]).toLowerCase();this.protocol=$,z=z.substr(ft.length)}if(G||ft||z.match(/^\/\/[^@\/]+@[^@\/]+/)){var gt=z.substr(0,2)==="//";!gt||ft&&R[ft]||(z=z.substr(2),this.slashes=!0)}if(!R[ft]&&(gt||ft&&!F[ft])){for(var Lt,K,dt=-1,it=0;it<pt.length;it++)(_t=z.indexOf(pt[it]))!==-1&&(dt===-1||_t<dt)&&(dt=_t);for((K=dt===-1?z.lastIndexOf("@"):z.lastIndexOf("@",dt))!==-1&&(Lt=z.slice(0,K),z=z.slice(K+1),this.auth=decodeURIComponent(Lt)),dt=-1,it=0;it<et.length;it++){var _t;(_t=z.indexOf(et[it]))!==-1&&(dt===-1||_t<dt)&&(dt=_t)}dt===-1&&(dt=z.length),this.host=z.slice(0,dt),z=z.slice(dt),this.parseHost(),this.hostname=this.hostname||"";var St=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!St)for(var kt=this.hostname.split(/\./),Xt=(it=0,kt.length);it<Xt;it++){var Jt=kt[it];if(Jt&&!Jt.match(Dt)){for(var at="",_e=0,Ue=Jt.length;_e<Ue;_e++)Jt.charCodeAt(_e)>127?at+="x":at+=Jt[_e];if(!at.match(Dt)){var Oe=kt.slice(0,it),Ae=kt.slice(it+1),ze=Jt.match(At);ze&&(Oe.push(ze[1]),Ae.unshift(ze[2])),Ae.length&&(z="/"+Ae.join(".")+z),this.hostname=Oe.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),St||(this.hostname=P.toASCII(this.hostname));var $e=this.port?":"+this.port:"",cn=this.hostname||"";this.host=cn+$e,this.href+=this.host,St&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),z[0]!=="/"&&(z="/"+z))}if(!L[$])for(it=0,Xt=V.length;it<Xt;it++){var ke=V[it];if(z.indexOf(ke)!==-1){var Ge=encodeURIComponent(ke);Ge===ke&&(Ge=escape(ke)),z=z.split(ke).join(Ge)}}var Rn=z.indexOf("#");Rn!==-1&&(this.hash=z.substr(Rn),z=z.slice(0,Rn));var re=z.indexOf("?");if(re!==-1?(this.search=z.substr(re),this.query=z.substr(re+1),tt&&(this.query=Y.parse(this.query)),z=z.slice(0,re)):tt&&(this.search="",this.query={}),z&&(this.pathname=z),F[$]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){$e=this.pathname||"";var pe=this.search||"";this.path=$e+pe}return this.href=this.format(),this},I.prototype.format=function(){var H=this.auth||"";H&&(H=(H=encodeURIComponent(H)).replace(/%3A/i,":"),H+="@");var tt=this.protocol||"",G=this.pathname||"",Ot=this.hash||"",Vt=!1,st="";this.host?Vt=H+this.host:this.hostname&&(Vt=H+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(Vt+=":"+this.port)),this.query&&M.isObject(this.query)&&Object.keys(this.query).length&&(st=Y.stringify(this.query));var z=this.search||st&&"?"+st||"";return tt&&tt.substr(-1)!==":"&&(tt+=":"),this.slashes||(!tt||F[tt])&&Vt!==!1?(Vt="//"+(Vt||""),G&&G.charAt(0)!=="/"&&(G="/"+G)):Vt||(Vt=""),Ot&&Ot.charAt(0)!=="#"&&(Ot="#"+Ot),z&&z.charAt(0)!=="?"&&(z="?"+z),tt+Vt+(G=G.replace(/[?#]/g,function(U){return encodeURIComponent(U)}))+(z=z.replace("#","%23"))+Ot},I.prototype.resolve=function(H){return this.resolveObject(O(H,!1,!0)).format()},I.prototype.resolveObject=function(H){if(M.isString(H)){var tt=new I;tt.parse(H,!1,!0),H=tt}for(var G=new I,Ot=Object.keys(this),Vt=0;Vt<Ot.length;Vt++){var st=Ot[Vt];G[st]=this[st]}if(G.hash=H.hash,H.href==="")return G.href=G.format(),G;if(H.slashes&&!H.protocol){for(var z=Object.keys(H),U=0;U<z.length;U++){var ft=z[U];ft!=="protocol"&&(G[ft]=H[ft])}return F[G.protocol]&&G.hostname&&!G.pathname&&(G.path=G.pathname="/"),G.href=G.format(),G}if(H.protocol&&H.protocol!==G.protocol){if(!F[H.protocol]){for(var $=Object.keys(H),gt=0;gt<$.length;gt++){var Lt=$[gt];G[Lt]=H[Lt]}return G.href=G.format(),G}if(G.protocol=H.protocol,H.host||R[H.protocol])G.pathname=H.pathname;else{for(var K=(H.pathname||"").split("/");K.length&&!(H.host=K.shift()););H.host||(H.host=""),H.hostname||(H.hostname=""),K[0]!==""&&K.unshift(""),K.length<2&&K.unshift(""),G.pathname=K.join("/")}if(G.search=H.search,G.query=H.query,G.host=H.host||"",G.auth=H.auth,G.hostname=H.hostname||H.host,G.port=H.port,G.pathname||G.search){var dt=G.pathname||"",it=G.search||"";G.path=dt+it}return G.slashes=G.slashes||H.slashes,G.href=G.format(),G}var _t=G.pathname&&G.pathname.charAt(0)==="/",St=H.host||H.pathname&&H.pathname.charAt(0)==="/",kt=St||_t||G.host&&H.pathname,Xt=kt,Jt=G.pathname&&G.pathname.split("/")||[],at=(K=H.pathname&&H.pathname.split("/")||[],G.protocol&&!F[G.protocol]);if(at&&(G.hostname="",G.port=null,G.host&&(Jt[0]===""?Jt[0]=G.host:Jt.unshift(G.host)),G.host="",H.protocol&&(H.hostname=null,H.port=null,H.host&&(K[0]===""?K[0]=H.host:K.unshift(H.host)),H.host=null),kt=kt&&(K[0]===""||Jt[0]==="")),St)G.host=H.host||H.host===""?H.host:G.host,G.hostname=H.hostname||H.hostname===""?H.hostname:G.hostname,G.search=H.search,G.query=H.query,Jt=K;else if(K.length)Jt||(Jt=[]),Jt.pop(),Jt=Jt.concat(K),G.search=H.search,G.query=H.query;else if(!M.isNullOrUndefined(H.search))return at&&(G.hostname=G.host=Jt.shift(),(ze=!!(G.host&&G.host.indexOf("@")>0)&&G.host.split("@"))&&(G.auth=ze.shift(),G.host=G.hostname=ze.shift())),G.search=H.search,G.query=H.query,M.isNull(G.pathname)&&M.isNull(G.search)||(G.path=(G.pathname?G.pathname:"")+(G.search?G.search:"")),G.href=G.format(),G;if(!Jt.length)return G.pathname=null,G.search?G.path="/"+G.search:G.path=null,G.href=G.format(),G;for(var _e=Jt.slice(-1)[0],Ue=(G.host||H.host||Jt.length>1)&&(_e==="."||_e==="..")||_e==="",Oe=0,Ae=Jt.length;Ae>=0;Ae--)(_e=Jt[Ae])==="."?Jt.splice(Ae,1):_e===".."?(Jt.splice(Ae,1),Oe++):Oe&&(Jt.splice(Ae,1),Oe--);if(!kt&&!Xt)for(;Oe--;Oe)Jt.unshift("..");!kt||Jt[0]===""||Jt[0]&&Jt[0].charAt(0)==="/"||Jt.unshift(""),Ue&&Jt.join("/").substr(-1)!=="/"&&Jt.push("");var ze,$e=Jt[0]===""||Jt[0]&&Jt[0].charAt(0)==="/";return at&&(G.hostname=G.host=$e?"":Jt.length?Jt.shift():"",(ze=!!(G.host&&G.host.indexOf("@")>0)&&G.host.split("@"))&&(G.auth=ze.shift(),G.host=G.hostname=ze.shift())),(kt=kt||G.host&&Jt.length)&&!$e&&Jt.unshift(""),Jt.length?G.pathname=Jt.join("/"):(G.pathname=null,G.path=null),M.isNull(G.pathname)&&M.isNull(G.search)||(G.path=(G.pathname?G.pathname:"")+(G.search?G.search:"")),G.auth=H.auth||G.auth,G.slashes=G.slashes||H.slashes,G.href=G.format(),G},I.prototype.parseHost=function(){var H=this.host,tt=k.exec(H);tt&&((tt=tt[0])!==":"&&(this.port=tt.substr(1)),H=H.substr(0,H.length-tt.length)),H&&(this.hostname=H)}},function(b,A){b.exports=function(v,P){return v===P||v!=v&&P!=P}},function(b,A,v){var P=v(22)(v(14),"Map");b.exports=P},function(b,A,v){var P=v(187),M=v(62),I=Object.prototype.propertyIsEnumerable,D=Object.getOwnPropertySymbols,k=D?function(W){return W==null?[]:(W=Object(W),P(D(W),function(X){return I.call(W,X)}))}:M;b.exports=k},function(b,A,v){var P=v(63),M=v(194),I=v(67);b.exports=function(D){return I(D)?P(D):M(D)}},function(b,A,v){(function(P){var M=v(14),I=v(191),D=A&&!A.nodeType&&A,k=D&&typeof P=="object"&&P&&!P.nodeType&&P,W=k&&k.exports===D?M.Buffer:void 0,X=(W?W.isBuffer:void 0)||I;P.exports=X}).call(this,v(25)(b))},function(b,A){b.exports=function(v){return function(P){return v(P)}}},function(b,A,v){(function(P){var M=v(51),I=A&&!A.nodeType&&A,D=I&&typeof P=="object"&&P&&!P.nodeType&&P,k=D&&D.exports===I&&M.process,W=function(){try{var X=D&&D.require&&D.require("util").types;return X||k&&k.binding&&k.binding("util")}catch{}}();P.exports=W}).call(this,v(25)(b))},function(b,A){var v=Object.prototype;b.exports=function(P){var M=P&&P.constructor;return P===(typeof M=="function"&&M.prototype||v)}},function(b,A,v){var P=v(63),M=v(210),I=v(67);b.exports=function(D){return I(D)?P(D,!0):M(D)}},function(b,A,v){var P=v(58);b.exports=function(M){var I=new M.constructor(M.byteLength);return new P(I).set(new P(M)),I}},function(b,A){b.exports=`#define PI 3.14159265
uniform float galleryHeight;
varying vec2 vUv;
varying float vPixelY;
void main() {
	vUv = uv;
	float pixelHeight = (galleryHeight * 1.2) + 8.0;
	float pixelY = (pixelHeight * 0.5) - position.y;
	vPixelY = pixelY;
	vec4 newPosition = vec4(position, 1.0);
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D galleryTexture;
uniform float galleryHeight;
varying vec2 vUv;
varying float vPixelY;
void main() {
	vec4 color;
	if ((vPixelY >= 0.0) && (vPixelY <= galleryHeight)) {
		color = texture2D(galleryTexture, vec2(vUv.x, 1.0 - (vPixelY / galleryHeight)));
	}
	else if ((vPixelY > galleryHeight) && (vPixelY < (galleryHeight + 8.0))) {
		color = vec4(0.0, 0.0, 0.0, 1.0);
	}
	else {
		float alpha = 1.0 - ((vPixelY - (galleryHeight + 8.0)) / (galleryHeight * 0.2));
		color = texture2D(galleryTexture, vec2(vUv.x, ((vPixelY - galleryHeight) + 8.0) / galleryHeight));
		color.a = alpha;
		vec4 shadow = vec4(0.0, 0.0, 0.0, 1.0);
		color = blendSrcOver(color, shadow);
	}
	gl_FragColor = color;
}
`},function(b,A,v){var P=v(148);b.exports=function(M,I){I=I||{};var D=new P,k=I.inPlace||!1,W=M.map(function(V){return k?V:{width:V.width,height:V.height,item:V}});W=W.sort(function(V,et){return et.width*et.height-V.width*V.height}),D.fit(W);var X={width:W.reduce(function(V,et){return Math.max(V,et.x+et.width)},0),height:W.reduce(function(V,et){return Math.max(V,et.y+et.height)},0)};return k||(X.items=W),X}},function(b,A,v){var P=v(21),M=v(200),I=v(201),D=Math.max,k=Math.min;b.exports=function(W,X,V){var et,pt,Dt,At,L,R,F=0,Y=!1,O=!1,H=!0;if(typeof W!="function")throw new TypeError("Expected a function");function tt(U){var ft=et,$=pt;return et=pt=void 0,F=U,At=W.apply($,ft)}function G(U){return F=U,L=setTimeout(Vt,X),Y?tt(U):At}function Ot(U){var ft=U-R;return R===void 0||ft>=X||ft<0||O&&U-F>=Dt}function Vt(){var U=M();if(Ot(U))return st(U);L=setTimeout(Vt,function(ft){var $=X-(ft-R);return O?k($,Dt-(ft-F)):$}(U))}function st(U){return L=void 0,H&&et?tt(U):(et=pt=void 0,At)}function z(){var U=M(),ft=Ot(U);if(et=arguments,pt=this,R=U,ft){if(L===void 0)return G(R);if(O)return clearTimeout(L),L=setTimeout(Vt,X),tt(R)}return L===void 0&&(L=setTimeout(Vt,X)),At}return X=I(X)||0,P(V)&&(Y=!!V.leading,Dt=(O="maxWait"in V)?D(I(V.maxWait)||0,X):Dt,H="trailing"in V?!!V.trailing:H),z.cancel=function(){L!==void 0&&clearTimeout(L),F=0,et=R=pt=L=void 0},z.flush=function(){return L===void 0?At:st(M())},z}},function(b,A,v){var P=v(205);b.exports=function(M){return P(M,5)}},function(b,A,v){(function(P){var M=typeof P=="object"&&P&&P.Object===Object&&P;b.exports=M}).call(this,v(17))},function(b,A,v){var P=Object.prototype.hasOwnProperty,M="~";function I(){}function D(V,et,pt){this.fn=V,this.context=et,this.once=pt||!1}function k(V,et,pt,Dt,At){if(typeof pt!="function")throw new TypeError("The listener must be a function");var L=new D(pt,Dt||V,At),R=M?M+et:et;return V._events[R]?V._events[R].fn?V._events[R]=[V._events[R],L]:V._events[R].push(L):(V._events[R]=L,V._eventsCount++),V}function W(V,et){--V._eventsCount==0?V._events=new I:delete V._events[et]}function X(){this._events=new I,this._eventsCount=0}Object.create&&(I.prototype=Object.create(null),new I().__proto__||(M=!1)),X.prototype.eventNames=function(){var V,et,pt=[];if(this._eventsCount===0)return pt;for(et in V=this._events)P.call(V,et)&&pt.push(M?et.slice(1):et);return Object.getOwnPropertySymbols?pt.concat(Object.getOwnPropertySymbols(V)):pt},X.prototype.listeners=function(V){var et=M?M+V:V,pt=this._events[et];if(!pt)return[];if(pt.fn)return[pt.fn];for(var Dt=0,At=pt.length,L=new Array(At);Dt<At;Dt++)L[Dt]=pt[Dt].fn;return L},X.prototype.listenerCount=function(V){var et=M?M+V:V,pt=this._events[et];return pt?pt.fn?1:pt.length:0},X.prototype.emit=function(V,et,pt,Dt,At,L){var R=M?M+V:V;if(!this._events[R])return!1;var F,Y,O=this._events[R],H=arguments.length;if(O.fn){switch(O.once&&this.removeListener(V,O.fn,void 0,!0),H){case 1:return O.fn.call(O.context),!0;case 2:return O.fn.call(O.context,et),!0;case 3:return O.fn.call(O.context,et,pt),!0;case 4:return O.fn.call(O.context,et,pt,Dt),!0;case 5:return O.fn.call(O.context,et,pt,Dt,At),!0;case 6:return O.fn.call(O.context,et,pt,Dt,At,L),!0}for(Y=1,F=new Array(H-1);Y<H;Y++)F[Y-1]=arguments[Y];O.fn.apply(O.context,F)}else{var tt,G=O.length;for(Y=0;Y<G;Y++)switch(O[Y].once&&this.removeListener(V,O[Y].fn,void 0,!0),H){case 1:O[Y].fn.call(O[Y].context);break;case 2:O[Y].fn.call(O[Y].context,et);break;case 3:O[Y].fn.call(O[Y].context,et,pt);break;case 4:O[Y].fn.call(O[Y].context,et,pt,Dt);break;default:if(!F)for(tt=1,F=new Array(H-1);tt<H;tt++)F[tt-1]=arguments[tt];O[Y].fn.apply(O[Y].context,F)}}return!0},X.prototype.on=function(V,et,pt){return k(this,V,et,pt,!1)},X.prototype.once=function(V,et,pt){return k(this,V,et,pt,!0)},X.prototype.removeListener=function(V,et,pt,Dt){var At=M?M+V:V;if(!this._events[At])return this;if(!et)return W(this,At),this;var L=this._events[At];if(L.fn)L.fn!==et||Dt&&!L.once||pt&&L.context!==pt||W(this,At);else{for(var R=0,F=[],Y=L.length;R<Y;R++)(L[R].fn!==et||Dt&&!L[R].once||pt&&L[R].context!==pt)&&F.push(L[R]);F.length?this._events[At]=F.length===1?F[0]:F:W(this,At)}return this},X.prototype.removeAllListeners=function(V){var et;return V?(et=M?M+V:V,this._events[et]&&W(this,et)):(this._events=new I,this._eventsCount=0),this},X.prototype.off=X.prototype.removeListener,X.prototype.addListener=X.prototype.on,X.prefixed=M,X.EventEmitter=X,b.exports=X},function(b,A,v){function P($,gt,Lt){Lt=Lt||2;var K,dt,it,_t,St,kt,Xt,Jt=gt&&gt.length,at=Jt?gt[0]*Lt:$.length,_e=M($,0,at,Lt,!0),Ue=[];if(!_e||_e.next===_e.prev)return Ue;if(Jt&&(_e=function(Ae,ze,$e,cn){var ke,Ge,Rn,re,pe,Ee=[];for(ke=0,Ge=ze.length;ke<Ge;ke++)Rn=ze[ke]*cn,re=ke<Ge-1?ze[ke+1]*cn:Ae.length,(pe=M(Ae,Rn,re,cn,!1))===pe.next&&(pe.steiner=!0),Ee.push(L(pe));for(Ee.sort(et),ke=0;ke<Ee.length;ke++)$e=pt(Ee[ke],$e);return $e}($,gt,_e,Lt)),$.length>80*Lt){K=it=$[0],dt=_t=$[1];for(var Oe=Lt;Oe<at;Oe+=Lt)(St=$[Oe])<K&&(K=St),(kt=$[Oe+1])<dt&&(dt=kt),St>it&&(it=St),kt>_t&&(_t=kt);Xt=(Xt=Math.max(it-K,_t-dt))!==0?32767/Xt:0}return D(_e,Ue,Lt,K,dt,Xt,0),Ue}function M($,gt,Lt,K,dt){var it,_t;if(dt===ft($,gt,Lt,K)>0)for(it=gt;it<Lt;it+=K)_t=st(it,$[it],$[it+1],_t);else for(it=Lt-K;it>=gt;it-=K)_t=st(it,$[it],$[it+1],_t);return _t&&O(_t,_t.next)&&(z(_t),_t=_t.next),_t}function I($,gt){if(!$)return $;gt||(gt=$);var Lt,K=$;do if(Lt=!1,K.steiner||!O(K,K.next)&&Y(K.prev,K,K.next)!==0)K=K.next;else{if(z(K),(K=gt=K.prev)===K.next)break;Lt=!0}while(Lt||K!==gt);return gt}function D($,gt,Lt,K,dt,it,_t){if($){!_t&&it&&function(Jt,at,_e,Ue){var Oe=Jt;do Oe.z===0&&(Oe.z=At(Oe.x,Oe.y,at,_e,Ue)),Oe.prevZ=Oe.prev,Oe.nextZ=Oe.next,Oe=Oe.next;while(Oe!==Jt);Oe.prevZ.nextZ=null,Oe.prevZ=null,function(Ae){var ze,$e,cn,ke,Ge,Rn,re,pe,Ee=1;do{for($e=Ae,Ae=null,Ge=null,Rn=0;$e;){for(Rn++,cn=$e,re=0,ze=0;ze<Ee&&(re++,cn=cn.nextZ);ze++);for(pe=Ee;re>0||pe>0&&cn;)re!==0&&(pe===0||!cn||$e.z<=cn.z)?(ke=$e,$e=$e.nextZ,re--):(ke=cn,cn=cn.nextZ,pe--),Ge?Ge.nextZ=ke:Ae=ke,ke.prevZ=Ge,Ge=ke;$e=cn}Ge.nextZ=null,Ee*=2}while(Rn>1)}(Oe)}($,K,dt,it);for(var St,kt,Xt=$;$.prev!==$.next;)if(St=$.prev,kt=$.next,it?W($,K,dt,it):k($))gt.push(St.i/Lt|0),gt.push($.i/Lt|0),gt.push(kt.i/Lt|0),z($),$=kt.next,Xt=kt.next;else if(($=kt)===Xt){_t?_t===1?D($=X(I($),gt,Lt),gt,Lt,K,dt,it,2):_t===2&&V($,gt,Lt,K,dt,it):D(I($),gt,Lt,K,dt,it,1);break}}}function k($){var gt=$.prev,Lt=$,K=$.next;if(Y(gt,Lt,K)>=0)return!1;for(var dt=gt.x,it=Lt.x,_t=K.x,St=gt.y,kt=Lt.y,Xt=K.y,Jt=dt<it?dt<_t?dt:_t:it<_t?it:_t,at=St<kt?St<Xt?St:Xt:kt<Xt?kt:Xt,_e=dt>it?dt>_t?dt:_t:it>_t?it:_t,Ue=St>kt?St>Xt?St:Xt:kt>Xt?kt:Xt,Oe=K.next;Oe!==gt;){if(Oe.x>=Jt&&Oe.x<=_e&&Oe.y>=at&&Oe.y<=Ue&&R(dt,St,it,kt,_t,Xt,Oe.x,Oe.y)&&Y(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.next}return!0}function W($,gt,Lt,K){var dt=$.prev,it=$,_t=$.next;if(Y(dt,it,_t)>=0)return!1;for(var St=dt.x,kt=it.x,Xt=_t.x,Jt=dt.y,at=it.y,_e=_t.y,Ue=St<kt?St<Xt?St:Xt:kt<Xt?kt:Xt,Oe=Jt<at?Jt<_e?Jt:_e:at<_e?at:_e,Ae=St>kt?St>Xt?St:Xt:kt>Xt?kt:Xt,ze=Jt>at?Jt>_e?Jt:_e:at>_e?at:_e,$e=At(Ue,Oe,gt,Lt,K),cn=At(Ae,ze,gt,Lt,K),ke=$.prevZ,Ge=$.nextZ;ke&&ke.z>=$e&&Ge&&Ge.z<=cn;){if(ke.x>=Ue&&ke.x<=Ae&&ke.y>=Oe&&ke.y<=ze&&ke!==dt&&ke!==_t&&R(St,Jt,kt,at,Xt,_e,ke.x,ke.y)&&Y(ke.prev,ke,ke.next)>=0||(ke=ke.prevZ,Ge.x>=Ue&&Ge.x<=Ae&&Ge.y>=Oe&&Ge.y<=ze&&Ge!==dt&&Ge!==_t&&R(St,Jt,kt,at,Xt,_e,Ge.x,Ge.y)&&Y(Ge.prev,Ge,Ge.next)>=0))return!1;Ge=Ge.nextZ}for(;ke&&ke.z>=$e;){if(ke.x>=Ue&&ke.x<=Ae&&ke.y>=Oe&&ke.y<=ze&&ke!==dt&&ke!==_t&&R(St,Jt,kt,at,Xt,_e,ke.x,ke.y)&&Y(ke.prev,ke,ke.next)>=0)return!1;ke=ke.prevZ}for(;Ge&&Ge.z<=cn;){if(Ge.x>=Ue&&Ge.x<=Ae&&Ge.y>=Oe&&Ge.y<=ze&&Ge!==dt&&Ge!==_t&&R(St,Jt,kt,at,Xt,_e,Ge.x,Ge.y)&&Y(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.nextZ}return!0}function X($,gt,Lt){var K=$;do{var dt=K.prev,it=K.next.next;!O(dt,it)&&H(dt,K,K.next,it)&&Ot(dt,it)&&Ot(it,dt)&&(gt.push(dt.i/Lt|0),gt.push(K.i/Lt|0),gt.push(it.i/Lt|0),z(K),z(K.next),K=$=it),K=K.next}while(K!==$);return I(K)}function V($,gt,Lt,K,dt,it){var _t=$;do{for(var St=_t.next.next;St!==_t.prev;){if(_t.i!==St.i&&F(_t,St)){var kt=Vt(_t,St);return _t=I(_t,_t.next),kt=I(kt,kt.next),D(_t,gt,Lt,K,dt,it,0),void D(kt,gt,Lt,K,dt,it,0)}St=St.next}_t=_t.next}while(_t!==$)}function et($,gt){return $.x-gt.x}function pt($,gt){var Lt=function(dt,it){var _t,St=it,kt=dt.x,Xt=dt.y,Jt=-1/0;do{if(Xt<=St.y&&Xt>=St.next.y&&St.next.y!==St.y){var at=St.x+(Xt-St.y)*(St.next.x-St.x)/(St.next.y-St.y);if(at<=kt&&at>Jt&&(Jt=at,_t=St.x<St.next.x?St:St.next,at===kt))return _t}St=St.next}while(St!==it);if(!_t)return null;var _e,Ue=_t,Oe=_t.x,Ae=_t.y,ze=1/0;St=_t;do kt>=St.x&&St.x>=Oe&&kt!==St.x&&R(Xt<Ae?kt:Jt,Xt,Oe,Ae,Xt<Ae?Jt:kt,Xt,St.x,St.y)&&(_e=Math.abs(Xt-St.y)/(kt-St.x),Ot(St,dt)&&(_e<ze||_e===ze&&(St.x>_t.x||St.x===_t.x&&Dt(_t,St)))&&(_t=St,ze=_e)),St=St.next;while(St!==Ue);return _t}($,gt);if(!Lt)return gt;var K=Vt(Lt,$);return I(K,K.next),I(Lt,Lt.next)}function Dt($,gt){return Y($.prev,$,gt.prev)<0&&Y(gt.next,$,$.next)<0}function At($,gt,Lt,K,dt){return($=1431655765&(($=858993459&(($=252645135&(($=16711935&(($=($-Lt)*dt|0)|$<<8))|$<<4))|$<<2))|$<<1))|(gt=1431655765&((gt=858993459&((gt=252645135&((gt=16711935&((gt=(gt-K)*dt|0)|gt<<8))|gt<<4))|gt<<2))|gt<<1))<<1}function L($){var gt=$,Lt=$;do(gt.x<Lt.x||gt.x===Lt.x&&gt.y<Lt.y)&&(Lt=gt),gt=gt.next;while(gt!==$);return Lt}function R($,gt,Lt,K,dt,it,_t,St){return(dt-_t)*(gt-St)>=($-_t)*(it-St)&&($-_t)*(K-St)>=(Lt-_t)*(gt-St)&&(Lt-_t)*(it-St)>=(dt-_t)*(K-St)}function F($,gt){return $.next.i!==gt.i&&$.prev.i!==gt.i&&!function(Lt,K){var dt=Lt;do{if(dt.i!==Lt.i&&dt.next.i!==Lt.i&&dt.i!==K.i&&dt.next.i!==K.i&&H(dt,dt.next,Lt,K))return!0;dt=dt.next}while(dt!==Lt);return!1}($,gt)&&(Ot($,gt)&&Ot(gt,$)&&function(Lt,K){var dt=Lt,it=!1,_t=(Lt.x+K.x)/2,St=(Lt.y+K.y)/2;do dt.y>St!=dt.next.y>St&&dt.next.y!==dt.y&&_t<(dt.next.x-dt.x)*(St-dt.y)/(dt.next.y-dt.y)+dt.x&&(it=!it),dt=dt.next;while(dt!==Lt);return it}($,gt)&&(Y($.prev,$,gt.prev)||Y($,gt.prev,gt))||O($,gt)&&Y($.prev,$,$.next)>0&&Y(gt.prev,gt,gt.next)>0)}function Y($,gt,Lt){return(gt.y-$.y)*(Lt.x-gt.x)-(gt.x-$.x)*(Lt.y-gt.y)}function O($,gt){return $.x===gt.x&&$.y===gt.y}function H($,gt,Lt,K){var dt=G(Y($,gt,Lt)),it=G(Y($,gt,K)),_t=G(Y(Lt,K,$)),St=G(Y(Lt,K,gt));return dt!==it&&_t!==St||!(dt!==0||!tt($,Lt,gt))||!(it!==0||!tt($,K,gt))||!(_t!==0||!tt(Lt,$,K))||!(St!==0||!tt(Lt,gt,K))}function tt($,gt,Lt){return gt.x<=Math.max($.x,Lt.x)&&gt.x>=Math.min($.x,Lt.x)&&gt.y<=Math.max($.y,Lt.y)&&gt.y>=Math.min($.y,Lt.y)}function G($){return $>0?1:$<0?-1:0}function Ot($,gt){return Y($.prev,$,$.next)<0?Y($,gt,$.next)>=0&&Y($,$.prev,gt)>=0:Y($,gt,$.prev)<0||Y($,$.next,gt)<0}function Vt($,gt){var Lt=new U($.i,$.x,$.y),K=new U(gt.i,gt.x,gt.y),dt=$.next,it=gt.prev;return $.next=gt,gt.prev=$,Lt.next=dt,dt.prev=Lt,K.next=Lt,Lt.prev=K,it.next=K,K.prev=it,K}function st($,gt,Lt,K){var dt=new U($,gt,Lt);return K?(dt.next=K.next,dt.prev=K,K.next.prev=dt,K.next=dt):(dt.prev=dt,dt.next=dt),dt}function z($){$.next.prev=$.prev,$.prev.next=$.next,$.prevZ&&($.prevZ.nextZ=$.nextZ),$.nextZ&&($.nextZ.prevZ=$.prevZ)}function U($,gt,Lt){this.i=$,this.x=gt,this.y=Lt,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ft($,gt,Lt,K){for(var dt=0,it=gt,_t=Lt-K;it<Lt;it+=K)dt+=($[_t]-$[it])*($[it+1]+$[_t+1]),_t=it;return dt}b.exports=P,b.exports.default=P,P.deviation=function($,gt,Lt,K){var dt=gt&&gt.length,it=dt?gt[0]*Lt:$.length,_t=Math.abs(ft($,0,it,Lt));if(dt)for(var St=0,kt=gt.length;St<kt;St++){var Xt=gt[St]*Lt,Jt=St<kt-1?gt[St+1]*Lt:$.length;_t-=Math.abs(ft($,Xt,Jt,Lt))}var at=0;for(St=0;St<K.length;St+=3){var _e=K[St]*Lt,Ue=K[St+1]*Lt,Oe=K[St+2]*Lt;at+=Math.abs(($[_e]-$[Oe])*($[Ue+1]-$[_e+1])-($[_e]-$[Ue])*($[Oe+1]-$[_e+1]))}return _t===0&&at===0?0:Math.abs((at-_t)/_t)},P.flatten=function($){for(var gt=$[0][0].length,Lt={vertices:[],holes:[],dimensions:gt},K=0,dt=0;dt<$.length;dt++){for(var it=0;it<$[dt].length;it++)for(var _t=0;_t<gt;_t++)Lt.vertices.push($[dt][it][_t]);dt>0&&(K+=$[dt-1].length,Lt.holes.push(K))}return Lt}},function(b,A,v){var P=v(26),M=v(157),I=v(158),D=v(159),k=v(160),W=v(161);function X(V){var et=this.__data__=new P(V);this.size=et.size}X.prototype.clear=M,X.prototype.delete=I,X.prototype.get=D,X.prototype.has=k,X.prototype.set=W,b.exports=X},function(b,A){var v=Function.prototype.toString;b.exports=function(P){if(P!=null){try{return v.call(P)}catch{}try{return P+""}catch{}}return""}},function(b,A,v){var P=v(166),M=v(173),I=v(175),D=v(176),k=v(177);function W(X){var V=-1,et=X==null?0:X.length;for(this.clear();++V<et;){var pt=X[V];this.set(pt[0],pt[1])}}W.prototype.clear=P,W.prototype.delete=M,W.prototype.get=I,W.prototype.has=D,W.prototype.set=k,b.exports=W},function(b,A,v){var P=v(178),M=v(181),I=v(182);b.exports=function(D,k,W,X,V,et){var pt=1&W,Dt=D.length,At=k.length;if(Dt!=At&&!(pt&&At>Dt))return!1;var L=et.get(D),R=et.get(k);if(L&&R)return L==k&&R==D;var F=-1,Y=!0,O=2&W?new P:void 0;for(et.set(D,k),et.set(k,D);++F<Dt;){var H=D[F],tt=k[F];if(X)var G=pt?X(tt,H,F,k,D,et):X(H,tt,F,D,k,et);if(G!==void 0){if(G)continue;Y=!1;break}if(O){if(!M(k,function(Ot,Vt){if(!I(O,Vt)&&(H===Ot||V(H,Ot,W,X,et)))return O.push(Vt)})){Y=!1;break}}else if(H!==tt&&!V(H,tt,W,X,et)){Y=!1;break}}return et.delete(D),et.delete(k),Y}},function(b,A,v){var P=v(14).Uint8Array;b.exports=P},function(b,A,v){var P=v(60),M=v(38),I=v(39);b.exports=function(D){return P(D,I,M)}},function(b,A,v){var P=v(61),M=v(30);b.exports=function(I,D,k){var W=D(I);return M(I)?W:P(W,k(I))}},function(b,A){b.exports=function(v,P){for(var M=-1,I=P.length,D=v.length;++M<I;)v[D+M]=P[M];return v}},function(b,A){b.exports=function(){return[]}},function(b,A,v){var P=v(188),M=v(189),I=v(30),D=v(40),k=v(192),W=v(64),X=Object.prototype.hasOwnProperty;b.exports=function(V,et){var pt=I(V),Dt=!pt&&M(V),At=!pt&&!Dt&&D(V),L=!pt&&!Dt&&!At&&W(V),R=pt||Dt||At||L,F=R?P(V.length,String):[],Y=F.length;for(var O in V)!et&&!X.call(V,O)||R&&(O=="length"||At&&(O=="offset"||O=="parent")||L&&(O=="buffer"||O=="byteLength"||O=="byteOffset")||k(O,Y))||F.push(O);return F}},function(b,A,v){var P=v(193),M=v(41),I=v(42),D=I&&I.isTypedArray,k=D?M(D):P;b.exports=k},function(b,A){b.exports=function(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=9007199254740991}},function(b,A){b.exports=function(v,P){return function(M){return v(P(M))}}},function(b,A,v){var P=v(33),M=v(65);b.exports=function(I){return I!=null&&M(I.length)&&!P(I)}},function(b,A,v){var P=v(69),M=v(36),I=Object.prototype.hasOwnProperty;b.exports=function(D,k,W){var X=D[k];I.call(D,k)&&M(X,W)&&(W!==void 0||k in D)||P(D,k,W)}},function(b,A,v){var P=v(207);b.exports=function(M,I,D){I=="__proto__"&&P?P(M,I,{configurable:!0,enumerable:!0,value:D,writable:!0}):M[I]=D}},function(b,A,v){var P=v(61),M=v(71),I=v(38),D=v(62),k=Object.getOwnPropertySymbols?function(W){for(var X=[];W;)P(X,I(W)),W=M(W);return X}:D;b.exports=k},function(b,A,v){var P=v(66)(Object.getPrototypeOf,Object);b.exports=P},function(b,A){b.exports=`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform float lines[26];
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float direction;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float middleAlpha = 0.0;
	float endAlpha = 0.0;
	float headLength = 0.0;
	if (timePercent < 0.5) {
		middleAlpha = 1.0;
		endAlpha = 1.0 - (timePercent / 0.5);
	}
	else {
		middleAlpha = 1.0 - ((timePercent - 0.5) / 0.5);
		endAlpha = 0.0;
	}
	for (int i = 0; i < 26; i++) {
		float halfDis = lines[i] / 2.0;
		float middle = headLength + halfDis;
		headLength += lines[i];
		if ((direction > 0.9) && (direction < 1.1)) {
			if (abs(vUv.y - middle) <= halfDis) {
				srcColor.a = endAlpha + (((halfDis - abs(vUv.y - middle)) / halfDis) * (middleAlpha - endAlpha));
				gl_FragColor = blendSrcOver(srcColor, distColor);
				return ;
			}
		}
		else {
			if (abs(vUv.x - middle) <= halfDis) {
				srcColor.a = endAlpha + (((halfDis - abs(vUv.x - middle)) / halfDis) * (middleAlpha - endAlpha));
				gl_FragColor = blendSrcOver(srcColor, distColor);
				return ;
			}
		}
	}
	gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
void main() {
	float maxR;
	float ringR;
	float radiusMin;
	float radiusMax;
	float dist;
	vec2 uv = vec2(vUv.x, vUv.y);
	maxR = length(transform(vec2(1.0, 1.0)));
	ringR = 1.0 / 6.0;
	radiusMin = timePercent * maxR;
	radiusMax = radiusMin + ringR;
	dist = length(transform(uv));
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	if (dist < radiusMin) {
		srcColor.a = 0.0;
	}
	else if ((dist >= radiusMin) && (dist <= radiusMax)) {
		srcColor.a = (dist - radiusMin) / ringR;
	}
	else {
		srcColor.a = 1.0;
	}
	if (timePercent >= 1.0) {
		srcColor.a = 0.0;
	}
	else if (timePercent == 0.0) {
		srcColor.a = 1.0;
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
uniform int option;
varying vec2 vUv;
vec2 transformTo(vec2 uv, vec2 origin) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(origin.x, (origin.y * height) / width);
}
vec2 offset(float progress[4], float band, float amp, float radius, vec2 centerPosition) {
	vec2 tc = vUv.xy;
	vec2 uv = vec2(0.0, 0.0);
	vec2 p;
	float len;
	vec2 uv_offset;
	float wave_width = band * radius;
	for (int i = 0; i < 4; i += 1) {
		if (progress[i] == -1.0) {
			continue;
		}
		p = tc - centerPosition;
		p.x = (p.x * width) / height;
		len = length(p);
		float current_progress = progress[i];
		float current_radius = radius * current_progress;
		float damp_factor = 1.0;
		if (current_progress > .5) {
			damp_factor = (1.0 - current_progress) * 2.0;
		}
		float cut_factor = clamp((wave_width * damp_factor) - abs(current_radius - len), 0.0, 1.0);
		float waves_factor = (4.0 * len) / radius;
		uv_offset = (((p / len) * cos((waves_factor - (current_progress * 10.0)) * 3.14)) * amp) * cut_factor;
		uv += uv_offset;
	}
	return uv;
}
void main() {
	float maxR;
	float ringR;
	float radiusMin;
	float radiusMax;
	float dist;
	float progress[4];
	vec2 uv = vUv.xy;
	vec2 uvOffset = vec2(0.0, 0.0);
	vec2 startPosition = vec2(0.5, 0.5);
	float redius = 2.0;
	if (option == 1) {
		startPosition = vec2(0.0, 0.0);
	}
	else if (option == 2) {
		startPosition = vec2(1.0, 0.0);
	}
	else if (option == 3) {
		startPosition = vec2(1.0, 1.0);
	}
	else if (option == 4) {
		startPosition = vec2(0.0, 1.0);
	}
	maxR = length(transformTo(vec2(1.0, 1.0), vec2(0.0, 0.0)));
	if (option == 0) {
		maxR = maxR / 2.0;
		redius = redius / 2.0;
	}
	dist = length(transformTo(uv, startPosition));
	ringR = 1.0 / 6.0;
	radiusMin = timePercent * maxR;
	radiusMax = radiusMin + ringR;
	for (int i = 0; i < 4; i++) {
		progress[i] = timePercent + (0.1 * float(i));
		if (progress[i] < 0.0) {
			progress[i] = 0.0;
		}
	}
	uvOffset = offset(progress, 0.2, 0.3, redius, startPosition);
	vec4 srcColor = texture2D(texturePrev, fract(vUv + uvOffset));
	vec4 distColor = texture2D(textureNext, fract(vUv + uvOffset));
	if (dist < radiusMin) {
		srcColor.a = 0.0;
	}
	else if ((dist >= radiusMin) && (dist <= radiusMax)) {
		srcColor.a = (dist - radiusMin) / ringR;
	}
	else {
		srcColor.a = 1.0;
	}
	if (timePercent >= 1.0) {
		srcColor.a = 0.0;
	}
	else if (timePercent == 0.0) {
		srcColor.a = 1.0;
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alphaStart;
	float alphaEnd;
	float rectStart;
	float rectEnd;
	bool isRevert = option > 1 ? true : false;
	if (timePercent <= 0.33) {
		alphaStart = isRevert ? 1.0 - (timePercent / 0.33) : 1.0;
		alphaEnd = isRevert ? 1.0 : 1.0 - (timePercent / 0.33);
		rectStart = isRevert ? 0.0 : 0.5;
		rectEnd = isRevert ? 0.5 : 1.0;
	}
	else if ((timePercent > 0.33) && (timePercent <= 0.66)) {
		alphaStart = isRevert ? 0.0 : 1.0;
		alphaEnd = isRevert ? 1.0 : 0.0;
		rectEnd = isRevert ? (((timePercent - 0.33) / 0.33) * 0.5) + 0.5 : 1.0 - (((timePercent - 0.33) / 0.33) * 0.5);
		rectStart = rectEnd - 0.5;
	}
	else {
		alphaStart = isRevert ? 0.0 : (1.0 - timePercent) / (1.0 - 0.66);
		alphaEnd = isRevert ? (1.0 - timePercent) / (1.0 - 0.66) : 0.0;
		rectStart = isRevert ? 0.5 : 0.0;
		rectEnd = isRevert ? 1.0 : 0.5;
	}
	float changAxis = (option % 2) == 0 ? vUv.x : vUv.y;
	if (changAxis >= rectEnd) {
		srcColor.a = isRevert ? 1.0 : 0.0;
	}
	else if (changAxis <= rectStart) {
		srcColor.a = isRevert ? 0.0 : 1.0;
	}
	else {
		srcColor.a = alphaStart + (((changAxis - rectStart) / 0.5) * (alphaEnd - alphaStart));
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,A){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform sampler2D dissolveTexture;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 dissolveColor = texture2D(dissolveTexture, vUv);
	if (dissolveColor.r == 0.0) {
		result = srcColor;
	}
	else {
		result = distColor;
	}
	gl_FragColor = result;
}
`},function(b,A){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	if (timePercent < 0.5) {
		float stagePercent = timePercent / 0.5;
		result = srcColor + (stagePercent * (1.0 - srcColor));
	}
	else {
		float stagePercent = (timePercent - 0.5) / 0.5;
		result = 1.0 - (stagePercent * (1.0 - distColor));
	}
	gl_FragColor = result;
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	if (option == 1) {
		if (timePercent < 0.5) {
			srcColor.rgb *= (1.0 - (timePercent * 2.0));
			gl_FragColor = srcColor;
		}
		else {
			distColor.rgb *= ((timePercent - 0.5) * 2.0);
			gl_FragColor = distColor;
		}
	}
	else {
		srcColor.a = 1.0 - timePercent;
		gl_FragColor = blendSrcOver(srcColor, distColor);
	}
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float changeAxis = (option % 2) == 1 ? vUv.x : vUv.y;
	bool changeAxisX = (option % 2) == 1;
	bool isRevert = option > 1;
	float line;
	if (isRevert) {
		line = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 3);
	}
	else {
		line = interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 3);
	}
	vec2 uv = vUv.xy;
	if (changeAxis > line) {
		if (changeAxisX) {
			uv.x -= line;
		}
		else {
			uv.y -= line;
		}
	}
	else {
		if (changeAxisX) {
			uv.x += (1.0 - line);
		}
		else {
			uv.y += (1.0 - line);
		}
	}
	if (isRevert) {
		result = changeAxis > line ? texture2D(textureNext, uv) : texture2D(texturePrev, uv);
	}
	else {
		result = changeAxis > line ? texture2D(texturePrev, uv) : texture2D(textureNext, uv);
	}
	gl_FragColor = result;
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform bool direction;
uniform bool orient;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec2 rectLeft = direction ? vec2(0.25, 0.0) : vec2(0.25, 0.5);
	vec2 rectRight = direction ? vec2(1, 0.75) : vec2(0.5, 0.75);
	vec2 alphaLeft = vec2(1.0, 1.0);
	vec2 alphaRight = vec2(1.0, 1.0);
	if (timePercent <= 0.333) {
		alphaLeft.y = 1.0 - (timePercent / 0.333);
		alphaRight.x = 1.0 - (timePercent / 0.333);
	}
	else if ((timePercent <= 0.666) && (timePercent > 0.333)) {
		rectLeft.x = direction ? (((timePercent - 0.333) / 0.333) * 0.25) + rectLeft.x : rectLeft.x - (((timePercent - 0.333) / 0.333) * 0.25);
		rectLeft.y = direction ? rectLeft.x - 0.25 : rectLeft.x + 0.25;
		rectRight.y = direction ? rectRight.y - (((timePercent - 0.333) / 0.333) * 0.25) : rectRight.y + (((timePercent - 0.333) / 0.333) * 0.25);
		rectRight.x = direction ? rectRight.y + 0.25 : rectRight.y - 0.25;
		alphaLeft.y = 0.0;
		alphaRight.x = 0.0;
	}
	else {
		rectLeft = direction ? vec2(0.5, 0.25) : vec2(0.0, 0.25);
		rectRight = direction ? vec2(0.75, 0.5) : vec2(0.75, 1.0);
		alphaLeft.y = 0.0;
		alphaRight.x = 0.0;
		alphaLeft.x = 1.0 - ((timePercent - 0.666) / (1.0 - 0.666));
		alphaRight.y = 1.0 - ((timePercent - 0.666) / (1.0 - 0.666));
	}
	float axis = orient ? vUv.x : vUv.y;
	if (direction) {
		if ((axis < rectLeft.y) || (axis > rectRight.x)) {
			srcColor.a = 0.0;
		}
		else if ((axis > rectLeft.x) && (axis < rectRight.y)) {
			srcColor.a = 1.0;
		}
		else {
			if ((axis < rectLeft.x) && (axis > rectLeft.y)) {
				srcColor.a = alphaLeft.y - (((axis - rectLeft.y) / (rectLeft.x - rectLeft.y)) * (alphaLeft.y - alphaLeft.x));
			}
			else {
				srcColor.a = alphaRight.x - (((rectRight.x - axis) / (rectLeft.x - rectLeft.y)) * (alphaRight.x - alphaRight.y));
			}
		}
	}
	else {
		if ((axis < rectLeft.x) || (axis > rectRight.y)) {
			srcColor.a = 1.0;
		}
		else if ((axis > rectLeft.y) && (axis < rectRight.x)) {
			srcColor.a = 0.0;
		}
		else {
			if ((axis >= rectLeft.x) && (axis <= rectLeft.y)) {
				srcColor.a = alphaLeft.x - (((axis - rectLeft.x) / (rectLeft.y - rectLeft.x)) * (alphaLeft.x - alphaLeft.y));
			}
			else {
				srcColor.a = alphaRight.y - (((rectRight.y - axis) / (rectLeft.y - rectLeft.x)) * (alphaRight.y - alphaRight.x));
			}
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,A){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform bool direction;
uniform bool thruBlk;
varying vec2 vUv;
void main() {
	vec4 uv4 = vec4(vUv.xy, 1.0, 1.0);
	float scale;
	float transform;
	if (timePercent < 0.5) {
		scale = 1.0 - ((timePercent / 0.5) * 0.05);
		transform = (1.0 - scale) * 0.5;
	}
	else {
		scale = 0.95 + (((timePercent - 0.5) / 0.5) * 0.05);
		transform = (1.0 - scale) * 0.5;
	}
	mat4 matrix = mat4(scale, 0.0, 0.0, 0.0, 0.0, scale, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, transform, transform, 0.0, 1.0);
	vec4 uv = matrix * uv4;
	vec4 srcColor = texture2D(texturePrev, uv.xy);
	vec4 distColor = texture2D(textureNext, uv.xy);
	vec4 result = timePercent < 0.5 ? srcColor : distColor;
	vec3 start;
	vec3 end;
	vec3 middleColor = thruBlk ? vec3(0.0, 0.0, 0.0) : vec3(1.0, 1.0, 1.0);
	if ((timePercent < 0.25) || (timePercent > 0.75)) {
		result *= 1.0;
	}
	else if ((timePercent >= 0.25) && (timePercent <= 0.5)) {
		if (timePercent <= 0.375) {
			start = result.rgb;
			end = start + (((timePercent - 0.25) / 0.125) * (middleColor - result.rgb));
		}
		else {
			start = result.rgb + (((timePercent - 0.375) / 0.125) * (middleColor - result.rgb));
			end = middleColor;
		}
		result = direction ? vec4(end - (vUv.x * (end - start)), result.a) : vec4(start - (vUv.x * (start - end)), result.a);
	}
	else if ((timePercent > 0.5) && (timePercent <= 0.75)) {
		if (timePercent < 0.625) {
			start = middleColor - (((timePercent - 0.5) / 0.125) * (middleColor - result.rgb));
			end = middleColor;
		}
		else {
			start = result.rgb;
			end = middleColor - (((timePercent - 0.625) / 0.125) * (middleColor - result.rgb));
		}
		result = direction ? vec4(end - (vUv.x * (end - start)), result.a) : vec4(start - (vUv.x * (start - end)), result.a);
	}
	gl_FragColor = result;
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int optionX;
uniform int optionY;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float lineX = optionX > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	float lineY = optionY > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	vec2 uv = vUv.xy;
	if ((optionX < 0) && (vUv.x <= lineX)) {
		uv.x += (1.0 - lineX);
	}
	if ((optionX > 0) && (vUv.x >= lineX)) {
		uv.x -= lineX;
	}
	if ((optionY < 0) && (vUv.y <= lineY)) {
		uv.y += (1.0 - lineY);
	}
	if ((optionY > 0) && (vUv.y >= lineY)) {
		uv.y -= lineY;
	}
	if ((optionX != 0) && (optionY == 0)) {
		if (optionX > 0) {
			result = vUv.x > lineX ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else {
			result = vUv.x > lineX ? texture2D(textureNext, vUv) : texture2D(texturePrev, uv);
		}
	}
	if ((optionX == 0) && (optionY != 0)) {
		if (optionY > 0) {
			result = vUv.y > lineY ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else {
			result = vUv.y > lineY ? texture2D(textureNext, vUv) : texture2D(texturePrev, uv);
		}
	}
	if ((optionX != 0) && (optionY != 0)) {
		if ((optionX > 0) && (optionY > 0)) {
			result = (vUv.x > lineX) && (vUv.y > lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else if ((optionX > 0) && (optionY < 0)) {
			result = (vUv.x > lineX) && (vUv.y < lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else if ((optionX < 0) && (optionY > 0)) {
			result = (vUv.x < lineX) && (vUv.y > lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
		else {
			result = (vUv.x < lineX) && (vUv.y < lineY) ? texture2D(texturePrev, uv) : texture2D(textureNext, vUv);
		}
	}
	gl_FragColor = result;
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int optionX;
uniform int optionY;
varying vec2 vUv;
void main() {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	float lineX = optionX > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	float lineY = optionY > 0 ? interpolationFloat(0.0, 1.0, 0.0, 1.0, timePercent, 1) : interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 1);
	vec2 uv = vUv.xy;
	if ((optionX < 0) && (vUv.x > lineX)) {
		uv.x -= lineX;
	}
	if ((optionX > 0) && (vUv.x < lineX)) {
		uv.x += (1.0 - lineX);
	}
	if ((optionY < 0) && (vUv.y > lineY)) {
		uv.y -= lineY;
	}
	if ((optionY > 0) && (vUv.y < lineY)) {
		uv.y += (1.0 - lineY);
	}
	if ((optionX != 0) && (optionY == 0)) {
		if (optionX > 0) {
			result = vUv.x > lineX ? texture2D(texturePrev, vUv) : texture2D(textureNext, uv);
		}
		else {
			result = vUv.x > lineX ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
	}
	if ((optionX == 0) && (optionY != 0)) {
		if (optionY > 0) {
			result = vUv.y > lineY ? texture2D(texturePrev, vUv) : texture2D(textureNext, uv);
		}
		else {
			result = vUv.y > lineY ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
	}
	if ((optionX != 0) && (optionY != 0)) {
		if ((optionX > 0) && (optionY > 0)) {
			result = (vUv.x < lineX) && (vUv.y < lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
		else if ((optionX > 0) && (optionY < 0)) {
			result = (vUv.x < lineX) && (vUv.y > lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
		else if ((optionX < 0) && (optionY > 0)) {
			result = (vUv.x > lineX) && (vUv.y < lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
		else {
			result = (vUv.x > lineX) && (vUv.y > lineY) ? texture2D(textureNext, uv) : texture2D(texturePrev, vUv);
		}
	}
	gl_FragColor = result;
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
mat3 yuv2rgb = mat3(1.0, 0.0, 1.13983, 1.0, -0.39465, -0.58060, 1.0, 2.03211, 0.0);
mat3 rgb2yuv = mat3(0.2126, 0.7152, 0.0722, -0.09991, -0.33609, 0.43600, 0.615, -0.5586, -0.05639);
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec3 result;
	float resultAlpha;
	if (timePercent < 0.5) {
		result = srcColor.rgb * rgb2yuv;
		result.r += interpolationFloat(0.0, 1.0, 0.0, 0.5, timePercent, 0);
		resultAlpha = srcColor.a;
	}
	else {
		result = distColor.rgb * rgb2yuv;
		result.r += interpolationFloat(1.0, 0.0, 0.5, 1.0, timePercent, 0);
		resultAlpha = distColor.a;
	}
	result *= yuv2rgb;
	gl_FragColor = vec4(result.rgb, resultAlpha);
}
`},function(b,A){b.exports=`uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
attribute vec2 segment;
attribute float times;
attribute int option;
varying vec2 vUv;
varying float fakePercent;
void main() {
	vUv = uv;
	float width = segmentWidth * horizontalSegments;
	float height = segmentHeight * verticalSegments;
	vec4 newPosition = vec4(position, 1.0);
	vec2 segmentOrigin = vec2(((segment.x + 0.5) * segmentWidth) - (width * 0.5), (height * 0.5) - ((1.0 * (segment.y + 0.5)) * segmentHeight));
	if (timePercent > times) {
		float percent = (timePercent - times) / 0.7;
		if (percent > 1.0) {
			percent = 1.0;
		}
		if (percent > 0.5) {
			percent += 1.0;
		}
		mat4 matrix = mat4(cos((-1.0 * percent) * 3.14), 0.0, sin((-1.0 * percent) * 3.14), 0.0, 0.0, 1.0, 0.0, 0.0, -sin((-1.0 * percent) * 3.14), 0.0, cos((-1.0 * percent) * 3.14), 0.0, 0.0, 0.0, 0.0, 1.0);
		if (option == 1) {
			matrix = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(percent * 3.14), -sin(percent * 3.14), 0.0, 0.0, sin(percent * 3.13), cos(percent * 3.14), 0.0, 0.0, 0.0, 0.0, 1.0);
		}
		newPosition.x -= segmentOrigin.x;
		newPosition.y -= segmentOrigin.y;
		newPosition = matrix * newPosition;
		newPosition.x += segmentOrigin.x;
		newPosition.y += segmentOrigin.y;
		if (segment.x < (horizontalSegments / 2.0)) {
			fakePercent = percent - (abs((horizontalSegments / 2.0) - segment.x) * (0.25 / horizontalSegments));
		}
		else {
			fakePercent = percent + (abs((horizontalSegments / 2.0) - segment.x) * (0.25 / horizontalSegments));
		}
	}
	if ((timePercent < 0.0001) || (timePercent > 0.9999)) {
		gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
		return ;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,A){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float fakePercent;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = srcColor;
	if (fakePercent > 0.5) {
		color = distColor;
	}
	if ((fakePercent < 0.5) && (fakePercent > 0.35)) {
		color.a = 0.5;
	}
	gl_FragColor = color;
}
`},function(b,A){b.exports=`#define PI 3.14159265
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
uniform float duration;
attribute vec2 segment;
attribute float times;
varying vec2 vUv;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	vUv = uv;
	float width = segmentWidth * horizontalSegments;
	float height = segmentHeight * verticalSegments;
	mat4 matrix;
	float stagePercent;
	vec4 newPosition = vec4(position, 1.0);
	float selfTimePercent = (timePercent - times) / (4.0 / 5.0);
	if (selfTimePercent < 0.0) {
		selfTimePercent = 0.0;
	}
	else if (selfTimePercent > 1.0) {
		selfTimePercent = 1.0;
	}
	if (selfTimePercent < (2.0 / 5.0)) {
		stagePercent = selfTimePercent / (2.0 / 5.0);
		newPosition.x -= (0.5 * width);
		matrix = rotateY(((-1.0 * stagePercent) * PI) * 0.5);
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
	}
	else if ((selfTimePercent >= (2.0 / 5.0)) && (selfTimePercent < (3.0 / 5.0))) {
		stagePercent = (selfTimePercent - (2.0 / 5.0)) / (1.0 / 5.0);
		newPosition.x -= (0.5 * width);
		newPosition = rotateY((-1.0 * PI) * 0.5) * newPosition;
		matrix = rotateY(((-1.0 * stagePercent) * PI) * 2.0);
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
		newPosition.x -= (width * stagePercent);
	}
	else {
		float offset = (((newPosition.x + (0.5 * width)) / width) * 2.0) / 5.0;
		stagePercent = (selfTimePercent - (1.0 / 5.0)) / ((2.0 / 5.0) + offset);
		if (stagePercent > 1.0) {
			stagePercent = 1.0;
		}
		vec4 vvUvv = vec4(vUv.x - 0.5, vUv.y - 0.5, 0.0, 1.0);
		vvUvv = rotateY(-1.0 * PI) * vvUvv;
		vUv = vvUvv.xy + 0.5;
		newPosition.x -= (0.5 * width);
		matrix = rotateY((((-1.0 * stagePercent) * PI) * 0.5) - (PI * 2.5));
		newPosition = matrix * newPosition;
		newPosition.x += (0.5 * width);
		newPosition.x -= width;
	}
	if ((timePercent < 0.0001) || (timePercent > 0.9999)) {
		vUv = uv;
		gl_Position = (projectionMatrix * modelViewMatrix) * vec4(position, 1.0);
		return ;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,A){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = srcColor;
	if (timePercent > 0.5) {
		color = distColor;
	}
	if (timePercent < 0.0001) {
		color = srcColor;
	}
	else if (timePercent > 0.9999) {
		color = distColor;
	}
	gl_FragColor = color;
}
`},function(b,A){b.exports=`#define PI 3.14159265
attribute float index;
attribute float type;
attribute float delay;
uniform float timePercent;
uniform float segmentWidth;
uniform float segments;
varying vec2 vUv;
varying float vType;
varying float rotatePercent;
mat4 rotateY(float angle) {
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	vUv = uv;
	vType = type;
	vec4 newPosition = vec4(position, 1.0);
	float selfPercent = (timePercent - delay) / 0.7;
	rotatePercent = selfPercent;
	if (selfPercent < 0.0) {
		selfPercent = 0.0;
	}
	else if (selfPercent > 1.0) {
		selfPercent = 1.0;
	}
	float offsetX = ((segments * segmentWidth) * 0.5) - ((index + 0.5) * segmentWidth);
	float offsetZ = segmentWidth * 0.5;
	newPosition.x += offsetX;
	newPosition.z += offsetZ;
	newPosition.x *= (0.9 + ((abs(timePercent - 0.5) / 0.5) * 0.1));
	newPosition.z *= (0.9 + ((abs(timePercent - 0.5) / 0.5) * 0.1));
	newPosition = rotateY((PI * 0.5) * selfPercent) * newPosition;
	newPosition.x -= offsetX;
	newPosition.z -= offsetZ;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,A){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float vType;
varying float rotatePercent;
mat3 yuv2rgb = mat3(1.0, 0.0, 1.13983, 1.0, -0.39465, -0.58060, 1.0, 2.03211, 0.0);
mat3 rgb2yuv = mat3(0.2126, 0.7152, 0.0722, -0.09991, -0.33609, 0.43600, 0.615, -0.5586, -0.05639);
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec3 srcYuv;
	vec3 distYuv;
	if (rotatePercent < 0.5) {
		distYuv = distColor.rgb * rgb2yuv;
		distYuv.r *= (1.0 - (abs(rotatePercent - 0.5) / 0.5));
		distColor = vec4(distYuv * yuv2rgb, distColor.a);
	}
	else {
		srcYuv = distColor.rgb * rgb2yuv;
		srcYuv.r *= (abs(rotatePercent - 0.5) / 0.5);
		srcColor = vec4(srcYuv * yuv2rgb, srcColor.a);
	}
	vec4 color = vType < 0.5 ? srcColor : distColor;
	gl_FragColor = color;
}
`},function(b,A){b.exports=`float easeInFloat(float t, float b, float c, float d) {
	t = t / d;
	return ((c * t) * t) + b;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.141592653
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float timePercent;
uniform float segmentWidth;
uniform float segmentHeight;
attribute float isLeft;
varying vec2 vUv;
varying vec4 shadow;
void main() {
	vUv = uv;
	float scaleX;
	float transform;
	float displacement;
	vec4 newPosition = vec4(position, 1.0);
	vec4 glPosition = (projectionMatrix * modelViewMatrix) * newPosition;
	float crestCount = 24.0;
	float width = horizontalSegments * segmentWidth;
	float height = verticalSegments * segmentHeight;
	float heightFactor = (newPosition.y + (height * 0.5)) / height;
	float scaleY = interpolationFloat(1.0, 1.05, 0.0, 0.11, timePercent, 0);
	newPosition.y += (height * 0.5);
	newPosition.y *= scaleY;
	newPosition.y -= (height * 0.5);
	newPosition.y += 10.0;
	if ((timePercent > 0.0) && (timePercent < 0.333)) {
		float delay = (1.0 - heightFactor) * 0.1;
		scaleX = interpolationFloat(1.0, 0.5, 0.0 + delay, 0.333, timePercent, 1);
	}
	else if ((timePercent >= 0.333) && (timePercent < 0.5)) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.5, 0.25, 0.333, 0.5, timePercent, 2);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop - incr;
	}
	else if ((timePercent >= 0.5) && (timePercent < 0.583)) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.25, 0.5, 0.5, 0.583, timePercent, 1);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop - incr;
	}
	else if (timePercent >= 0.583) {
		float scaleTop = 0.5;
		float scaleBottom = interpolationFloat(0.5, 0.75, 0.583, 0.666, timePercent, 2);
		float incr = easeInFloat(1.0 - heightFactor, 0.0, abs(scaleBottom - scaleTop), 1.0);
		scaleX = scaleTop + incr;
	}
	if (timePercent > 0.583) {
		displacement = (isLeft < 0.5 ? 1.0 : -1.0) * interpolationFloat(0.0, width / 2.0, 0.583, 1.0, timePercent, 0);
	}
	float ampTop = interpolationFloat(0.0, 1.0, 0.0, 0.11, timePercent, 0);
	float ampBottom = interpolationFloat(0.0, 1.0, 0.11, 0.22, timePercent, 0);
	float amp = ampBottom + (heightFactor * abs(ampBottom - ampTop));
	float foo = newPosition.x * ((crestCount * PI) / width);
	newPosition.z = (amp * cos(foo + (PI / 2.0))) * 20.0;
	transform = (isLeft < 0.5 ? -1.0 : 1.0) * (width * 0.5);
	newPosition.x += transform;
	newPosition.x *= scaleX;
	newPosition.x -= transform;
	newPosition.x += displacement;
	shadow = vec4(0.0, 0.0, 0.0, 0.0);
	if (newPosition.z < 15.0) {
		float alpha = 0.3 * (1.0 - ((newPosition.z + 20.0) / 35.0));
		shadow.a = alpha * amp;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying vec4 shadow;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 color = blendSrcOver(shadow, srcColor);
	gl_FragColor = color;
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265
uniform float timePercent;
uniform float aCoefficient;
uniform float zCurveLimit;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float curve;
	float progress = option == 1 ? halfWidth - newPosition.x : newPosition.x + halfWidth;
	float aStart = interpolationFloat(0.00000009, aCoefficient, 0.0, 0.5, timePercent, 0);
	float aEnd = 0.0000009;
	float zStart = interpolationFloat(0.0, zCurveLimit, 0.0, 0.5, timePercent, 0);
	float zEnd = 0.0;
	float a = interpolationFloat(aStart, aEnd, 0.0, halfWidth * 2.0, progress, 0);
	float z = interpolationFloat(zStart, zEnd, 0.0, halfWidth * 2.0, progress, 0);
	newPosition.z -= (((-a * newPosition.y) * newPosition.y) + z);
	float scaleYStart = interpolationFloat(1.0, 0.8, 0.0, 0.5, timePercent, 0);
	float scaleYEnd = 1.0;
	float scaleY = interpolationFloat(scaleYStart, scaleYEnd, 0.0, halfWidth * 2.0, progress, 0);
	newPosition.y += halfHeight;
	newPosition.y *= scaleY;
	float angle = interpolationFloat(0.0, -((2.0 * PI) / 3.0), 0.111, 1.0, timePercent, 1);
	mat4 rotateX = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), sin(angle), 0.0, 0.0, -sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	newPosition = rotateX * newPosition;
	newPosition.y -= halfHeight;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
	vec4 shadow = vec4(0.0, 0.0, 0.0, alpha);
	gl_FragColor = blendSrcOver(shadow, srcColor);
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
varying float shadowAlpha;
mat2 rotateOrigin(float angle) {
	return mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec2 shadowPosition = vec2(position.xy);
	float presetAngle = option == 1 ? 0.77 : 0.27;
	float rotateAngle = PI * presetAngle;
	float min_r = halfWidth * 0.05;
	shadowPosition = rotateOrigin(rotateAngle) * shadowPosition;
	vec4 newPosition = vec4(shadowPosition.xy, position.z, 1.0);
	float line = interpolationFloat(0.0, halfWidth * 2.8, 0.0, 1.0, timePercent, 1);
	float dis2BaseLine = halfWidth - newPosition.x;
	float dis2Line = line - dis2BaseLine;
	float L = line <= (halfWidth * 2.0) ? line : halfWidth * 2.0;
	float r = L / PI;
	r = r < min_r ? min_r : r;
	float angle = dis2Line / r;
	if (((dis2Line > 0.0) && (dis2Line < (line * 0.5))) && (r > min_r)) {
		shadowAlpha = interpolationFloat(0.0, 0.3, 0.0, line * 0.5, dis2Line, 0);
	}
	else {
		shadowAlpha = 0.0;
	}
	if (dis2BaseLine < line) {
		newPosition.x = ((sin(angle) * r) + halfWidth) - line;
		newPosition.z = (r - (cos(angle) * r)) * 0.5;
	}
	vec2 finalPosition = vec2(newPosition.xy);
	finalPosition = rotateOrigin(-rotateAngle) * finalPosition;
	gl_Position = (projectionMatrix * modelViewMatrix) * vec4(finalPosition.xy, newPosition.z, 1.0);
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
varying float shadowAlpha;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec4 shadow = vec4(0.0, 0.0, 0.0, shadowAlpha);
	gl_FragColor = blendSrcOver(shadow, srcColor);
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
mat4 rotateX(float angle) {
	return mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), sin(angle), 0.0, 0.0, -sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float progress = option == 0 ? halfWidth - newPosition.x : halfWidth + newPosition.x;
	float delay = interpolationFloat(0.0, 0.08, 0.0, halfWidth * 2.0, progress, 0);
	float arc = halfHeight - newPosition.y;
	float L;
	if (timePercent < 0.8) {
		L = interpolationFloat(halfHeight * 4.0, halfHeight * 22.0, 0.3 + delay, 0.8, timePercent, 0);
	}
	else {
		L = interpolationFloat(halfHeight * 22.0, halfHeight * 300.0, 0.8, 1.0, timePercent, 0);
	}
	float r = L / (2.0 * PI);
	float angle = PI - (arc / r);
	float y = sin(angle) * r;
	float z = cos(angle) * r;
	newPosition.y = halfHeight - y;
	newPosition.z = (z + r) * 0.45;
	float rotateAngle = interpolationFloat(-PI * 0.5, 0.0, 0.0 + delay, 0.4, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(rotateAngle) * newPosition;
	newPosition.y += halfHeight;
	float backRotate1 = interpolationFloat(0.0, PI * 0.03, 0.75, 0.9, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(backRotate1) * newPosition;
	newPosition.y += halfHeight;
	float backRotate2 = interpolationFloat(0.0, -PI * 0.03, 0.8, 1.0, timePercent, 0);
	newPosition.y -= halfHeight;
	newPosition = rotateX(backRotate2) * newPosition;
	newPosition.y += halfHeight;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float alpha = interpolationFloat(0.0, 0.6, 0.5, 1.0, timePercent, 0);
	vec4 shadow = vec4(0.0, 0.0, 0.0, 0.0);
	gl_FragColor = blendSrcOver(shadow, distColor);
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
varying vec2 vUv;
vec2 transform(vec2 uv) {
	uv.y = (uv.y * height) / width;
	return uv - vec2(0.5, (0.5 * height) / width);
}
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	float shadowAngle = PI / 6.0;
	float clockAngle;
	vec2 a;
	vec2 b = transform(vUv);
	float angle;
	if (timePercent < 0.5) {
		a = vec2(0.0, 0.5);
		clockAngle = interpolationFloat(0.0, PI, 0.0, 0.5, timePercent, 0);
		if (b.x > 0.0) {
			angle = acos(((a.x * b.x) + (a.y * b.y)) / (sqrt((a.x * a.x) + (a.y * a.y)) * sqrt((b.x * b.x) + (b.y * b.y))));
			if (angle < clockAngle) {
				if (angle > (clockAngle - shadowAngle)) {
					float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
					srcColor.a = shadowAlpha;
				}
				else {
					srcColor.a = 0.0;
				}
			}
		}
		else {
			srcColor.a = 1.0;
		}
	}
	else {
		a = vec2(0.0, -0.5);
		clockAngle = interpolationFloat(0.0, PI + shadowAngle, 0.5, 1.0, timePercent, 0);
		if (b.x <= 0.0) {
			angle = acos(((a.x * b.x) + (a.y * b.y)) / (sqrt((a.x * a.x) + (a.y * a.y)) * sqrt((b.x * b.x) + (b.y * b.y))));
			if (angle < clockAngle) {
				if (angle > (clockAngle - shadowAngle)) {
					float shadowAlpha = interpolationFloat(1.0, 0.0, 0.0, 1.0, abs(clockAngle - angle) / shadowAngle, 0);
					srcColor.a = shadowAlpha;
				}
				else {
					srcColor.a = 0.0;
				}
			}
		}
		else {
			srcColor.a = 0.0;
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
uniform int option;
varying vec2 vUv;
void main() {
	vec2 uv = vUv;
	bool useSrc = false;
	vec2 row;
	float delay = 0.02;
	bool isVert = bool(option);
	int segmentCount = isVert ? 10 : 7;
	float axis = isVert ? uv.y : uv.x;
	float compareAxis = isVert ? uv.x : uv.y;
	for (int i = 0; i < segmentCount; i++) {
		float fi = float(i);
		row.r = (fi * 1.0) / float(segmentCount);
		row.g = (float(i + 1) * 1.0) / float(segmentCount);
		if ((compareAxis <= row.g) && (compareAxis > row.r)) {
			if ((i % 2) == 0) {
				float line = interpolationFloat(0.0, 1.0, delay * fi, (delay * fi) + 0.86, timePercent, 1);
				if (axis < line) {
					useSrc = false;
				}
				else {
					axis -= line;
					useSrc = true;
				}
			}
			else {
				float line = interpolationFloat(1.0, 0.0, delay * fi, (delay * fi) + 0.86, timePercent, 1);
				if (axis < line) {
					axis = (1.0 - line) + axis;
					useSrc = true;
				}
				else {
					useSrc = false;
				}
			}
			break;
		}
	}
	if (isVert) {
		uv.y = axis;
	}
	else {
		uv.x = axis;
	}
	vec4 srcColor = texture2D(texturePrev, uv);
	vec4 distColor = texture2D(textureNext, uv);
	gl_FragColor = useSrc ? srcColor : distColor;
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform float width;
uniform float height;
uniform int option;
varying vec2 vUv;
void main() {
	vec2 uvSrc = vUv;
	vec2 uvDist = vUv;
	float scaleSrc = option == 1 ? interpolationFloat(1.0, 2.0, 0.0, 1.0, timePercent, 0) : interpolationFloat(1.0, 0.1, 0.0, 1.0, timePercent, 0);
	float scaleDist = option == 1 ? interpolationFloat(0.1, 1.0, 0.0, 1.0, timePercent, 0) : interpolationFloat(2.0, 1.0, 0.0, 1.0, timePercent, 0);
	uvSrc -= 0.5;
	uvSrc *= scaleSrc;
	uvSrc += 0.5;
	uvDist -= 0.5;
	uvDist *= scaleDist;
	uvDist += 0.5;
	vec4 srcColor = texture2D(texturePrev, uvSrc);
	srcColor.a = interpolationFloat(1.0, 0.0, 0.0, 1.0, timePercent, 0);
	vec4 distColor;
	if ((((uvDist.x > 1.0) || (uvDist.x < 0.0)) || (uvDist.y > 1.0)) || (uvDist.y < 0.0)) {
		distColor = vec4(0.0, 0.0, 0.0, 1.0);
	}
	else {
		distColor = texture2D(textureNext, uvDist);
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
#define PI 3.14159265358
uniform float timePercent;
uniform float horizontalSegments;
uniform float verticalSegments;
uniform float segmentWidth;
uniform float segmentHeight;
uniform int option;
varying vec2 vUv;
mat4 rotateY(float angle) {
	if (option == 1) {
		angle *= -1.0;
	}
	return mat4(cos(angle), 0.0, sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, -sin(angle), 0.0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
}
void main() {
	float halfWidth = (segmentWidth * horizontalSegments) * 0.5;
	float halfHeight = (segmentHeight * verticalSegments) * 0.5;
	vUv = uv;
	vec4 newPosition = vec4(position, 1.0);
	float stageOneAngle = PI / 14.0;
	float stageTwoAngle = (PI * 12.0) / 14.0;
	float stage_1 = 0.1;
	float stage_2 = 0.8;
	if (timePercent < 0.5) {
		newPosition.z = interpolationFloat(0.0, -100.0, 0.0, 0.5, timePercent, 0);
	}
	else {
		newPosition.z = interpolationFloat(-100.0, 0.0, 0.5, 1.0, timePercent, 0);
	}
	if (timePercent < stage_1) {
		float angle = interpolationFloat(0.0, stageOneAngle, 0.0, stage_1, timePercent, 0);
		newPosition.x += halfWidth;
		newPosition *= rotateY(angle);
		newPosition.x -= halfWidth;
	}
	else if ((timePercent >= stage_1) && (timePercent < stage_2)) {
		if (timePercent > 0.5) {
			newPosition *= rotateY(PI);
		}
		float offset = halfWidth - (sin((PI * 0.5) - stageOneAngle) * halfWidth);
		float angle = interpolationFloat(0.0, stageTwoAngle, stage_1, stage_2, timePercent, 0);
		newPosition *= rotateY(angle);
		newPosition.x += halfWidth;
		newPosition *= rotateY(stageOneAngle);
		newPosition.x -= halfWidth;
		newPosition.x += interpolationFloat(0.0, 2.0 * offset, stage_1, stage_2, timePercent, 0);
	}
	else {
		float angle = interpolationFloat(-stageOneAngle, 0.0, stage_2, 1.0, timePercent, 0);
		newPosition.x -= halfWidth;
		newPosition *= rotateY(angle);
		newPosition.x += halfWidth;
	}
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,A){b.exports=`uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	gl_FragColor = timePercent < 0.5 ? srcColor : distColor;
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
#define PI 3.14159265358
uniform sampler2D texturePrev;
uniform sampler2D textureNext;
uniform float timePercent;
uniform int option;
varying vec2 vUv;
mat2 rotateOrigin(float angle) {
	return mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
}
void main() {
	float alphaStart;
	float alphaEnd;
	float rectStart;
	float rectEnd;
	bool isRevert = (option == 3) || (option == 2);
	bool rotateParam = (option == 3) || (option == 1);
	if (timePercent <= 0.33) {
		alphaStart = isRevert ? 1.0 - (timePercent / 0.33) : 1.0;
		alphaEnd = isRevert ? 1.0 : 1.0 - (timePercent / 0.33);
		rectStart = isRevert ? 0.0 : 1.5;
		rectEnd = isRevert ? 0.5 : 2.0;
	}
	else if ((timePercent > 0.33) && (timePercent <= 0.66)) {
		alphaStart = isRevert ? 0.0 : 1.0;
		alphaEnd = isRevert ? 1.0 : 0.0;
		rectEnd = isRevert ? (((timePercent - 0.33) / 0.33) * 1.5) + 0.5 : 2.0 - (((timePercent - 0.33) / 0.33) * 1.5);
		rectStart = rectEnd - 0.5;
	}
	else {
		alphaStart = isRevert ? 0.0 : (1.0 - timePercent) / (1.0 - 0.66);
		alphaEnd = isRevert ? (1.0 - timePercent) / (1.0 - 0.66) : 0.0;
		rectStart = isRevert ? 1.5 : 0.0;
		rectEnd = isRevert ? 2.0 : 0.5;
	}
	if (!rotateParam) {
		rectStart -= 1.0;
		rectEnd -= 1.0;
	}
	float rotate = rotateParam ? PI * 0.25 : PI * 0.75;
	vec2 rotateUv = vUv * rotateOrigin(rotate);
	vec4 srcColor = texture2D(texturePrev, vUv);
	vec4 distColor = texture2D(textureNext, vUv);
	vec2 startPoint = vec2(rectStart, 0.0) * rotateOrigin(rotate);
	vec2 endPoint = vec2(rectEnd, 0.0) * rotateOrigin(rotate);
	if (rotateParam) {
		if (rotateUv.x >= endPoint.x) {
			srcColor.a = isRevert ? 1.0 : 0.0;
		}
		else if (rotateUv.x <= startPoint.x) {
			srcColor.a = isRevert ? 0.0 : 1.0;
		}
		else {
			srcColor.a = alphaStart + (((rotateUv.x - startPoint.x) / (0.5 / sqrt(2.0))) * (alphaEnd - alphaStart));
		}
	}
	else {
		if (rotateUv.x <= endPoint.x) {
			srcColor.a = isRevert ? 1.0 : 0.0;
		}
		else if (rotateUv.x >= startPoint.x) {
			srcColor.a = isRevert ? 0.0 : 1.0;
		}
		else {
			srcColor.a = alphaStart + (((startPoint.x - rotateUv.x) / (0.5 / sqrt(2.0))) * (alphaEnd - alphaStart));
		}
	}
	gl_FragColor = blendSrcOver(srcColor, distColor);
}
`},function(b,A){b.exports=`#define PI 3.14159265
attribute float left;
uniform float timePercent;
uniform float offset;
varying vec2 vUv;
uniform float option;
void main() {
	vUv = uv;
	float angle;
	if (left > 0.0) {
		angle = (PI / 6.0) * timePercent;
	}
	else {
		angle = (-PI / 6.0) * timePercent;
	}
	if (option > 0.5) {
		if (left > 0.0) {
			angle = (-PI / 6.0) * timePercent;
		}
		else {
			angle = (PI / 6.0) * timePercent;
		}
	}
	vec4 newPosition = vec4(position, 1.0);
	mat4 transform;
	mat4 rotateY = mat4(cos(angle), 0.0, -sin(angle), 0.0, 0.0, 1.0, 0.0, 0.0, sin(angle), 0, cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	if (option > 0.5) {
		rotateY = mat4(1.0, 0.0, 0.0, 0.0, 0.0, cos(angle), -sin(angle), 0.0, 0.0, sin(angle), cos(angle), 0.0, 0.0, 0.0, 0.0, 1.0);
	}
	if (option > 0.5) {
		if (left > 0.0) {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, offset * timePercent, 0.0, 1.0);
		}
		else {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -offset * timePercent, 0.0, 1.0);
		}
	}
	else {
		if (left > 0.0) {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, -offset * timePercent, 0.0, 0.0, 1.0);
		}
		else {
			transform = rotateY * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, offset * timePercent, 0.0, 0.0, 1.0);
		}
	}
	newPosition = transform * newPosition;
	gl_Position = (projectionMatrix * modelViewMatrix) * newPosition;
}
`},function(b,A){b.exports=`uniform sampler2D prevTexture;
uniform float timePercent;
varying vec2 vUv;
void main() {
	vec4 color = texture2D(prevTexture, vUv);
	color.a = 1.0 - timePercent;
	gl_FragColor = color;
}
`},function(b,A,v){(function(P){var M=v(109),I=v(110),D=setTimeout;function k(R){return Boolean(R&&R.length!==void 0)}function W(){}function X(R){if(!(this instanceof X))throw new TypeError("Promises must be constructed via new");if(typeof R!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],L(R,this)}function V(R,F){for(;R._state===3;)R=R._value;R._state!==0?(R._handled=!0,X._immediateFn(function(){var Y=R._state===1?F.onFulfilled:F.onRejected;if(Y!==null){var O;try{O=Y(R._value)}catch(H){return void pt(F.promise,H)}et(F.promise,O)}else(R._state===1?et:pt)(F.promise,R._value)})):R._deferreds.push(F)}function et(R,F){try{if(F===R)throw new TypeError("A promise cannot be resolved with itself.");if(F&&(typeof F=="object"||typeof F=="function")){var Y=F.then;if(F instanceof X)return R._state=3,R._value=F,void Dt(R);if(typeof Y=="function")return void L((O=Y,H=F,function(){O.apply(H,arguments)}),R)}R._state=1,R._value=F,Dt(R)}catch(tt){pt(R,tt)}var O,H}function pt(R,F){R._state=2,R._value=F,Dt(R)}function Dt(R){R._state===2&&R._deferreds.length===0&&X._immediateFn(function(){R._handled||X._unhandledRejectionFn(R._value)});for(var F=0,Y=R._deferreds.length;F<Y;F++)V(R,R._deferreds[F]);R._deferreds=null}function At(R,F,Y){this.onFulfilled=typeof R=="function"?R:null,this.onRejected=typeof F=="function"?F:null,this.promise=Y}function L(R,F){var Y=!1;try{R(function(O){Y||(Y=!0,et(F,O))},function(O){Y||(Y=!0,pt(F,O))})}catch(O){if(Y)return;Y=!0,pt(F,O)}}X.prototype.catch=function(R){return this.then(null,R)},X.prototype.then=function(R,F){var Y=new this.constructor(W);return V(this,new At(R,F,Y)),Y},X.prototype.finally=M.a,X.all=function(R){return new X(function(F,Y){if(!k(R))return Y(new TypeError("Promise.all accepts an array"));var O=Array.prototype.slice.call(R);if(O.length===0)return F([]);var H=O.length;function tt(Ot,Vt){try{if(Vt&&(typeof Vt=="object"||typeof Vt=="function")){var st=Vt.then;if(typeof st=="function")return void st.call(Vt,function(z){tt(Ot,z)},Y)}O[Ot]=Vt,--H==0&&F(O)}catch(z){Y(z)}}for(var G=0;G<O.length;G++)tt(G,O[G])})},X.allSettled=I.a,X.resolve=function(R){return R&&typeof R=="object"&&R.constructor===X?R:new X(function(F){F(R)})},X.reject=function(R){return new X(function(F,Y){Y(R)})},X.race=function(R){return new X(function(F,Y){if(!k(R))return Y(new TypeError("Promise.race accepts an array"));for(var O=0,H=R.length;O<H;O++)X.resolve(R[O]).then(F,Y)})},X._immediateFn=typeof P=="function"&&function(R){P(R)}||function(R){D(R,0)},X._unhandledRejectionFn=function(R){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",R)},A.a=X}).call(this,v(140).setImmediate)},function(b,A,v){A.a=function(P){var M=this.constructor;return this.then(function(I){return M.resolve(P()).then(function(){return I})},function(I){return M.resolve(P()).then(function(){return M.reject(I)})})}},function(b,A,v){A.a=function(P){return new this(function(M,I){if(!P||P.length===void 0)return I(new TypeError(typeof P+" "+P+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var D=Array.prototype.slice.call(P);if(D.length===0)return M([]);var k=D.length;function W(V,et){if(et&&(typeof et=="object"||typeof et=="function")){var pt=et.then;if(typeof pt=="function")return void pt.call(et,function(Dt){W(V,Dt)},function(Dt){D[V]={status:"rejected",reason:Dt},--k==0&&M(D)})}D[V]={status:"fulfilled",value:et},--k==0&&M(D)}for(var X=0;X<D.length;X++)W(X,D[X])})}},function(b,A,v){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var P=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;function D(k){if(k==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(k)}b.exports=function(){try{if(!Object.assign)return!1;var k=new String("abc");if(k[5]="de",Object.getOwnPropertyNames(k)[0]==="5")return!1;for(var W={},X=0;X<10;X++)W["_"+String.fromCharCode(X)]=X;if(Object.getOwnPropertyNames(W).map(function(et){return W[et]}).join("")!=="0123456789")return!1;var V={};return"abcdefghijklmnopqrst".split("").forEach(function(et){V[et]=et}),Object.keys(Object.assign({},V)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(k,W){for(var X,V,et=D(k),pt=1;pt<arguments.length;pt++){for(var Dt in X=Object(arguments[pt]))M.call(X,Dt)&&(et[Dt]=X[Dt]);if(P){V=P(X);for(var At=0;At<V.length;At++)I.call(X,V[At])&&(et[V[At]]=X[V[At]])}}return et}},function(b,A,v){var P=v(20),M=v(15);b.exports=function(I){return I===!0||I===!1||M(I)&&P(I)=="[object Boolean]"}},function(b,A){b.exports=`precision mediump float;
attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 outputFrame;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord() {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	filterCoord = aVertexPosition * outputFrame.zw;
}
`},function(b,A){b.exports=`vec4 blendSrcOver(vec4 src, vec4 dist) {
	vec4 result = vec4(0.0, 0.0, 0.0, 0.0);
	src.r *= src.a;
	src.g *= src.a;
	src.b *= src.a;
	result.a = src.a + (dist.a * (1.0 - src.a));
	result.r = (src.r + (dist.r * (1.0 - src.a))) / result.a;
	result.g = (src.g + (dist.g * (1.0 - src.a))) / result.a;
	result.b = (src.b + (dist.b * (1.0 - src.a))) / result.a;
	return result;
}
precision mediump float;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
uniform sampler2D uSdfSampler;
uniform float uSdfIsReady;
uniform float uSdfMaxDis;
uniform float uRad;
uniform vec4 uGlowColor;
uniform vec2 uSdfPosition;
uniform vec4 inputSize;
uniform vec4 outputFrame;
void main() {
	vec4 texColor = texture2D(uSampler, vTextureCoord);
	vec4 glowColor = vec4(uGlowColor.rgb * uGlowColor.a, uGlowColor.a);
	float a = 1.0;
	if (uSdfIsReady > 0.0) {
		vec2 cod = vec2(filterCoord.x / uShapeFilterArea.z, filterCoord.y / uShapeFilterArea.w);
		vec4 sdfColor = texture2D(uSdfSampler, cod + uSdfPosition);
		float dis = sdfColor.a * uSdfMaxDis;
		if ((sdfColor.r <= 0.0) && (dis >= (uRad * 0.5))) {
			a = 1.0 - smoothstep(uRad * 0.5, uRad, dis);
		}
	}
	vec4 resultColor = blendSrcOver(texColor, glowColor);
	resultColor.rgb *= resultColor.a;
	resultColor.rgb *= a;
	resultColor.a *= a;
	gl_FragColor = resultColor;
}
`},function(b,A){b.exports=`precision mediump float;
varying vec2 vTextureCoord;
varying vec2 filterCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
uniform sampler2D uSdfSampler;
uniform float uSdfIsReady;
uniform float uSdfMaxDis;
uniform float uRad;
uniform vec4 inputSize;
uniform vec4 outputFrame;
void main() {
	vec4 texColor = texture2D(uSampler, vTextureCoord);
	if (uSdfIsReady > 0.0) {
		float dx = uShapeFilterArea.x < 0.0 ? -uShapeFilterArea.x : 0.0;
		float dy = uShapeFilterArea.y < 0.0 ? -uShapeFilterArea.y : 0.0;
		vec2 cod = vec2((filterCoord.x + dx) / uShapeFilterArea.z, (filterCoord.y + dy) / uShapeFilterArea.w);
		vec4 sdfColor = texture2D(uSdfSampler, cod);
		float dis = sdfColor.a * uSdfMaxDis;
		if (texColor.a > 0.0392156862745098) {
			if (dis <= (uRad / 2.0)) {
				float a = smoothstep(0.0, uRad / 2.0, dis) * 0.1;
				texColor.rgb *= a;
				texColor.a = a;
			}
			else if ((dis > (uRad / 2.0)) && (dis < (uRad * 1.2))) {
				float a = (smoothstep(uRad / 2.0, uRad * 1.2, dis) * 0.9) + 0.1;
				texColor.rgb *= a;
				texColor.a = a;
			}
		}
		else {
			texColor.rgba *= 0.0;
		}
	}
	gl_FragColor = texColor;
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 uColor;
void main() {
	vec4 sourceColor = texture2D(uSampler, vTextureCoord);
	if (sourceColor.a == 0.0) {
		gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	}
	else {
		gl_FragColor = uColor * sourceColor.a;
	}
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform vec4 inputSize;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform float uStartAlpha;
uniform float uEndAlpha;
uniform float uStartPos;
uniform float uEndPos;
uniform float uHeight;
void main() {
	vec4 sourceColor = texture2D(uSampler, vTextureCoord);
	vec2 cod = vTextureCoord * inputSize.xy;
	float startY = uStartPos * uHeight;
	float endY = uEndPos * uHeight;
	if ((cod.y >= startY) && (cod.y <= endY)) {
		float alpha = uStartAlpha - (((cod.y - startY) / (endY - startY)) * (uStartAlpha - uEndAlpha));
		gl_FragColor = sourceColor * alpha;
	}
	else {
		gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	}
}
`},function(b,A){b.exports=`precision mediump float;
varying vec2 vTextureCoord;
uniform vec4 inputSize;
varying vec2 filterCoord;
uniform vec4 uShapeFilterArea;
uniform sampler2D uSampler;
void main() {
	vec4 texColor = texture2D(uSampler, vTextureCoord);
	if (texColor.r > 0.0) {
		vec2 translateCoord = vec2(filterCoord.x + 10.0, filterCoord.y);
		vec4 translateColor = texture2D(uSampler, translateCoord * inputSize.zw);
		if (translateColor.a > 0.0) {
			gl_FragColor = texColor;
		}
		else {
			gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
		}
	}
	else {
		gl_FragColor = texColor;
	}
}
`},function(b,A,v){var P;(function(M,I){var D="model",k="name",W="type",X="vendor",V="version",et="mobile",pt="tablet",Dt="smarttv",At=function(st){for(var z={},U=0;U<st.length;U++)z[st[U].toUpperCase()]=st[U];return z},L=function(st,z){return typeof st=="string"&&R(z).indexOf(R(st))!==-1},R=function(st){return st.toLowerCase()},F=function(st,z){if(typeof st=="string")return st=st.replace(/^\s\s*/,"").replace(/\s\s*$/,""),z===void 0?st:st.substring(0,255)},Y=function(st,z){for(var U,ft,$,gt,Lt,K,dt=0;dt<z.length&&!Lt;){var it=z[dt],_t=z[dt+1];for(U=ft=0;U<it.length&&!Lt;)if(Lt=it[U++].exec(st))for($=0;$<_t.length;$++)K=Lt[++ft],typeof(gt=_t[$])=="object"&&gt.length>0?gt.length===2?typeof gt[1]=="function"?this[gt[0]]=gt[1].call(this,K):this[gt[0]]=gt[1]:gt.length===3?typeof gt[1]!="function"||gt[1].exec&&gt[1].test?this[gt[0]]=K?K.replace(gt[1],gt[2]):void 0:this[gt[0]]=K?gt[1].call(this,K,gt[2]):void 0:gt.length===4&&(this[gt[0]]=K?gt[3].call(this,K.replace(gt[1],gt[2])):void 0):this[gt]=K||void 0;dt+=2}},O=function(st,z){for(var U in z)if(typeof z[U]=="object"&&z[U].length>0){for(var ft=0;ft<z[U].length;ft++)if(L(z[U][ft],st))return U==="?"?void 0:U}else if(L(z[U],st))return U==="?"?void 0:U;return st},H={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},tt={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[V,[k,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[V,[k,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[k,V],[/opios[\/ ]+([\w\.]+)/i],[V,[k,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[V,[k,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[k,V],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[V,[k,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[V,[k,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[V,[k,"WeChat"]],[/konqueror\/([\w\.]+)/i],[V,[k,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[V,[k,"IE"]],[/yabrowser\/([\w\.]+)/i],[V,[k,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[k,/(.+)/,"$1 Secure Browser"],V],[/\bfocus\/([\w\.]+)/i],[V,[k,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[V,[k,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[V,[k,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[V,[k,"Dolphin"]],[/coast\/([\w\.]+)/i],[V,[k,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[V,[k,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[V,[k,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[k,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[k,/(.+)/,"$1 Browser"],V],[/(comodo_dragon)\/([\w\.]+)/i],[[k,/_/g," "],V],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[k,V],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[k],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[k,"Facebook"],V],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[k,V],[/\bgsa\/([\w\.]+) .*safari\//i],[V,[k,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[V,[k,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[k,"Chrome WebView"],V],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[V,[k,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[k,V],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[V,[k,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[V,k],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[k,[V,O,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[k,V],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[k,"Netscape"],V],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[V,[k,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[k,V]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",R]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",R]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",R]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[D,[X,"Samsung"],[W,pt]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[D,[X,"Samsung"],[W,et]],[/\((ip(?:hone|od)[\w ]*);/i],[D,[X,"Apple"],[W,et]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[D,[X,"Apple"],[W,pt]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[D,[X,"Huawei"],[W,pt]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[D,[X,"Huawei"],[W,et]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[D,/_/g," "],[X,"Xiaomi"],[W,et]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[D,/_/g," "],[X,"Xiaomi"],[W,pt]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[D,[X,"OPPO"],[W,et]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[D,[X,"Vivo"],[W,et]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[D,[X,"Realme"],[W,et]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[D,[X,"Motorola"],[W,et]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[D,[X,"Motorola"],[W,pt]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[D,[X,"LG"],[W,pt]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[D,[X,"LG"],[W,et]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[D,[X,"Lenovo"],[W,pt]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[D,/_/g," "],[X,"Nokia"],[W,et]],[/(pixel c)\b/i],[D,[X,"Google"],[W,pt]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[D,[X,"Google"],[W,et]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[D,[X,"Sony"],[W,et]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[D,"Xperia Tablet"],[X,"Sony"],[W,pt]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[D,[X,"OnePlus"],[W,et]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[D,[X,"Amazon"],[W,pt]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[D,/(.+)/g,"Fire Phone $1"],[X,"Amazon"],[W,et]],[/(playbook);[-\w\),; ]+(rim)/i],[D,X,[W,pt]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[D,[X,"BlackBerry"],[W,et]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[D,[X,"ASUS"],[W,pt]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[D,[X,"ASUS"],[W,et]],[/(nexus 9)/i],[D,[X,"HTC"],[W,pt]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[X,[D,/_/g," "],[W,et]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[D,[X,"Acer"],[W,pt]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[D,[X,"Meizu"],[W,et]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[D,[X,"Sharp"],[W,et]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[X,D,[W,et]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[X,D,[W,pt]],[/(surface duo)/i],[D,[X,"Microsoft"],[W,pt]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[D,[X,"Fairphone"],[W,et]],[/(u304aa)/i],[D,[X,"AT&T"],[W,et]],[/\bsie-(\w*)/i],[D,[X,"Siemens"],[W,et]],[/\b(rct\w+) b/i],[D,[X,"RCA"],[W,pt]],[/\b(venue[\d ]{2,7}) b/i],[D,[X,"Dell"],[W,pt]],[/\b(q(?:mv|ta)\w+) b/i],[D,[X,"Verizon"],[W,pt]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[D,[X,"Barnes & Noble"],[W,pt]],[/\b(tm\d{3}\w+) b/i],[D,[X,"NuVision"],[W,pt]],[/\b(k88) b/i],[D,[X,"ZTE"],[W,pt]],[/\b(nx\d{3}j) b/i],[D,[X,"ZTE"],[W,et]],[/\b(gen\d{3}) b.+49h/i],[D,[X,"Swiss"],[W,et]],[/\b(zur\d{3}) b/i],[D,[X,"Swiss"],[W,pt]],[/\b((zeki)?tb.*\b) b/i],[D,[X,"Zeki"],[W,pt]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[X,"Dragon Touch"],D,[W,pt]],[/\b(ns-?\w{0,9}) b/i],[D,[X,"Insignia"],[W,pt]],[/\b((nxa|next)-?\w{0,9}) b/i],[D,[X,"NextBook"],[W,pt]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[X,"Voice"],D,[W,et]],[/\b(lvtel\-)?(v1[12]) b/i],[[X,"LvTel"],D,[W,et]],[/\b(ph-1) /i],[D,[X,"Essential"],[W,et]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[D,[X,"Envizen"],[W,pt]],[/\b(trio[-\w\. ]+) b/i],[D,[X,"MachSpeed"],[W,pt]],[/\btu_(1491) b/i],[D,[X,"Rotor"],[W,pt]],[/(shield[\w ]+) b/i],[D,[X,"Nvidia"],[W,pt]],[/(sprint) (\w+)/i],[X,D,[W,et]],[/(kin\.[onetw]{3})/i],[[D,/\./g," "],[X,"Microsoft"],[W,et]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[D,[X,"Zebra"],[W,pt]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[D,[X,"Zebra"],[W,et]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[X,D,[W,"console"]],[/droid.+; (shield) bui/i],[D,[X,"Nvidia"],[W,"console"]],[/(playstation [345portablevi]+)/i],[D,[X,"Sony"],[W,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[D,[X,"Microsoft"],[W,"console"]],[/smart-tv.+(samsung)/i],[X,[W,Dt]],[/hbbtv.+maple;(\d+)/i],[[D,/^/,"SmartTV"],[X,"Samsung"],[W,Dt]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[X,"LG"],[W,Dt]],[/(apple) ?tv/i],[X,[D,"Apple TV"],[W,Dt]],[/crkey/i],[[D,"Chromecast"],[X,"Google"],[W,Dt]],[/droid.+aft(\w)( bui|\))/i],[D,[X,"Amazon"],[W,Dt]],[/\(dtv[\);].+(aquos)/i],[D,[X,"Sharp"],[W,Dt]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[X,F],[D,F],[W,Dt]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[W,Dt]],[/((pebble))app/i],[X,D,[W,"wearable"]],[/droid.+; (glass) \d/i],[D,[X,"Google"],[W,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[D,[X,"Zebra"],[W,"wearable"]],[/(quest( 2)?)/i],[D,[X,"Facebook"],[W,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[X,[W,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[D,[W,et]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[D,[W,pt]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[W,pt]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[W,et]],[/(android[-\w\. ]{0,9});.+buil/i],[D,[X,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[V,[k,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[V,[k,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[k,V],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[V,k]],os:[[/microsoft (windows) (vista|xp)/i],[k,V],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[k,[V,O,H]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[k,"Windows"],[V,O,H]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[V,/_/g,"."],[k,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[k,"Mac OS"],[V,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[V,k],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[k,V],[/\(bb(10);/i],[V,[k,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[V,[k,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[V,[k,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[V,[k,"webOS"]],[/crkey\/([\d\.]+)/i],[V,[k,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[k,"Chromium OS"],V],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[k,V],[/(sunos) ?([\w\.\d]*)/i],[[k,"Solaris"],V],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[k,V]]},G=function(st,z){if(typeof st=="object"&&(z=st,st=void 0),!(this instanceof G))return new G(st,z).getResult();var U=st||(M!==void 0&&M.navigator&&M.navigator.userAgent?M.navigator.userAgent:""),ft=z?function($,gt){var Lt={};for(var K in $)gt[K]&&gt[K].length%2==0?Lt[K]=gt[K].concat($[K]):Lt[K]=$[K];return Lt}(tt,z):tt;return this.getBrowser=function(){var $,gt={};return gt[k]=void 0,gt[V]=void 0,Y.call(gt,U,ft.browser),gt.major=typeof($=gt.version)=="string"?$.replace(/[^\d\.]/g,"").split(".")[0]:void 0,gt},this.getCPU=function(){var $={architecture:void 0};return Y.call($,U,ft.cpu),$},this.getDevice=function(){var $={vendor:void 0,model:void 0,type:void 0};return Y.call($,U,ft.device),$},this.getEngine=function(){var $={name:void 0,version:void 0};return Y.call($,U,ft.engine),$},this.getOS=function(){var $={name:void 0,version:void 0};return Y.call($,U,ft.os),$},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return U},this.setUA=function($){return U=typeof $=="string"&&$.length>255?F($,255):$,this},this.setUA(U),this};G.VERSION="1.0.2",G.BROWSER=At([k,V,"major"]),G.CPU=At(["architecture"]),G.DEVICE=At([D,X,W,"console",et,Dt,pt,"wearable","embedded"]),G.ENGINE=G.OS=At([k,V]),A!==void 0?(b!==void 0&&b.exports&&(A=b.exports=G),A.UAParser=G):v(149)?(P=function(){return G}.call(A,v,A,b))===void 0||(b.exports=P):M!==void 0&&(M.UAParser=G);var Ot=M!==void 0&&(M.jQuery||M.Zepto);if(Ot&&!Ot.ua){var Vt=new G;Ot.ua=Vt.getResult(),Ot.ua.get=function(){return Vt.getUA()},Ot.ua.set=function(st){Vt.setUA(st);var z=Vt.getResult();for(var U in z)Ot.ua[U]=z[U]}}})(typeof window=="object"?window:this)},function(b,A,v){(function(P){var M;/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){var I=function(){this.init()};I.prototype={init:function(){var L=this||D;return L._counter=1e3,L._html5AudioPool=[],L.html5PoolSize=10,L._codecs={},L._howls=[],L._muted=!1,L._volume=1,L._canPlayEvent="canplaythrough",L._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,L.masterGain=null,L.noAudio=!1,L.usingWebAudio=!0,L.autoSuspend=!0,L.ctx=null,L.autoUnlock=!0,L._setup(),L},volume:function(L){var R=this||D;if(L=parseFloat(L),R.ctx||At(),L!==void 0&&L>=0&&L<=1){if(R._volume=L,R._muted)return R;R.usingWebAudio&&R.masterGain.gain.setValueAtTime(L,D.ctx.currentTime);for(var F=0;F<R._howls.length;F++)if(!R._howls[F]._webAudio)for(var Y=R._howls[F]._getSoundIds(),O=0;O<Y.length;O++){var H=R._howls[F]._soundById(Y[O]);H&&H._node&&(H._node.volume=H._volume*L)}return R}return R._volume},mute:function(L){var R=this||D;R.ctx||At(),R._muted=L,R.usingWebAudio&&R.masterGain.gain.setValueAtTime(L?0:R._volume,D.ctx.currentTime);for(var F=0;F<R._howls.length;F++)if(!R._howls[F]._webAudio)for(var Y=R._howls[F]._getSoundIds(),O=0;O<Y.length;O++){var H=R._howls[F]._soundById(Y[O]);H&&H._node&&(H._node.muted=!!L||H._muted)}return R},stop:function(){for(var L=this||D,R=0;R<L._howls.length;R++)L._howls[R].stop();return L},unload:function(){for(var L=this||D,R=L._howls.length-1;R>=0;R--)L._howls[R].unload();return L.usingWebAudio&&L.ctx&&L.ctx.close!==void 0&&(L.ctx.close(),L.ctx=null,At()),L},codecs:function(L){return(this||D)._codecs[L.replace(/^x-/,"")]},_setup:function(){var L=this||D;if(L.state=L.ctx&&L.ctx.state||"suspended",L._autoSuspend(),!L.usingWebAudio)if(typeof Audio!="undefined")try{new Audio().oncanplaythrough===void 0&&(L._canPlayEvent="canplay")}catch{L.noAudio=!0}else L.noAudio=!0;try{new Audio().muted&&(L.noAudio=!0)}catch{}return L.noAudio||L._setupCodecs(),L},_setupCodecs:function(){var L=this||D,R=null;try{R=typeof Audio!="undefined"?new Audio:null}catch{return L}if(!R||typeof R.canPlayType!="function")return L;var F=R.canPlayType("audio/mpeg;").replace(/^no$/,""),Y=L._navigator?L._navigator.userAgent:"",O=Y.match(/OPR\/([0-6].)/g),H=O&&parseInt(O[0].split("/")[1],10)<33,tt=Y.indexOf("Safari")!==-1&&Y.indexOf("Chrome")===-1,G=Y.match(/Version\/(.*?) /),Ot=tt&&G&&parseInt(G[1],10)<15;return L._codecs={mp3:!(H||!F&&!R.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!F,opus:!!R.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!R.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!R.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(R.canPlayType('audio/wav; codecs="1"')||R.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!R.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!R.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(R.canPlayType("audio/x-m4a;")||R.canPlayType("audio/m4a;")||R.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(R.canPlayType("audio/x-m4b;")||R.canPlayType("audio/m4b;")||R.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(R.canPlayType("audio/x-mp4;")||R.canPlayType("audio/mp4;")||R.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(Ot||!R.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(Ot||!R.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!R.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(R.canPlayType("audio/x-flac;")||R.canPlayType("audio/flac;")).replace(/^no$/,"")},L},_unlockAudio:function(){var L=this||D;if(!L._audioUnlocked&&L.ctx){L._audioUnlocked=!1,L.autoUnlock=!1,L._mobileUnloaded||L.ctx.sampleRate===44100||(L._mobileUnloaded=!0,L.unload()),L._scratchBuffer=L.ctx.createBuffer(1,1,22050);var R=function(F){for(;L._html5AudioPool.length<L.html5PoolSize;)try{var Y=new Audio;Y._unlocked=!0,L._releaseHtml5Audio(Y)}catch{L.noAudio=!0;break}for(var O=0;O<L._howls.length;O++)if(!L._howls[O]._webAudio)for(var H=L._howls[O]._getSoundIds(),tt=0;tt<H.length;tt++){var G=L._howls[O]._soundById(H[tt]);G&&G._node&&!G._node._unlocked&&(G._node._unlocked=!0,G._node.load())}L._autoResume();var Ot=L.ctx.createBufferSource();Ot.buffer=L._scratchBuffer,Ot.connect(L.ctx.destination),Ot.start===void 0?Ot.noteOn(0):Ot.start(0),typeof L.ctx.resume=="function"&&L.ctx.resume(),Ot.onended=function(){Ot.disconnect(0),L._audioUnlocked=!0,document.removeEventListener("touchstart",R,!0),document.removeEventListener("touchend",R,!0),document.removeEventListener("click",R,!0),document.removeEventListener("keydown",R,!0);for(var Vt=0;Vt<L._howls.length;Vt++)L._howls[Vt]._emit("unlock")}};return document.addEventListener("touchstart",R,!0),document.addEventListener("touchend",R,!0),document.addEventListener("click",R,!0),document.addEventListener("keydown",R,!0),L}},_obtainHtml5Audio:function(){var L=this||D;if(L._html5AudioPool.length)return L._html5AudioPool.pop();var R=new Audio().play();return R&&typeof Promise!="undefined"&&(R instanceof Promise||typeof R.then=="function")&&R.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(L){var R=this||D;return L._unlocked&&R._html5AudioPool.push(L),R},_autoSuspend:function(){var L=this;if(L.autoSuspend&&L.ctx&&L.ctx.suspend!==void 0&&D.usingWebAudio){for(var R=0;R<L._howls.length;R++)if(L._howls[R]._webAudio){for(var F=0;F<L._howls[R]._sounds.length;F++)if(!L._howls[R]._sounds[F]._paused)return L}return L._suspendTimer&&clearTimeout(L._suspendTimer),L._suspendTimer=setTimeout(function(){if(L.autoSuspend){L._suspendTimer=null,L.state="suspending";var Y=function(){L.state="suspended",L._resumeAfterSuspend&&(delete L._resumeAfterSuspend,L._autoResume())};L.ctx.suspend().then(Y,Y)}},3e4),L}},_autoResume:function(){var L=this;if(L.ctx&&L.ctx.resume!==void 0&&D.usingWebAudio)return L.state==="running"&&L.ctx.state!=="interrupted"&&L._suspendTimer?(clearTimeout(L._suspendTimer),L._suspendTimer=null):L.state==="suspended"||L.state==="running"&&L.ctx.state==="interrupted"?(L.ctx.resume().then(function(){L.state="running";for(var R=0;R<L._howls.length;R++)L._howls[R]._emit("resume")}),L._suspendTimer&&(clearTimeout(L._suspendTimer),L._suspendTimer=null)):L.state==="suspending"&&(L._resumeAfterSuspend=!0),L}};var D=new I,k=function(L){L.src&&L.src.length!==0?this.init(L):console.error("An array of source files must be passed with any new Howl.")};k.prototype={init:function(L){var R=this;return D.ctx||At(),R._autoplay=L.autoplay||!1,R._format=typeof L.format!="string"?L.format:[L.format],R._html5=L.html5||!1,R._muted=L.mute||!1,R._loop=L.loop||!1,R._pool=L.pool||5,R._preload=typeof L.preload!="boolean"&&L.preload!=="metadata"||L.preload,R._rate=L.rate||1,R._sprite=L.sprite||{},R._src=typeof L.src!="string"?L.src:[L.src],R._volume=L.volume!==void 0?L.volume:1,R._xhr={method:L.xhr&&L.xhr.method?L.xhr.method:"GET",headers:L.xhr&&L.xhr.headers?L.xhr.headers:null,withCredentials:!(!L.xhr||!L.xhr.withCredentials)&&L.xhr.withCredentials},R._duration=0,R._state="unloaded",R._sounds=[],R._endTimers={},R._queue=[],R._playLock=!1,R._onend=L.onend?[{fn:L.onend}]:[],R._onfade=L.onfade?[{fn:L.onfade}]:[],R._onload=L.onload?[{fn:L.onload}]:[],R._onloaderror=L.onloaderror?[{fn:L.onloaderror}]:[],R._onplayerror=L.onplayerror?[{fn:L.onplayerror}]:[],R._onpause=L.onpause?[{fn:L.onpause}]:[],R._onplay=L.onplay?[{fn:L.onplay}]:[],R._onstop=L.onstop?[{fn:L.onstop}]:[],R._onmute=L.onmute?[{fn:L.onmute}]:[],R._onvolume=L.onvolume?[{fn:L.onvolume}]:[],R._onrate=L.onrate?[{fn:L.onrate}]:[],R._onseek=L.onseek?[{fn:L.onseek}]:[],R._onunlock=L.onunlock?[{fn:L.onunlock}]:[],R._onresume=[],R._webAudio=D.usingWebAudio&&!R._html5,D.ctx!==void 0&&D.ctx&&D.autoUnlock&&D._unlockAudio(),D._howls.push(R),R._autoplay&&R._queue.push({event:"play",action:function(){R.play()}}),R._preload&&R._preload!=="none"&&R.load(),R},load:function(){var L=null;if(D.noAudio)this._emit("loaderror",null,"No audio support.");else{typeof this._src=="string"&&(this._src=[this._src]);for(var R=0;R<this._src.length;R++){var F,Y;if(this._format&&this._format[R])F=this._format[R];else{if(typeof(Y=this._src[R])!="string"){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(F=/^data:audio\/([^;,]+);/i.exec(Y))||(F=/\.([^.]+)$/.exec(Y.split("?",1)[0])),F&&(F=F[1].toLowerCase())}if(F||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),F&&D.codecs(F)){L=this._src[R];break}}if(L)return this._src=L,this._state="loading",window.location.protocol==="https:"&&L.slice(0,5)==="http:"&&(this._html5=!0,this._webAudio=!1),new W(this),this._webAudio&&V(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(L,R){var F=this,Y=null;if(typeof L=="number")Y=L,L=null;else{if(typeof L=="string"&&F._state==="loaded"&&!F._sprite[L])return null;if(L===void 0&&(L="__default",!F._playLock)){for(var O=0,H=0;H<F._sounds.length;H++)F._sounds[H]._paused&&!F._sounds[H]._ended&&(O++,Y=F._sounds[H]._id);O===1?L=null:Y=null}}var tt=Y?F._soundById(Y):F._inactiveSound();if(!tt)return null;if(Y&&!L&&(L=tt._sprite||"__default"),F._state!=="loaded"){tt._sprite=L,tt._ended=!1;var G=tt._id;return F._queue.push({event:"play",action:function(){F.play(G)}}),G}if(Y&&!tt._paused)return R||F._loadQueue("play"),tt._id;F._webAudio&&D._autoResume();var Ot=Math.max(0,tt._seek>0?tt._seek:F._sprite[L][0]/1e3),Vt=Math.max(0,(F._sprite[L][0]+F._sprite[L][1])/1e3-Ot),st=1e3*Vt/Math.abs(tt._rate),z=F._sprite[L][0]/1e3,U=(F._sprite[L][0]+F._sprite[L][1])/1e3;tt._sprite=L,tt._ended=!1;var ft=function(){tt._paused=!1,tt._seek=Ot,tt._start=z,tt._stop=U,tt._loop=!(!tt._loop&&!F._sprite[L][2])};if(!(Ot>=U)){var $=tt._node;if(F._webAudio){var gt=function(){F._playLock=!1,ft(),F._refreshBuffer(tt);var it=tt._muted||F._muted?0:tt._volume;$.gain.setValueAtTime(it,D.ctx.currentTime),tt._playStart=D.ctx.currentTime,$.bufferSource.start===void 0?tt._loop?$.bufferSource.noteGrainOn(0,Ot,86400):$.bufferSource.noteGrainOn(0,Ot,Vt):tt._loop?$.bufferSource.start(0,Ot,86400):$.bufferSource.start(0,Ot,Vt),st!==1/0&&(F._endTimers[tt._id]=setTimeout(F._ended.bind(F,tt),st)),R||setTimeout(function(){F._emit("play",tt._id),F._loadQueue()},0)};D.state==="running"&&D.ctx.state!=="interrupted"?gt():(F._playLock=!0,F.once("resume",gt),F._clearTimer(tt._id))}else{var Lt=function(){$.currentTime=Ot,$.muted=tt._muted||F._muted||D._muted||$.muted,$.volume=tt._volume*D.volume(),$.playbackRate=tt._rate;try{var it=$.play();if(it&&typeof Promise!="undefined"&&(it instanceof Promise||typeof it.then=="function")?(F._playLock=!0,ft(),it.then(function(){F._playLock=!1,$._unlocked=!0,R?F._loadQueue():F._emit("play",tt._id)}).catch(function(){F._playLock=!1,F._emit("playerror",tt._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),tt._ended=!0,tt._paused=!0})):R||(F._playLock=!1,ft(),F._emit("play",tt._id)),$.playbackRate=tt._rate,$.paused)return void F._emit("playerror",tt._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");L!=="__default"||tt._loop?F._endTimers[tt._id]=setTimeout(F._ended.bind(F,tt),st):(F._endTimers[tt._id]=function(){F._ended(tt),$.removeEventListener("ended",F._endTimers[tt._id],!1)},$.addEventListener("ended",F._endTimers[tt._id],!1))}catch(_t){F._emit("playerror",tt._id,_t)}};$.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&($.src=F._src,$.load());var K=window&&window.ejecta||!$.readyState&&D._navigator.isCocoonJS;if($.readyState>=3||K)Lt();else{F._playLock=!0,F._state="loading";var dt=function(){F._state="loaded",Lt(),$.removeEventListener(D._canPlayEvent,dt,!1)};$.addEventListener(D._canPlayEvent,dt,!1),F._clearTimer(tt._id)}}return tt._id}F._ended(tt)},pause:function(L){var R=this;if(R._state!=="loaded"||R._playLock)return R._queue.push({event:"pause",action:function(){R.pause(L)}}),R;for(var F=R._getSoundIds(L),Y=0;Y<F.length;Y++){R._clearTimer(F[Y]);var O=R._soundById(F[Y]);if(O&&!O._paused&&(O._seek=R.seek(F[Y]),O._rateSeek=0,O._paused=!0,R._stopFade(F[Y]),O._node))if(R._webAudio){if(!O._node.bufferSource)continue;O._node.bufferSource.stop===void 0?O._node.bufferSource.noteOff(0):O._node.bufferSource.stop(0),R._cleanBuffer(O._node)}else isNaN(O._node.duration)&&O._node.duration!==1/0||O._node.pause();arguments[1]||R._emit("pause",O?O._id:null)}return R},stop:function(L,R){var F=this;if(F._state!=="loaded"||F._playLock)return F._queue.push({event:"stop",action:function(){F.stop(L)}}),F;for(var Y=F._getSoundIds(L),O=0;O<Y.length;O++){F._clearTimer(Y[O]);var H=F._soundById(Y[O]);H&&(H._seek=H._start||0,H._rateSeek=0,H._paused=!0,H._ended=!0,F._stopFade(Y[O]),H._node&&(F._webAudio?H._node.bufferSource&&(H._node.bufferSource.stop===void 0?H._node.bufferSource.noteOff(0):H._node.bufferSource.stop(0),F._cleanBuffer(H._node)):isNaN(H._node.duration)&&H._node.duration!==1/0||(H._node.currentTime=H._start||0,H._node.pause(),H._node.duration===1/0&&F._clearSound(H._node))),R||F._emit("stop",H._id))}return F},mute:function(L,R){var F=this;if(F._state!=="loaded"||F._playLock)return F._queue.push({event:"mute",action:function(){F.mute(L,R)}}),F;if(R===void 0){if(typeof L!="boolean")return F._muted;F._muted=L}for(var Y=F._getSoundIds(R),O=0;O<Y.length;O++){var H=F._soundById(Y[O]);H&&(H._muted=L,H._interval&&F._stopFade(H._id),F._webAudio&&H._node?H._node.gain.setValueAtTime(L?0:H._volume,D.ctx.currentTime):H._node&&(H._node.muted=!!D._muted||L),F._emit("mute",H._id))}return F},volume:function(){var L,R,F,Y=this,O=arguments;if(O.length===0)return Y._volume;if(O.length===1||O.length===2&&O[1]===void 0){var H=Y._getSoundIds(),tt=H.indexOf(O[0]);tt>=0?R=parseInt(O[0],10):L=parseFloat(O[0])}else O.length>=2&&(L=parseFloat(O[0]),R=parseInt(O[1],10));if(!(L!==void 0&&L>=0&&L<=1))return(F=R?Y._soundById(R):Y._sounds[0])?F._volume:0;if(Y._state!=="loaded"||Y._playLock)return Y._queue.push({event:"volume",action:function(){Y.volume.apply(Y,O)}}),Y;R===void 0&&(Y._volume=L),R=Y._getSoundIds(R);for(var G=0;G<R.length;G++)(F=Y._soundById(R[G]))&&(F._volume=L,O[2]||Y._stopFade(R[G]),Y._webAudio&&F._node&&!F._muted?F._node.gain.setValueAtTime(L,D.ctx.currentTime):F._node&&!F._muted&&(F._node.volume=L*D.volume()),Y._emit("volume",F._id));return Y},fade:function(L,R,F,Y){var O=this;if(O._state!=="loaded"||O._playLock)return O._queue.push({event:"fade",action:function(){O.fade(L,R,F,Y)}}),O;L=Math.min(Math.max(0,parseFloat(L)),1),R=Math.min(Math.max(0,parseFloat(R)),1),F=parseFloat(F),O.volume(L,Y);for(var H=O._getSoundIds(Y),tt=0;tt<H.length;tt++){var G=O._soundById(H[tt]);if(G){if(Y||O._stopFade(H[tt]),O._webAudio&&!G._muted){var Ot=D.ctx.currentTime,Vt=Ot+F/1e3;G._volume=L,G._node.gain.setValueAtTime(L,Ot),G._node.gain.linearRampToValueAtTime(R,Vt)}O._startFadeInterval(G,L,R,F,H[tt],Y===void 0)}}return O},_startFadeInterval:function(L,R,F,Y,O,H){var tt=this,G=R,Ot=F-R,Vt=Math.abs(Ot/.01),st=Math.max(4,Vt>0?Y/Vt:Y),z=Date.now();L._fadeTo=F,L._interval=setInterval(function(){var U=(Date.now()-z)/Y;z=Date.now(),G+=Ot*U,G=Math.round(100*G)/100,G=Ot<0?Math.max(F,G):Math.min(F,G),tt._webAudio?L._volume=G:tt.volume(G,L._id,!0),H&&(tt._volume=G),(F<R&&G<=F||F>R&&G>=F)&&(clearInterval(L._interval),L._interval=null,L._fadeTo=null,tt.volume(F,L._id),tt._emit("fade",L._id))},st)},_stopFade:function(L){var R=this._soundById(L);return R&&R._interval&&(this._webAudio&&R._node.gain.cancelScheduledValues(D.ctx.currentTime),clearInterval(R._interval),R._interval=null,this.volume(R._fadeTo,L),R._fadeTo=null,this._emit("fade",L)),this},loop:function(){var L,R,F,Y=this,O=arguments;if(O.length===0)return Y._loop;if(O.length===1){if(typeof O[0]!="boolean")return!!(F=Y._soundById(parseInt(O[0],10)))&&F._loop;L=O[0],Y._loop=L}else O.length===2&&(L=O[0],R=parseInt(O[1],10));for(var H=Y._getSoundIds(R),tt=0;tt<H.length;tt++)(F=Y._soundById(H[tt]))&&(F._loop=L,Y._webAudio&&F._node&&F._node.bufferSource&&(F._node.bufferSource.loop=L,L&&(F._node.bufferSource.loopStart=F._start||0,F._node.bufferSource.loopEnd=F._stop,Y.playing(H[tt])&&(Y.pause(H[tt],!0),Y.play(H[tt],!0)))));return Y},rate:function(){var L,R,F,Y=this,O=arguments;if(O.length===0)R=Y._sounds[0]._id;else if(O.length===1){var H=Y._getSoundIds(),tt=H.indexOf(O[0]);tt>=0?R=parseInt(O[0],10):L=parseFloat(O[0])}else O.length===2&&(L=parseFloat(O[0]),R=parseInt(O[1],10));if(typeof L!="number")return(F=Y._soundById(R))?F._rate:Y._rate;if(Y._state!=="loaded"||Y._playLock)return Y._queue.push({event:"rate",action:function(){Y.rate.apply(Y,O)}}),Y;R===void 0&&(Y._rate=L),R=Y._getSoundIds(R);for(var G=0;G<R.length;G++)if(F=Y._soundById(R[G])){Y.playing(R[G])&&(F._rateSeek=Y.seek(R[G]),F._playStart=Y._webAudio?D.ctx.currentTime:F._playStart),F._rate=L,Y._webAudio&&F._node&&F._node.bufferSource?F._node.bufferSource.playbackRate.setValueAtTime(L,D.ctx.currentTime):F._node&&(F._node.playbackRate=L);var Ot=Y.seek(R[G]),Vt=(Y._sprite[F._sprite][0]+Y._sprite[F._sprite][1])/1e3-Ot,st=1e3*Vt/Math.abs(F._rate);!Y._endTimers[R[G]]&&F._paused||(Y._clearTimer(R[G]),Y._endTimers[R[G]]=setTimeout(Y._ended.bind(Y,F),st)),Y._emit("rate",F._id)}return Y},seek:function(){var L,R,F=this,Y=arguments;if(Y.length===0)F._sounds.length&&(R=F._sounds[0]._id);else if(Y.length===1){var O=F._getSoundIds(),H=O.indexOf(Y[0]);H>=0?R=parseInt(Y[0],10):F._sounds.length&&(R=F._sounds[0]._id,L=parseFloat(Y[0]))}else Y.length===2&&(L=parseFloat(Y[0]),R=parseInt(Y[1],10));if(R===void 0)return 0;if(typeof L=="number"&&(F._state!=="loaded"||F._playLock))return F._queue.push({event:"seek",action:function(){F.seek.apply(F,Y)}}),F;var tt=F._soundById(R);if(tt){if(!(typeof L=="number"&&L>=0)){if(F._webAudio){var G=F.playing(R)?D.ctx.currentTime-tt._playStart:0,Ot=tt._rateSeek?tt._rateSeek-tt._seek:0;return tt._seek+(Ot+G*Math.abs(tt._rate))}return tt._node.currentTime}var Vt=F.playing(R);Vt&&F.pause(R,!0),tt._seek=L,tt._ended=!1,F._clearTimer(R),F._webAudio||!tt._node||isNaN(tt._node.duration)||(tt._node.currentTime=L);var st=function(){Vt&&F.play(R,!0),F._emit("seek",R)};if(Vt&&!F._webAudio){var z=function(){F._playLock?setTimeout(z,0):st()};setTimeout(z,0)}else st()}return F},playing:function(L){if(typeof L=="number"){var R=this._soundById(L);return!!R&&!R._paused}for(var F=0;F<this._sounds.length;F++)if(!this._sounds[F]._paused)return!0;return!1},duration:function(L){var R=this._duration,F=this._soundById(L);return F&&(R=this._sprite[F._sprite][1]/1e3),R},state:function(){return this._state},unload:function(){for(var L=this,R=L._sounds,F=0;F<R.length;F++)R[F]._paused||L.stop(R[F]._id),L._webAudio||(L._clearSound(R[F]._node),R[F]._node.removeEventListener("error",R[F]._errorFn,!1),R[F]._node.removeEventListener(D._canPlayEvent,R[F]._loadFn,!1),R[F]._node.removeEventListener("ended",R[F]._endFn,!1),D._releaseHtml5Audio(R[F]._node)),delete R[F]._node,L._clearTimer(R[F]._id);var Y=D._howls.indexOf(L);Y>=0&&D._howls.splice(Y,1);var O=!0;for(F=0;F<D._howls.length;F++)if(D._howls[F]._src===L._src||L._src.indexOf(D._howls[F]._src)>=0){O=!1;break}return X&&O&&delete X[L._src],D.noAudio=!1,L._state="unloaded",L._sounds=[],L=null,null},on:function(L,R,F,Y){var O=this["_on"+L];return typeof R=="function"&&O.push(Y?{id:F,fn:R,once:Y}:{id:F,fn:R}),this},off:function(L,R,F){var Y=this["_on"+L],O=0;if(typeof R=="number"&&(F=R,R=null),R||F)for(O=0;O<Y.length;O++){var H=F===Y[O].id;if(R===Y[O].fn&&H||!R&&H){Y.splice(O,1);break}}else if(L)this["_on"+L]=[];else{var tt=Object.keys(this);for(O=0;O<tt.length;O++)tt[O].indexOf("_on")===0&&Array.isArray(this[tt[O]])&&(this[tt[O]]=[])}return this},once:function(L,R,F){return this.on(L,R,F,1),this},_emit:function(L,R,F){for(var Y=this["_on"+L],O=Y.length-1;O>=0;O--)Y[O].id&&Y[O].id!==R&&L!=="load"||(setTimeout(function(H){H.call(this,R,F)}.bind(this,Y[O].fn),0),Y[O].once&&this.off(L,Y[O].fn,Y[O].id));return this._loadQueue(L),this},_loadQueue:function(L){if(this._queue.length>0){var R=this._queue[0];R.event===L&&(this._queue.shift(),this._loadQueue()),L||R.action()}return this},_ended:function(L){var R=L._sprite;if(!this._webAudio&&L._node&&!L._node.paused&&!L._node.ended&&L._node.currentTime<L._stop)return setTimeout(this._ended.bind(this,L),100),this;var F=!(!L._loop&&!this._sprite[R][2]);if(this._emit("end",L._id),!this._webAudio&&F&&this.stop(L._id,!0).play(L._id),this._webAudio&&F){this._emit("play",L._id),L._seek=L._start||0,L._rateSeek=0,L._playStart=D.ctx.currentTime;var Y=1e3*(L._stop-L._start)/Math.abs(L._rate);this._endTimers[L._id]=setTimeout(this._ended.bind(this,L),Y)}return this._webAudio&&!F&&(L._paused=!0,L._ended=!0,L._seek=L._start||0,L._rateSeek=0,this._clearTimer(L._id),this._cleanBuffer(L._node),D._autoSuspend()),this._webAudio||F||this.stop(L._id,!0),this},_clearTimer:function(L){if(this._endTimers[L]){if(typeof this._endTimers[L]!="function")clearTimeout(this._endTimers[L]);else{var R=this._soundById(L);R&&R._node&&R._node.removeEventListener("ended",this._endTimers[L],!1)}delete this._endTimers[L]}return this},_soundById:function(L){for(var R=0;R<this._sounds.length;R++)if(L===this._sounds[R]._id)return this._sounds[R];return null},_inactiveSound:function(){this._drain();for(var L=0;L<this._sounds.length;L++)if(this._sounds[L]._ended)return this._sounds[L].reset();return new W(this)},_drain:function(){var L=this._pool,R=0,F=0;if(!(this._sounds.length<L)){for(F=0;F<this._sounds.length;F++)this._sounds[F]._ended&&R++;for(F=this._sounds.length-1;F>=0;F--){if(R<=L)return;this._sounds[F]._ended&&(this._webAudio&&this._sounds[F]._node&&this._sounds[F]._node.disconnect(0),this._sounds.splice(F,1),R--)}}},_getSoundIds:function(L){if(L===void 0){for(var R=[],F=0;F<this._sounds.length;F++)R.push(this._sounds[F]._id);return R}return[L]},_refreshBuffer:function(L){return L._node.bufferSource=D.ctx.createBufferSource(),L._node.bufferSource.buffer=X[this._src],L._panner?L._node.bufferSource.connect(L._panner):L._node.bufferSource.connect(L._node),L._node.bufferSource.loop=L._loop,L._loop&&(L._node.bufferSource.loopStart=L._start||0,L._node.bufferSource.loopEnd=L._stop||0),L._node.bufferSource.playbackRate.setValueAtTime(L._rate,D.ctx.currentTime),this},_cleanBuffer:function(L){var R=D._navigator&&D._navigator.vendor.indexOf("Apple")>=0;if(D._scratchBuffer&&L.bufferSource&&(L.bufferSource.onended=null,L.bufferSource.disconnect(0),R))try{L.bufferSource.buffer=D._scratchBuffer}catch{}return L.bufferSource=null,this},_clearSound:function(L){/MSIE |Trident\//.test(D._navigator&&D._navigator.userAgent)||(L.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var W=function(L){this._parent=L,this.init()};W.prototype={init:function(){var L=this._parent;return this._muted=L._muted,this._loop=L._loop,this._volume=L._volume,this._rate=L._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++D._counter,L._sounds.push(this),this.create(),this},create:function(){var L=this._parent,R=D._muted||this._muted||this._parent._muted?0:this._volume;return L._webAudio?(this._node=D.ctx.createGain===void 0?D.ctx.createGainNode():D.ctx.createGain(),this._node.gain.setValueAtTime(R,D.ctx.currentTime),this._node.paused=!0,this._node.connect(D.masterGain)):D.noAudio||(this._node=D._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(D._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=L._src,this._node.preload=L._preload===!0?"auto":L._preload,this._node.volume=R*D.volume(),this._node.load()),this},reset:function(){var L=this._parent;return this._muted=L._muted,this._loop=L._loop,this._volume=L._volume,this._rate=L._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++D._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var L=this._parent;L._duration=Math.ceil(10*this._node.duration)/10,Object.keys(L._sprite).length===0&&(L._sprite={__default:[0,1e3*L._duration]}),L._state!=="loaded"&&(L._state="loaded",L._emit("load"),L._loadQueue()),this._node.removeEventListener(D._canPlayEvent,this._loadFn,!1)},_endListener:function(){var L=this._parent;L._duration===1/0&&(L._duration=Math.ceil(10*this._node.duration)/10,L._sprite.__default[1]===1/0&&(L._sprite.__default[1]=1e3*L._duration),L._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}};var X={},V=function(L){var R=L._src;if(X[R])return L._duration=X[R].duration,void Dt(L);if(/^data:[^;]+;base64,/.test(R)){for(var F=atob(R.split(",")[1]),Y=new Uint8Array(F.length),O=0;O<F.length;++O)Y[O]=F.charCodeAt(O);pt(Y.buffer,L)}else{var H=new XMLHttpRequest;H.open(L._xhr.method,R,!0),H.withCredentials=L._xhr.withCredentials,H.responseType="arraybuffer",L._xhr.headers&&Object.keys(L._xhr.headers).forEach(function(tt){H.setRequestHeader(tt,L._xhr.headers[tt])}),H.onload=function(){var tt=(H.status+"")[0];tt==="0"||tt==="2"||tt==="3"?pt(H.response,L):L._emit("loaderror",null,"Failed loading audio file with status: "+H.status+".")},H.onerror=function(){L._webAudio&&(L._html5=!0,L._webAudio=!1,L._sounds=[],delete X[R],L.load())},et(H)}},et=function(L){try{L.send()}catch{L.onerror()}},pt=function(L,R){var F=function(){R._emit("loaderror",null,"Decoding audio data failed.")},Y=function(O){O&&R._sounds.length>0?(X[R._src]=O,Dt(R,O)):F()};typeof Promise!="undefined"&&D.ctx.decodeAudioData.length===1?D.ctx.decodeAudioData(L).then(Y).catch(F):D.ctx.decodeAudioData(L,Y,F)},Dt=function(L,R){R&&!L._duration&&(L._duration=R.duration),Object.keys(L._sprite).length===0&&(L._sprite={__default:[0,1e3*L._duration]}),L._state!=="loaded"&&(L._state="loaded",L._emit("load"),L._loadQueue())},At=function(){if(D.usingWebAudio){try{typeof AudioContext!="undefined"?D.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?D.ctx=new webkitAudioContext:D.usingWebAudio=!1}catch{D.usingWebAudio=!1}D.ctx||(D.usingWebAudio=!1);var L=/iP(hone|od|ad)/.test(D._navigator&&D._navigator.platform),R=D._navigator&&D._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),F=R?parseInt(R[1],10):null;if(L&&F&&F<9){var Y=/safari/.test(D._navigator&&D._navigator.userAgent.toLowerCase());D._navigator&&!Y&&(D.usingWebAudio=!1)}D.usingWebAudio&&(D.masterGain=D.ctx.createGain===void 0?D.ctx.createGainNode():D.ctx.createGain(),D.masterGain.gain.setValueAtTime(D._muted?0:D._volume,D.ctx.currentTime),D.masterGain.connect(D.ctx.destination)),D._setup()}};(M=function(){return{Howler:D,Howl:k}}.apply(A,[]))===void 0||(b.exports=M),A.Howler=D,A.Howl=k,P!==void 0?(P.HowlerGlobal=I,P.Howler=D,P.Howl=k,P.Sound=W):typeof window!="undefined"&&(window.HowlerGlobal=I,window.Howler=D,window.Howl=k,window.Sound=W)})(),function(){var I;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(k){if(!this.ctx||!this.ctx.listener)return this;for(var W=this._howls.length-1;W>=0;W--)this._howls[W].stereo(k);return this},HowlerGlobal.prototype.pos=function(k,W,X){return this.ctx&&this.ctx.listener?(W=typeof W!="number"?this._pos[1]:W,X=typeof X!="number"?this._pos[2]:X,typeof k!="number"?this._pos:(this._pos=[k,W,X],this.ctx.listener.positionX!==void 0?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(k,W,X,V,et,pt){if(!this.ctx||!this.ctx.listener)return this;var Dt=this._orientation;return W=typeof W!="number"?Dt[1]:W,X=typeof X!="number"?Dt[2]:X,V=typeof V!="number"?Dt[3]:V,et=typeof et!="number"?Dt[4]:et,pt=typeof pt!="number"?Dt[5]:pt,typeof k!="number"?Dt:(this._orientation=[k,W,X,V,et,pt],this.ctx.listener.forwardX!==void 0?(this.ctx.listener.forwardX.setTargetAtTime(k,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(W,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(X,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(V,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(et,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(pt,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(k,W,X,V,et,pt),this)},Howl.prototype.init=(I=Howl.prototype.init,function(k){return this._orientation=k.orientation||[1,0,0],this._stereo=k.stereo||null,this._pos=k.pos||null,this._pannerAttr={coneInnerAngle:k.coneInnerAngle!==void 0?k.coneInnerAngle:360,coneOuterAngle:k.coneOuterAngle!==void 0?k.coneOuterAngle:360,coneOuterGain:k.coneOuterGain!==void 0?k.coneOuterGain:0,distanceModel:k.distanceModel!==void 0?k.distanceModel:"inverse",maxDistance:k.maxDistance!==void 0?k.maxDistance:1e4,panningModel:k.panningModel!==void 0?k.panningModel:"HRTF",refDistance:k.refDistance!==void 0?k.refDistance:1,rolloffFactor:k.rolloffFactor!==void 0?k.rolloffFactor:1},this._onstereo=k.onstereo?[{fn:k.onstereo}]:[],this._onpos=k.onpos?[{fn:k.onpos}]:[],this._onorientation=k.onorientation?[{fn:k.onorientation}]:[],I.call(this,k)}),Howl.prototype.stereo=function(k,W){var X=this;if(!X._webAudio)return X;if(X._state!=="loaded")return X._queue.push({event:"stereo",action:function(){X.stereo(k,W)}}),X;var V=Howler.ctx.createStereoPanner===void 0?"spatial":"stereo";if(W===void 0){if(typeof k!="number")return X._stereo;X._stereo=k,X._pos=[k,0,0]}for(var et=X._getSoundIds(W),pt=0;pt<et.length;pt++){var Dt=X._soundById(et[pt]);if(Dt){if(typeof k!="number")return Dt._stereo;Dt._stereo=k,Dt._pos=[k,0,0],Dt._node&&(Dt._pannerAttr.panningModel="equalpower",Dt._panner&&Dt._panner.pan||D(Dt,V),V==="spatial"?Dt._panner.positionX!==void 0?(Dt._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),Dt._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),Dt._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):Dt._panner.setPosition(k,0,0):Dt._panner.pan.setValueAtTime(k,Howler.ctx.currentTime)),X._emit("stereo",Dt._id)}}return X},Howl.prototype.pos=function(k,W,X,V){var et=this;if(!et._webAudio)return et;if(et._state!=="loaded")return et._queue.push({event:"pos",action:function(){et.pos(k,W,X,V)}}),et;if(W=typeof W!="number"?0:W,X=typeof X!="number"?-.5:X,V===void 0){if(typeof k!="number")return et._pos;et._pos=[k,W,X]}for(var pt=et._getSoundIds(V),Dt=0;Dt<pt.length;Dt++){var At=et._soundById(pt[Dt]);if(At){if(typeof k!="number")return At._pos;At._pos=[k,W,X],At._node&&(At._panner&&!At._panner.pan||D(At,"spatial"),At._panner.positionX!==void 0?(At._panner.positionX.setValueAtTime(k,Howler.ctx.currentTime),At._panner.positionY.setValueAtTime(W,Howler.ctx.currentTime),At._panner.positionZ.setValueAtTime(X,Howler.ctx.currentTime)):At._panner.setPosition(k,W,X)),et._emit("pos",At._id)}}return et},Howl.prototype.orientation=function(k,W,X,V){var et=this;if(!et._webAudio)return et;if(et._state!=="loaded")return et._queue.push({event:"orientation",action:function(){et.orientation(k,W,X,V)}}),et;if(W=typeof W!="number"?et._orientation[1]:W,X=typeof X!="number"?et._orientation[2]:X,V===void 0){if(typeof k!="number")return et._orientation;et._orientation=[k,W,X]}for(var pt=et._getSoundIds(V),Dt=0;Dt<pt.length;Dt++){var At=et._soundById(pt[Dt]);if(At){if(typeof k!="number")return At._orientation;At._orientation=[k,W,X],At._node&&(At._panner||(At._pos||(At._pos=et._pos||[0,0,-.5]),D(At,"spatial")),At._panner.orientationX!==void 0?(At._panner.orientationX.setValueAtTime(k,Howler.ctx.currentTime),At._panner.orientationY.setValueAtTime(W,Howler.ctx.currentTime),At._panner.orientationZ.setValueAtTime(X,Howler.ctx.currentTime)):At._panner.setOrientation(k,W,X)),et._emit("orientation",At._id)}}return et},Howl.prototype.pannerAttr=function(){var k,W,X,V=this,et=arguments;if(!V._webAudio)return V;if(et.length===0)return V._pannerAttr;if(et.length===1){if(typeof et[0]!="object")return(X=V._soundById(parseInt(et[0],10)))?X._pannerAttr:V._pannerAttr;k=et[0],W===void 0&&(k.pannerAttr||(k.pannerAttr={coneInnerAngle:k.coneInnerAngle,coneOuterAngle:k.coneOuterAngle,coneOuterGain:k.coneOuterGain,distanceModel:k.distanceModel,maxDistance:k.maxDistance,refDistance:k.refDistance,rolloffFactor:k.rolloffFactor,panningModel:k.panningModel}),V._pannerAttr={coneInnerAngle:k.pannerAttr.coneInnerAngle!==void 0?k.pannerAttr.coneInnerAngle:V._coneInnerAngle,coneOuterAngle:k.pannerAttr.coneOuterAngle!==void 0?k.pannerAttr.coneOuterAngle:V._coneOuterAngle,coneOuterGain:k.pannerAttr.coneOuterGain!==void 0?k.pannerAttr.coneOuterGain:V._coneOuterGain,distanceModel:k.pannerAttr.distanceModel!==void 0?k.pannerAttr.distanceModel:V._distanceModel,maxDistance:k.pannerAttr.maxDistance!==void 0?k.pannerAttr.maxDistance:V._maxDistance,refDistance:k.pannerAttr.refDistance!==void 0?k.pannerAttr.refDistance:V._refDistance,rolloffFactor:k.pannerAttr.rolloffFactor!==void 0?k.pannerAttr.rolloffFactor:V._rolloffFactor,panningModel:k.pannerAttr.panningModel!==void 0?k.pannerAttr.panningModel:V._panningModel})}else et.length===2&&(k=et[0],W=parseInt(et[1],10));for(var pt=V._getSoundIds(W),Dt=0;Dt<pt.length;Dt++)if(X=V._soundById(pt[Dt])){var At=X._pannerAttr;At={coneInnerAngle:k.coneInnerAngle!==void 0?k.coneInnerAngle:At.coneInnerAngle,coneOuterAngle:k.coneOuterAngle!==void 0?k.coneOuterAngle:At.coneOuterAngle,coneOuterGain:k.coneOuterGain!==void 0?k.coneOuterGain:At.coneOuterGain,distanceModel:k.distanceModel!==void 0?k.distanceModel:At.distanceModel,maxDistance:k.maxDistance!==void 0?k.maxDistance:At.maxDistance,refDistance:k.refDistance!==void 0?k.refDistance:At.refDistance,rolloffFactor:k.rolloffFactor!==void 0?k.rolloffFactor:At.rolloffFactor,panningModel:k.panningModel!==void 0?k.panningModel:At.panningModel};var L=X._panner;L?(L.coneInnerAngle=At.coneInnerAngle,L.coneOuterAngle=At.coneOuterAngle,L.coneOuterGain=At.coneOuterGain,L.distanceModel=At.distanceModel,L.maxDistance=At.maxDistance,L.refDistance=At.refDistance,L.rolloffFactor=At.rolloffFactor,L.panningModel=At.panningModel):(X._pos||(X._pos=V._pos||[0,0,-.5]),D(X,"spatial"))}return V},Sound.prototype.init=function(k){return function(){var W=this._parent;this._orientation=W._orientation,this._stereo=W._stereo,this._pos=W._pos,this._pannerAttr=W._pannerAttr,k.call(this),this._stereo?W.stereo(this._stereo):this._pos&&W.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(k){return function(){var W=this._parent;return this._orientation=W._orientation,this._stereo=W._stereo,this._pos=W._pos,this._pannerAttr=W._pannerAttr,this._stereo?W.stereo(this._stereo):this._pos?W.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,W._refreshBuffer(this)),k.call(this)}}(Sound.prototype.reset);var D=function(k,W){(W=W||"spatial")==="spatial"?(k._panner=Howler.ctx.createPanner(),k._panner.coneInnerAngle=k._pannerAttr.coneInnerAngle,k._panner.coneOuterAngle=k._pannerAttr.coneOuterAngle,k._panner.coneOuterGain=k._pannerAttr.coneOuterGain,k._panner.distanceModel=k._pannerAttr.distanceModel,k._panner.maxDistance=k._pannerAttr.maxDistance,k._panner.refDistance=k._pannerAttr.refDistance,k._panner.rolloffFactor=k._pannerAttr.rolloffFactor,k._panner.panningModel=k._pannerAttr.panningModel,k._panner.positionX!==void 0?(k._panner.positionX.setValueAtTime(k._pos[0],Howler.ctx.currentTime),k._panner.positionY.setValueAtTime(k._pos[1],Howler.ctx.currentTime),k._panner.positionZ.setValueAtTime(k._pos[2],Howler.ctx.currentTime)):k._panner.setPosition(k._pos[0],k._pos[1],k._pos[2]),k._panner.orientationX!==void 0?(k._panner.orientationX.setValueAtTime(k._orientation[0],Howler.ctx.currentTime),k._panner.orientationY.setValueAtTime(k._orientation[1],Howler.ctx.currentTime),k._panner.orientationZ.setValueAtTime(k._orientation[2],Howler.ctx.currentTime)):k._panner.setOrientation(k._orientation[0],k._orientation[1],k._orientation[2])):(k._panner=Howler.ctx.createStereoPanner(),k._panner.pan.setValueAtTime(k._stereo,Howler.ctx.currentTime)),k._panner.connect(k._node),k._paused||k._parent.pause(k._id,!0).play(k._id,!0)}}()}).call(this,v(17))},function(b,A){b.exports=`varying vec2 vTextureCoord;
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;
uniform sampler2D uSampler;
void main() {
	vec4 outputColor;
	float percent = vPercent;
	float direction = vDirection;
	if (vTransition < 0.0) {
		percent = 1.0 - percent;
		if ((vDirection > 1.5) && (vDirection < 2.5)) {
			direction = 1.0;
		}
		else if ((vDirection > 0.5) && (vDirection < 1.5)) {
			direction = 2.0;
		}
		else if ((vDirection > 2.5) && (vDirection < 3.5)) {
			direction = 4.0;
		}
		else {
			direction = 3.0;
		}
	}
	if ((direction > 1.5) && (direction < 2.5)) {
		if (vVertexPosition.y >= (1.0 - percent)) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.y >= (1.0 - percent)) && (vVertexPosition.y <= ((1.0 - percent) + 0.2))) {
			outputColor = outputColor * ((vVertexPosition.y - (1.0 - percent)) / 0.2);
		}
	}
	else if ((direction > 0.5) && (direction < 1.5)) {
		if (vVertexPosition.y <= percent) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.y <= percent) && (vVertexPosition.y >= (percent - 0.2))) {
			outputColor = outputColor * (1.0 - ((vVertexPosition.y - (percent - 0.2)) / 0.2));
		}
	}
	else if ((direction > 2.5) && (direction < 3.5)) {
		if (vVertexPosition.x <= percent) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.x <= percent) && (vVertexPosition.x >= (percent - 0.2))) {
			outputColor = outputColor * (1.0 - ((vVertexPosition.x - (percent - 0.2)) / 0.2));
		}
	}
	else {
		if (vVertexPosition.x >= (1.0 - percent)) {
			outputColor = texture2D(uSampler, vTextureCoord);
		}
		else {
			outputColor = vec4(0.0, 0.0, 0.0, 0.0);
		}
		if ((vVertexPosition.x >= (1.0 - percent)) && (vVertexPosition.x <= ((1.0 - percent) + 0.2))) {
			outputColor = outputColor * ((vVertexPosition.x - (1.0 - percent)) / 0.2);
		}
	}
	gl_FragColor = outputColor;
}
`},function(b,A){b.exports=`attribute vec2 aVertexPosition;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
varying vec2 vVertexPosition;
varying float vPercent;
varying float vDirection;
varying float vTransition;
uniform vec4 inputSize;
uniform vec4 outputFrame;
uniform float percent;
uniform float direction;
uniform float transition;
vec4 filterVertexPosition() {
	vec2 position = (aVertexPosition * max(outputFrame.zw, vec2(0.))) + outputFrame.xy;
	return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}
vec2 filterTextureCoord(vec2 aVertexPosition) {
	return aVertexPosition * (outputFrame.zw * inputSize.zw);
}
void main() {
	vTransition = transition;
	vDirection = direction;
	vPercent = percent;
	vVertexPosition = aVertexPosition;
	vec2 localVertexPosition = aVertexPosition;
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord(localVertexPosition);
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
uniform float transition;
void main() {
	float alpha = (transition * (percent - 0.5)) + 0.5;
	vec4 color1 = texture2D(uSampler, vTextureCoord);
	gl_FragColor = color1 * alpha;
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 position = vec2(uBoundRect.z - filterCoord.x, uBoundRect.w - filterCoord.y);
	float timePercent = transition > 0.0 ? percent : 1.0 - percent;
	float barCount = 6.0;
	float barWidth = (option < 0.5 ? uBoundRect.w : uBoundRect.z) / barCount;
	float alphaWidthPercent = 0.03;
	float alphaWidth = alphaWidthPercent * (option < 0.5 ? uBoundRect.w : uBoundRect.z);
	float selectAxis = option < 0.5 ? -position.y : -position.x;
	float countAxis = floor(selectAxis / barWidth);
	float modAxis = mod(selectAxis, barWidth);
	float timePosition = barWidth * timePercent;
	if (modAxis < timePosition) {
		outputColor = outputColor;
	}
	else if (modAxis < (timePosition + alphaWidth)) {
		outputColor = (outputColor * ((alphaWidth - modAxis) + timePosition)) / alphaWidth;
	}
	else {
		outputColor = outputColor * 0.0;
	}
	gl_FragColor = outputColor;
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 position = vec2(uBoundRect.z - filterCoord.x, uBoundRect.w - filterCoord.y);
	float timePercent = transition > 0.0 ? percent : 1.0 - percent;
	float barCount = 6.0;
	float horizontalBarWidth = uBoundRect.z / barCount;
	float verticalBarWidth = uBoundRect.w / barCount;
	float alphaWidthPercent = 0.01;
	float alphaWidth = alphaWidthPercent * (option < 0.5 ? uBoundRect.z : uBoundRect.w);
	float timePosition = horizontalBarWidth * timePercent;
	float countAxisY = floor(-position.y / verticalBarWidth);
	float modAxisY = mod(-position.y, verticalBarWidth);
	float countAxisX = floor(-position.x / horizontalBarWidth);
	float modAxisX = mod(-position.x, horizontalBarWidth);
	float modAxis = modAxisX;
	if (option < 0.5) {
		if (mod(countAxisY, 2.0) > 0.5) {
			countAxisX = floor(((horizontalBarWidth * 0.5) - position.x) / horizontalBarWidth);
			modAxisX = mod((horizontalBarWidth * 0.5) - position.x, horizontalBarWidth);
		}
		modAxis = modAxisX;
	}
	else {
		if (mod(countAxisX, 2.0) > 0.5) {
			countAxisY = floor(((verticalBarWidth * 0.5) - position.y) / verticalBarWidth);
			modAxisY = mod((verticalBarWidth * 0.5) - position.y, verticalBarWidth);
		}
		modAxis = modAxisY;
	}
	if (modAxis < timePosition) {
		outputColor = outputColor;
	}
	else if (modAxis < (timePosition + alphaWidth)) {
		outputColor = (outputColor * ((alphaWidth - modAxis) + timePosition)) / alphaWidth;
	}
	else {
		outputColor = outputColor * 0.0;
	}
	gl_FragColor = outputColor;
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 inputSize;
uniform vec4 uBoundRect;
uniform float transition;
uniform sampler2D dissolveSampler;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	float splitWidth = max(uBoundRect.z, uBoundRect.w) / 3.0;
	vec2 position = mod(filterCoord.xy, splitWidth);
	vec2 loopTime = floor(filterCoord.xy / splitWidth);
	if (loopTime.x > 0.5) {
		position.x = splitWidth - position.x;
	}
	if (loopTime.y > 0.5) {
		position.y = splitWidth - position.y;
	}
	vec4 dissolveColor = texture2D(dissolveSampler, position.xy / splitWidth);
	float timePercent = transition > 0.0 ? percent : 1.0 - percent;
	if (dissolveColor.r < percent) {
		gl_FragColor = outputColor;
	}
	else {
		gl_FragColor = vec4(0, 0, 0, 0);
	}
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform sampler2D dissolveSampler;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 position = vec2(uBoundRect.z - filterCoord.x, uBoundRect.w - filterCoord.y);
	vec4 dissolveColor;
	if (option > 0.5) {
		dissolveColor = texture2D(dissolveSampler, vec2(vTextureCoord.x, 0.0));
	}
	else {
		dissolveColor = texture2D(dissolveSampler, vec2(0.0, vTextureCoord.y));
	}
	if (dissolveColor.r < percent) {
		gl_FragColor = outputColor * min(percent + dissolveColor.r, 1.0);
	}
	else {
		gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	}
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	float radius = sqrt(pow(uBoundRect.z, 2.0) + pow(uBoundRect.w, 2.0)) / 2.0;
	float alphaWidth = 0.1;
	float pointDistance = sqrt(pow(point.x, 2.0) + pow(point.y, 2.0));
	float alphaRadiusFormula;
	if (option > 0.5) {
		if (transition > 0.0) {
			alphaRadiusFormula = 1.0 - ((pointDistance - (radius * timePercent)) / (alphaWidth * radius));
		}
		else {
			alphaRadiusFormula = (pointDistance - (radius * timePercent)) / (alphaWidth * radius);
		}
	}
	else {
		if (transition > 0.0) {
			alphaRadiusFormula = (pointDistance - (radius * (1.0 - timePercent))) / (alphaWidth * radius);
		}
		else {
			alphaRadiusFormula = 1.0 - ((pointDistance - (radius * (1.0 - timePercent))) / (alphaWidth * radius));
		}
	}
	if (option > 0.5) {
		if (pointDistance < (radius * timePercent)) {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
		else if (pointDistance < (radius * (timePercent + alphaWidth))) {
			gl_FragColor = outputColor * alphaRadiusFormula;
		}
		else {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
	}
	else {
		if (pointDistance < (radius * (1.0 - timePercent))) {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
		else if (pointDistance < (radius * ((1.0 - timePercent) + alphaWidth))) {
			gl_FragColor = outputColor * alphaRadiusFormula;
		}
		else {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
	}
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	if (option < 0.5) {
		timePercent = 1.0 - timePercent;
	}
	float alphaWidth = 0.2;
	vec2 halfRect = uBoundRect.zw / 2.0;
	vec2 absPoint = abs(point.xy);
	vec2 alphaFormula = vec2(((halfRect.x * (timePercent + alphaWidth)) - absPoint.x) / (halfRect.x * alphaWidth), ((halfRect.y * (timePercent + alphaWidth)) - absPoint.y) / (halfRect.y * alphaWidth));
	if (option < 0.5) {
		if ((absPoint.x < (halfRect.x * timePercent)) && (absPoint.y < (halfRect.y * timePercent))) {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
		else if ((absPoint.x < (halfRect.x * (timePercent + alphaWidth))) && (absPoint.y < (halfRect.y * (timePercent + alphaWidth)))) {
			if (absPoint.x > absPoint.y) {
				gl_FragColor = outputColor * (transition > 0.0 ? 1.0 - alphaFormula.x : alphaFormula.x);
			}
			else {
				gl_FragColor = outputColor * (transition > 0.0 ? 1.0 - alphaFormula.y : alphaFormula.y);
			}
		}
		else {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
	}
	else {
		if ((absPoint.x < (halfRect.x * timePercent)) && (absPoint.y < (halfRect.y * timePercent))) {
			gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
		}
		else if ((absPoint.x < (halfRect.x * (timePercent + alphaWidth))) && (absPoint.y < (halfRect.y * (timePercent + alphaWidth)))) {
			if (absPoint.x > absPoint.y) {
				gl_FragColor = outputColor * (transition > 0.0 ? alphaFormula.x : 1.0 - alphaFormula.x);
			}
			else {
				gl_FragColor = outputColor * (transition > 0.0 ? alphaFormula.y : 1.0 - alphaFormula.y);
			}
		}
		else {
			gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
		}
	}
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), (uBoundRect.w / 2.0) - filterCoord.y);
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	if (option < 0.5) {
		timePercent = 1.0 - timePercent;
	}
	float alphaWidth = 0.1;
	float rightTop = (((2.0 * uBoundRect.w) * timePercent) - ((uBoundRect.w * point.x) / uBoundRect.z)) - point.y;
	float rightBottom = (((uBoundRect.w * point.x) / uBoundRect.z) - ((2.0 * uBoundRect.w) * timePercent)) - point.y;
	float leftTop = (((2.0 * uBoundRect.w) * timePercent) + ((uBoundRect.w * point.x) / uBoundRect.z)) - point.y;
	float leftBottom = (((-uBoundRect.w * point.x) / uBoundRect.z) - ((2.0 * uBoundRect.w) * timePercent)) - point.y;
	if (((option < 0.5) && (transition > 0.0)) || ((option > 0.5) && (transition < 0.0))) {
		if ((point.x >= 0.0) && (point.y >= 0.0)) {
			if (rightTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor;
			}
			else if (rightTop < 0.0) {
				gl_FragColor = outputColor * (-rightTop / (alphaWidth * uBoundRect.w));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
		if ((point.x >= 0.0) && (point.y <= 0.0)) {
			if (rightBottom < 0.0) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (rightBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = (outputColor * rightBottom) / (alphaWidth * uBoundRect.w);
			}
			else {
				gl_FragColor = outputColor;
			}
		}
		if ((point.x <= 0.0) && (point.y >= 0.0)) {
			if (leftTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor;
			}
			else if (leftTop < 0.0) {
				gl_FragColor = outputColor * (-leftTop / (alphaWidth * uBoundRect.w));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
		if ((point.x <= 0.0) && (point.y <= 0.0)) {
			if (leftBottom < 0.0) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (leftBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = (outputColor * leftBottom) / (alphaWidth * uBoundRect.w);
			}
			else {
				gl_FragColor = outputColor;
			}
		}
	}
	else {
		if ((point.x >= 0.0) && (point.y >= 0.0)) {
			if (rightTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (rightTop < 0.0) {
				gl_FragColor = outputColor * (1.0 + (rightTop / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = outputColor;
			}
		}
		if ((point.x >= 0.0) && (point.y <= 0.0)) {
			if (rightBottom < 0.0) {
				gl_FragColor = outputColor;
			}
			else if (rightBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor * (1.0 - (rightBottom / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
		if ((point.x <= 0.0) && (point.y >= 0.0)) {
			if (leftTop < (-alphaWidth * uBoundRect.w)) {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
			else if (leftTop < 0.0) {
				gl_FragColor = outputColor * (1.0 + (leftTop / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = outputColor;
			}
		}
		if ((point.x <= 0.0) && (point.y <= 0.0)) {
			if (leftBottom < 0.0) {
				gl_FragColor = outputColor;
			}
			else if (leftBottom < (alphaWidth * uBoundRect.w)) {
				gl_FragColor = outputColor * (1.0 - (leftBottom / (alphaWidth * uBoundRect.w)));
			}
			else {
				gl_FragColor = vec4(0, 0, 0, 0);
			}
		}
	}
}
`},function(b,A){b.exports=`float interpolationFloat(float from, float to, float start, float end, float timePercent, int timing) {
	float pi = 3.14159265358;
	float current;
	float duration = 1.0;
	if (timePercent < start) {
		current = 0.0;
	}
	else if (timePercent > end) {
		current = 1.0;
	}
	else {
		current = (timePercent - start) / (end - start);
	}
	if (timing == 0) {
		return ((current / duration) * (to - from)) + from;
	}
	else if (timing == 1) {
		current = current / duration;
		return (((to - from) * current) * current) + from;
	}
	else if (timing == 2) {
		current = current / duration;
		return (((-1.0 * (to - from)) * current) * (current - 2.0)) + from;
	}
	else {
		current /= (duration / 2.0);
		if (current < 1.0) {
			return ((((to - from) / 2.0) * current) * current) + from;
		}
		current--;
		return ((-(to - from) / 2.0) * ((current * (current - 2.0)) - 1.0)) + from;
	}
}
varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	float timePercent = interpolationFloat(0.0, 1.0, 0.0, 1.0, percent, 2);
	if (option < 0.5) {
		timePercent = 1.0 - timePercent;
	}
	float alphaWidth = 0.1;
	vec2 absPoint = abs(point);
	vec2 halfRect = uBoundRect.zw / 2.0;
	vec2 alphaFormula = vec2(((halfRect.x * (timePercent + alphaWidth)) - absPoint.x) / (halfRect.x * alphaWidth), ((halfRect.y * (timePercent + alphaWidth)) - absPoint.y) / (halfRect.y * alphaWidth));
	if (((option < 0.5) && (transition > 0.0)) || ((option > 0.5) && (transition < 0.0))) {
		if ((absPoint.x < ((uBoundRect.z * 0.5) * timePercent)) || (absPoint.y < ((uBoundRect.w * 0.5) * timePercent))) {
			gl_FragColor = vec4(0, 0, 0, 0);
		}
		else if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) || (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
			if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) && (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
				gl_FragColor = (outputColor * (1.0 - alphaFormula.x)) * (1.0 - alphaFormula.y);
			}
			else if (absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) {
				gl_FragColor = outputColor * (1.0 - alphaFormula.x);
			}
			else {
				gl_FragColor = outputColor * (1.0 - alphaFormula.y);
			}
		}
		else {
			gl_FragColor = outputColor;
		}
	}
	else {
		if ((absPoint.x < ((uBoundRect.z * 0.5) * timePercent)) || (absPoint.y < ((uBoundRect.w * 0.5) * timePercent))) {
			gl_FragColor = outputColor;
		}
		else if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) || (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
			if ((absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) && (absPoint.y < ((uBoundRect.w * 0.5) * (timePercent + alphaWidth)))) {
				gl_FragColor = outputColor * (1.0 - ((1.0 - alphaFormula.x) * (1.0 - alphaFormula.y)));
			}
			else if (absPoint.x < ((uBoundRect.z * 0.5) * (timePercent + alphaWidth))) {
				gl_FragColor = outputColor * alphaFormula.x;
			}
			else {
				gl_FragColor = outputColor * alphaFormula.y;
			}
		}
		else {
			gl_FragColor = vec4(0, 0, 0, 0);
		}
	}
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	vec2 absPoint = abs(point);
	vec2 halfRect = uBoundRect.zw / 2.0;
	float alphaWidth = 0.1;
	float timePercent = percent;
	if (option < 1.5) {
		timePercent = 1.0 - timePercent;
	}
	float axis = (option > 0.5) && (option < 2.5) ? absPoint.y : absPoint.x;
	float compareAxis = (option > 0.5) && (option < 2.5) ? halfRect.y : halfRect.x;
	float alphaColor = abs(((timePercent * compareAxis) - axis) / (alphaWidth * compareAxis));
	vec4 beginColor;
	vec4 endColor;
	if ((option > 1.5) && (option < 3.5)) {
		if (transition < 0.0) {
			beginColor = vec4(0, 0, 0, 0);
			endColor = outputColor;
		}
		else {
			beginColor = outputColor;
			endColor = vec4(0, 0, 0, 0);
			alphaColor = 1.0 - alphaColor;
		}
	}
	else {
		if (transition < 0.0) {
			beginColor = outputColor;
			endColor = vec4(0, 0, 0, 0);
			alphaColor = 1.0 - alphaColor;
		}
		else {
			beginColor = vec4(0, 0, 0, 0);
			endColor = outputColor;
		}
	}
	if (axis < (timePercent * compareAxis)) {
		gl_FragColor = beginColor;
	}
	else if (axis < ((timePercent + alphaWidth) * compareAxis)) {
		gl_FragColor = outputColor * alphaColor;
	}
	else {
		gl_FragColor = endColor;
	}
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x, filterCoord.y);
	if ((option > 0.5) && (option < 1.5)) {
		point = filterCoord.xy;
	}
	else if ((option > 1.5) && (option < 2.5)) {
		point = uBoundRect.zw - point.xy;
	}
	else if ((option > 2.5) && (option < 3.5)) {
		point = vec2(uBoundRect.z - filterCoord.x, filterCoord.y);
	}
	else {
		point = vec2(filterCoord.x, uBoundRect.w - filterCoord.y);
	}
	float squareCount = 16.0;
	float horzBarWidth = uBoundRect.z / squareCount;
	float verticalBarWidth = uBoundRect.w / squareCount;
	float horzCount = floor(point.x / horzBarWidth);
	float verticalCount = floor(point.y / verticalBarWidth);
	float timePercent = (percent * squareCount) * 2.5;
	vec4 alphaStage;
	if (transition > 0.0) {
		alphaStage = vec4(0.2, 0.4, 0.6, 0.8);
	}
	else {
		alphaStage = vec4(0.8, 0.6, 0.4, 0.2);
	}
	if ((horzCount + verticalCount) < (timePercent - 4.0)) {
		gl_FragColor = transition > 0.0 ? outputColor : vec4(0, 0, 0, 0);
	}
	else if ((horzCount + verticalCount) < (timePercent - 3.0)) {
		gl_FragColor = outputColor * alphaStage.w;
	}
	else if ((horzCount + verticalCount) < (timePercent - 2.0)) {
		gl_FragColor = outputColor * alphaStage.z;
	}
	else if ((horzCount + verticalCount) < (timePercent - 1.0)) {
		gl_FragColor = outputColor * alphaStage.y;
	}
	else if ((horzCount + verticalCount) < timePercent) {
		gl_FragColor = outputColor * alphaStage.x;
	}
	else {
		gl_FragColor = transition > 0.0 ? vec4(0, 0, 0, 0) : outputColor;
	}
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
#define PI 3.1415926538
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	vec2 start = vec2(0.0, -1.0);
	float arc = acos((dot(point.xy, start) / length(point)) / length(start));
	if ((point.x == 0.0) && (point.y < 0.0)) {
		arc = 0.0;
	}
	if ((point.x == 0.0) && (point.y > 0.0)) {
		arc = PI;
	}
	float alphaBarArcWidth = 0.3;
	float timePercent = (percent * PI) * (1.0 + alphaBarArcWidth);
	vec3 colorAlpha = transition > 0.0 ? vec3(1.0, (timePercent - arc) / alphaBarArcWidth, 0.0) : vec3(0.0, 1.0 - ((timePercent - arc) / alphaBarArcWidth), 1.0);
	if ((arc + alphaBarArcWidth) <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.x;
	}
	else if (arc <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.y;
	}
	else {
		gl_FragColor = outputColor * colorAlpha.z;
	}
}
`},function(b,A){b.exports=`varying vec2 vTextureCoord;
uniform float percent;
uniform sampler2D uSampler;
varying vec2 filterCoord;
uniform vec4 uBoundRect;
uniform float transition;
uniform float option;
#define PI 3.1415926538
void main() {
	vec4 outputColor = texture2D(uSampler, vTextureCoord);
	vec2 point = vec2(filterCoord.x - (uBoundRect.z / 2.0), filterCoord.y - (uBoundRect.w / 2.0));
	vec2 start = vec2(0.0, -1.0);
	float arc = acos((dot(point.xy, start) / length(point)) / length(start));
	if ((point.x == 0.0) && (point.y < 0.0)) {
		arc = 0.0;
	}
	if ((point.x == 0.0) && (point.y > 0.0)) {
		arc = PI;
	}
	if (point.x < 0.0) {
		arc = (2.0 * PI) - arc;
	}
	arc = arc == 0.0 ? arc : mod(arc, (2.0 * PI) / option);
	float totalAlphaBarArcWidth = 0.75;
	float alphaBarArcWidth = totalAlphaBarArcWidth / option;
	float timePercent = ((percent * PI) * (2.0 + totalAlphaBarArcWidth)) / option;
	vec3 colorAlpha = transition > 0.0 ? vec3(1.0, (timePercent - arc) / alphaBarArcWidth, 0.0) : vec3(0.0, 1.0 - ((timePercent - arc) / alphaBarArcWidth), 1.0);
	if ((arc + alphaBarArcWidth) <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.x;
	}
	else if (arc <= timePercent) {
		gl_FragColor = outputColor * colorAlpha.y;
	}
	else {
		gl_FragColor = outputColor * colorAlpha.z;
	}
}
`},function(b,A,v){var P=v(150);b.exports=function(M,I){return P(M,I)}},function(b,A,v){var P=v(24),M=Object.prototype,I=M.hasOwnProperty,D=M.toString,k=P?P.toStringTag:void 0;b.exports=function(W){var X=I.call(W,k),V=W[k];try{W[k]=void 0;var et=!0}catch{}var pt=D.call(W);return et&&(X?W[k]=V:delete W[k]),pt}},function(b,A){var v=Object.prototype.toString;b.exports=function(P){return v.call(P)}},function(b,A,v){(function(P){var M=v(108),I=v(111),D=v.n(I);/*!
 * @pixi/polyfill - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */if(typeof globalThis=="undefined"&&(typeof self!="undefined"?self.globalThis=self:P!==void 0&&(P.globalThis=P)),globalThis.Promise||(globalThis.Promise=M.a),Object.assign||(Object.assign=D.a),Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()}),!globalThis.performance||!globalThis.performance.now){var k=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-k}}for(var W=Date.now(),X=["ms","moz","webkit","o"],V=0;V<X.length&&!globalThis.requestAnimationFrame;++V){var et=X[V];globalThis.requestAnimationFrame=globalThis[et+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[et+"CancelAnimationFrame"]||globalThis[et+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(pt){if(typeof pt!="function")throw new TypeError(pt+"is not a function");var Dt=Date.now(),At=16+W-Dt;return At<0&&(At=0),W=Dt,globalThis.self.setTimeout(function(){W=Date.now(),pt(performance.now())},At)}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(pt){return clearTimeout(pt)}),Math.sign||(Math.sign=function(pt){return(pt=Number(pt))===0||isNaN(pt)?pt:pt>0?1:-1}),Number.isInteger||(Number.isInteger=function(pt){return typeof pt=="number"&&isFinite(pt)&&Math.floor(pt)===pt}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array)}).call(this,v(17))},function(b,A,v){(function(P){var M=P!==void 0&&P||typeof self!="undefined"&&self||window,I=Function.prototype.apply;function D(k,W){this._id=k,this._clearFn=W}A.setTimeout=function(){return new D(I.call(setTimeout,M,arguments),clearTimeout)},A.setInterval=function(){return new D(I.call(setInterval,M,arguments),clearInterval)},A.clearTimeout=A.clearInterval=function(k){k&&k.close()},D.prototype.unref=D.prototype.ref=function(){},D.prototype.close=function(){this._clearFn.call(M,this._id)},A.enroll=function(k,W){clearTimeout(k._idleTimeoutId),k._idleTimeout=W},A.unenroll=function(k){clearTimeout(k._idleTimeoutId),k._idleTimeout=-1},A._unrefActive=A.active=function(k){clearTimeout(k._idleTimeoutId);var W=k._idleTimeout;W>=0&&(k._idleTimeoutId=setTimeout(function(){k._onTimeout&&k._onTimeout()},W))},v(141),A.setImmediate=typeof self!="undefined"&&self.setImmediate||P!==void 0&&P.setImmediate||this&&this.setImmediate,A.clearImmediate=typeof self!="undefined"&&self.clearImmediate||P!==void 0&&P.clearImmediate||this&&this.clearImmediate}).call(this,v(17))},function(b,A,v){(function(P,M){(function(I,D){if(!I.setImmediate){var k,W,X,V,et,pt=1,Dt={},At=!1,L=I.document,R=Object.getPrototypeOf&&Object.getPrototypeOf(I);R=R&&R.setTimeout?R:I,{}.toString.call(I.process)==="[object process]"?k=function(O){M.nextTick(function(){Y(O)})}:function(){if(I.postMessage&&!I.importScripts){var O=!0,H=I.onmessage;return I.onmessage=function(){O=!1},I.postMessage("","*"),I.onmessage=H,O}}()?(V="setImmediate$"+Math.random()+"$",et=function(O){O.source===I&&typeof O.data=="string"&&O.data.indexOf(V)===0&&Y(+O.data.slice(V.length))},I.addEventListener?I.addEventListener("message",et,!1):I.attachEvent("onmessage",et),k=function(O){I.postMessage(V+O,"*")}):I.MessageChannel?((X=new MessageChannel).port1.onmessage=function(O){Y(O.data)},k=function(O){X.port2.postMessage(O)}):L&&"onreadystatechange"in L.createElement("script")?(W=L.documentElement,k=function(O){var H=L.createElement("script");H.onreadystatechange=function(){Y(O),H.onreadystatechange=null,W.removeChild(H),H=null},W.appendChild(H)}):k=function(O){setTimeout(Y,0,O)},R.setImmediate=function(O){typeof O!="function"&&(O=new Function(""+O));for(var H=new Array(arguments.length-1),tt=0;tt<H.length;tt++)H[tt]=arguments[tt+1];var G={callback:O,args:H};return Dt[pt]=G,k(pt),pt++},R.clearImmediate=F}function F(O){delete Dt[O]}function Y(O){if(At)setTimeout(Y,0,O);else{var H=Dt[O];if(H){At=!0;try{(function(tt){var G=tt.callback,Ot=tt.args;switch(Ot.length){case 0:G();break;case 1:G(Ot[0]);break;case 2:G(Ot[0],Ot[1]);break;case 3:G(Ot[0],Ot[1],Ot[2]);break;default:G.apply(void 0,Ot)}})(H)}finally{F(O),At=!1}}}}})(typeof self=="undefined"?P===void 0?this:P:self)}).call(this,v(17),v(142))},function(b,A){var v,P,M=b.exports={};function I(){throw new Error("setTimeout has not been defined")}function D(){throw new Error("clearTimeout has not been defined")}function k(R){if(v===setTimeout)return setTimeout(R,0);if((v===I||!v)&&setTimeout)return v=setTimeout,setTimeout(R,0);try{return v(R,0)}catch{try{return v.call(null,R,0)}catch{return v.call(this,R,0)}}}(function(){try{v=typeof setTimeout=="function"?setTimeout:I}catch{v=I}try{P=typeof clearTimeout=="function"?clearTimeout:D}catch{P=D}})();var W,X=[],V=!1,et=-1;function pt(){V&&W&&(V=!1,W.length?X=W.concat(X):et=-1,X.length&&Dt())}function Dt(){if(!V){var R=k(pt);V=!0;for(var F=X.length;F;){for(W=X,X=[];++et<F;)W&&W[et].run();et=-1,F=X.length}W=null,V=!1,function(Y){if(P===clearTimeout)return clearTimeout(Y);if((P===D||!P)&&clearTimeout)return P=clearTimeout,clearTimeout(Y);try{P(Y)}catch{try{return P.call(null,Y)}catch{return P.call(this,Y)}}}(R)}}function At(R,F){this.fun=R,this.array=F}function L(){}M.nextTick=function(R){var F=new Array(arguments.length-1);if(arguments.length>1)for(var Y=1;Y<arguments.length;Y++)F[Y-1]=arguments[Y];X.push(new At(R,F)),X.length!==1||V||k(Dt)},At.prototype.run=function(){this.fun.apply(null,this.array)},M.title="browser",M.browser=!0,M.env={},M.argv=[],M.version="",M.versions={},M.on=L,M.addListener=L,M.once=L,M.off=L,M.removeListener=L,M.removeAllListeners=L,M.emit=L,M.prependListener=L,M.prependOnceListener=L,M.listeners=function(R){return[]},M.binding=function(R){throw new Error("process.binding is not supported")},M.cwd=function(){return"/"},M.chdir=function(R){throw new Error("process.chdir is not supported")},M.umask=function(){return 0}},function(b,A,v){(function(P,M){var I;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(D){A&&A.nodeType,P&&P.nodeType;var k=typeof M=="object"&&M;k.global!==k&&k.window!==k&&k.self;var W,X=2147483647,V=/^xn--/,et=/[^\x20-\x7E]/,pt=/[\x2E\u3002\uFF0E\uFF61]/g,Dt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},At=Math.floor,L=String.fromCharCode;function R(st){throw new RangeError(Dt[st])}function F(st,z){for(var U=st.length,ft=[];U--;)ft[U]=z(st[U]);return ft}function Y(st,z){var U=st.split("@"),ft="";return U.length>1&&(ft=U[0]+"@",st=U[1]),ft+F((st=st.replace(pt,".")).split("."),z).join(".")}function O(st){for(var z,U,ft=[],$=0,gt=st.length;$<gt;)(z=st.charCodeAt($++))>=55296&&z<=56319&&$<gt?(64512&(U=st.charCodeAt($++)))==56320?ft.push(((1023&z)<<10)+(1023&U)+65536):(ft.push(z),$--):ft.push(z);return ft}function H(st){return F(st,function(z){var U="";return z>65535&&(U+=L((z-=65536)>>>10&1023|55296),z=56320|1023&z),U+=L(z)}).join("")}function tt(st,z){return st+22+75*(st<26)-((z!=0)<<5)}function G(st,z,U){var ft=0;for(st=U?At(st/700):st>>1,st+=At(st/z);st>455;ft+=36)st=At(st/35);return At(ft+36*st/(st+38))}function Ot(st){var z,U,ft,$,gt,Lt,K,dt,it,_t,St,kt=[],Xt=st.length,Jt=0,at=128,_e=72;for((U=st.lastIndexOf("-"))<0&&(U=0),ft=0;ft<U;++ft)st.charCodeAt(ft)>=128&&R("not-basic"),kt.push(st.charCodeAt(ft));for($=U>0?U+1:0;$<Xt;){for(gt=Jt,Lt=1,K=36;$>=Xt&&R("invalid-input"),((dt=(St=st.charCodeAt($++))-48<10?St-22:St-65<26?St-65:St-97<26?St-97:36)>=36||dt>At((X-Jt)/Lt))&&R("overflow"),Jt+=dt*Lt,!(dt<(it=K<=_e?1:K>=_e+26?26:K-_e));K+=36)Lt>At(X/(_t=36-it))&&R("overflow"),Lt*=_t;_e=G(Jt-gt,z=kt.length+1,gt==0),At(Jt/z)>X-at&&R("overflow"),at+=At(Jt/z),Jt%=z,kt.splice(Jt++,0,at)}return H(kt)}function Vt(st){var z,U,ft,$,gt,Lt,K,dt,it,_t,St,kt,Xt,Jt,at,_e=[];for(kt=(st=O(st)).length,z=128,U=0,gt=72,Lt=0;Lt<kt;++Lt)(St=st[Lt])<128&&_e.push(L(St));for(ft=$=_e.length,$&&_e.push("-");ft<kt;){for(K=X,Lt=0;Lt<kt;++Lt)(St=st[Lt])>=z&&St<K&&(K=St);for(K-z>At((X-U)/(Xt=ft+1))&&R("overflow"),U+=(K-z)*Xt,z=K,Lt=0;Lt<kt;++Lt)if((St=st[Lt])<z&&++U>X&&R("overflow"),St==z){for(dt=U,it=36;!(dt<(_t=it<=gt?1:it>=gt+26?26:it-gt));it+=36)at=dt-_t,Jt=36-_t,_e.push(L(tt(_t+at%Jt,0))),dt=At(at/Jt);_e.push(L(tt(dt,0))),gt=G(U,Xt,ft==$),U=0,++ft}++U,++z}return _e.join("")}W={version:"1.4.1",ucs2:{decode:O,encode:H},decode:Ot,encode:Vt,toASCII:function(st){return Y(st,function(z){return et.test(z)?"xn--"+Vt(z):z})},toUnicode:function(st){return Y(st,function(z){return V.test(z)?Ot(z.slice(4).toLowerCase()):z})}},(I=function(){return W}.call(A,v,A,P))===void 0||(P.exports=I)})()}).call(this,v(25)(b),v(17))},function(b,A,v){b.exports={isString:function(P){return typeof P=="string"},isObject:function(P){return typeof P=="object"&&P!==null},isNull:function(P){return P===null},isNullOrUndefined:function(P){return P==null}}},function(b,A,v){A.decode=A.parse=v(146),A.encode=A.stringify=v(147)},function(b,A,v){function P(I,D){return Object.prototype.hasOwnProperty.call(I,D)}b.exports=function(I,D,k,W){D=D||"&",k=k||"=";var X={};if(typeof I!="string"||I.length===0)return X;var V=/\+/g;I=I.split(D);var et=1e3;W&&typeof W.maxKeys=="number"&&(et=W.maxKeys);var pt=I.length;et>0&&pt>et&&(pt=et);for(var Dt=0;Dt<pt;++Dt){var At,L,R,F,Y=I[Dt].replace(V,"%20"),O=Y.indexOf(k);O>=0?(At=Y.substr(0,O),L=Y.substr(O+1)):(At=Y,L=""),R=decodeURIComponent(At),F=decodeURIComponent(L),P(X,R)?M(X[R])?X[R].push(F):X[R]=[X[R],F]:X[R]=F}return X};var M=Array.isArray||function(I){return Object.prototype.toString.call(I)==="[object Array]"}},function(b,A,v){var P=function(k){switch(typeof k){case"string":return k;case"boolean":return k?"true":"false";case"number":return isFinite(k)?k:"";default:return""}};b.exports=function(k,W,X,V){return W=W||"&",X=X||"=",k===null&&(k=void 0),typeof k=="object"?I(D(k),function(et){var pt=encodeURIComponent(P(et))+X;return M(k[et])?I(k[et],function(Dt){return pt+encodeURIComponent(P(Dt))}).join(W):pt+encodeURIComponent(P(k[et]))}).join(W):V?encodeURIComponent(P(V))+X+encodeURIComponent(P(k)):""};var M=Array.isArray||function(k){return Object.prototype.toString.call(k)==="[object Array]"};function I(k,W){if(k.map)return k.map(W);for(var X=[],V=0;V<k.length;V++)X.push(W(k[V],V));return X}var D=Object.keys||function(k){var W=[];for(var X in k)Object.prototype.hasOwnProperty.call(k,X)&&W.push(X);return W}},function(b,A){var v=function(){};v.prototype={fit:function(P){var M,I,D,k,W=P.length,X=W>0?P[0].width:0,V=W>0?P[0].height:0;for(this.root={x:0,y:0,width:X,height:V},M=0;M<W;M++)D=P[M],(I=this.findNode(this.root,D.width,D.height))?(k=this.splitNode(I,D.width,D.height),D.x=k.x,D.y=k.y):(k=this.growNode(D.width,D.height),D.x=k.x,D.y=k.y)},findNode:function(P,M,I){return P.used?this.findNode(P.right,M,I)||this.findNode(P.down,M,I):M<=P.width&&I<=P.height?P:null},splitNode:function(P,M,I){return P.used=!0,P.down={x:P.x,y:P.y+I,width:P.width,height:P.height-I},P.right={x:P.x+M,y:P.y,width:P.width-M,height:I},P},growNode:function(P,M){var I=P<=this.root.width,D=M<=this.root.height,k=D&&this.root.height>=this.root.width+P,W=I&&this.root.width>=this.root.height+M;return k?this.growRight(P,M):W?this.growDown(P,M):D?this.growRight(P,M):I?this.growDown(P,M):null},growRight:function(P,M){var I;return this.root={used:!0,x:0,y:0,width:this.root.width+P,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:P,height:this.root.height}},(I=this.findNode(this.root,P,M))?this.splitNode(I,P,M):null},growDown:function(P,M){var I;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+M,down:{x:0,y:this.root.height,width:this.root.width,height:M},right:this.root},(I=this.findNode(this.root,P,M))?this.splitNode(I,P,M):null}},b.exports=v},function(b,A){(function(v){b.exports=v}).call(this,{})},function(b,A,v){var P=v(151),M=v(15);b.exports=function I(D,k,W,X,V){return D===k||(D==null||k==null||!M(D)&&!M(k)?D!=D&&k!=k:P(D,k,W,X,I,V))}},function(b,A,v){var P=v(54),M=v(57),I=v(183),D=v(186),k=v(31),W=v(30),X=v(40),V=v(64),et="[object Object]",pt=Object.prototype.hasOwnProperty;b.exports=function(Dt,At,L,R,F,Y){var O=W(Dt),H=W(At),tt=O?"[object Array]":k(Dt),G=H?"[object Array]":k(At),Ot=(tt=tt=="[object Arguments]"?et:tt)==et,Vt=(G=G=="[object Arguments]"?et:G)==et,st=tt==G;if(st&&X(Dt)){if(!X(At))return!1;O=!0,Ot=!1}if(st&&!Ot)return Y||(Y=new P),O||V(Dt)?M(Dt,At,L,R,F,Y):I(Dt,At,tt,L,R,F,Y);if(!(1&L)){var z=Ot&&pt.call(Dt,"__wrapped__"),U=Vt&&pt.call(At,"__wrapped__");if(z||U){var ft=z?Dt.value():Dt,$=U?At.value():At;return Y||(Y=new P),F(ft,$,L,R,Y)}}return!!st&&(Y||(Y=new P),D(Dt,At,L,R,F,Y))}},function(b,A){b.exports=function(){this.__data__=[],this.size=0}},function(b,A,v){var P=v(27),M=Array.prototype.splice;b.exports=function(I){var D=this.__data__,k=P(D,I);return!(k<0)&&(k==D.length-1?D.pop():M.call(D,k,1),--this.size,!0)}},function(b,A,v){var P=v(27);b.exports=function(M){var I=this.__data__,D=P(I,M);return D<0?void 0:I[D][1]}},function(b,A,v){var P=v(27);b.exports=function(M){return P(this.__data__,M)>-1}},function(b,A,v){var P=v(27);b.exports=function(M,I){var D=this.__data__,k=P(D,M);return k<0?(++this.size,D.push([M,I])):D[k][1]=I,this}},function(b,A,v){var P=v(26);b.exports=function(){this.__data__=new P,this.size=0}},function(b,A){b.exports=function(v){var P=this.__data__,M=P.delete(v);return this.size=P.size,M}},function(b,A){b.exports=function(v){return this.__data__.get(v)}},function(b,A){b.exports=function(v){return this.__data__.has(v)}},function(b,A,v){var P=v(26),M=v(37),I=v(56);b.exports=function(D,k){var W=this.__data__;if(W instanceof P){var X=W.__data__;if(!M||X.length<199)return X.push([D,k]),this.size=++W.size,this;W=this.__data__=new I(X)}return W.set(D,k),this.size=W.size,this}},function(b,A,v){var P=v(33),M=v(163),I=v(21),D=v(55),k=/^\[object .+?Constructor\]$/,W=Function.prototype,X=Object.prototype,V=W.toString,et=X.hasOwnProperty,pt=RegExp("^"+V.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");b.exports=function(Dt){return!(!I(Dt)||M(Dt))&&(P(Dt)?pt:k).test(D(Dt))}},function(b,A,v){var P,M=v(164),I=(P=/[^.]+$/.exec(M&&M.keys&&M.keys.IE_PROTO||""))?"Symbol(src)_1."+P:"";b.exports=function(D){return!!I&&I in D}},function(b,A,v){var P=v(14)["__core-js_shared__"];b.exports=P},function(b,A){b.exports=function(v,P){return v==null?void 0:v[P]}},function(b,A,v){var P=v(167),M=v(26),I=v(37);b.exports=function(){this.size=0,this.__data__={hash:new P,map:new(I||M),string:new P}}},function(b,A,v){var P=v(168),M=v(169),I=v(170),D=v(171),k=v(172);function W(X){var V=-1,et=X==null?0:X.length;for(this.clear();++V<et;){var pt=X[V];this.set(pt[0],pt[1])}}W.prototype.clear=P,W.prototype.delete=M,W.prototype.get=I,W.prototype.has=D,W.prototype.set=k,b.exports=W},function(b,A,v){var P=v(28);b.exports=function(){this.__data__=P?P(null):{},this.size=0}},function(b,A){b.exports=function(v){var P=this.has(v)&&delete this.__data__[v];return this.size-=P?1:0,P}},function(b,A,v){var P=v(28),M=Object.prototype.hasOwnProperty;b.exports=function(I){var D=this.__data__;if(P){var k=D[I];return k==="__lodash_hash_undefined__"?void 0:k}return M.call(D,I)?D[I]:void 0}},function(b,A,v){var P=v(28),M=Object.prototype.hasOwnProperty;b.exports=function(I){var D=this.__data__;return P?D[I]!==void 0:M.call(D,I)}},function(b,A,v){var P=v(28);b.exports=function(M,I){var D=this.__data__;return this.size+=this.has(M)?0:1,D[M]=P&&I===void 0?"__lodash_hash_undefined__":I,this}},function(b,A,v){var P=v(29);b.exports=function(M){var I=P(this,M).delete(M);return this.size-=I?1:0,I}},function(b,A){b.exports=function(v){var P=typeof v;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?v!=="__proto__":v===null}},function(b,A,v){var P=v(29);b.exports=function(M){return P(this,M).get(M)}},function(b,A,v){var P=v(29);b.exports=function(M){return P(this,M).has(M)}},function(b,A,v){var P=v(29);b.exports=function(M,I){var D=P(this,M),k=D.size;return D.set(M,I),this.size+=D.size==k?0:1,this}},function(b,A,v){var P=v(56),M=v(179),I=v(180);function D(k){var W=-1,X=k==null?0:k.length;for(this.__data__=new P;++W<X;)this.add(k[W])}D.prototype.add=D.prototype.push=M,D.prototype.has=I,b.exports=D},function(b,A){b.exports=function(v){return this.__data__.set(v,"__lodash_hash_undefined__"),this}},function(b,A){b.exports=function(v){return this.__data__.has(v)}},function(b,A){b.exports=function(v,P){for(var M=-1,I=v==null?0:v.length;++M<I;)if(P(v[M],M,v))return!0;return!1}},function(b,A){b.exports=function(v,P){return v.has(P)}},function(b,A,v){var P=v(24),M=v(58),I=v(36),D=v(57),k=v(184),W=v(185),X=P?P.prototype:void 0,V=X?X.valueOf:void 0;b.exports=function(et,pt,Dt,At,L,R,F){switch(Dt){case"[object DataView]":if(et.byteLength!=pt.byteLength||et.byteOffset!=pt.byteOffset)return!1;et=et.buffer,pt=pt.buffer;case"[object ArrayBuffer]":return!(et.byteLength!=pt.byteLength||!R(new M(et),new M(pt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return I(+et,+pt);case"[object Error]":return et.name==pt.name&&et.message==pt.message;case"[object RegExp]":case"[object String]":return et==pt+"";case"[object Map]":var Y=k;case"[object Set]":var O=1&At;if(Y||(Y=W),et.size!=pt.size&&!O)return!1;var H=F.get(et);if(H)return H==pt;At|=2,F.set(et,pt);var tt=D(Y(et),Y(pt),At,L,R,F);return F.delete(et),tt;case"[object Symbol]":if(V)return V.call(et)==V.call(pt)}return!1}},function(b,A){b.exports=function(v){var P=-1,M=Array(v.size);return v.forEach(function(I,D){M[++P]=[D,I]}),M}},function(b,A){b.exports=function(v){var P=-1,M=Array(v.size);return v.forEach(function(I){M[++P]=I}),M}},function(b,A,v){var P=v(59),M=Object.prototype.hasOwnProperty;b.exports=function(I,D,k,W,X,V){var et=1&k,pt=P(I),Dt=pt.length;if(Dt!=P(D).length&&!et)return!1;for(var At=Dt;At--;){var L=pt[At];if(!(et?L in D:M.call(D,L)))return!1}var R=V.get(I),F=V.get(D);if(R&&F)return R==D&&F==I;var Y=!0;V.set(I,D),V.set(D,I);for(var O=et;++At<Dt;){var H=I[L=pt[At]],tt=D[L];if(W)var G=et?W(tt,H,L,D,I,V):W(H,tt,L,I,D,V);if(!(G===void 0?H===tt||X(H,tt,k,W,V):G)){Y=!1;break}O||(O=L=="constructor")}if(Y&&!O){var Ot=I.constructor,Vt=D.constructor;Ot==Vt||!("constructor"in I)||!("constructor"in D)||typeof Ot=="function"&&Ot instanceof Ot&&typeof Vt=="function"&&Vt instanceof Vt||(Y=!1)}return V.delete(I),V.delete(D),Y}},function(b,A){b.exports=function(v,P){for(var M=-1,I=v==null?0:v.length,D=0,k=[];++M<I;){var W=v[M];P(W,M,v)&&(k[D++]=W)}return k}},function(b,A){b.exports=function(v,P){for(var M=-1,I=Array(v);++M<v;)I[M]=P(M);return I}},function(b,A,v){var P=v(190),M=v(15),I=Object.prototype,D=I.hasOwnProperty,k=I.propertyIsEnumerable,W=P(function(){return arguments}())?P:function(X){return M(X)&&D.call(X,"callee")&&!k.call(X,"callee")};b.exports=W},function(b,A,v){var P=v(20),M=v(15);b.exports=function(I){return M(I)&&P(I)=="[object Arguments]"}},function(b,A){b.exports=function(){return!1}},function(b,A){var v=/^(?:0|[1-9]\d*)$/;b.exports=function(P,M){var I=typeof P;return!!(M=M==null?9007199254740991:M)&&(I=="number"||I!="symbol"&&v.test(P))&&P>-1&&P%1==0&&P<M}},function(b,A,v){var P=v(20),M=v(65),I=v(15),D={};D["[object Float32Array]"]=D["[object Float64Array]"]=D["[object Int8Array]"]=D["[object Int16Array]"]=D["[object Int32Array]"]=D["[object Uint8Array]"]=D["[object Uint8ClampedArray]"]=D["[object Uint16Array]"]=D["[object Uint32Array]"]=!0,D["[object Arguments]"]=D["[object Array]"]=D["[object ArrayBuffer]"]=D["[object Boolean]"]=D["[object DataView]"]=D["[object Date]"]=D["[object Error]"]=D["[object Function]"]=D["[object Map]"]=D["[object Number]"]=D["[object Object]"]=D["[object RegExp]"]=D["[object Set]"]=D["[object String]"]=D["[object WeakMap]"]=!1,b.exports=function(k){return I(k)&&M(k.length)&&!!D[P(k)]}},function(b,A,v){var P=v(43),M=v(195),I=Object.prototype.hasOwnProperty;b.exports=function(D){if(!P(D))return M(D);var k=[];for(var W in Object(D))I.call(D,W)&&W!="constructor"&&k.push(W);return k}},function(b,A,v){var P=v(66)(Object.keys,Object);b.exports=P},function(b,A,v){var P=v(22)(v(14),"DataView");b.exports=P},function(b,A,v){var P=v(22)(v(14),"Promise");b.exports=P},function(b,A,v){var P=v(22)(v(14),"Set");b.exports=P},function(b,A,v){var P=v(22)(v(14),"WeakMap");b.exports=P},function(b,A,v){var P=v(14);b.exports=function(){return P.Date.now()}},function(b,A,v){var P=v(202),M=v(21),I=v(204),D=/^[-+]0x[0-9a-f]+$/i,k=/^0b[01]+$/i,W=/^0o[0-7]+$/i,X=parseInt;b.exports=function(V){if(typeof V=="number")return V;if(I(V))return NaN;if(M(V)){var et=typeof V.valueOf=="function"?V.valueOf():V;V=M(et)?et+"":et}if(typeof V!="string")return V===0?V:+V;V=P(V);var pt=k.test(V);return pt||W.test(V)?X(V.slice(2),pt?2:8):D.test(V)?NaN:+V}},function(b,A,v){var P=v(203),M=/^\s+/;b.exports=function(I){return I&&I.slice(0,P(I)+1).replace(M,"")}},function(b,A){var v=/\s/;b.exports=function(P){for(var M=P.length;M--&&v.test(P.charAt(M)););return M}},function(b,A,v){var P=v(20),M=v(15);b.exports=function(I){return typeof I=="symbol"||M(I)&&P(I)=="[object Symbol]"}},function(b,A,v){var P=v(54),M=v(206),I=v(68),D=v(208),k=v(209),W=v(212),X=v(213),V=v(214),et=v(215),pt=v(59),Dt=v(216),At=v(31),L=v(217),R=v(218),F=v(223),Y=v(30),O=v(40),H=v(225),tt=v(21),G=v(227),Ot=v(39),Vt=v(44),st={};st["[object Arguments]"]=st["[object Array]"]=st["[object ArrayBuffer]"]=st["[object DataView]"]=st["[object Boolean]"]=st["[object Date]"]=st["[object Float32Array]"]=st["[object Float64Array]"]=st["[object Int8Array]"]=st["[object Int16Array]"]=st["[object Int32Array]"]=st["[object Map]"]=st["[object Number]"]=st["[object Object]"]=st["[object RegExp]"]=st["[object Set]"]=st["[object String]"]=st["[object Symbol]"]=st["[object Uint8Array]"]=st["[object Uint8ClampedArray]"]=st["[object Uint16Array]"]=st["[object Uint32Array]"]=!0,st["[object Error]"]=st["[object Function]"]=st["[object WeakMap]"]=!1,b.exports=function z(U,ft,$,gt,Lt,K){var dt,it=1&ft,_t=2&ft,St=4&ft;if($&&(dt=Lt?$(U,gt,Lt,K):$(U)),dt!==void 0)return dt;if(!tt(U))return U;var kt=Y(U);if(kt){if(dt=L(U),!it)return X(U,dt)}else{var Xt=At(U),Jt=Xt=="[object Function]"||Xt=="[object GeneratorFunction]";if(O(U))return W(U,it);if(Xt=="[object Object]"||Xt=="[object Arguments]"||Jt&&!Lt){if(dt=_t||Jt?{}:F(U),!it)return _t?et(U,k(dt,U)):V(U,D(dt,U))}else{if(!st[Xt])return Lt?U:{};dt=R(U,Xt,it)}}K||(K=new P);var at=K.get(U);if(at)return at;K.set(U,dt),G(U)?U.forEach(function(Ue){dt.add(z(Ue,ft,$,Ue,U,K))}):H(U)&&U.forEach(function(Ue,Oe){dt.set(Oe,z(Ue,ft,$,Oe,U,K))});var _e=kt?void 0:(St?_t?Dt:pt:_t?Vt:Ot)(U);return M(_e||U,function(Ue,Oe){_e&&(Ue=U[Oe=Ue]),I(dt,Oe,z(Ue,ft,$,Oe,U,K))}),dt}},function(b,A){b.exports=function(v,P){for(var M=-1,I=v==null?0:v.length;++M<I&&P(v[M],M,v)!==!1;);return v}},function(b,A,v){var P=v(22),M=function(){try{var I=P(Object,"defineProperty");return I({},"",{}),I}catch{}}();b.exports=M},function(b,A,v){var P=v(32),M=v(39);b.exports=function(I,D){return I&&P(D,M(D),I)}},function(b,A,v){var P=v(32),M=v(44);b.exports=function(I,D){return I&&P(D,M(D),I)}},function(b,A,v){var P=v(21),M=v(43),I=v(211),D=Object.prototype.hasOwnProperty;b.exports=function(k){if(!P(k))return I(k);var W=M(k),X=[];for(var V in k)(V!="constructor"||!W&&D.call(k,V))&&X.push(V);return X}},function(b,A){b.exports=function(v){var P=[];if(v!=null)for(var M in Object(v))P.push(M);return P}},function(b,A,v){(function(P){var M=v(14),I=A&&!A.nodeType&&A,D=I&&typeof P=="object"&&P&&!P.nodeType&&P,k=D&&D.exports===I?M.Buffer:void 0,W=k?k.allocUnsafe:void 0;P.exports=function(X,V){if(V)return X.slice();var et=X.length,pt=W?W(et):new X.constructor(et);return X.copy(pt),pt}}).call(this,v(25)(b))},function(b,A){b.exports=function(v,P){var M=-1,I=v.length;for(P||(P=Array(I));++M<I;)P[M]=v[M];return P}},function(b,A,v){var P=v(32),M=v(38);b.exports=function(I,D){return P(I,M(I),D)}},function(b,A,v){var P=v(32),M=v(70);b.exports=function(I,D){return P(I,M(I),D)}},function(b,A,v){var P=v(60),M=v(70),I=v(44);b.exports=function(D){return P(D,I,M)}},function(b,A){var v=Object.prototype.hasOwnProperty;b.exports=function(P){var M=P.length,I=new P.constructor(M);return M&&typeof P[0]=="string"&&v.call(P,"index")&&(I.index=P.index,I.input=P.input),I}},function(b,A,v){var P=v(45),M=v(219),I=v(220),D=v(221),k=v(222);b.exports=function(W,X,V){var et=W.constructor;switch(X){case"[object ArrayBuffer]":return P(W);case"[object Boolean]":case"[object Date]":return new et(+W);case"[object DataView]":return M(W,V);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return k(W,V);case"[object Map]":return new et;case"[object Number]":case"[object String]":return new et(W);case"[object RegExp]":return I(W);case"[object Set]":return new et;case"[object Symbol]":return D(W)}}},function(b,A,v){var P=v(45);b.exports=function(M,I){var D=I?P(M.buffer):M.buffer;return new M.constructor(D,M.byteOffset,M.byteLength)}},function(b,A){var v=/\w*$/;b.exports=function(P){var M=new P.constructor(P.source,v.exec(P));return M.lastIndex=P.lastIndex,M}},function(b,A,v){var P=v(24),M=P?P.prototype:void 0,I=M?M.valueOf:void 0;b.exports=function(D){return I?Object(I.call(D)):{}}},function(b,A,v){var P=v(45);b.exports=function(M,I){var D=I?P(M.buffer):M.buffer;return new M.constructor(D,M.byteOffset,M.length)}},function(b,A,v){var P=v(224),M=v(71),I=v(43);b.exports=function(D){return typeof D.constructor!="function"||I(D)?{}:P(M(D))}},function(b,A,v){var P=v(21),M=Object.create,I=function(){function D(){}return function(k){if(!P(k))return{};if(M)return M(k);D.prototype=k;var W=new D;return D.prototype=void 0,W}}();b.exports=I},function(b,A,v){var P=v(226),M=v(41),I=v(42),D=I&&I.isMap,k=D?M(D):P;b.exports=k},function(b,A,v){var P=v(31),M=v(15);b.exports=function(I){return M(I)&&P(I)=="[object Map]"}},function(b,A,v){var P=v(228),M=v(41),I=v(42),D=I&&I.isSet,k=D?M(D):P;b.exports=k},function(b,A,v){var P=v(31),M=v(15);b.exports=function(I){return M(I)&&P(I)=="[object Set]"}},function(b,A,v){v.r(A),v.d(A,"delay",function(){return Mh}),v.d(A,"waitUntil",function(){return Nw}),v.d(A,"SLIDE_EVENTS",function(){return hr}),v.d(A,"Slide",function(){return io});const P=[];for(let i=0;i<256;i++)P[i]=(i<16?"0":"")+i.toString(16);function M(){const i=4294967295*Math.random()|0,t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(P[255&i]+P[i>>8&255]+P[i>>16&255]+P[i>>24&255]+"-"+P[255&t]+P[t>>8&255]+"-"+P[t>>16&15|64]+P[t>>24&255]+"-"+P[63&e|128]+P[e>>8&255]+"-"+P[e>>16&255]+P[e>>24&255]+P[255&n]+P[n>>8&255]+P[n>>16&255]+P[n>>24&255]).toUpperCase()}var I=v(23);/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */class D{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const n=this._listeners[t];if(n!==void 0){const r=n.indexOf(e);r!==-1&&n.splice(r,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const e=this._listeners[t.type];if(e!==void 0){t.target=this;const n=e.slice(0);for(let r=0,o=n.length;r<o;r++)n[r].call(this,t);t.target=null}}}const k=[];for(let i=0;i<256;i++)k[i]=(i<16?"0":"")+i.toString(16);const W=Math.PI/180,X=180/Math.PI;function V(){const i=4294967295*Math.random()|0,t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(k[255&i]+k[i>>8&255]+k[i>>16&255]+k[i>>24&255]+"-"+k[255&t]+k[t>>8&255]+"-"+k[t>>16&15|64]+k[t>>24&255]+"-"+k[63&e|128]+k[e>>8&255]+"-"+k[e>>16&255]+k[e>>24&255]+k[255&n]+k[n>>8&255]+k[n>>16&255]+k[n>>24&255]).toUpperCase()}function et(i,t,e){return Math.max(t,Math.min(e,i))}function pt(i,t){return(i%t+t)%t}function Dt(i,t,e){return(1-e)*i+e*t}function At(i){return(i&i-1)==0&&i!==0}function L(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}class R{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),o=this.x-t.x,s=this.y-t.y;return this.x=o*n-s*r+t.x,this.y=o*r+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}R.prototype.isVector2=!0;class F{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,o,s,a,l,h){const u=this.elements;return u[0]=t,u[1]=r,u[2]=a,u[3]=e,u[4]=o,u[5]=l,u[6]=n,u[7]=s,u[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,o=this.elements,s=n[0],a=n[3],l=n[6],h=n[1],u=n[4],p=n[7],y=n[2],x=n[5],E=n[8],w=r[0],C=r[3],j=r[6],Z=r[1],rt=r[4],ct=r[7],nt=r[2],vt=r[5],ht=r[8];return o[0]=s*w+a*Z+l*nt,o[3]=s*C+a*rt+l*vt,o[6]=s*j+a*ct+l*ht,o[1]=h*w+u*Z+p*nt,o[4]=h*C+u*rt+p*vt,o[7]=h*j+u*ct+p*ht,o[2]=y*w+x*Z+E*nt,o[5]=y*C+x*rt+E*vt,o[8]=y*j+x*ct+E*ht,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],h=t[7],u=t[8];return e*s*u-e*a*h-n*o*u+n*a*l+r*o*h-r*s*l}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],h=t[7],u=t[8],p=u*s-a*h,y=a*l-u*o,x=h*o-s*l,E=e*p+n*y+r*x;if(E===0)return this.set(0,0,0,0,0,0,0,0,0);const w=1/E;return t[0]=p*w,t[1]=(r*h-u*n)*w,t[2]=(a*n-r*s)*w,t[3]=y*w,t[4]=(u*e-r*l)*w,t[5]=(r*o-a*e)*w,t[6]=x*w,t[7]=(n*l-h*e)*w,t[8]=(s*e-n*o)*w,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,o,s,a){const l=Math.cos(o),h=Math.sin(o);return this.set(n*l,n*h,-n*(l*s+h*a)+s+t,-r*h,r*l,-r*(-h*s+l*a)+a+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.elements,o=r[0],s=r[3],a=r[6],l=r[1],h=r[4],u=r[7];return r[0]=e*o+n*l,r[3]=e*s+n*h,r[6]=e*a+n*u,r[1]=-n*o+e*l,r[4]=-n*s+e*h,r[7]=-n*a+e*u,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}let Y;F.prototype.isMatrix3=!0;class O{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Y===void 0&&(Y=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Y.width=t.width,Y.height=t.height;const n=Y.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Y}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}}let H=0;class tt extends D{constructor(t=tt.DEFAULT_IMAGE,e=tt.DEFAULT_MAPPING,n=1001,r=1001,o=1006,s=1008,a=1023,l=1009,h=1,u=3e3){super(),Object.defineProperty(this,"id",{value:H++}),this.uuid=V(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=o,this.minFilter=s,this.anisotropy=h,this.format=a,this.internalFormat=null,this.type=l,this.offset=new R(0,0),this.repeat=new R(1,1),this.center=new R(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new F,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const r=this.image;if(r.uuid===void 0&&(r.uuid=V()),!e&&t.images[r.uuid]===void 0){let o;if(Array.isArray(r)){o=[];for(let s=0,a=r.length;s<a;s++)r[s].isDataTexture?o.push(G(r[s].image)):o.push(G(r[s]))}else o=G(r);t.images[r.uuid]={uuid:r.uuid,url:o}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==300)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&this.version++}}function G(i){return typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&i instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap?O.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}tt.DEFAULT_IMAGE=void 0,tt.DEFAULT_MAPPING=300,tt.prototype.isTexture=!0;class Ot{constructor(t=0,e=0,n=0,r=1){this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,o=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r+s[12]*o,this.y=s[1]*e+s[5]*n+s[9]*r+s[13]*o,this.z=s[2]*e+s[6]*n+s[10]*r+s[14]*o,this.w=s[3]*e+s[7]*n+s[11]*r+s[15]*o,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,o;const s=t.elements,a=s[0],l=s[4],h=s[8],u=s[1],p=s[5],y=s[9],x=s[2],E=s[6],w=s[10];if(Math.abs(l-u)<.01&&Math.abs(h-x)<.01&&Math.abs(y-E)<.01){if(Math.abs(l+u)<.1&&Math.abs(h+x)<.1&&Math.abs(y+E)<.1&&Math.abs(a+p+w-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const j=(a+1)/2,Z=(p+1)/2,rt=(w+1)/2,ct=(l+u)/4,nt=(h+x)/4,vt=(y+E)/4;return j>Z&&j>rt?j<.01?(n=0,r=.707106781,o=.707106781):(n=Math.sqrt(j),r=ct/n,o=nt/n):Z>rt?Z<.01?(n=.707106781,r=0,o=.707106781):(r=Math.sqrt(Z),n=ct/r,o=vt/r):rt<.01?(n=.707106781,r=.707106781,o=0):(o=Math.sqrt(rt),n=nt/o,r=vt/o),this.set(n,r,o,e),this}let C=Math.sqrt((E-y)*(E-y)+(h-x)*(h-x)+(u-l)*(u-l));return Math.abs(C)<.001&&(C=1),this.x=(E-y)/C,this.y=(h-x)/C,this.z=(u-l)/C,this.w=Math.acos((a+p+w-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Ot.prototype.isVector4=!0;class Vt extends D{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new Ot(0,0,t,e),this.scissorTest=!1,this.viewport=new Ot(0,0,t,e),this.texture=new tt(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=n.generateMipmaps!==void 0&&n.generateMipmaps,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:1006,this.depthBuffer=n.depthBuffer===void 0||n.depthBuffer,this.stencilBuffer=n.stencilBuffer!==void 0&&n.stencilBuffer,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image=qc({},this.texture.image),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Vt.prototype.isWebGLRenderTarget=!0,class extends Vt{constructor(i,t,e){super(i,t);const n=this.texture;this.texture=[];for(let r=0;r<e;r++)this.texture[r]=n.clone()}setSize(i,t,e=1){if(this.width!==i||this.height!==t||this.depth!==e){this.width=i,this.height=t,this.depth=e;for(let n=0,r=this.texture.length;n<r;n++)this.texture[n].image.width=i,this.texture[n].image.height=t,this.texture[n].image.depth=e;this.dispose()}return this.viewport.set(0,0,i,t),this.scissor.set(0,0,i,t),this}copy(i){this.dispose(),this.width=i.width,this.height=i.height,this.depth=i.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.texture.length=0;for(let t=0,e=i.texture.length;t<e;t++)this.texture[t]=i.texture[t].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class st extends Vt{constructor(t,e,n){super(t,e,n),this.samples=4}copy(t){return super.copy.call(this,t),this.samples=t.samples,this}}st.prototype.isWebGLMultisampleRenderTarget=!0;class z{constructor(t=0,e=0,n=0,r=1){this._x=t,this._y=e,this._z=n,this._w=r}static slerp(t,e,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,r)}static slerpFlat(t,e,n,r,o,s,a){let l=n[r+0],h=n[r+1],u=n[r+2],p=n[r+3];const y=o[s+0],x=o[s+1],E=o[s+2],w=o[s+3];if(a===0)return t[e+0]=l,t[e+1]=h,t[e+2]=u,void(t[e+3]=p);if(a===1)return t[e+0]=y,t[e+1]=x,t[e+2]=E,void(t[e+3]=w);if(p!==w||l!==y||h!==x||u!==E){let C=1-a;const j=l*y+h*x+u*E+p*w,Z=j>=0?1:-1,rt=1-j*j;if(rt>Number.EPSILON){const nt=Math.sqrt(rt),vt=Math.atan2(nt,j*Z);C=Math.sin(C*vt)/nt,a=Math.sin(a*vt)/nt}const ct=a*Z;if(l=l*C+y*ct,h=h*C+x*ct,u=u*C+E*ct,p=p*C+w*ct,C===1-a){const nt=1/Math.sqrt(l*l+h*h+u*u+p*p);l*=nt,h*=nt,u*=nt,p*=nt}}t[e]=l,t[e+1]=h,t[e+2]=u,t[e+3]=p}static multiplyQuaternionsFlat(t,e,n,r,o,s){const a=n[r],l=n[r+1],h=n[r+2],u=n[r+3],p=o[s],y=o[s+1],x=o[s+2],E=o[s+3];return t[e]=a*E+u*p+l*x-h*y,t[e+1]=l*E+u*y+h*p-a*x,t[e+2]=h*E+u*x+a*y-l*p,t[e+3]=u*E-a*p-l*y-h*x,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,r=t._y,o=t._z,s=t._order,a=Math.cos,l=Math.sin,h=a(n/2),u=a(r/2),p=a(o/2),y=l(n/2),x=l(r/2),E=l(o/2);switch(s){case"XYZ":this._x=y*u*p+h*x*E,this._y=h*x*p-y*u*E,this._z=h*u*E+y*x*p,this._w=h*u*p-y*x*E;break;case"YXZ":this._x=y*u*p+h*x*E,this._y=h*x*p-y*u*E,this._z=h*u*E-y*x*p,this._w=h*u*p+y*x*E;break;case"ZXY":this._x=y*u*p-h*x*E,this._y=h*x*p+y*u*E,this._z=h*u*E+y*x*p,this._w=h*u*p-y*x*E;break;case"ZYX":this._x=y*u*p-h*x*E,this._y=h*x*p+y*u*E,this._z=h*u*E-y*x*p,this._w=h*u*p+y*x*E;break;case"YZX":this._x=y*u*p+h*x*E,this._y=h*x*p+y*u*E,this._z=h*u*E-y*x*p,this._w=h*u*p-y*x*E;break;case"XZY":this._x=y*u*p-h*x*E,this._y=h*x*p-y*u*E,this._z=h*u*E+y*x*p,this._w=h*u*p+y*x*E;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],o=e[8],s=e[1],a=e[5],l=e[9],h=e[2],u=e[6],p=e[10],y=n+a+p;if(y>0){const x=.5/Math.sqrt(y+1);this._w=.25/x,this._x=(u-l)*x,this._y=(o-h)*x,this._z=(s-r)*x}else if(n>a&&n>p){const x=2*Math.sqrt(1+n-a-p);this._w=(u-l)/x,this._x=.25*x,this._y=(r+s)/x,this._z=(o+h)/x}else if(a>p){const x=2*Math.sqrt(1+a-n-p);this._w=(o-h)/x,this._x=(r+s)/x,this._y=.25*x,this._z=(l+u)/x}else{const x=2*Math.sqrt(1+p-n-a);this._w=(s-r)/x,this._x=(o+h)/x,this._y=(l+u)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(et(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(n===0)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return e!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,o=t._z,s=t._w,a=e._x,l=e._y,h=e._z,u=e._w;return this._x=n*u+s*a+r*h-o*l,this._y=r*u+s*l+o*a-n*h,this._z=o*u+s*h+n*l-r*a,this._w=s*u-n*a-r*l-o*h,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const n=this._x,r=this._y,o=this._z,s=this._w;let a=s*t._w+n*t._x+r*t._y+o*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=n,this._y=r,this._z=o,this;const l=1-a*a;if(l<=Number.EPSILON){const x=1-e;return this._w=x*s+e*this._w,this._x=x*n+e*this._x,this._y=x*r+e*this._y,this._z=x*o+e*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(l),u=Math.atan2(h,a),p=Math.sin((1-e)*u)/h,y=Math.sin(e*u)/h;return this._w=s*p+this._w*y,this._x=n*p+this._x*y,this._y=r*p+this._y*y,this._z=o*p+this._z*y,this._onChangeCallback(),this}slerpQuaternions(t,e,n){this.copy(t).slerp(e,n)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}z.prototype.isQuaternion=!0;class U{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return n===void 0&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion($.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion($.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[3]*n+o[6]*r,this.y=o[1]*e+o[4]*n+o[7]*r,this.z=o[2]*e+o[5]*n+o[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,o=t.elements,s=1/(o[3]*e+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*e+o[4]*n+o[8]*r+o[12])*s,this.y=(o[1]*e+o[5]*n+o[9]*r+o[13])*s,this.z=(o[2]*e+o[6]*n+o[10]*r+o[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,o=t.x,s=t.y,a=t.z,l=t.w,h=l*e+s*r-a*n,u=l*n+a*e-o*r,p=l*r+o*n-s*e,y=-o*e-s*n-a*r;return this.x=h*l+y*-o+u*-a-p*-s,this.y=u*l+y*-s+p*-o-h*-a,this.z=p*l+y*-a+h*-s-u*-o,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r,this.y=o[1]*e+o[5]*n+o[9]*r,this.z=o[2]*e+o[6]*n+o[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return e!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,o=t.z,s=e.x,a=e.y,l=e.z;return this.x=r*l-o*a,this.y=o*s-n*l,this.z=n*a-r*s,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return ft.copy(this).projectOnVector(t),this.sub(ft)}reflect(t){return this.sub(ft.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(et(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}U.prototype.isVector3=!0;const ft=new U,$=new z;class gt{constructor(t=new U(1/0,1/0,1/0),e=new U(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,h=t.length;l<h;l+=3){const u=t[l],p=t[l+1],y=t[l+2];u<e&&(e=u),p<n&&(n=p),y<r&&(r=y),u>o&&(o=u),p>s&&(s=p),y>a&&(a=y)}return this.min.set(e,n,r),this.max.set(o,s,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,h=t.count;l<h;l++){const u=t.getX(l),p=t.getY(l),y=t.getZ(l);u<e&&(e=u),p<n&&(n=p),y<r&&(r=y),u>o&&(o=u),p>s&&(s=p),y>a&&(a=y)}return this.min.set(e,n,r),this.max.set(o,s,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=K.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;e!==void 0&&(e.boundingBox===null&&e.computeBoundingBox(),dt.copy(e.boundingBox),dt.applyMatrix4(t.matrixWorld),this.union(dt));const n=t.children;for(let r=0,o=n.length;r<o;r++)this.expandByObject(n[r]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,K),K.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(at),_e.subVectors(this.max,at),it.subVectors(t.a,at),_t.subVectors(t.b,at),St.subVectors(t.c,at),kt.subVectors(_t,it),Xt.subVectors(St,_t),Jt.subVectors(it,St);let e=[0,-kt.z,kt.y,0,-Xt.z,Xt.y,0,-Jt.z,Jt.y,kt.z,0,-kt.x,Xt.z,0,-Xt.x,Jt.z,0,-Jt.x,-kt.y,kt.x,0,-Xt.y,Xt.x,0,-Jt.y,Jt.x,0];return!!Ae(e,it,_t,St,_e)&&(e=[1,0,0,0,1,0,0,0,1],!!Ae(e,it,_t,St,_e)&&(Ue.crossVectors(kt,Xt),e=[Ue.x,Ue.y,Ue.z],Ae(e,it,_t,St,_e)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return K.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(K).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(Lt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Lt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Lt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Lt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Lt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Lt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Lt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Lt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Lt)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}gt.prototype.isBox3=!0;const Lt=[new U,new U,new U,new U,new U,new U,new U,new U],K=new U,dt=new gt,it=new U,_t=new U,St=new U,kt=new U,Xt=new U,Jt=new U,at=new U,_e=new U,Ue=new U,Oe=new U;function Ae(i,t,e,n,r){for(let o=0,s=i.length-3;o<=s;o+=3){Oe.fromArray(i,o);const a=r.x*Math.abs(Oe.x)+r.y*Math.abs(Oe.y)+r.z*Math.abs(Oe.z),l=t.dot(Oe),h=e.dot(Oe),u=n.dot(Oe);if(Math.max(-Math.max(l,h,u),Math.min(l,h,u))>a)return!1}return!0}const ze=new gt,$e=new U,cn=new U,ke=new U;class Ge{constructor(t=new U,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;e!==void 0?n.copy(e):ze.setFromPoints(t).getCenter(n);let r=0;for(let o=0,s=t.length;o<s;o++)r=Math.max(r,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){ke.subVectors(t,this.center);const e=ke.lengthSq();if(e>this.radius*this.radius){const n=Math.sqrt(e),r=.5*(n-this.radius);this.center.add(ke.multiplyScalar(r/n)),this.radius+=r}return this}union(t){return cn.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint($e.copy(t.center).add(cn)),this.expandByPoint($e.copy(t.center).sub(cn)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Rn=new U,re=new U,pe=new U,Ee=new U,ln=new U,In=new U,Qn=new U;class fi{constructor(t=new U,e=new U(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Rn)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Rn.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Rn.copy(this.direction).multiplyScalar(e).add(this.origin),Rn.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){re.copy(t).add(e).multiplyScalar(.5),pe.copy(e).sub(t).normalize(),Ee.copy(this.origin).sub(re);const o=.5*t.distanceTo(e),s=-this.direction.dot(pe),a=Ee.dot(this.direction),l=-Ee.dot(pe),h=Ee.lengthSq(),u=Math.abs(1-s*s);let p,y,x,E;if(u>0)if(p=s*l-a,y=s*a-l,E=o*u,p>=0)if(y>=-E)if(y<=E){const w=1/u;p*=w,y*=w,x=p*(p+s*y+2*a)+y*(s*p+y+2*l)+h}else y=o,p=Math.max(0,-(s*y+a)),x=-p*p+y*(y+2*l)+h;else y=-o,p=Math.max(0,-(s*y+a)),x=-p*p+y*(y+2*l)+h;else y<=-E?(p=Math.max(0,-(-s*o+a)),y=p>0?-o:Math.min(Math.max(-o,-l),o),x=-p*p+y*(y+2*l)+h):y<=E?(p=0,y=Math.min(Math.max(-o,-l),o),x=y*(y+2*l)+h):(p=Math.max(0,-(s*o+a)),y=p>0?o:Math.min(Math.max(-o,-l),o),x=-p*p+y*(y+2*l)+h);else y=s>0?-o:o,p=Math.max(0,-(s*y+a)),x=-p*p+y*(y+2*l)+h;return n&&n.copy(this.direction).multiplyScalar(p).add(this.origin),r&&r.copy(pe).multiplyScalar(y).add(re),x}intersectSphere(t,e){Rn.subVectors(t.center,this.origin);const n=Rn.dot(this.direction),r=Rn.dot(Rn)-n*n,o=t.radius*t.radius;if(r>o)return null;const s=Math.sqrt(o-r),a=n-s,l=n+s;return a<0&&l<0?null:a<0?this.at(l,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return n===null?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0?!0:t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,o,s,a,l;const h=1/this.direction.x,u=1/this.direction.y,p=1/this.direction.z,y=this.origin;return h>=0?(n=(t.min.x-y.x)*h,r=(t.max.x-y.x)*h):(n=(t.max.x-y.x)*h,r=(t.min.x-y.x)*h),u>=0?(o=(t.min.y-y.y)*u,s=(t.max.y-y.y)*u):(o=(t.max.y-y.y)*u,s=(t.min.y-y.y)*u),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),p>=0?(a=(t.min.z-y.z)*p,l=(t.max.z-y.z)*p):(a=(t.max.z-y.z)*p,l=(t.min.z-y.z)*p),n>l||a>r?null:((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return this.intersectBox(t,Rn)!==null}intersectTriangle(t,e,n,r,o){ln.subVectors(e,t),In.subVectors(n,t),Qn.crossVectors(ln,In);let s,a=this.direction.dot(Qn);if(a>0){if(r)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}Ee.subVectors(this.origin,t);const l=s*this.direction.dot(In.crossVectors(Ee,In));if(l<0)return null;const h=s*this.direction.dot(ln.cross(Ee));if(h<0||l+h>a)return null;const u=-s*Ee.dot(Qn);return u<0?null:this.at(u/a,o)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class tn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,o,s,a,l,h,u,p,y,x,E,w,C){const j=this.elements;return j[0]=t,j[4]=e,j[8]=n,j[12]=r,j[1]=o,j[5]=s,j[9]=a,j[13]=l,j[2]=h,j[6]=u,j[10]=p,j[14]=y,j[3]=x,j[7]=E,j[11]=w,j[15]=C,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new tn().fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/yt.setFromMatrixColumn(t,0).length(),o=1/yt.setFromMatrixColumn(t,1).length(),s=1/yt.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*o,e[5]=n[5]*o,e[6]=n[6]*o,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,r=t.y,o=t.z,s=Math.cos(n),a=Math.sin(n),l=Math.cos(r),h=Math.sin(r),u=Math.cos(o),p=Math.sin(o);if(t.order==="XYZ"){const y=s*u,x=s*p,E=a*u,w=a*p;e[0]=l*u,e[4]=-l*p,e[8]=h,e[1]=x+E*h,e[5]=y-w*h,e[9]=-a*l,e[2]=w-y*h,e[6]=E+x*h,e[10]=s*l}else if(t.order==="YXZ"){const y=l*u,x=l*p,E=h*u,w=h*p;e[0]=y+w*a,e[4]=E*a-x,e[8]=s*h,e[1]=s*p,e[5]=s*u,e[9]=-a,e[2]=x*a-E,e[6]=w+y*a,e[10]=s*l}else if(t.order==="ZXY"){const y=l*u,x=l*p,E=h*u,w=h*p;e[0]=y-w*a,e[4]=-s*p,e[8]=E+x*a,e[1]=x+E*a,e[5]=s*u,e[9]=w-y*a,e[2]=-s*h,e[6]=a,e[10]=s*l}else if(t.order==="ZYX"){const y=s*u,x=s*p,E=a*u,w=a*p;e[0]=l*u,e[4]=E*h-x,e[8]=y*h+w,e[1]=l*p,e[5]=w*h+y,e[9]=x*h-E,e[2]=-h,e[6]=a*l,e[10]=s*l}else if(t.order==="YZX"){const y=s*l,x=s*h,E=a*l,w=a*h;e[0]=l*u,e[4]=w-y*p,e[8]=E*p+x,e[1]=p,e[5]=s*u,e[9]=-a*u,e[2]=-h*u,e[6]=x*p+E,e[10]=y-w*p}else if(t.order==="XZY"){const y=s*l,x=s*h,E=a*l,w=a*h;e[0]=l*u,e[4]=-p,e[8]=h*u,e[1]=y*p+w,e[5]=s*u,e[9]=x*p-E,e[2]=E*p-x,e[6]=a*u,e[10]=w*p+y}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Rt,t,Qt)}lookAt(t,e,n){const r=this.elements;return oe.subVectors(t,e),oe.lengthSq()===0&&(oe.z=1),oe.normalize(),Wt.crossVectors(n,oe),Wt.lengthSq()===0&&(Math.abs(n.z)===1?oe.x+=1e-4:oe.z+=1e-4,oe.normalize(),Wt.crossVectors(n,oe)),Wt.normalize(),Kt.crossVectors(oe,Wt),r[0]=Wt.x,r[4]=Kt.x,r[8]=oe.x,r[1]=Wt.y,r[5]=Kt.y,r[9]=oe.y,r[2]=Wt.z,r[6]=Kt.z,r[10]=oe.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,o=this.elements,s=n[0],a=n[4],l=n[8],h=n[12],u=n[1],p=n[5],y=n[9],x=n[13],E=n[2],w=n[6],C=n[10],j=n[14],Z=n[3],rt=n[7],ct=n[11],nt=n[15],vt=r[0],ht=r[4],mt=r[8],jt=r[12],Ft=r[1],Mt=r[5],wt=r[9],Pt=r[13],Nt=r[2],ne=r[6],$t=r[10],zt=r[14],Yt=r[3],ge=r[7],be=r[11],Pe=r[15];return o[0]=s*vt+a*Ft+l*Nt+h*Yt,o[4]=s*ht+a*Mt+l*ne+h*ge,o[8]=s*mt+a*wt+l*$t+h*be,o[12]=s*jt+a*Pt+l*zt+h*Pe,o[1]=u*vt+p*Ft+y*Nt+x*Yt,o[5]=u*ht+p*Mt+y*ne+x*ge,o[9]=u*mt+p*wt+y*$t+x*be,o[13]=u*jt+p*Pt+y*zt+x*Pe,o[2]=E*vt+w*Ft+C*Nt+j*Yt,o[6]=E*ht+w*Mt+C*ne+j*ge,o[10]=E*mt+w*wt+C*$t+j*be,o[14]=E*jt+w*Pt+C*zt+j*Pe,o[3]=Z*vt+rt*Ft+ct*Nt+nt*Yt,o[7]=Z*ht+rt*Mt+ct*ne+nt*ge,o[11]=Z*mt+rt*wt+ct*$t+nt*be,o[15]=Z*jt+rt*Pt+ct*zt+nt*Pe,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],o=t[12],s=t[1],a=t[5],l=t[9],h=t[13],u=t[2],p=t[6],y=t[10],x=t[14];return t[3]*(+o*l*p-r*h*p-o*a*y+n*h*y+r*a*x-n*l*x)+t[7]*(+e*l*x-e*h*y+o*s*y-r*s*x+r*h*u-o*l*u)+t[11]*(+e*h*p-e*a*x-o*s*p+n*s*x+o*a*u-n*h*u)+t[15]*(-r*a*u-e*l*p+e*a*y+r*s*p-n*s*y+n*l*u)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],h=t[7],u=t[8],p=t[9],y=t[10],x=t[11],E=t[12],w=t[13],C=t[14],j=t[15],Z=p*C*h-w*y*h+w*l*x-a*C*x-p*l*j+a*y*j,rt=E*y*h-u*C*h-E*l*x+s*C*x+u*l*j-s*y*j,ct=u*w*h-E*p*h+E*a*x-s*w*x-u*a*j+s*p*j,nt=E*p*l-u*w*l-E*a*y+s*w*y+u*a*C-s*p*C,vt=e*Z+n*rt+r*ct+o*nt;if(vt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ht=1/vt;return t[0]=Z*ht,t[1]=(w*y*o-p*C*o-w*r*x+n*C*x+p*r*j-n*y*j)*ht,t[2]=(a*C*o-w*l*o+w*r*h-n*C*h-a*r*j+n*l*j)*ht,t[3]=(p*l*o-a*y*o-p*r*h+n*y*h+a*r*x-n*l*x)*ht,t[4]=rt*ht,t[5]=(u*C*o-E*y*o+E*r*x-e*C*x-u*r*j+e*y*j)*ht,t[6]=(E*l*o-s*C*o-E*r*h+e*C*h+s*r*j-e*l*j)*ht,t[7]=(s*y*o-u*l*o+u*r*h-e*y*h-s*r*x+e*l*x)*ht,t[8]=ct*ht,t[9]=(E*p*o-u*w*o-E*n*x+e*w*x+u*n*j-e*p*j)*ht,t[10]=(s*w*o-E*a*o+E*n*h-e*w*h-s*n*j+e*a*j)*ht,t[11]=(u*a*o-s*p*o-u*n*h+e*p*h+s*n*x-e*a*x)*ht,t[12]=nt*ht,t[13]=(u*w*r-E*p*r+E*n*y-e*w*y-u*n*C+e*p*C)*ht,t[14]=(E*a*r-s*w*r-E*n*l+e*w*l+s*n*C-e*a*C)*ht,t[15]=(s*p*r-u*a*r+u*n*l-e*p*l-s*n*y+e*a*y)*ht,this}scale(t){const e=this.elements,n=t.x,r=t.y,o=t.z;return e[0]*=n,e[4]*=r,e[8]*=o,e[1]*=n,e[5]*=r,e[9]*=o,e[2]*=n,e[6]*=r,e[10]*=o,e[3]*=n,e[7]*=r,e[11]*=o,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),o=1-n,s=t.x,a=t.y,l=t.z,h=o*s,u=o*a;return this.set(h*s+n,h*a-r*l,h*l+r*a,0,h*a+r*l,u*a+n,u*l-r*s,0,h*l-r*a,u*l+r*s,o*l*l+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,o,s){return this.set(1,n,o,0,t,1,s,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,o=e._x,s=e._y,a=e._z,l=e._w,h=o+o,u=s+s,p=a+a,y=o*h,x=o*u,E=o*p,w=s*u,C=s*p,j=a*p,Z=l*h,rt=l*u,ct=l*p,nt=n.x,vt=n.y,ht=n.z;return r[0]=(1-(w+j))*nt,r[1]=(x+ct)*nt,r[2]=(E-rt)*nt,r[3]=0,r[4]=(x-ct)*vt,r[5]=(1-(y+j))*vt,r[6]=(C+Z)*vt,r[7]=0,r[8]=(E+rt)*ht,r[9]=(C-Z)*ht,r[10]=(1-(y+w))*ht,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let o=yt.set(r[0],r[1],r[2]).length();const s=yt.set(r[4],r[5],r[6]).length(),a=yt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),t.x=r[12],t.y=r[13],t.z=r[14],Et.copy(this);const l=1/o,h=1/s,u=1/a;return Et.elements[0]*=l,Et.elements[1]*=l,Et.elements[2]*=l,Et.elements[4]*=h,Et.elements[5]*=h,Et.elements[6]*=h,Et.elements[8]*=u,Et.elements[9]*=u,Et.elements[10]*=u,e.setFromRotationMatrix(Et),n.x=o,n.y=s,n.z=a,this}makePerspective(t,e,n,r,o,s){s===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,l=2*o/(e-t),h=2*o/(n-r),u=(e+t)/(e-t),p=(n+r)/(n-r),y=-(s+o)/(s-o),x=-2*s*o/(s-o);return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=p,a[13]=0,a[2]=0,a[6]=0,a[10]=y,a[14]=x,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,r,o,s){const a=this.elements,l=1/(e-t),h=1/(n-r),u=1/(s-o),p=(e+t)*l,y=(n+r)*h,x=(s+o)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-p,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-y,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-x,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}tn.prototype.isMatrix4=!0;const yt=new U,Et=new tn,Rt=new U(0,0,0),Qt=new U(1,1,1),Wt=new U,Kt=new U,oe=new U,Me=new tn,we=new z;class Se{constructor(t=0,e=0,n=0,r=Se.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,o=r[0],s=r[4],a=r[8],l=r[1],h=r[5],u=r[9],p=r[2],y=r[6],x=r[10];switch(e){case"XYZ":this._y=Math.asin(et(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,x),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(y,h),this._z=0);break;case"YXZ":this._x=Math.asin(-et(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,x),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-p,o),this._z=0);break;case"ZXY":this._x=Math.asin(et(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-p,x),this._z=Math.atan2(-s,h)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-et(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(y,x),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,h));break;case"YZX":this._z=Math.asin(et(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(a,x));break;case"XZY":this._z=Math.asin(-et(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(y,h),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-u,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Me.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Me,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return we.setFromEuler(this),this.setFromQuaternion(we,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new U(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Se.prototype.isEuler=!0,Se.DefaultOrder="XYZ",Se.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Ve{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!=0}}let en=0;const dn=new U,Tn=new z,yn=new tn,Yn=new U,Pn=new U,Vi=new U,bo=new z,so=new U(1,0,0),Bn=new U(0,1,0),Qo=new U(0,0,1),ao={type:"added"},To={type:"removed"};class kn extends D{constructor(){super(),Object.defineProperty(this,"id",{value:en++}),this.uuid=V(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=kn.DefaultUp.clone();const t=new U,e=new Se,n=new z,r=new U(1,1,1);e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new tn},normalMatrix:{value:new F}}),this.matrix=new tn,this.matrixWorld=new tn,this.matrixAutoUpdate=kn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ve,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Tn.setFromAxisAngle(t,e),this.quaternion.multiply(Tn),this}rotateOnWorldAxis(t,e){return Tn.setFromAxisAngle(t,e),this.quaternion.premultiply(Tn),this}rotateX(t){return this.rotateOnAxis(so,t)}rotateY(t){return this.rotateOnAxis(Bn,t)}rotateZ(t){return this.rotateOnAxis(Qo,t)}translateOnAxis(t,e){return dn.copy(t).applyQuaternion(this.quaternion),this.position.add(dn.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(so,t)}translateY(t){return this.translateOnAxis(Bn,t)}translateZ(t){return this.translateOnAxis(Qo,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(yn.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Yn.copy(t):Yn.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Pn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?yn.lookAt(Pn,Yn,this.up):yn.lookAt(Yn,Pn,this.up),this.quaternion.setFromRotationMatrix(yn),r&&(yn.extractRotation(r.matrixWorld),Tn.setFromRotationMatrix(yn),this.quaternion.premultiply(Tn.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(ao)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(To)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(To)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),yn.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),yn.multiply(t.parent.matrixWorld)),t.applyMatrix4(yn),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(t,e);if(o!==void 0)return o}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Pn,t,Vi),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Pn,bo,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(t===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const r=this.children;for(let o=0,s=r.length;o<s;o++)r[o].updateWorldMatrix(!1,!0)}}toJSON(t){const e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function o(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(t)),l.uuid}if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(t.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let h=0,u=l.length;h<u;h++){const p=l[h];o(t.shapes,p)}else o(t.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,h=this.material.length;l<h;l++)a.push(o(t.materials,this.material[l]));r.material=a}else r.material=o(t.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(o(t.animations,l))}}if(e){const a=s(t.geometries),l=s(t.materials),h=s(t.textures),u=s(t.images),p=s(t.shapes),y=s(t.skeletons),x=s(t.animations);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),h.length>0&&(n.textures=h),u.length>0&&(n.images=u),p.length>0&&(n.shapes=p),y.length>0&&(n.skeletons=y),x.length>0&&(n.animations=x)}return n.object=r,n;function s(a){const l=[];for(const h in a){const u=a[h];delete u.metadata,l.push(u)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){const r=t.children[n];this.add(r.clone())}return this}}kn.DefaultUp=new U(0,1,0),kn.DefaultMatrixAutoUpdate=!0,kn.prototype.isObject3D=!0;const zn=new U,Zi=new U,qr=new U,Ci=new U,Cr=new U,Fr=new U,$o=new U,ts=new U,Eo=new U,So=new U;class ci{constructor(t=new U,e=new U,n=new U){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),zn.subVectors(t,e),r.cross(zn);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(t,e,n,r,o){zn.subVectors(r,e),Zi.subVectors(n,e),qr.subVectors(t,e);const s=zn.dot(zn),a=zn.dot(Zi),l=zn.dot(qr),h=Zi.dot(Zi),u=Zi.dot(qr),p=s*h-a*a;if(p===0)return o.set(-2,-1,-1);const y=1/p,x=(h*l-a*u)*y,E=(s*u-a*l)*y;return o.set(1-x-E,E,x)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,Ci),Ci.x>=0&&Ci.y>=0&&Ci.x+Ci.y<=1}static getUV(t,e,n,r,o,s,a,l){return this.getBarycoord(t,e,n,r,Ci),l.set(0,0),l.addScaledVector(o,Ci.x),l.addScaledVector(s,Ci.y),l.addScaledVector(a,Ci.z),l}static isFrontFacing(t,e,n,r){return zn.subVectors(n,e),Zi.subVectors(t,e),zn.cross(Zi).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return zn.subVectors(this.c,this.b),Zi.subVectors(this.a,this.b),.5*zn.cross(Zi).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(t){return ci.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return ci.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,o){return ci.getUV(t,this.a,this.b,this.c,e,n,r,o)}containsPoint(t){return ci.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return ci.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,o=this.c;let s,a;Cr.subVectors(r,n),Fr.subVectors(o,n),ts.subVectors(t,n);const l=Cr.dot(ts),h=Fr.dot(ts);if(l<=0&&h<=0)return e.copy(n);Eo.subVectors(t,r);const u=Cr.dot(Eo),p=Fr.dot(Eo);if(u>=0&&p<=u)return e.copy(r);const y=l*p-u*h;if(y<=0&&l>=0&&u<=0)return s=l/(l-u),e.copy(n).addScaledVector(Cr,s);So.subVectors(t,o);const x=Cr.dot(So),E=Fr.dot(So);if(E>=0&&x<=E)return e.copy(o);const w=x*h-l*E;if(w<=0&&h>=0&&E<=0)return a=h/(h-E),e.copy(n).addScaledVector(Fr,a);const C=u*E-x*p;if(C<=0&&p-u>=0&&x-E>=0)return $o.subVectors(o,r),a=(p-u)/(p-u+(x-E)),e.copy(r).addScaledVector($o,a);const j=1/(C+w+y);return s=w*j,a=y*j,e.copy(n).addScaledVector(Cr,s).addScaledVector(Fr,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let es=0;class Ri extends D{constructor(){super(),Object.defineProperty(this,"id",{value:es++}),this.uuid=V(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const n=t[e];if(n===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if(e==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===1;continue}const r=this[e];r!==void 0?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(o){const s=[];for(const a in o){const l=o[a];delete l.metadata,s.push(l)}return s}if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(n.blending=this.blending),this.side!==0&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.morphNormals===!0&&(n.morphNormals=!0),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),e){const o=r(t.textures),s=r(t.images);o.length>0&&(n.textures=o),s.length>0&&(n.images=s)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(e!==null){const r=e.length;n=new Array(r);for(let o=0;o!==r;++o)n[o]=e[o].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}Ri.prototype.isMaterial=!0;const vr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Oi={h:0,s:0,l:0},Br={h:0,s:0,l:0};function wo(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<.16666666666666666?i+6*(t-i)*e:e<.5?t:e<.6666666666666666?i+6*(t-i)*(.6666666666666666-e):i}function lo(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function Ao(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}class fn{constructor(t,e,n){return e===void 0&&n===void 0?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=pt(t,1),e=et(e,0,1),n=et(n,0,1),e===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,o=2*n-r;this.r=wo(o,r,t+.3333333333333333),this.g=wo(o,r,t),this.b=wo(o,r,t-.3333333333333333)}return this}setStyle(t){function e(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let r;const o=n[1],s=n[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const a=parseFloat(r[1])/360,l=parseInt(r[2],10)/100,h=parseInt(r[3],10)/100;return e(r[4]),this.setHSL(a,l,h)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const r=n[1],o=r.length;if(o===3)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(o===6)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=vr[t.toLowerCase()];return e!==void 0?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=lo(t.r),this.g=lo(t.g),this.b=lo(t.b),this}copyLinearToSRGB(t){return this.r=Ao(t.r),this.g=Ao(t.g),this.b=Ao(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,n=this.g,r=this.b,o=Math.max(e,n,r),s=Math.min(e,n,r);let a,l;const h=(s+o)/2;if(s===o)a=0,l=0;else{const u=o-s;switch(l=h<=.5?u/(o+s):u/(2-o-s),o){case e:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-e)/u+2;break;case r:a=(e-n)/u+4}a/=6}return t.h=a,t.s=l,t.l=h,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(Oi),Oi.h+=t,Oi.s+=e,Oi.l+=n,this.setHSL(Oi.h,Oi.s,Oi.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Oi),t.getHSL(Br);const n=Dt(Oi.h,Br.h,e),r=Dt(Oi.s,Br.s,e),o=Dt(Oi.l,Br.l,e);return this.setHSL(n,r,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}fn.NAMES=vr,fn.prototype.isColor=!0,fn.prototype.r=1,fn.prototype.g=1,fn.prototype.b=1;class Qi extends Ri{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this}}Qi.prototype.isMeshBasicMaterial=!0;const Mn=new U,Mo=new R;class qn{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=n===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),s=new fn),e[n++]=s.r,e[n++]=s.g,e[n++]=s.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),s=new R),e[n++]=s.x,e[n++]=s.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),s=new U),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let r=0,o=t.length;r<o;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),s=new Ot),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z,e[n++]=s.w}return this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,n=this.count;e<n;e++)Mo.fromBufferAttribute(this,e),Mo.applyMatrix3(t),this.setXY(e,Mo.x,Mo.y);else if(this.itemSize===3)for(let e=0,n=this.count;e<n;e++)Mn.fromBufferAttribute(this,e),Mn.applyMatrix3(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Mn.x=this.getX(e),Mn.y=this.getY(e),Mn.z=this.getZ(e),Mn.applyMatrix4(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Mn.x=this.getX(e),Mn.y=this.getY(e),Mn.z=this.getZ(e),Mn.applyNormalMatrix(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Mn.x=this.getX(e),Mn.y=this.getY(e),Mn.z=this.getZ(e),Mn.transformDirection(t),this.setXYZ(e,Mn.x,Mn.y,Mn.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,o){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=o,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==35044&&(t.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(t.updateRange=this.updateRange),t}}qn.prototype.isBufferAttribute=!0;class Ts extends qn{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class da extends qn{constructor(t,e,n){super(new Int32Array(t),e,n)}}class Co extends qn{constructor(t,e,n){super(new Uint32Array(t),e,n)}}(class extends qn{constructor(i,t,e){super(new Uint16Array(i),t,e)}}).prototype.isFloat16BufferAttribute=!0;class An extends qn{constructor(t,e,n){super(new Float32Array(t),e,n)}}function Es(i){if(i.length===0)return-1/0;let t=i[0];for(let e=1,n=i.length;e<n;++e)i[e]>t&&(t=i[e]);return t}let ns=0;const bi=new tn,is=new kn,_r=new U,Ni=new gt,ho=new gt,mi=new U;class Xn extends D{constructor(){super(),Object.defineProperty(this,"id",{value:ns++}),this.uuid=V(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Es(t)>65535?Co:Ts)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new F().getNormalMatrix(t);n.applyNormalMatrix(o),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return bi.makeRotationFromQuaternion(t),this.applyMatrix4(bi),this}rotateX(t){return bi.makeRotationX(t),this.applyMatrix4(bi),this}rotateY(t){return bi.makeRotationY(t),this.applyMatrix4(bi),this}rotateZ(t){return bi.makeRotationZ(t),this.applyMatrix4(bi),this}translate(t,e,n){return bi.makeTranslation(t,e,n),this.applyMatrix4(bi),this}scale(t,e,n){return bi.makeScale(t,e,n),this.applyMatrix4(bi),this}lookAt(t){return is.lookAt(t),is.updateMatrix(),this.applyMatrix4(is.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_r).negate(),this.translate(_r.x,_r.y,_r.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const o=t[n];e.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new An(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gt);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new U(-1/0,-1/0,-1/0),new U(1/0,1/0,1/0));if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++){const o=e[n];Ni.setFromBufferAttribute(o),this.morphTargetsRelative?(mi.addVectors(this.boundingBox.min,Ni.min),this.boundingBox.expandByPoint(mi),mi.addVectors(this.boundingBox.max,Ni.max),this.boundingBox.expandByPoint(mi)):(this.boundingBox.expandByPoint(Ni.min),this.boundingBox.expandByPoint(Ni.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ge);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new U,1/0);if(t){const n=this.boundingSphere.center;if(Ni.setFromBufferAttribute(t),e)for(let o=0,s=e.length;o<s;o++){const a=e[o];ho.setFromBufferAttribute(a),this.morphTargetsRelative?(mi.addVectors(Ni.min,ho.min),Ni.expandByPoint(mi),mi.addVectors(Ni.max,ho.max),Ni.expandByPoint(mi)):(Ni.expandByPoint(ho.min),Ni.expandByPoint(ho.max))}Ni.getCenter(n);let r=0;for(let o=0,s=t.count;o<s;o++)mi.fromBufferAttribute(t,o),r=Math.max(r,n.distanceToSquared(mi));if(e)for(let o=0,s=e.length;o<s;o++){const a=e[o],l=this.morphTargetsRelative;for(let h=0,u=a.count;h<u;h++)mi.fromBufferAttribute(a,h),l&&(_r.fromBufferAttribute(t,h),mi.add(_r)),r=Math.max(r,n.distanceToSquared(mi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeFaceNormals(){}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,r=e.position.array,o=e.normal.array,s=e.uv.array,a=r.length/3;e.tangent===void 0&&this.setAttribute("tangent",new qn(new Float32Array(4*a),4));const l=e.tangent.array,h=[],u=[];for(let Ft=0;Ft<a;Ft++)h[Ft]=new U,u[Ft]=new U;const p=new U,y=new U,x=new U,E=new R,w=new R,C=new R,j=new U,Z=new U;function rt(Ft,Mt,wt){p.fromArray(r,3*Ft),y.fromArray(r,3*Mt),x.fromArray(r,3*wt),E.fromArray(s,2*Ft),w.fromArray(s,2*Mt),C.fromArray(s,2*wt),y.sub(p),x.sub(p),w.sub(E),C.sub(E);const Pt=1/(w.x*C.y-C.x*w.y);isFinite(Pt)&&(j.copy(y).multiplyScalar(C.y).addScaledVector(x,-w.y).multiplyScalar(Pt),Z.copy(x).multiplyScalar(w.x).addScaledVector(y,-C.x).multiplyScalar(Pt),h[Ft].add(j),h[Mt].add(j),h[wt].add(j),u[Ft].add(Z),u[Mt].add(Z),u[wt].add(Z))}let ct=this.groups;ct.length===0&&(ct=[{start:0,count:n.length}]);for(let Ft=0,Mt=ct.length;Ft<Mt;++Ft){const wt=ct[Ft],Pt=wt.start;for(let Nt=Pt,ne=Pt+wt.count;Nt<ne;Nt+=3)rt(n[Nt+0],n[Nt+1],n[Nt+2])}const nt=new U,vt=new U,ht=new U,mt=new U;function jt(Ft){ht.fromArray(o,3*Ft),mt.copy(ht);const Mt=h[Ft];nt.copy(Mt),nt.sub(ht.multiplyScalar(ht.dot(Mt))).normalize(),vt.crossVectors(mt,Mt);const wt=vt.dot(u[Ft])<0?-1:1;l[4*Ft]=nt.x,l[4*Ft+1]=nt.y,l[4*Ft+2]=nt.z,l[4*Ft+3]=wt}for(let Ft=0,Mt=ct.length;Ft<Mt;++Ft){const wt=ct[Ft],Pt=wt.start;for(let Nt=Pt,ne=Pt+wt.count;Nt<ne;Nt+=3)jt(n[Nt+0]),jt(n[Nt+1]),jt(n[Nt+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new qn(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let y=0,x=n.count;y<x;y++)n.setXYZ(y,0,0,0);const r=new U,o=new U,s=new U,a=new U,l=new U,h=new U,u=new U,p=new U;if(t)for(let y=0,x=t.count;y<x;y+=3){const E=t.getX(y+0),w=t.getX(y+1),C=t.getX(y+2);r.fromBufferAttribute(e,E),o.fromBufferAttribute(e,w),s.fromBufferAttribute(e,C),u.subVectors(s,o),p.subVectors(r,o),u.cross(p),a.fromBufferAttribute(n,E),l.fromBufferAttribute(n,w),h.fromBufferAttribute(n,C),a.add(u),l.add(u),h.add(u),n.setXYZ(E,a.x,a.y,a.z),n.setXYZ(w,l.x,l.y,l.z),n.setXYZ(C,h.x,h.y,h.z)}else for(let y=0,x=e.count;y<x;y+=3)r.fromBufferAttribute(e,y+0),o.fromBufferAttribute(e,y+1),s.fromBufferAttribute(e,y+2),u.subVectors(s,o),p.subVectors(r,o),u.cross(p),n.setXYZ(y+0,u.x,u.y,u.z),n.setXYZ(y+1,u.x,u.y,u.z),n.setXYZ(y+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);e===void 0&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(t.attributes[r]===void 0)continue;const o=n[r].array,s=t.attributes[r],a=s.array,l=s.itemSize*e,h=Math.min(a.length,o.length-l);for(let u=0,p=l;u<h;u++,p++)o[p]=a[u]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)mi.fromBufferAttribute(t,e),mi.normalize(),t.setXYZ(e,mi.x,mi.y,mi.z)}toNonIndexed(){function t(a,l){const h=a.array,u=a.itemSize,p=a.normalized,y=new h.constructor(l.length*u);let x=0,E=0;for(let w=0,C=l.length;w<C;w++){x=a.isInterleavedBufferAttribute?l[w]*a.data.stride+a.offset:l[w]*u;for(let j=0;j<u;j++)y[E++]=h[x++]}return new qn(y,u,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Xn,n=this.index.array,r=this.attributes;for(const a in r){const l=t(r[a],n);e.setAttribute(a,l)}const o=this.morphAttributes;for(const a in o){const l=[],h=o[a];for(let u=0,p=h.length;u<p;u++){const y=t(h[u],n);l.push(y)}e.morphAttributes[a]=l}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,l=s.length;a<l;a++){const h=s[a];e.addGroup(h.start,h.count,h.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const h in l)l[h]!==void 0&&(t[h]=l[h]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const l in n){const h=n[l];t.data.attributes[l]=h.toJSON(t.data)}const r={};let o=!1;for(const l in this.morphAttributes){const h=this.morphAttributes[l],u=[];for(let p=0,y=h.length;p<y;p++){const x=h[p];u.push(x.toJSON(t.data))}u.length>0&&(r[l]=u,o=!0)}o&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return a!==null&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return new Xn().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(e));const r=t.attributes;for(const h in r){const u=r[h];this.setAttribute(h,u.clone(e))}const o=t.morphAttributes;for(const h in o){const u=[],p=o[h];for(let y=0,x=p.length;y<x;y++)u.push(p[y].clone(e));this.morphAttributes[h]=u}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let h=0,u=s.length;h<u;h++){const p=s[h];this.addGroup(p.start,p.count,p.materialIndex)}const a=t.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}Xn.prototype.isBufferGeometry=!0;const Ro=new tn,Ur=new fi,Io=new Ge,Rr=new U,Ir=new U,sr=new U,Po=new U,Oo=new U,No=new U,q=new U,g=new U,m=new U,_=new R,N=new R,J=new R,lt=new U,xt=new U;class Tt extends kn{constructor(t=new Xn,e=new Qi){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const n=this.geometry,r=this.material,o=this.matrixWorld;if(r===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Io.copy(n.boundingSphere),Io.applyMatrix4(o),t.ray.intersectsSphere(Io)===!1)||(Ro.copy(o).invert(),Ur.copy(t.ray).applyMatrix4(Ro),n.boundingBox!==null&&Ur.intersectsBox(n.boundingBox)===!1))return;let s;if(n.isBufferGeometry){const a=n.index,l=n.attributes.position,h=n.morphAttributes.position,u=n.morphTargetsRelative,p=n.attributes.uv,y=n.attributes.uv2,x=n.groups,E=n.drawRange;if(a!==null)if(Array.isArray(r))for(let w=0,C=x.length;w<C;w++){const j=x[w],Z=r[j.materialIndex];for(let rt=Math.max(j.start,E.start),ct=Math.min(j.start+j.count,E.start+E.count);rt<ct;rt+=3){const nt=a.getX(rt),vt=a.getX(rt+1),ht=a.getX(rt+2);s=Zt(this,Z,t,Ur,l,h,u,p,y,nt,vt,ht),s&&(s.faceIndex=Math.floor(rt/3),s.face.materialIndex=j.materialIndex,e.push(s))}}else for(let w=Math.max(0,E.start),C=Math.min(a.count,E.start+E.count);w<C;w+=3){const j=a.getX(w),Z=a.getX(w+1),rt=a.getX(w+2);s=Zt(this,r,t,Ur,l,h,u,p,y,j,Z,rt),s&&(s.faceIndex=Math.floor(w/3),e.push(s))}else if(l!==void 0)if(Array.isArray(r))for(let w=0,C=x.length;w<C;w++){const j=x[w],Z=r[j.materialIndex];for(let rt=Math.max(j.start,E.start),ct=Math.min(j.start+j.count,E.start+E.count);rt<ct;rt+=3)s=Zt(this,Z,t,Ur,l,h,u,p,y,rt,rt+1,rt+2),s&&(s.faceIndex=Math.floor(rt/3),s.face.materialIndex=j.materialIndex,e.push(s))}else for(let w=Math.max(0,E.start),C=Math.min(l.count,E.start+E.count);w<C;w+=3)s=Zt(this,r,t,Ur,l,h,u,p,y,w,w+1,w+2),s&&(s.faceIndex=Math.floor(w/3),e.push(s))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function Zt(i,t,e,n,r,o,s,a,l,h,u,p){Rr.fromBufferAttribute(r,h),Ir.fromBufferAttribute(r,u),sr.fromBufferAttribute(r,p);const y=i.morphTargetInfluences;if(t.morphTargets&&o&&y){q.set(0,0,0),g.set(0,0,0),m.set(0,0,0);for(let E=0,w=o.length;E<w;E++){const C=y[E],j=o[E];C!==0&&(Po.fromBufferAttribute(j,h),Oo.fromBufferAttribute(j,u),No.fromBufferAttribute(j,p),s?(q.addScaledVector(Po,C),g.addScaledVector(Oo,C),m.addScaledVector(No,C)):(q.addScaledVector(Po.sub(Rr),C),g.addScaledVector(Oo.sub(Ir),C),m.addScaledVector(No.sub(sr),C)))}Rr.add(q),Ir.add(g),sr.add(m)}i.isSkinnedMesh&&(i.boneTransform(h,Rr),i.boneTransform(u,Ir),i.boneTransform(p,sr));const x=function(E,w,C,j,Z,rt,ct,nt){let vt;if(vt=w.side===1?j.intersectTriangle(ct,rt,Z,!0,nt):j.intersectTriangle(Z,rt,ct,w.side!==2,nt),vt===null)return null;xt.copy(nt),xt.applyMatrix4(E.matrixWorld);const ht=C.ray.origin.distanceTo(xt);return ht<C.near||ht>C.far?null:{distance:ht,point:xt.clone(),object:E}}(i,t,e,n,Rr,Ir,sr,lt);if(x){a&&(_.fromBufferAttribute(a,h),N.fromBufferAttribute(a,u),J.fromBufferAttribute(a,p),x.uv=ci.getUV(lt,Rr,Ir,sr,_,N,J,new R)),l&&(_.fromBufferAttribute(l,h),N.fromBufferAttribute(l,u),J.fromBufferAttribute(l,p),x.uv2=ci.getUV(lt,Rr,Ir,sr,_,N,J,new R));const E={a:h,b:u,c:p,normal:new U,materialIndex:0};ci.getNormal(Rr,Ir,sr,E.normal),x.face=E}return x}Tt.prototype.isMesh=!0;class ee extends Xn{constructor(t=1,e=1,n=1,r=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:o,depthSegments:s};const a=this;r=Math.floor(r),o=Math.floor(o),s=Math.floor(s);const l=[],h=[],u=[],p=[];let y=0,x=0;function E(w,C,j,Z,rt,ct,nt,vt,ht,mt,jt){const Ft=ct/ht,Mt=nt/mt,wt=ct/2,Pt=nt/2,Nt=vt/2,ne=ht+1,$t=mt+1;let zt=0,Yt=0;const ge=new U;for(let be=0;be<$t;be++){const Pe=be*Mt-Pt;for(let Ct=0;Ct<ne;Ct++){const Bt=Ct*Ft-wt;ge[w]=Bt*Z,ge[C]=Pe*rt,ge[j]=Nt,h.push(ge.x,ge.y,ge.z),ge[w]=0,ge[C]=0,ge[j]=vt>0?1:-1,u.push(ge.x,ge.y,ge.z),p.push(Ct/ht),p.push(1-be/mt),zt+=1}}for(let be=0;be<mt;be++)for(let Pe=0;Pe<ht;Pe++){const Ct=y+Pe+ne*be,Bt=y+Pe+ne*(be+1),ve=y+(Pe+1)+ne*(be+1),le=y+(Pe+1)+ne*be;l.push(Ct,Bt,le),l.push(Bt,ve,le),Yt+=6}a.addGroup(x,Yt,jt),x+=Yt,y+=zt}E("z","y","x",-1,-1,n,e,t,s,o,0),E("z","y","x",1,-1,n,e,-t,s,o,1),E("x","z","y",1,1,t,n,e,r,s,2),E("x","z","y",1,-1,t,n,-e,r,s,3),E("x","y","z",1,-1,t,e,n,r,o,4),E("x","y","z",-1,-1,t,e,-n,r,o,5),this.setIndex(l),this.setAttribute("position",new An(h,3)),this.setAttribute("normal",new An(u,3)),this.setAttribute("uv",new An(p,2))}static fromJSON(t){return new ee(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Fe(i){const t={};for(const e in i){t[e]={};for(const n in i[e]){const r=i[e][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[e][n]=r.clone():Array.isArray(r)?t[e][n]=r.slice():t[e][n]=r}}return t}function Te(i){const t={};for(let e=0;e<i.length;e++){const n=Fe(i[e]);for(const r in n)t[r]=n[r]}return t}const Qe={clone:Fe,merge:Te};class hn extends Ri{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Fe(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?e.uniforms[r]={type:"t",value:o.toJSON(t).uuid}:o&&o.isColor?e.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?e.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?e.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?e.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?e.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?e.uniforms[r]={type:"m4",value:o.toArray()}:e.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}hn.prototype.isShaderMaterial=!0;class vn extends kn{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new tn,this.projectionMatrix=new tn,this.projectionMatrixInverse=new tn}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}vn.prototype.isCamera=!0;class un extends vn{constructor(t=50,e=1,n=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*X*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*W*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*X*Math.atan(Math.tan(.5*W*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,o,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*W*this.fov)/this.zoom,n=2*e,r=this.aspect*n,o=-.5*r;const s=this.view;if(this.view!==null&&this.view.enabled){const l=s.fullWidth,h=s.fullHeight;o+=s.offsetX*r/l,e-=s.offsetY*n/h,r*=s.width/l,n*=s.height/h}const a=this.filmOffset;a!==0&&(o+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}un.prototype.isPerspectiveCamera=!0;class $n extends kn{constructor(t,e,n){if(super(),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new un(90,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new U(1,0,0)),this.add(r);const o=new un(90,1,t,e);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new U(-1,0,0)),this.add(o);const s=new un(90,1,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new U(0,1,0)),this.add(s);const a=new un(90,1,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new U(0,-1,0)),this.add(a);const l=new un(90,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new U(0,0,1)),this.add(l);const h=new un(90,1,t,e);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new U(0,0,-1)),this.add(h)}update(t,e){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[r,o,s,a,l,h]=this.children,u=t.xr.enabled,p=t.getRenderTarget();t.xr.enabled=!1;const y=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,o),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,l),n.texture.generateMipmaps=y,t.setRenderTarget(n,5),t.render(e,h),t.setRenderTarget(p),t.xr.enabled=u}}class gi extends tt{constructor(t,e,n,r,o,s,a,l,h,u){super(t=t!==void 0?t:[],e=e!==void 0?e:301,n,r,o,s,a=a!==void 0?a:1022,l,h,u),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}gi.prototype.isCubeTexture=!0;class vi extends Vt{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),e=e||{},this.texture=new gi(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.generateMipmaps=e.generateMipmaps!==void 0&&e.generateMipmaps,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:1006,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=1023,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new ee(5,5,5),o=new hn({name:"CubemapFromEquirect",uniforms:Fe(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});o.uniforms.tEquirect.value=e;const s=new Tt(r,o),a=e.minFilter;return e.minFilter===1008&&(e.minFilter=1006),new $n(1,10,this).update(t,s),e.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,r){const o=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,r);t.setRenderTarget(o)}}vi.prototype.isWebGLCubeRenderTarget=!0;const ii=new U,Fi=new U,Bi=new F;class ui{constructor(t=new U(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=ii.subVectors(n,e).cross(Fi.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(ii),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;const o=-(t.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:e.copy(n).multiplyScalar(o).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Bi.getNormalMatrix(t),r=this.coplanarPoint(ii).applyMatrix4(t),o=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(o),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}ui.prototype.isPlane=!0;const Ti=new Ge,yr=new U;class kr{constructor(t=new ui,e=new ui,n=new ui,r=new ui,o=new ui,s=new ui){this.planes=[t,e,n,r,o,s]}set(t,e,n,r,o,s){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(o),a[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,r=n[0],o=n[1],s=n[2],a=n[3],l=n[4],h=n[5],u=n[6],p=n[7],y=n[8],x=n[9],E=n[10],w=n[11],C=n[12],j=n[13],Z=n[14],rt=n[15];return e[0].setComponents(a-r,p-l,w-y,rt-C).normalize(),e[1].setComponents(a+r,p+l,w+y,rt+C).normalize(),e[2].setComponents(a+o,p+h,w+x,rt+j).normalize(),e[3].setComponents(a-o,p-h,w-x,rt-j).normalize(),e[4].setComponents(a-s,p-u,w-E,rt-Z).normalize(),e[5].setComponents(a+s,p+u,w+E,rt+Z).normalize(),this}intersectsObject(t){const e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),Ti.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ti)}intersectsSprite(t){return Ti.center.set(0,0,0),Ti.radius=.7071067811865476,Ti.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ti)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let o=0;o<6;o++)if(e[o].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(yr.x=r.normal.x>0?t.max.x:t.min.x,yr.y=r.normal.y>0?t.max.y:t.min.y,yr.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(yr)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function rs(){let i=null,t=!1,e=null,n=null;function r(o,s){e(o,s),n=i.requestAnimationFrame(r)}return{start:function(){t!==!0&&e!==null&&(n=i.requestAnimationFrame(r),t=!0)},stop:function(){i.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(o){e=o},setContext:function(o){i=o}}}function os(i,t){const e=t.isWebGL2,n=new WeakMap;return{get:function(r){return r.isInterleavedBufferAttribute&&(r=r.data),n.get(r)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);const o=n.get(r);o&&(i.deleteBuffer(o.buffer),n.delete(r))},update:function(r,o){if(r.isGLBufferAttribute){const a=n.get(r);return void((!a||a.version<r.version)&&n.set(r,{buffer:r.buffer,type:r.type,bytesPerElement:r.elementSize,version:r.version}))}r.isInterleavedBufferAttribute&&(r=r.data);const s=n.get(r);s===void 0?n.set(r,function(a,l){const h=a.array,u=a.usage,p=i.createBuffer();i.bindBuffer(l,p),i.bufferData(l,h,u),a.onUploadCallback();let y=5126;return h instanceof Float32Array?y=5126:h instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):h instanceof Uint16Array?a.isFloat16BufferAttribute?e?y=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):y=5123:h instanceof Int16Array?y=5122:h instanceof Uint32Array?y=5125:h instanceof Int32Array?y=5124:h instanceof Int8Array?y=5120:(h instanceof Uint8Array||h instanceof Uint8ClampedArray)&&(y=5121),{buffer:p,type:y,bytesPerElement:h.BYTES_PER_ELEMENT,version:a.version}}(r,o)):s.version<r.version&&(function(a,l,h){const u=l.array,p=l.updateRange;i.bindBuffer(h,a),p.count===-1?i.bufferSubData(h,0,u):(e?i.bufferSubData(h,p.offset*u.BYTES_PER_ELEMENT,u,p.offset,p.count):i.bufferSubData(h,p.offset*u.BYTES_PER_ELEMENT,u.subarray(p.offset,p.offset+p.count)),p.count=-1)}(s.buffer,r,o),s.version=r.version)}}}class Pr extends Xn{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const o=t/2,s=e/2,a=Math.floor(n),l=Math.floor(r),h=a+1,u=l+1,p=t/a,y=e/l,x=[],E=[],w=[],C=[];for(let j=0;j<u;j++){const Z=j*y-s;for(let rt=0;rt<h;rt++){const ct=rt*p-o;E.push(ct,-Z,0),w.push(0,0,1),C.push(rt/a),C.push(1-j/l)}}for(let j=0;j<l;j++)for(let Z=0;Z<a;Z++){const rt=Z+h*j,ct=Z+h*(j+1),nt=Z+1+h*(j+1),vt=Z+1+h*j;x.push(rt,ct,vt),x.push(ct,nt,vt)}this.setIndex(x),this.setAttribute("position",new An(E,3)),this.setAttribute("normal",new An(w,3)),this.setAttribute("uv",new An(C,2))}static fromJSON(t){return new Pr(t.width,t.height,t.widthSegments,t.heightSegments)}}const On={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotVH ) {
	float fresnel = exp2( ( -5.55473 * dotVH - 6.98316 ) * dotVH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment:`#ifdef USE_TRANSMISSION
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSNMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition.xyz / vWorldPosition.w;
	vec3 v = normalize( cameraPosition - pos );
	float ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );
	vec3 transmission = transmissionFactor * getIBLVolumeRefraction(
		normal, v, roughnessFactor, material.diffuseColor, totalSpecular,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission, transmissionFactor );
#endif`,transmission_pars_fragment:`#ifdef USE_TRANSMISSION
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec4 vWorldPosition;
	vec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {
		vec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);
		vec3 modelScale;
		modelScale.x = length(vec3(modelMatrix[0].xyz));
		modelScale.y = length(vec3(modelMatrix[1].xyz));
		modelScale.z = length(vec3(modelMatrix[2].xyz));
		return normalize(refractionVector) * thickness * modelScale;
	}
	float applyIorToRoughness(float roughness, float ior) {
		return roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);
	}
	vec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {
		float framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);
		return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;
	}
	vec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {
		if (attenuationDistance == 0.0) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;
			vec3 transmittance = exp(-attenuationCoefficient * transmissionDistance);			return transmittance * radiance;
		}
	}
	vec3 getIBLVolumeRefraction(vec3 n, vec3 v, float perceptualRoughness, vec3 baseColor, vec3 specularColor,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance) {
		vec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);
		vec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);
		return (1.0 - specularColor) * attenuatedColor * baseColor;
	}
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform vec3 attenuationColor;
	uniform float attenuationDistance;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <transmission_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#ifdef USE_TRANSMISSION
	varying vec4 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition;
#endif
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},sn={common:{diffuse:{value:new fn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new F},uv2Transform:{value:new F},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new R(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new fn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new fn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new F}},sprite:{diffuse:{value:new fn(16777215)},opacity:{value:1},center:{value:new R(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new F}}},Or={basic:{uniforms:Te([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.fog]),vertexShader:On.meshbasic_vert,fragmentShader:On.meshbasic_frag},lambert:{uniforms:Te([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.fog,sn.lights,{emissive:{value:new fn(0)}}]),vertexShader:On.meshlambert_vert,fragmentShader:On.meshlambert_frag},phong:{uniforms:Te([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.fog,sn.lights,{emissive:{value:new fn(0)},specular:{value:new fn(1118481)},shininess:{value:30}}]),vertexShader:On.meshphong_vert,fragmentShader:On.meshphong_frag},standard:{uniforms:Te([sn.common,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.roughnessmap,sn.metalnessmap,sn.fog,sn.lights,{emissive:{value:new fn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:On.meshphysical_vert,fragmentShader:On.meshphysical_frag},toon:{uniforms:Te([sn.common,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.gradientmap,sn.fog,sn.lights,{emissive:{value:new fn(0)}}]),vertexShader:On.meshtoon_vert,fragmentShader:On.meshtoon_frag},matcap:{uniforms:Te([sn.common,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.fog,{matcap:{value:null}}]),vertexShader:On.meshmatcap_vert,fragmentShader:On.meshmatcap_frag},points:{uniforms:Te([sn.points,sn.fog]),vertexShader:On.points_vert,fragmentShader:On.points_frag},dashed:{uniforms:Te([sn.common,sn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:On.linedashed_vert,fragmentShader:On.linedashed_frag},depth:{uniforms:Te([sn.common,sn.displacementmap]),vertexShader:On.depth_vert,fragmentShader:On.depth_frag},normal:{uniforms:Te([sn.common,sn.bumpmap,sn.normalmap,sn.displacementmap,{opacity:{value:1}}]),vertexShader:On.normal_vert,fragmentShader:On.normal_frag},sprite:{uniforms:Te([sn.sprite,sn.fog]),vertexShader:On.sprite_vert,fragmentShader:On.sprite_frag},background:{uniforms:{uvTransform:{value:new F},t2D:{value:null}},vertexShader:On.background_vert,fragmentShader:On.background_frag},cube:{uniforms:Te([sn.envmap,{opacity:{value:1}}]),vertexShader:On.cube_vert,fragmentShader:On.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:On.equirect_vert,fragmentShader:On.equirect_frag},distanceRGBA:{uniforms:Te([sn.common,sn.displacementmap,{referencePosition:{value:new U},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:On.distanceRGBA_vert,fragmentShader:On.distanceRGBA_frag},shadow:{uniforms:Te([sn.lights,sn.fog,{color:{value:new fn(0)},opacity:{value:1}}]),vertexShader:On.shadow_vert,fragmentShader:On.shadow_frag}};function Jh(i,t,e,n,r){const o=new fn(0);let s,a,l=0,h=null,u=0,p=null;function y(x,E){e.buffers.color.setClear(x.r,x.g,x.b,E,r)}return{getClearColor:function(){return o},setClearColor:function(x,E=1){o.set(x),l=E,y(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,y(o,l)},render:function(x,E){let w=!1,C=E.isScene===!0?E.background:null;C&&C.isTexture&&(C=t.get(C));const j=i.xr,Z=j.getSession&&j.getSession();Z&&Z.environmentBlendMode==="additive"&&(C=null),C===null?y(o,l):C&&C.isColor&&(y(C,1),w=!0),(i.autoClear||w)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),C&&(C.isCubeTexture||C.mapping===306)?(a===void 0&&(a=new Tt(new ee(1,1,1),new hn({name:"BackgroundCubeMaterial",uniforms:Fe(Or.cube.uniforms),vertexShader:Or.cube.vertexShader,fragmentShader:Or.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(rt,ct,nt){this.matrixWorld.copyPosition(nt.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a)),a.material.uniforms.envMap.value=C,a.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C._needsFlipEnvMap?-1:1,h===C&&u===C.version&&p===i.toneMapping||(a.material.needsUpdate=!0,h=C,u=C.version,p=i.toneMapping),x.unshift(a,a.geometry,a.material,0,0,null)):C&&C.isTexture&&(s===void 0&&(s=new Tt(new Pr(2,2),new hn({name:"BackgroundMaterial",uniforms:Fe(Or.background.uniforms),vertexShader:Or.background.vertexShader,fragmentShader:Or.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(s)),s.material.uniforms.t2D.value=C,C.matrixAutoUpdate===!0&&C.updateMatrix(),s.material.uniforms.uvTransform.value.copy(C.matrix),h===C&&u===C.version&&p===i.toneMapping||(s.material.needsUpdate=!0,h=C,u=C.version,p=i.toneMapping),x.unshift(s,s.geometry,s.material,0,0,null))}}}function uo(i,t,e,n){const r=i.getParameter(34921),o=n.isWebGL2?null:t.get("OES_vertex_array_object"),s=n.isWebGL2||o!==null,a={},l=y(null);let h=l;function u(ct){return n.isWebGL2?i.bindVertexArray(ct):o.bindVertexArrayOES(ct)}function p(ct){return n.isWebGL2?i.deleteVertexArray(ct):o.deleteVertexArrayOES(ct)}function y(ct){const nt=[],vt=[],ht=[];for(let mt=0;mt<r;mt++)nt[mt]=0,vt[mt]=0,ht[mt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:nt,enabledAttributes:vt,attributeDivisors:ht,object:ct,attributes:{},index:null}}function x(){const ct=h.newAttributes;for(let nt=0,vt=ct.length;nt<vt;nt++)ct[nt]=0}function E(ct){w(ct,0)}function w(ct,nt){const vt=h.newAttributes,ht=h.enabledAttributes,mt=h.attributeDivisors;vt[ct]=1,ht[ct]===0&&(i.enableVertexAttribArray(ct),ht[ct]=1),mt[ct]!==nt&&((n.isWebGL2?i:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ct,nt),mt[ct]=nt)}function C(){const ct=h.newAttributes,nt=h.enabledAttributes;for(let vt=0,ht=nt.length;vt<ht;vt++)nt[vt]!==ct[vt]&&(i.disableVertexAttribArray(vt),nt[vt]=0)}function j(ct,nt,vt,ht,mt,jt){n.isWebGL2!==!0||vt!==5124&&vt!==5125?i.vertexAttribPointer(ct,nt,vt,ht,mt,jt):i.vertexAttribIPointer(ct,nt,vt,mt,jt)}function Z(){rt(),h!==l&&(h=l,u(h.object))}function rt(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(ct,nt,vt,ht,mt){let jt=!1;if(s){const Ft=function(Mt,wt,Pt){const Nt=Pt.wireframe===!0;let ne=a[Mt.id];ne===void 0&&(ne={},a[Mt.id]=ne);let $t=ne[wt.id];$t===void 0&&($t={},ne[wt.id]=$t);let zt=$t[Nt];return zt===void 0&&(zt=y(n.isWebGL2?i.createVertexArray():o.createVertexArrayOES()),$t[Nt]=zt),zt}(ht,vt,nt);h!==Ft&&(h=Ft,u(h.object)),jt=function(Mt,wt){const Pt=h.attributes,Nt=Mt.attributes;let ne=0;for(const $t in Nt){const zt=Pt[$t],Yt=Nt[$t];if(zt===void 0||zt.attribute!==Yt||zt.data!==Yt.data)return!0;ne++}return h.attributesNum!==ne||h.index!==wt}(ht,mt),jt&&function(Mt,wt){const Pt={},Nt=Mt.attributes;let ne=0;for(const $t in Nt){const zt=Nt[$t],Yt={};Yt.attribute=zt,zt.data&&(Yt.data=zt.data),Pt[$t]=Yt,ne++}h.attributes=Pt,h.attributesNum=ne,h.index=wt}(ht,mt)}else{const Ft=nt.wireframe===!0;h.geometry===ht.id&&h.program===vt.id&&h.wireframe===Ft||(h.geometry=ht.id,h.program=vt.id,h.wireframe=Ft,jt=!0)}ct.isInstancedMesh===!0&&(jt=!0),mt!==null&&e.update(mt,34963),jt&&(function(Ft,Mt,wt,Pt){if(n.isWebGL2===!1&&(Ft.isInstancedMesh||Pt.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;x();const Nt=Pt.attributes,ne=wt.getAttributes(),$t=Mt.defaultAttributeValues;for(const zt in ne){const Yt=ne[zt];if(Yt>=0){const ge=Nt[zt];if(ge!==void 0){const be=ge.normalized,Pe=ge.itemSize,Ct=e.get(ge);if(Ct===void 0)continue;const Bt=Ct.buffer,ve=Ct.type,le=Ct.bytesPerElement;if(ge.isInterleavedBufferAttribute){const se=ge.data,Ie=se.stride,Le=ge.offset;se&&se.isInstancedInterleavedBuffer?(w(Yt,se.meshPerAttribute),Pt._maxInstanceCount===void 0&&(Pt._maxInstanceCount=se.meshPerAttribute*se.count)):E(Yt),i.bindBuffer(34962,Bt),j(Yt,Pe,ve,be,Ie*le,Le*le)}else ge.isInstancedBufferAttribute?(w(Yt,ge.meshPerAttribute),Pt._maxInstanceCount===void 0&&(Pt._maxInstanceCount=ge.meshPerAttribute*ge.count)):E(Yt),i.bindBuffer(34962,Bt),j(Yt,Pe,ve,be,0,0)}else if(zt==="instanceMatrix"){const be=e.get(Ft.instanceMatrix);if(be===void 0)continue;const Pe=be.buffer,Ct=be.type;w(Yt+0,1),w(Yt+1,1),w(Yt+2,1),w(Yt+3,1),i.bindBuffer(34962,Pe),i.vertexAttribPointer(Yt+0,4,Ct,!1,64,0),i.vertexAttribPointer(Yt+1,4,Ct,!1,64,16),i.vertexAttribPointer(Yt+2,4,Ct,!1,64,32),i.vertexAttribPointer(Yt+3,4,Ct,!1,64,48)}else if(zt==="instanceColor"){const be=e.get(Ft.instanceColor);if(be===void 0)continue;const Pe=be.buffer,Ct=be.type;w(Yt,1),i.bindBuffer(34962,Pe),i.vertexAttribPointer(Yt,3,Ct,!1,12,0)}else if($t!==void 0){const be=$t[zt];if(be!==void 0)switch(be.length){case 2:i.vertexAttrib2fv(Yt,be);break;case 3:i.vertexAttrib3fv(Yt,be);break;case 4:i.vertexAttrib4fv(Yt,be);break;default:i.vertexAttrib1fv(Yt,be)}}}}C()}(ct,nt,vt,ht),mt!==null&&i.bindBuffer(34963,e.get(mt).buffer))},reset:Z,resetDefaultState:rt,dispose:function(){Z();for(const ct in a){const nt=a[ct];for(const vt in nt){const ht=nt[vt];for(const mt in ht)p(ht[mt].object),delete ht[mt];delete nt[vt]}delete a[ct]}},releaseStatesOfGeometry:function(ct){if(a[ct.id]===void 0)return;const nt=a[ct.id];for(const vt in nt){const ht=nt[vt];for(const mt in ht)p(ht[mt].object),delete ht[mt];delete nt[vt]}delete a[ct.id]},releaseStatesOfProgram:function(ct){for(const nt in a){const vt=a[nt];if(vt[ct.id]===void 0)continue;const ht=vt[ct.id];for(const mt in ht)p(ht[mt].object),delete ht[mt];delete vt[ct.id]}},initAttributes:x,enableAttribute:E,disableUnusedAttributes:C}}function ss(i,t,e,n){const r=n.isWebGL2;let o;this.setMode=function(s){o=s},this.render=function(s,a){i.drawArrays(o,s,a),e.update(a,o,1)},this.renderInstances=function(s,a,l){if(l===0)return;let h,u;if(r)h=i,u="drawArraysInstanced";else if(h=t.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",h===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[u](o,s,a,l),e.update(a,o,l)}}function Kh(i,t,e){let n;function r(ct){if(ct==="highp"){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";ct="mediump"}return ct==="mediump"&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext!="undefined"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&i instanceof WebGL2ComputeRenderingContext;let s=e.precision!==void 0?e.precision:"highp";const a=r(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);const l=o||t.has("WEBGL_draw_buffers"),h=e.logarithmicDepthBuffer===!0,u=i.getParameter(34930),p=i.getParameter(35660),y=i.getParameter(3379),x=i.getParameter(34076),E=i.getParameter(34921),w=i.getParameter(36347),C=i.getParameter(36348),j=i.getParameter(36349),Z=p>0,rt=o||t.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){const ct=t.get("EXT_texture_filter_anisotropic");n=i.getParameter(ct.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:r,precision:s,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:p,maxTextureSize:y,maxCubemapSize:x,maxAttributes:E,maxVertexUniforms:w,maxVaryings:C,maxFragmentUniforms:j,vertexTextures:Z,floatFragmentTextures:rt,floatVertexTextures:Z&&rt,maxSamples:o?i.getParameter(36183):0}}function Zh(i){const t=this;let e=null,n=0,r=!1,o=!1;const s=new ui,a=new F,l={value:null,needsUpdate:!1};function h(){l.value!==e&&(l.value=e,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(p,y,x,E){const w=p!==null?p.length:0;let C=null;if(w!==0){if(C=l.value,E!==!0||C===null){const j=x+4*w,Z=y.matrixWorldInverse;a.getNormalMatrix(Z),(C===null||C.length<j)&&(C=new Float32Array(j));for(let rt=0,ct=x;rt!==w;++rt,ct+=4)s.copy(p[rt]).applyMatrix4(Z,a),s.normal.toArray(C,ct),C[ct+3]=s.constant}l.value=C,l.needsUpdate=!0}return t.numPlanes=w,t.numIntersection=0,C}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(p,y,x){const E=p.length!==0||y||n!==0||r;return r=y,e=u(p,x,0),n=p.length,E},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,h()},this.setState=function(p,y,x){const E=p.clippingPlanes,w=p.clipIntersection,C=p.clipShadows,j=i.get(p);if(!r||E===null||E.length===0||o&&!C)o?u(null):h();else{const Z=o?0:n,rt=4*Z;let ct=j.clippingState||null;l.value=ct,ct=u(E,y,rt,x);for(let nt=0;nt!==rt;++nt)ct[nt]=e[nt];j.clippingState=ct,this.numIntersection=w?this.numPlanes:0,this.numPlanes+=Z}}}function Qh(i){let t=new WeakMap;function e(r,o){return o===303?r.mapping=301:o===304&&(r.mapping=302),r}function n(r){const o=r.target;o.removeEventListener("dispose",n);const s=t.get(o);s!==void 0&&(t.delete(o),s.dispose())}return{get:function(r){if(r&&r.isTexture){const o=r.mapping;if(o===303||o===304){if(t.has(r))return e(t.get(r).texture,r.mapping);{const s=r.image;if(s&&s.height>0){const a=i.getRenderTarget(),l=new vi(s.height/2);return l.fromEquirectangularTexture(i,r),t.set(r,l),i.setRenderTarget(a),r.addEventListener("dispose",n),e(l.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}function dl(i){const t={};function e(n){if(t[n]!==void 0)return t[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return t[n]=r,r}return{has:function(n){return e(n)!==null},init:function(n){n.isWebGL2?e("EXT_color_buffer_float"):(e("WEBGL_depth_texture"),e("OES_texture_float"),e("OES_texture_half_float"),e("OES_texture_half_float_linear"),e("OES_standard_derivatives"),e("OES_element_index_uint"),e("OES_vertex_array_object"),e("ANGLE_instanced_arrays")),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float")},get:function(n){const r=e(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function $h(i,t,e,n){const r={},o=new WeakMap;function s(l){const h=l.target;h.index!==null&&t.remove(h.index);for(const p in h.attributes)t.remove(h.attributes[p]);h.removeEventListener("dispose",s),delete r[h.id];const u=o.get(h);u&&(t.remove(u),o.delete(h)),n.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,e.memory.geometries--}function a(l){const h=[],u=l.index,p=l.attributes.position;let y=0;if(u!==null){const w=u.array;y=u.version;for(let C=0,j=w.length;C<j;C+=3){const Z=w[C+0],rt=w[C+1],ct=w[C+2];h.push(Z,rt,rt,ct,ct,Z)}}else{const w=p.array;y=p.version;for(let C=0,j=w.length/3-1;C<j;C+=3){const Z=C+0,rt=C+1,ct=C+2;h.push(Z,rt,rt,ct,ct,Z)}}const x=new(Es(h)>65535?Co:Ts)(h,1);x.version=y;const E=o.get(l);E&&t.remove(E),o.set(l,x)}return{get:function(l,h){return r[h.id]===!0||(h.addEventListener("dispose",s),r[h.id]=!0,e.memory.geometries++),h},update:function(l){const h=l.attributes;for(const p in h)t.update(h[p],34962);const u=l.morphAttributes;for(const p in u){const y=u[p];for(let x=0,E=y.length;x<E;x++)t.update(y[x],34962)}},getWireframeAttribute:function(l){const h=o.get(l);if(h){const u=l.index;u!==null&&h.version<u.version&&a(l)}else a(l);return o.get(l)}}}function tu(i,t,e,n){const r=n.isWebGL2;let o,s,a;this.setMode=function(l){o=l},this.setIndex=function(l){s=l.type,a=l.bytesPerElement},this.render=function(l,h){i.drawElements(o,h,s,l*a),e.update(h,o,1)},this.renderInstances=function(l,h,u){if(u===0)return;let p,y;if(r)p=i,y="drawElementsInstanced";else if(p=t.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",p===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[y](o,h,s,l*a,u),e.update(h,o,u)}}function eu(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function nu(i,t){return i[0]-t[0]}function Ss(i,t){return Math.abs(t[1])-Math.abs(i[1])}function iu(i){const t={},e=new Float32Array(8),n=[];for(let r=0;r<8;r++)n[r]=[r,0];return{update:function(r,o,s,a){const l=r.morphTargetInfluences,h=l===void 0?0:l.length;let u=t[o.id];if(u===void 0||u.length!==h){u=[];for(let w=0;w<h;w++)u[w]=[w,0];t[o.id]=u}for(let w=0;w<h;w++){const C=u[w];C[0]=w,C[1]=l[w]}u.sort(Ss);for(let w=0;w<8;w++)w<h&&u[w][1]?(n[w][0]=u[w][0],n[w][1]=u[w][1]):(n[w][0]=Number.MAX_SAFE_INTEGER,n[w][1]=0);n.sort(nu);const p=s.morphTargets&&o.morphAttributes.position,y=s.morphNormals&&o.morphAttributes.normal;let x=0;for(let w=0;w<8;w++){const C=n[w],j=C[0],Z=C[1];j!==Number.MAX_SAFE_INTEGER&&Z?(p&&o.getAttribute("morphTarget"+w)!==p[j]&&o.setAttribute("morphTarget"+w,p[j]),y&&o.getAttribute("morphNormal"+w)!==y[j]&&o.setAttribute("morphNormal"+w,y[j]),e[w]=Z,x+=Z):(p&&o.hasAttribute("morphTarget"+w)===!0&&o.deleteAttribute("morphTarget"+w),y&&o.hasAttribute("morphNormal"+w)===!0&&o.deleteAttribute("morphNormal"+w),e[w]=0)}const E=o.morphTargetsRelative?1:1-x;a.getUniforms().setValue(i,"morphTargetBaseInfluence",E),a.getUniforms().setValue(i,"morphTargetInfluences",e)}}}function ru(i,t,e,n){let r=new WeakMap;function o(s){const a=s.target;a.removeEventListener("dispose",o),e.remove(a.instanceMatrix),a.instanceColor!==null&&e.remove(a.instanceColor)}return{update:function(s){const a=n.render.frame,l=s.geometry,h=t.get(s,l);return r.get(h)!==a&&(t.update(h),r.set(h,a)),s.isInstancedMesh&&(s.hasEventListener("dispose",o)===!1&&s.addEventListener("dispose",o),e.update(s.instanceMatrix,34962),s.instanceColor!==null&&e.update(s.instanceColor,34962)),h},dispose:function(){r=new WeakMap}}}Or.physical={uniforms:Te([Or.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new R(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new fn(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new R},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new fn(0)}}]),vertexShader:On.meshphysical_vert,fragmentShader:On.meshphysical_frag};class pl extends tt{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}pl.prototype.isDataTexture2DArray=!0;class ws extends tt{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}ws.prototype.isDataTexture3D=!0;const fl=new tt,pa=new pl,ou=new ws,ml=new gi,gl=[],vl=[],_l=new Float32Array(16),yl=new Float32Array(9),xl=new Float32Array(4);function Lo(i,t,e){const n=i[0];if(n<=0||n>0)return i;const r=t*e;let o=gl[r];if(o===void 0&&(o=new Float32Array(r),gl[r]=o),t!==0){n.toArray(o,0);for(let s=1,a=0;s!==t;++s)a+=e,i[s].toArray(o,a)}return o}function Xi(i,t){if(i.length!==t.length)return!1;for(let e=0,n=i.length;e<n;e++)if(i[e]!==t[e])return!1;return!0}function Ui(i,t){for(let e=0,n=t.length;e<n;e++)i[e]=t[e]}function fa(i,t){let e=vl[t];e===void 0&&(e=new Int32Array(t),vl[t]=e);for(let n=0;n!==t;++n)e[n]=i.allocateTextureUnit();return e}function su(i,t){const e=this.cache;e[0]!==t&&(i.uniform1f(this.addr,t),e[0]=t)}function bl(i,t){const e=this.cache;if(t.x!==void 0)e[0]===t.x&&e[1]===t.y||(i.uniform2f(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(Xi(e,t))return;i.uniform2fv(this.addr,t),Ui(e,t)}}function T(i,t){const e=this.cache;if(t.x!==void 0)e[0]===t.x&&e[1]===t.y&&e[2]===t.z||(i.uniform3f(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else if(t.r!==void 0)e[0]===t.r&&e[1]===t.g&&e[2]===t.b||(i.uniform3f(this.addr,t.r,t.g,t.b),e[0]=t.r,e[1]=t.g,e[2]=t.b);else{if(Xi(e,t))return;i.uniform3fv(this.addr,t),Ui(e,t)}}function d(i,t){const e=this.cache;if(t.x!==void 0)e[0]===t.x&&e[1]===t.y&&e[2]===t.z&&e[3]===t.w||(i.uniform4f(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(Xi(e,t))return;i.uniform4fv(this.addr,t),Ui(e,t)}}function c(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(Xi(e,t))return;i.uniformMatrix2fv(this.addr,!1,t),Ui(e,t)}else{if(Xi(e,n))return;xl.set(n),i.uniformMatrix2fv(this.addr,!1,xl),Ui(e,n)}}function f(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(Xi(e,t))return;i.uniformMatrix3fv(this.addr,!1,t),Ui(e,t)}else{if(Xi(e,n))return;yl.set(n),i.uniformMatrix3fv(this.addr,!1,yl),Ui(e,n)}}function S(i,t){const e=this.cache,n=t.elements;if(n===void 0){if(Xi(e,t))return;i.uniformMatrix4fv(this.addr,!1,t),Ui(e,t)}else{if(Xi(e,n))return;_l.set(n),i.uniformMatrix4fv(this.addr,!1,_l),Ui(e,n)}}function B(i,t){const e=this.cache;e[0]!==t&&(i.uniform1i(this.addr,t),e[0]=t)}function Q(i,t){const e=this.cache;Xi(e,t)||(i.uniform2iv(this.addr,t),Ui(e,t))}function ot(i,t){const e=this.cache;Xi(e,t)||(i.uniform3iv(this.addr,t),Ui(e,t))}function ut(i,t){const e=this.cache;Xi(e,t)||(i.uniform4iv(this.addr,t),Ui(e,t))}function It(i,t){const e=this.cache;e[0]!==t&&(i.uniform1ui(this.addr,t),e[0]=t)}function Ut(i,t){const e=this.cache;Xi(e,t)||(i.uniform2uiv(this.addr,t),Ui(e,t))}function he(i,t){const e=this.cache;Xi(e,t)||(i.uniform3uiv(this.addr,t),Ui(e,t))}function te(i,t){const e=this.cache;Xi(e,t)||(i.uniform4uiv(this.addr,t),Ui(e,t))}function me(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.safeSetTexture2D(t||fl,r)}function xe(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture3D(t||ou,r)}function Be(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.safeSetTextureCube(t||ml,r)}function qe(i,t,e){const n=this.cache,r=e.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),e.setTexture2DArray(t||pa,r)}function Ye(i,t){i.uniform1fv(this.addr,t)}function Je(i,t){const e=Lo(t,this.size,2);i.uniform2fv(this.addr,e)}function je(i,t){const e=Lo(t,this.size,3);i.uniform3fv(this.addr,e)}function pn(i,t){const e=Lo(t,this.size,4);i.uniform4fv(this.addr,e)}function _n(i,t){const e=Lo(t,this.size,4);i.uniformMatrix2fv(this.addr,!1,e)}function Gn(i,t){const e=Lo(t,this.size,9);i.uniformMatrix3fv(this.addr,!1,e)}function Fn(i,t){const e=Lo(t,this.size,16);i.uniformMatrix4fv(this.addr,!1,e)}function Xe(i,t){i.uniform1iv(this.addr,t)}function an(i,t){i.uniform2iv(this.addr,t)}function bn(i,t){i.uniform3iv(this.addr,t)}function Hn(i,t){i.uniform4iv(this.addr,t)}function Jn(i,t){i.uniform1uiv(this.addr,t)}function Ei(i,t){i.uniform2uiv(this.addr,t)}function ei(i,t){i.uniform3uiv(this.addr,t)}function _i(i,t){i.uniform4uiv(this.addr,t)}function Ii(i,t,e){const n=t.length,r=fa(e,n);i.uniform1iv(this.addr,r);for(let o=0;o!==n;++o)e.safeSetTexture2D(t[o]||fl,r[o])}function Yi(i,t,e){const n=t.length,r=fa(e,n);i.uniform1iv(this.addr,r);for(let o=0;o!==n;++o)e.safeSetTextureCube(t[o]||ml,r[o])}function ki(i,t,e){this.id=i,this.addr=e,this.cache=[],this.setValue=function(n){switch(n){case 5126:return su;case 35664:return bl;case 35665:return T;case 35666:return d;case 35674:return c;case 35675:return f;case 35676:return S;case 5124:case 35670:return B;case 35667:case 35671:return Q;case 35668:case 35672:return ot;case 35669:case 35673:return ut;case 5125:return It;case 36294:return Ut;case 36295:return he;case 36296:return te;case 35678:case 36198:case 36298:case 36306:case 35682:return me;case 35679:case 36299:case 36307:return xe;case 35680:case 36300:case 36308:case 36293:return Be;case 36289:case 36303:case 36311:case 36292:return qe}}(t.type)}function ri(i,t,e){this.id=i,this.addr=e,this.cache=[],this.size=t.size,this.setValue=function(n){switch(n){case 5126:return Ye;case 35664:return Je;case 35665:return je;case 35666:return pn;case 35674:return _n;case 35675:return Gn;case 35676:return Fn;case 5124:case 35670:return Xe;case 35667:case 35671:return an;case 35668:case 35672:return bn;case 35669:case 35673:return Hn;case 5125:return Jn;case 36294:return Ei;case 36295:return ei;case 36296:return _i;case 35678:case 36198:case 36298:case 36306:case 35682:return Ii;case 35680:case 36300:case 36308:case 36293:return Yi}}(t.type)}function Si(i){this.id=i,this.seq=[],this.map={}}ri.prototype.updateCache=function(i){const t=this.cache;i instanceof Float32Array&&t.length!==i.length&&(this.cache=new Float32Array(i.length)),Ui(t,i)},Si.prototype.setValue=function(i,t,e){const n=this.seq;for(let r=0,o=n.length;r!==o;++r){const s=n[r];s.setValue(i,t[s.id],e)}};const Gi=/(\w+)(\])?(\[|\.)?/g;function Hi(i,t){i.seq.push(t),i.map[t.id]=t}function $i(i,t,e){const n=i.name,r=n.length;for(Gi.lastIndex=0;;){const o=Gi.exec(n),s=Gi.lastIndex;let a=o[1];const l=o[2]==="]",h=o[3];if(l&&(a|=0),h===void 0||h==="["&&s+2===r){Hi(e,h===void 0?new ki(a,i,t):new ri(a,i,t));break}{let u=e.map[a];u===void 0&&(u=new Si(a),Hi(e,u)),e=u}}}function oi(i,t){this.seq=[],this.map={};const e=i.getProgramParameter(t,35718);for(let n=0;n<e;++n){const r=i.getActiveUniform(t,n);$i(r,i.getUniformLocation(t,r.name),this)}}function Tl(i,t,e){const n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),n}oi.prototype.setValue=function(i,t,e,n){const r=this.map[t];r!==void 0&&r.setValue(i,e,n)},oi.prototype.setOptional=function(i,t,e){const n=t[e];n!==void 0&&this.setValue(i,e,n)},oi.upload=function(i,t,e,n){for(let r=0,o=t.length;r!==o;++r){const s=t[r],a=e[s.id];a.needsUpdate!==!1&&s.setValue(i,a.value,n)}},oi.seqWithValue=function(i,t){const e=[];for(let n=0,r=i.length;n!==r;++n){const o=i[n];o.id in t&&e.push(o)}return e};let au=0;function El(i){switch(i){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}function Sl(i,t,e){const n=i.getShaderParameter(t,35713),r=i.getShaderInfoLog(t).trim();return n&&r===""?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+e+`
`+r+function(o){const s=o.split(`
`);for(let a=0;a<s.length;a++)s[a]=a+1+": "+s[a];return s.join(`
`)}(i.getShaderSource(t))}function as(i,t){const e=El(t);return"vec4 "+i+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function lu(i,t){const e=El(t);return"vec4 "+i+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function U_(i,t){let e;switch(t){case 1:e="Linear";break;case 2:e="Reinhard";break;case 3:e="OptimizedCineon";break;case 4:e="ACESFilmic";break;case 5:e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),e="Linear"}return"vec3 "+i+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function ma(i){return i!==""}function zd(i,t){return i.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Vd(i,t){return i.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const k_=/^[ \t]*#include +<([\w\d./]+)>/gm;function hu(i){return i.replace(k_,G_)}function G_(i,t){const e=On[t];if(e===void 0)throw new Error("Can not resolve #include <"+t+">");return hu(e)}const H_=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,j_=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Wd(i){return i.replace(j_,Xd).replace(H_,z_)}function z_(i,t,e,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Xd(i,t,e,n)}function Xd(i,t,e,n){let r="";for(let o=parseInt(t);o<parseInt(e);o++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function Yd(i){let t="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?t+=`
#define HIGH_PRECISION`:i.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function V_(i,t,e,n){const r=i.getContext(),o=e.defines;let s=e.vertexShader,a=e.fragmentShader;const l=function(mt){let jt="SHADOWMAP_TYPE_BASIC";return mt.shadowMapType===1?jt="SHADOWMAP_TYPE_PCF":mt.shadowMapType===2?jt="SHADOWMAP_TYPE_PCF_SOFT":mt.shadowMapType===3&&(jt="SHADOWMAP_TYPE_VSM"),jt}(e),h=function(mt){let jt="ENVMAP_TYPE_CUBE";if(mt.envMap)switch(mt.envMapMode){case 301:case 302:jt="ENVMAP_TYPE_CUBE";break;case 306:case 307:jt="ENVMAP_TYPE_CUBE_UV"}return jt}(e),u=function(mt){let jt="ENVMAP_MODE_REFLECTION";if(mt.envMap)switch(mt.envMapMode){case 302:case 307:jt="ENVMAP_MODE_REFRACTION"}return jt}(e),p=function(mt){let jt="ENVMAP_BLENDING_NONE";if(mt.envMap)switch(mt.combine){case 0:jt="ENVMAP_BLENDING_MULTIPLY";break;case 1:jt="ENVMAP_BLENDING_MIX";break;case 2:jt="ENVMAP_BLENDING_ADD"}return jt}(e),y=i.gammaFactor>0?i.gammaFactor:1,x=e.isWebGL2?"":function(mt){return[mt.extensionDerivatives||mt.envMapCubeUV||mt.bumpMap||mt.tangentSpaceNormalMap||mt.clearcoatNormalMap||mt.flatShading||mt.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(mt.extensionFragDepth||mt.logarithmicDepthBuffer)&&mt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",mt.extensionDrawBuffers&&mt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(mt.extensionShaderTextureLOD||mt.envMap||mt.transmission>0)&&mt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ma).join(`
`)}(e),E=function(mt){const jt=[];for(const Ft in mt){const Mt=mt[Ft];Mt!==!1&&jt.push("#define "+Ft+" "+Mt)}return jt.join(`
`)}(o),w=r.createProgram();let C,j,Z=e.glslVersion?"#version "+e.glslVersion+`
`:"";e.isRawShaderMaterial?(C=[E].filter(ma).join(`
`),C.length>0&&(C+=`
`),j=[x,E].filter(ma).join(`
`),j.length>0&&(j+=`
`)):(C=[Yd(e),"#define SHADER_NAME "+e.shaderName,E,e.instancing?"#define USE_INSTANCING":"",e.instancingColor?"#define USE_INSTANCING_COLOR":"",e.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+e.maxBones,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+u:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.displacementMap&&e.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&e.flatShading===!1?"#define USE_MORPHNORMALS":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ma).join(`
`),j=[x,Yd(e),"#define SHADER_NAME "+e.shaderName,E,e.alphaTest?"#define ALPHATEST "+e.alphaTest+(e.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+y,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+h:"",e.envMap?"#define "+u:"",e.envMap?"#define "+p:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.sheen?"#define USE_SHEEN":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==0?"#define TONE_MAPPING":"",e.toneMapping!==0?On.tonemapping_pars_fragment:"",e.toneMapping!==0?U_("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",On.encodings_pars_fragment,e.map?as("mapTexelToLinear",e.mapEncoding):"",e.matcap?as("matcapTexelToLinear",e.matcapEncoding):"",e.envMap?as("envMapTexelToLinear",e.envMapEncoding):"",e.emissiveMap?as("emissiveMapTexelToLinear",e.emissiveMapEncoding):"",e.lightMap?as("lightMapTexelToLinear",e.lightMapEncoding):"",lu("linearToOutputTexel",e.outputEncoding),e.depthPacking?"#define DEPTH_PACKING "+e.depthPacking:"",`
`].filter(ma).join(`
`)),s=hu(s),s=zd(s,e),s=Vd(s,e),a=hu(a),a=zd(a,e),a=Vd(a,e),s=Wd(s),a=Wd(a),e.isWebGL2&&e.isRawShaderMaterial!==!0&&(Z=`#version 300 es
`,C=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+C,j=["#define varying in",e.glslVersion==="300 es"?"":"out highp vec4 pc_fragColor;",e.glslVersion==="300 es"?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+j);const rt=Z+j+a,ct=Tl(r,35633,Z+C+s),nt=Tl(r,35632,rt);if(r.attachShader(w,ct),r.attachShader(w,nt),e.index0AttributeName!==void 0?r.bindAttribLocation(w,0,e.index0AttributeName):e.morphTargets===!0&&r.bindAttribLocation(w,0,"position"),r.linkProgram(w),i.debug.checkShaderErrors){const mt=r.getProgramInfoLog(w).trim(),jt=r.getShaderInfoLog(ct).trim(),Ft=r.getShaderInfoLog(nt).trim();let Mt=!0,wt=!0;if(r.getProgramParameter(w,35714)===!1){Mt=!1;const Pt=Sl(r,ct,"vertex"),Nt=Sl(r,nt,"fragment");console.error("THREE.WebGLProgram: shader error: ",r.getError(),"35715",r.getProgramParameter(w,35715),"gl.getProgramInfoLog",mt,Pt,Nt)}else mt!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",mt):jt!==""&&Ft!==""||(wt=!1);wt&&(this.diagnostics={runnable:Mt,programLog:mt,vertexShader:{log:jt,prefix:C},fragmentShader:{log:Ft,prefix:j}})}let vt,ht;return r.deleteShader(ct),r.deleteShader(nt),this.getUniforms=function(){return vt===void 0&&(vt=new oi(r,w)),vt},this.getAttributes=function(){return ht===void 0&&(ht=function(mt,jt){const Ft={},Mt=mt.getProgramParameter(jt,35721);for(let wt=0;wt<Mt;wt++){const Pt=mt.getActiveAttrib(jt,wt).name;Ft[Pt]=mt.getAttribLocation(jt,Pt)}return Ft}(r,w)),ht},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(w),this.program=void 0},this.name=e.shaderName,this.id=au++,this.cacheKey=t,this.usedTimes=1,this.program=w,this.vertexShader=ct,this.fragmentShader=nt,this}function W_(i,t,e,n,r,o){const s=[],a=n.isWebGL2,l=n.logarithmicDepthBuffer,h=n.floatVertexTextures,u=n.maxVertexUniforms,p=n.vertexTextures;let y=n.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},E=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmission","transmissionMap","thicknessMap"];function w(C){let j;return C&&C.isTexture?j=C.encoding:C&&C.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),j=C.texture.encoding):j=3e3,j}return{getParameters:function(C,j,Z,rt,ct){const nt=rt.fog,vt=C.isMeshStandardMaterial?rt.environment:null,ht=t.get(C.envMap||vt),mt=x[C.type],jt=ct.isSkinnedMesh?function(Pt){const Nt=Pt.skeleton.bones;if(h)return 1024;{const ne=u,$t=Math.floor((ne-20)/4),zt=Math.min($t,Nt.length);return zt<Nt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Nt.length+" bones. This GPU supports "+zt+"."),0):zt}}(ct):0;let Ft,Mt;if(C.precision!==null&&(y=n.getMaxPrecision(C.precision),y!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",y,"instead.")),mt){const Pt=Or[mt];Ft=Pt.vertexShader,Mt=Pt.fragmentShader}else Ft=C.vertexShader,Mt=C.fragmentShader;const wt=i.getRenderTarget();return{isWebGL2:a,shaderID:mt,shaderName:C.type,vertexShader:Ft,fragmentShader:Mt,defines:C.defines,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:y,instancing:ct.isInstancedMesh===!0,instancingColor:ct.isInstancedMesh===!0&&ct.instanceColor!==null,supportsVertexTextures:p,outputEncoding:wt!==null?w(wt.texture):i.outputEncoding,map:!!C.map,mapEncoding:w(C.map),matcap:!!C.matcap,matcapEncoding:w(C.matcap),envMap:!!ht,envMapMode:ht&&ht.mapping,envMapEncoding:w(ht),envMapCubeUV:!!ht&&(ht.mapping===306||ht.mapping===307),lightMap:!!C.lightMap,lightMapEncoding:w(C.lightMap),aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,emissiveMapEncoding:w(C.emissiveMap),bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===1,tangentSpaceNormalMap:C.normalMapType===0,clearcoatMap:!!C.clearcoatMap,clearcoatRoughnessMap:!!C.clearcoatRoughnessMap,clearcoatNormalMap:!!C.clearcoatNormalMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,alphaMap:!!C.alphaMap,gradientMap:!!C.gradientMap,sheen:!!C.sheen,transmission:!!C.transmission,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:C.normalMap&&C.vertexTangents,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&ct.geometry&&ct.geometry.attributes.color&&ct.geometry.attributes.color.itemSize===4,vertexUvs:!!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatMap||C.clearcoatRoughnessMap||C.clearcoatNormalMap||C.displacementMap||C.transmissionMap||C.thicknessMap),uvsVertexOnly:!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatNormalMap||C.transmission||C.transmissionMap||C.thicknessMap||!C.displacementMap),fog:!!nt,useFog:C.fog,fogExp2:nt&&nt.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:l,skinning:ct.isSkinnedMesh===!0&&jt>0,maxBones:jt,useVertexTexture:h,morphTargets:C.morphTargets,morphNormals:C.morphNormals,numDirLights:j.directional.length,numPointLights:j.point.length,numSpotLights:j.spot.length,numRectAreaLights:j.rectArea.length,numHemiLights:j.hemi.length,numDirLightShadows:j.directionalShadowMap.length,numPointLightShadows:j.pointShadowMap.length,numSpotLightShadows:j.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:i.shadowMap.enabled&&Z.length>0,shadowMapType:i.shadowMap.type,toneMapping:C.toneMapped?i.toneMapping:0,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,alphaTest:C.alphaTest,doubleSided:C.side===2,flipSided:C.side===1,depthPacking:C.depthPacking!==void 0&&C.depthPacking,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||e.has("EXT_frag_depth"),rendererExtensionDrawBuffers:a||e.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||e.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}},getProgramCacheKey:function(C){const j=[];if(C.shaderID?j.push(C.shaderID):(j.push(C.fragmentShader),j.push(C.vertexShader)),C.defines!==void 0)for(const Z in C.defines)j.push(Z),j.push(C.defines[Z]);if(C.isRawShaderMaterial===!1){for(let Z=0;Z<E.length;Z++)j.push(C[E[Z]]);j.push(i.outputEncoding),j.push(i.gammaFactor)}return j.push(C.customProgramCacheKey),j.join()},getUniforms:function(C){const j=x[C.type];let Z;if(j){const rt=Or[j];Z=Qe.clone(rt.uniforms)}else Z=C.uniforms;return Z},acquireProgram:function(C,j){let Z;for(let rt=0,ct=s.length;rt<ct;rt++){const nt=s[rt];if(nt.cacheKey===j){Z=nt,++Z.usedTimes;break}}return Z===void 0&&(Z=new V_(i,j,C,r),s.push(Z)),Z},releaseProgram:function(C){if(--C.usedTimes==0){const j=s.indexOf(C);s[j]=s[s.length-1],s.pop(),C.destroy()}},programs:s}}function X_(){let i=new WeakMap;return{get:function(t){let e=i.get(t);return e===void 0&&(e={},i.set(t,e)),e},remove:function(t){i.delete(t)},update:function(t,e,n){i.get(t)[e]=n},dispose:function(){i=new WeakMap}}}function Y_(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.program!==t.program?i.program.id-t.program.id:i.material.id!==t.material.id?i.material.id-t.material.id:i.z!==t.z?i.z-t.z:i.id-t.id}function qd(i,t){return i.groupOrder!==t.groupOrder?i.groupOrder-t.groupOrder:i.renderOrder!==t.renderOrder?i.renderOrder-t.renderOrder:i.z!==t.z?t.z-i.z:i.id-t.id}function Jd(i){const t=[];let e=0;const n=[],r=[],o=[],s={id:-1};function a(l,h,u,p,y,x){let E=t[e];const w=i.get(u);return E===void 0?(E={id:l.id,object:l,geometry:h,material:u,program:w.program||s,groupOrder:p,renderOrder:l.renderOrder,z:y,group:x},t[e]=E):(E.id=l.id,E.object=l,E.geometry=h,E.material=u,E.program=w.program||s,E.groupOrder=p,E.renderOrder=l.renderOrder,E.z=y,E.group=x),e++,E}return{opaque:n,transmissive:r,transparent:o,init:function(){e=0,n.length=0,r.length=0,o.length=0},push:function(l,h,u,p,y,x){const E=a(l,h,u,p,y,x);u.transmission>0?r.push(E):u.transparent===!0?o.push(E):n.push(E)},unshift:function(l,h,u,p,y,x){const E=a(l,h,u,p,y,x);u.transmission>0?r.unshift(E):u.transparent===!0?o.unshift(E):n.unshift(E)},finish:function(){for(let l=e,h=t.length;l<h;l++){const u=t[l];if(u.id===null)break;u.id=null,u.object=null,u.geometry=null,u.material=null,u.program=null,u.group=null}},sort:function(l,h){n.length>1&&n.sort(l||Y_),r.length>1&&r.sort(h||qd),o.length>1&&o.sort(h||qd)}}}function q_(i){let t=new WeakMap;return{get:function(e,n){let r;return t.has(e)===!1?(r=new Jd(i),t.set(e,[r])):n>=t.get(e).length?(r=new Jd(i),t.get(e).push(r)):r=t.get(e)[n],r},dispose:function(){t=new WeakMap}}}function J_(){const i={};return{get:function(t){if(i[t.id]!==void 0)return i[t.id];let e;switch(t.type){case"DirectionalLight":e={direction:new U,color:new fn};break;case"SpotLight":e={position:new U,direction:new U,color:new fn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new U,color:new fn,distance:0,decay:0};break;case"HemisphereLight":e={direction:new U,skyColor:new fn,groundColor:new fn};break;case"RectAreaLight":e={color:new fn,position:new U,halfWidth:new U,halfHeight:new U}}return i[t.id]=e,e}}}let K_=0;function Z_(i,t){return(t.castShadow?1:0)-(i.castShadow?1:0)}function Q_(i,t){const e=new J_,n=function(){const l={};return{get:function(h){if(l[h.id]!==void 0)return l[h.id];let u;switch(h.type){case"DirectionalLight":case"SpotLight":u={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new R};break;case"PointLight":u={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new R,shadowCameraNear:1,shadowCameraFar:1e3}}return l[h.id]=u,u}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let l=0;l<9;l++)r.probe.push(new U);const o=new U,s=new tn,a=new tn;return{setup:function(l){let h=0,u=0,p=0;for(let nt=0;nt<9;nt++)r.probe[nt].set(0,0,0);let y=0,x=0,E=0,w=0,C=0,j=0,Z=0,rt=0;l.sort(Z_);for(let nt=0,vt=l.length;nt<vt;nt++){const ht=l[nt],mt=ht.color,jt=ht.intensity,Ft=ht.distance,Mt=ht.shadow&&ht.shadow.map?ht.shadow.map.texture:null;if(ht.isAmbientLight)h+=mt.r*jt,u+=mt.g*jt,p+=mt.b*jt;else if(ht.isLightProbe)for(let wt=0;wt<9;wt++)r.probe[wt].addScaledVector(ht.sh.coefficients[wt],jt);else if(ht.isDirectionalLight){const wt=e.get(ht);if(wt.color.copy(ht.color).multiplyScalar(ht.intensity),ht.castShadow){const Pt=ht.shadow,Nt=n.get(ht);Nt.shadowBias=Pt.bias,Nt.shadowNormalBias=Pt.normalBias,Nt.shadowRadius=Pt.radius,Nt.shadowMapSize=Pt.mapSize,r.directionalShadow[y]=Nt,r.directionalShadowMap[y]=Mt,r.directionalShadowMatrix[y]=ht.shadow.matrix,j++}r.directional[y]=wt,y++}else if(ht.isSpotLight){const wt=e.get(ht);if(wt.position.setFromMatrixPosition(ht.matrixWorld),wt.color.copy(mt).multiplyScalar(jt),wt.distance=Ft,wt.coneCos=Math.cos(ht.angle),wt.penumbraCos=Math.cos(ht.angle*(1-ht.penumbra)),wt.decay=ht.decay,ht.castShadow){const Pt=ht.shadow,Nt=n.get(ht);Nt.shadowBias=Pt.bias,Nt.shadowNormalBias=Pt.normalBias,Nt.shadowRadius=Pt.radius,Nt.shadowMapSize=Pt.mapSize,r.spotShadow[E]=Nt,r.spotShadowMap[E]=Mt,r.spotShadowMatrix[E]=ht.shadow.matrix,rt++}r.spot[E]=wt,E++}else if(ht.isRectAreaLight){const wt=e.get(ht);wt.color.copy(mt).multiplyScalar(jt),wt.halfWidth.set(.5*ht.width,0,0),wt.halfHeight.set(0,.5*ht.height,0),r.rectArea[w]=wt,w++}else if(ht.isPointLight){const wt=e.get(ht);if(wt.color.copy(ht.color).multiplyScalar(ht.intensity),wt.distance=ht.distance,wt.decay=ht.decay,ht.castShadow){const Pt=ht.shadow,Nt=n.get(ht);Nt.shadowBias=Pt.bias,Nt.shadowNormalBias=Pt.normalBias,Nt.shadowRadius=Pt.radius,Nt.shadowMapSize=Pt.mapSize,Nt.shadowCameraNear=Pt.camera.near,Nt.shadowCameraFar=Pt.camera.far,r.pointShadow[x]=Nt,r.pointShadowMap[x]=Mt,r.pointShadowMatrix[x]=ht.shadow.matrix,Z++}r.point[x]=wt,x++}else if(ht.isHemisphereLight){const wt=e.get(ht);wt.skyColor.copy(ht.color).multiplyScalar(jt),wt.groundColor.copy(ht.groundColor).multiplyScalar(jt),r.hemi[C]=wt,C++}}w>0&&(t.isWebGL2||i.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=sn.LTC_FLOAT_1,r.rectAreaLTC2=sn.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=sn.LTC_HALF_1,r.rectAreaLTC2=sn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=u,r.ambient[2]=p;const ct=r.hash;ct.directionalLength===y&&ct.pointLength===x&&ct.spotLength===E&&ct.rectAreaLength===w&&ct.hemiLength===C&&ct.numDirectionalShadows===j&&ct.numPointShadows===Z&&ct.numSpotShadows===rt||(r.directional.length=y,r.spot.length=E,r.rectArea.length=w,r.point.length=x,r.hemi.length=C,r.directionalShadow.length=j,r.directionalShadowMap.length=j,r.pointShadow.length=Z,r.pointShadowMap.length=Z,r.spotShadow.length=rt,r.spotShadowMap.length=rt,r.directionalShadowMatrix.length=j,r.pointShadowMatrix.length=Z,r.spotShadowMatrix.length=rt,ct.directionalLength=y,ct.pointLength=x,ct.spotLength=E,ct.rectAreaLength=w,ct.hemiLength=C,ct.numDirectionalShadows=j,ct.numPointShadows=Z,ct.numSpotShadows=rt,r.version=K_++)},setupView:function(l,h){let u=0,p=0,y=0,x=0,E=0;const w=h.matrixWorldInverse;for(let C=0,j=l.length;C<j;C++){const Z=l[C];if(Z.isDirectionalLight){const rt=r.directional[u];rt.direction.setFromMatrixPosition(Z.matrixWorld),o.setFromMatrixPosition(Z.target.matrixWorld),rt.direction.sub(o),rt.direction.transformDirection(w),u++}else if(Z.isSpotLight){const rt=r.spot[y];rt.position.setFromMatrixPosition(Z.matrixWorld),rt.position.applyMatrix4(w),rt.direction.setFromMatrixPosition(Z.matrixWorld),o.setFromMatrixPosition(Z.target.matrixWorld),rt.direction.sub(o),rt.direction.transformDirection(w),y++}else if(Z.isRectAreaLight){const rt=r.rectArea[x];rt.position.setFromMatrixPosition(Z.matrixWorld),rt.position.applyMatrix4(w),a.identity(),s.copy(Z.matrixWorld),s.premultiply(w),a.extractRotation(s),rt.halfWidth.set(.5*Z.width,0,0),rt.halfHeight.set(0,.5*Z.height,0),rt.halfWidth.applyMatrix4(a),rt.halfHeight.applyMatrix4(a),x++}else if(Z.isPointLight){const rt=r.point[p];rt.position.setFromMatrixPosition(Z.matrixWorld),rt.position.applyMatrix4(w),p++}else if(Z.isHemisphereLight){const rt=r.hemi[E];rt.direction.setFromMatrixPosition(Z.matrixWorld),rt.direction.transformDirection(w),rt.direction.normalize(),E++}}},state:r}}function Kd(i,t){const e=new Q_(i,t),n=[],r=[];return{init:function(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:e},setupLights:function(){e.setup(n)},setupLightsView:function(o){e.setupView(n,o)},pushLight:function(o){n.push(o)},pushShadow:function(o){r.push(o)}}}function $_(i,t){let e=new WeakMap;return{get:function(n,r=0){let o;return e.has(n)===!1?(o=new Kd(i,t),e.set(n,[o])):r>=e.get(n).length?(o=new Kd(i,t),e.get(n).push(o)):o=e.get(n)[r],o},dispose:function(){e=new WeakMap}}}class Zd extends Ri{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}Zd.prototype.isMeshDepthMaterial=!0;class Qd extends Ri{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new U,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}Qd.prototype.isMeshDistanceMaterial=!0;function $d(i,t,e){let n=new kr;const r=new R,o=new R,s=new Ot,a=[],l=[],h={},u=e.maxTextureSize,p={0:1,1:0,2:2},y=new hn({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new R},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),x=y.clone();x.defines.HORIZONTAL_PASS=1;const E=new Xn;E.setAttribute("position",new qn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const w=new Tt(E,y),C=this;function j(vt,ht){const mt=t.update(w);y.uniforms.shadow_pass.value=vt.map.texture,y.uniforms.resolution.value=vt.mapSize,y.uniforms.radius.value=vt.radius,i.setRenderTarget(vt.mapPass),i.clear(),i.renderBufferDirect(ht,null,mt,y,w,null),x.uniforms.shadow_pass.value=vt.mapPass.texture,x.uniforms.resolution.value=vt.mapSize,x.uniforms.radius.value=vt.radius,i.setRenderTarget(vt.map),i.clear(),i.renderBufferDirect(ht,null,mt,x,w,null)}function Z(vt){const ht=vt<<0;let mt=a[ht];return mt===void 0&&(mt=new Zd({depthPacking:3201,morphTargets:vt}),a[ht]=mt),mt}function rt(vt){const ht=vt<<0;let mt=l[ht];return mt===void 0&&(mt=new Qd({morphTargets:vt}),l[ht]=mt),mt}function ct(vt,ht,mt,jt,Ft,Mt,wt){let Pt=null,Nt=Z,ne=vt.customDepthMaterial;if(jt.isPointLight===!0&&(Nt=rt,ne=vt.customDistanceMaterial),ne===void 0){let $t=!1;mt.morphTargets===!0&&($t=ht.morphAttributes&&ht.morphAttributes.position&&ht.morphAttributes.position.length>0),Pt=Nt($t)}else Pt=ne;if(i.localClippingEnabled&&mt.clipShadows===!0&&mt.clippingPlanes.length!==0){const $t=Pt.uuid,zt=mt.uuid;let Yt=h[$t];Yt===void 0&&(Yt={},h[$t]=Yt);let ge=Yt[zt];ge===void 0&&(ge=Pt.clone(),Yt[zt]=ge),Pt=ge}return Pt.visible=mt.visible,Pt.wireframe=mt.wireframe,Pt.side=wt===3?mt.shadowSide!==null?mt.shadowSide:mt.side:mt.shadowSide!==null?mt.shadowSide:p[mt.side],Pt.clipShadows=mt.clipShadows,Pt.clippingPlanes=mt.clippingPlanes,Pt.clipIntersection=mt.clipIntersection,Pt.wireframeLinewidth=mt.wireframeLinewidth,Pt.linewidth=mt.linewidth,jt.isPointLight===!0&&Pt.isMeshDistanceMaterial===!0&&(Pt.referencePosition.setFromMatrixPosition(jt.matrixWorld),Pt.nearDistance=Ft,Pt.farDistance=Mt),Pt}function nt(vt,ht,mt,jt,Ft){if(vt.visible===!1)return;if(vt.layers.test(ht.layers)&&(vt.isMesh||vt.isLine||vt.isPoints)&&(vt.castShadow||vt.receiveShadow&&Ft===3)&&(!vt.frustumCulled||n.intersectsObject(vt))){vt.modelViewMatrix.multiplyMatrices(mt.matrixWorldInverse,vt.matrixWorld);const wt=t.update(vt),Pt=vt.material;if(Array.isArray(Pt)){const Nt=wt.groups;for(let ne=0,$t=Nt.length;ne<$t;ne++){const zt=Nt[ne],Yt=Pt[zt.materialIndex];if(Yt&&Yt.visible){const ge=ct(vt,wt,Yt,jt,mt.near,mt.far,Ft);i.renderBufferDirect(mt,null,wt,ge,vt,zt)}}}else if(Pt.visible){const Nt=ct(vt,wt,Pt,jt,mt.near,mt.far,Ft);i.renderBufferDirect(mt,null,wt,Nt,vt,null)}}const Mt=vt.children;for(let wt=0,Pt=Mt.length;wt<Pt;wt++)nt(Mt[wt],ht,mt,jt,Ft)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(vt,ht,mt){if(C.enabled===!1||C.autoUpdate===!1&&C.needsUpdate===!1||vt.length===0)return;const jt=i.getRenderTarget(),Ft=i.getActiveCubeFace(),Mt=i.getActiveMipmapLevel(),wt=i.state;wt.setBlending(0),wt.buffers.color.setClear(1,1,1,1),wt.buffers.depth.setTest(!0),wt.setScissorTest(!1);for(let Pt=0,Nt=vt.length;Pt<Nt;Pt++){const ne=vt[Pt],$t=ne.shadow;if($t===void 0){console.warn("THREE.WebGLShadowMap:",ne,"has no shadow.");continue}if($t.autoUpdate===!1&&$t.needsUpdate===!1)continue;r.copy($t.mapSize);const zt=$t.getFrameExtents();if(r.multiply(zt),o.copy($t.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(o.x=Math.floor(u/zt.x),r.x=o.x*zt.x,$t.mapSize.x=o.x),r.y>u&&(o.y=Math.floor(u/zt.y),r.y=o.y*zt.y,$t.mapSize.y=o.y)),$t.map===null&&!$t.isPointLightShadow&&this.type===3){const ge={minFilter:1006,magFilter:1006,format:1023};$t.map=new Vt(r.x,r.y,ge),$t.map.texture.name=ne.name+".shadowMap",$t.mapPass=new Vt(r.x,r.y,ge),$t.camera.updateProjectionMatrix()}if($t.map===null){const ge={minFilter:1003,magFilter:1003,format:1023};$t.map=new Vt(r.x,r.y,ge),$t.map.texture.name=ne.name+".shadowMap",$t.camera.updateProjectionMatrix()}i.setRenderTarget($t.map),i.clear();const Yt=$t.getViewportCount();for(let ge=0;ge<Yt;ge++){const be=$t.getViewport(ge);s.set(o.x*be.x,o.y*be.y,o.x*be.z,o.y*be.w),wt.viewport(s),$t.updateMatrices(ne,ge),n=$t.getFrustum(),nt(ht,mt,$t.camera,ne,this.type)}$t.isPointLightShadow||this.type!==3||j($t,mt),$t.needsUpdate=!1}C.needsUpdate=!1,i.setRenderTarget(jt,Ft,Mt)}}function ty(i,t,e){const n=e.isWebGL2,r=new function(){let bt=!1;const Ht=new Ot;let ie=null;const ae=new Ot(0,0,0,0);return{setMask:function(qt){ie===qt||bt||(i.colorMask(qt,qt,qt,qt),ie=qt)},setLocked:function(qt){bt=qt},setClear:function(qt,ye,nn,on,rn){rn===!0&&(qt*=on,ye*=on,nn*=on),Ht.set(qt,ye,nn,on),ae.equals(Ht)===!1&&(i.clearColor(qt,ye,nn,on),ae.copy(Ht))},reset:function(){bt=!1,ie=null,ae.set(-1,0,0,0)}}},o=new function(){let bt=!1,Ht=null,ie=null,ae=null;return{setTest:function(qt){qt?Pe(2929):Ct(2929)},setMask:function(qt){Ht===qt||bt||(i.depthMask(qt),Ht=qt)},setFunc:function(qt){if(ie!==qt){if(qt)switch(qt){case 0:i.depthFunc(512);break;case 1:i.depthFunc(519);break;case 2:i.depthFunc(513);break;case 3:i.depthFunc(515);break;case 4:i.depthFunc(514);break;case 5:i.depthFunc(518);break;case 6:i.depthFunc(516);break;case 7:i.depthFunc(517);break;default:i.depthFunc(515)}else i.depthFunc(515);ie=qt}},setLocked:function(qt){bt=qt},setClear:function(qt){ae!==qt&&(i.clearDepth(qt),ae=qt)},reset:function(){bt=!1,Ht=null,ie=null,ae=null}}},s=new function(){let bt=!1,Ht=null,ie=null,ae=null,qt=null,ye=null,nn=null,on=null,rn=null;return{setTest:function(Sn){bt||(Sn?Pe(2960):Ct(2960))},setMask:function(Sn){Ht===Sn||bt||(i.stencilMask(Sn),Ht=Sn)},setFunc:function(Sn,Mi,Kn){ie===Sn&&ae===Mi&&qt===Kn||(i.stencilFunc(Sn,Mi,Kn),ie=Sn,ae=Mi,qt=Kn)},setOp:function(Sn,Mi,Kn){ye===Sn&&nn===Mi&&on===Kn||(i.stencilOp(Sn,Mi,Kn),ye=Sn,nn=Mi,on=Kn)},setLocked:function(Sn){bt=Sn},setClear:function(Sn){rn!==Sn&&(i.clearStencil(Sn),rn=Sn)},reset:function(){bt=!1,Ht=null,ie=null,ae=null,qt=null,ye=null,nn=null,on=null,rn=null}}};let a={},l=null,h={},u=null,p=!1,y=null,x=null,E=null,w=null,C=null,j=null,Z=null,rt=!1,ct=null,nt=null,vt=null,ht=null,mt=null;const jt=i.getParameter(35661);let Ft=!1,Mt=0;const wt=i.getParameter(7938);wt.indexOf("WebGL")!==-1?(Mt=parseFloat(/^WebGL (\d)/.exec(wt)[1]),Ft=Mt>=1):wt.indexOf("OpenGL ES")!==-1&&(Mt=parseFloat(/^OpenGL ES (\d)/.exec(wt)[1]),Ft=Mt>=2);let Pt=null,Nt={};const ne=i.getParameter(3088),$t=i.getParameter(2978),zt=new Ot().fromArray(ne),Yt=new Ot().fromArray($t);function ge(bt,Ht,ie){const ae=new Uint8Array(4),qt=i.createTexture();i.bindTexture(bt,qt),i.texParameteri(bt,10241,9728),i.texParameteri(bt,10240,9728);for(let ye=0;ye<ie;ye++)i.texImage2D(Ht+ye,0,6408,1,1,0,6408,5121,ae);return qt}const be={};function Pe(bt){a[bt]!==!0&&(i.enable(bt),a[bt]=!0)}function Ct(bt){a[bt]!==!1&&(i.disable(bt),a[bt]=!1)}be[3553]=ge(3553,3553,1),be[34067]=ge(34067,34069,6),r.setClear(0,0,0,1),o.setClear(1),s.setClear(0),Pe(2929),o.setFunc(3),se(!1),Ie(1),Pe(2884),le(0);const Bt={100:32774,101:32778,102:32779};if(n)Bt[103]=32775,Bt[104]=32776;else{const bt=t.get("EXT_blend_minmax");bt!==null&&(Bt[103]=bt.MIN_EXT,Bt[104]=bt.MAX_EXT)}const ve={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function le(bt,Ht,ie,ae,qt,ye,nn,on){if(bt!==0){if(p===!1&&(Pe(3042),p=!0),bt===5)qt=qt||Ht,ye=ye||ie,nn=nn||ae,Ht===x&&qt===C||(i.blendEquationSeparate(Bt[Ht],Bt[qt]),x=Ht,C=qt),ie===E&&ae===w&&ye===j&&nn===Z||(i.blendFuncSeparate(ve[ie],ve[ae],ve[ye],ve[nn]),E=ie,w=ae,j=ye,Z=nn),y=bt,rt=null;else if(bt!==y||on!==rt){if(x===100&&C===100||(i.blendEquation(32774),x=100,C=100),on)switch(bt){case 1:i.blendFuncSeparate(1,771,1,771);break;case 2:i.blendFunc(1,1);break;case 3:i.blendFuncSeparate(0,0,769,771);break;case 4:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",bt)}else switch(bt){case 1:i.blendFuncSeparate(770,771,1,771);break;case 2:i.blendFunc(770,1);break;case 3:i.blendFunc(0,769);break;case 4:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",bt)}E=null,w=null,j=null,Z=null,y=bt,rt=on}}else p===!0&&(Ct(3042),p=!1)}function se(bt){ct!==bt&&(bt?i.frontFace(2304):i.frontFace(2305),ct=bt)}function Ie(bt){bt!==0?(Pe(2884),bt!==nt&&(bt===1?i.cullFace(1029):bt===2?i.cullFace(1028):i.cullFace(1032))):Ct(2884),nt=bt}function Le(bt,Ht,ie){bt?(Pe(32823),ht===Ht&&mt===ie||(i.polygonOffset(Ht,ie),ht=Ht,mt=ie)):Ct(32823)}function ue(bt){bt===void 0&&(bt=33984+jt-1),Pt!==bt&&(i.activeTexture(bt),Pt=bt)}return{buffers:{color:r,depth:o,stencil:s},enable:Pe,disable:Ct,bindFramebuffer:function(bt,Ht){return Ht===null&&l!==null&&(Ht=l),h[bt]!==Ht&&(i.bindFramebuffer(bt,Ht),h[bt]=Ht,n&&(bt===36009&&(h[36160]=Ht),bt===36160&&(h[36009]=Ht)),!0)},bindXRFramebuffer:function(bt){bt!==l&&(i.bindFramebuffer(36160,bt),l=bt)},useProgram:function(bt){return u!==bt&&(i.useProgram(bt),u=bt,!0)},setBlending:le,setMaterial:function(bt,Ht){bt.side===2?Ct(2884):Pe(2884);let ie=bt.side===1;Ht&&(ie=!ie),se(ie),bt.blending===1&&bt.transparent===!1?le(0):le(bt.blending,bt.blendEquation,bt.blendSrc,bt.blendDst,bt.blendEquationAlpha,bt.blendSrcAlpha,bt.blendDstAlpha,bt.premultipliedAlpha),o.setFunc(bt.depthFunc),o.setTest(bt.depthTest),o.setMask(bt.depthWrite),r.setMask(bt.colorWrite);const ae=bt.stencilWrite;s.setTest(ae),ae&&(s.setMask(bt.stencilWriteMask),s.setFunc(bt.stencilFunc,bt.stencilRef,bt.stencilFuncMask),s.setOp(bt.stencilFail,bt.stencilZFail,bt.stencilZPass)),Le(bt.polygonOffset,bt.polygonOffsetFactor,bt.polygonOffsetUnits),bt.alphaToCoverage===!0?Pe(32926):Ct(32926)},setFlipSided:se,setCullFace:Ie,setLineWidth:function(bt){bt!==vt&&(Ft&&i.lineWidth(bt),vt=bt)},setPolygonOffset:Le,setScissorTest:function(bt){bt?Pe(3089):Ct(3089)},activeTexture:ue,bindTexture:function(bt,Ht){Pt===null&&ue();let ie=Nt[Pt];ie===void 0&&(ie={type:void 0,texture:void 0},Nt[Pt]=ie),ie.type===bt&&ie.texture===Ht||(i.bindTexture(bt,Ht||be[bt]),ie.type=bt,ie.texture=Ht)},unbindTexture:function(){const bt=Nt[Pt];bt!==void 0&&bt.type!==void 0&&(i.bindTexture(bt.type,null),bt.type=void 0,bt.texture=void 0)},compressedTexImage2D:function(){try{i.compressedTexImage2D.apply(i,arguments)}catch(bt){console.error("THREE.WebGLState:",bt)}},texImage2D:function(){try{i.texImage2D.apply(i,arguments)}catch(bt){console.error("THREE.WebGLState:",bt)}},texImage3D:function(){try{i.texImage3D.apply(i,arguments)}catch(bt){console.error("THREE.WebGLState:",bt)}},scissor:function(bt){zt.equals(bt)===!1&&(i.scissor(bt.x,bt.y,bt.z,bt.w),zt.copy(bt))},viewport:function(bt){Yt.equals(bt)===!1&&(i.viewport(bt.x,bt.y,bt.z,bt.w),Yt.copy(bt))},reset:function(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),n===!0&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),a={},Pt=null,Nt={},l=null,h={},u=null,p=!1,y=null,x=null,E=null,w=null,C=null,j=null,Z=null,rt=!1,ct=null,nt=null,vt=null,ht=null,mt=null,zt.set(0,0,i.canvas.width,i.canvas.height),Yt.set(0,0,i.canvas.width,i.canvas.height),r.reset(),o.reset(),s.reset()}}}function ey(i,t,e,n,r,o,s){const a=r.isWebGL2,l=r.maxTextures,h=r.maxCubemapSize,u=r.maxTextureSize,p=r.maxSamples,y=new WeakMap;let x,E=!1;try{E=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function w(Ct,Bt){return E?new OffscreenCanvas(Ct,Bt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function C(Ct,Bt,ve,le){let se=1;if((Ct.width>le||Ct.height>le)&&(se=le/Math.max(Ct.width,Ct.height)),se<1||Bt===!0){if(typeof HTMLImageElement!="undefined"&&Ct instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&Ct instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&Ct instanceof ImageBitmap){const Ie=Bt?L:Math.floor,Le=Ie(se*Ct.width),ue=Ie(se*Ct.height);x===void 0&&(x=w(Le,ue));const bt=ve?w(Le,ue):x;return bt.width=Le,bt.height=ue,bt.getContext("2d").drawImage(Ct,0,0,Le,ue),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ct.width+"x"+Ct.height+") to ("+Le+"x"+ue+")."),bt}return"data"in Ct&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ct.width+"x"+Ct.height+")."),Ct}return Ct}function j(Ct){return At(Ct.width)&&At(Ct.height)}function Z(Ct,Bt){return Ct.generateMipmaps&&Bt&&Ct.minFilter!==1003&&Ct.minFilter!==1006}function rt(Ct,Bt,ve,le,se=1){i.generateMipmap(Ct),n.get(Bt).__maxMipLevel=Math.log2(Math.max(ve,le,se))}function ct(Ct,Bt,ve){if(a===!1)return Bt;if(Ct!==null){if(i[Ct]!==void 0)return i[Ct];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ct+"'")}let le=Bt;return Bt===6403&&(ve===5126&&(le=33326),ve===5131&&(le=33325),ve===5121&&(le=33321)),Bt===6407&&(ve===5126&&(le=34837),ve===5131&&(le=34843),ve===5121&&(le=32849)),Bt===6408&&(ve===5126&&(le=34836),ve===5131&&(le=34842),ve===5121&&(le=32856)),le!==33325&&le!==33326&&le!==34842&&le!==34836||t.get("EXT_color_buffer_float"),le}function nt(Ct){return Ct===1003||Ct===1004||Ct===1005?9728:9729}function vt(Ct){const Bt=Ct.target;Bt.removeEventListener("dispose",vt),function(ve){const le=n.get(ve);le.__webglInit!==void 0&&(i.deleteTexture(le.__webglTexture),n.remove(ve))}(Bt),Bt.isVideoTexture&&y.delete(Bt),s.memory.textures--}function ht(Ct){const Bt=Ct.target;Bt.removeEventListener("dispose",ht),function(ve){const le=ve.texture,se=n.get(ve),Ie=n.get(le);if(!!ve){if(Ie.__webglTexture!==void 0&&(i.deleteTexture(Ie.__webglTexture),s.memory.textures--),ve.depthTexture&&ve.depthTexture.dispose(),ve.isWebGLCubeRenderTarget)for(let Le=0;Le<6;Le++)i.deleteFramebuffer(se.__webglFramebuffer[Le]),se.__webglDepthbuffer&&i.deleteRenderbuffer(se.__webglDepthbuffer[Le]);else i.deleteFramebuffer(se.__webglFramebuffer),se.__webglDepthbuffer&&i.deleteRenderbuffer(se.__webglDepthbuffer),se.__webglMultisampledFramebuffer&&i.deleteFramebuffer(se.__webglMultisampledFramebuffer),se.__webglColorRenderbuffer&&i.deleteRenderbuffer(se.__webglColorRenderbuffer),se.__webglDepthRenderbuffer&&i.deleteRenderbuffer(se.__webglDepthRenderbuffer);if(ve.isWebGLMultipleRenderTargets)for(let Le=0,ue=le.length;Le<ue;Le++){const bt=n.get(le[Le]);bt.__webglTexture&&(i.deleteTexture(bt.__webglTexture),s.memory.textures--),n.remove(le[Le])}n.remove(le),n.remove(ve)}}(Bt)}let mt=0;function jt(Ct,Bt){const ve=n.get(Ct);if(Ct.isVideoTexture&&function(le){const se=s.render.frame;y.get(le)!==se&&(y.set(le,se),le.update())}(Ct),Ct.version>0&&ve.__version!==Ct.version){const le=Ct.image;if(le===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(le.complete!==!1)return void ne(ve,Ct,Bt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}e.activeTexture(33984+Bt),e.bindTexture(3553,ve.__webglTexture)}function Ft(Ct,Bt){const ve=n.get(Ct);Ct.version>0&&ve.__version!==Ct.version?function(le,se,Ie){if(se.image.length!==6)return;Nt(le,se),e.activeTexture(33984+Ie),e.bindTexture(34067,le.__webglTexture),i.pixelStorei(37440,se.flipY),i.pixelStorei(37441,se.premultiplyAlpha),i.pixelStorei(3317,se.unpackAlignment),i.pixelStorei(37443,0);const Le=se&&(se.isCompressedTexture||se.image[0].isCompressedTexture),ue=se.image[0]&&se.image[0].isDataTexture,bt=[];for(let on=0;on<6;on++)bt[on]=Le||ue?ue?se.image[on].image:se.image[on]:C(se.image[on],!1,!0,h);const Ht=bt[0],ie=j(Ht)||a,ae=o.convert(se.format),qt=o.convert(se.type),ye=ct(se.internalFormat,ae,qt);let nn;if(Pt(34067,se,ie),Le){for(let on=0;on<6;on++){nn=bt[on].mipmaps;for(let rn=0;rn<nn.length;rn++){const Sn=nn[rn];se.format!==1023&&se.format!==1022?ae!==null?e.compressedTexImage2D(34069+on,rn,ye,Sn.width,Sn.height,0,Sn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):e.texImage2D(34069+on,rn,ye,Sn.width,Sn.height,0,ae,qt,Sn.data)}}le.__maxMipLevel=nn.length-1}else{nn=se.mipmaps;for(let on=0;on<6;on++)if(ue){e.texImage2D(34069+on,0,ye,bt[on].width,bt[on].height,0,ae,qt,bt[on].data);for(let rn=0;rn<nn.length;rn++){const Sn=nn[rn].image[on].image;e.texImage2D(34069+on,rn+1,ye,Sn.width,Sn.height,0,ae,qt,Sn.data)}}else{e.texImage2D(34069+on,0,ye,ae,qt,bt[on]);for(let rn=0;rn<nn.length;rn++){const Sn=nn[rn];e.texImage2D(34069+on,rn+1,ye,ae,qt,Sn.image[on])}}le.__maxMipLevel=nn.length}Z(se,ie)&&rt(34067,se,Ht.width,Ht.height),le.__version=se.version,se.onUpdate&&se.onUpdate(se)}(ve,Ct,Bt):(e.activeTexture(33984+Bt),e.bindTexture(34067,ve.__webglTexture))}const Mt={1e3:10497,1001:33071,1002:33648},wt={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987};function Pt(Ct,Bt,ve){if(ve?(i.texParameteri(Ct,10242,Mt[Bt.wrapS]),i.texParameteri(Ct,10243,Mt[Bt.wrapT]),Ct!==32879&&Ct!==35866||i.texParameteri(Ct,32882,Mt[Bt.wrapR]),i.texParameteri(Ct,10240,wt[Bt.magFilter]),i.texParameteri(Ct,10241,wt[Bt.minFilter])):(i.texParameteri(Ct,10242,33071),i.texParameteri(Ct,10243,33071),Ct!==32879&&Ct!==35866||i.texParameteri(Ct,32882,33071),Bt.wrapS===1001&&Bt.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(Ct,10240,nt(Bt.magFilter)),i.texParameteri(Ct,10241,nt(Bt.minFilter)),Bt.minFilter!==1003&&Bt.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){const le=t.get("EXT_texture_filter_anisotropic");if(Bt.type===1015&&t.has("OES_texture_float_linear")===!1||a===!1&&Bt.type===1016&&t.has("OES_texture_half_float_linear")===!1)return;(Bt.anisotropy>1||n.get(Bt).__currentAnisotropy)&&(i.texParameterf(Ct,le.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Bt.anisotropy,r.getMaxAnisotropy())),n.get(Bt).__currentAnisotropy=Bt.anisotropy)}}function Nt(Ct,Bt){Ct.__webglInit===void 0&&(Ct.__webglInit=!0,Bt.addEventListener("dispose",vt),Ct.__webglTexture=i.createTexture(),s.memory.textures++)}function ne(Ct,Bt,ve){let le=3553;Bt.isDataTexture2DArray&&(le=35866),Bt.isDataTexture3D&&(le=32879),Nt(Ct,Bt),e.activeTexture(33984+ve),e.bindTexture(le,Ct.__webglTexture),i.pixelStorei(37440,Bt.flipY),i.pixelStorei(37441,Bt.premultiplyAlpha),i.pixelStorei(3317,Bt.unpackAlignment),i.pixelStorei(37443,0);const se=function(qt){return!a&&(qt.wrapS!==1001||qt.wrapT!==1001||qt.minFilter!==1003&&qt.minFilter!==1006)}(Bt)&&j(Bt.image)===!1,Ie=C(Bt.image,se,!1,u),Le=j(Ie)||a,ue=o.convert(Bt.format);let bt,Ht=o.convert(Bt.type),ie=ct(Bt.internalFormat,ue,Ht);Pt(le,Bt,Le);const ae=Bt.mipmaps;if(Bt.isDepthTexture)ie=6402,a?ie=Bt.type===1015?36012:Bt.type===1014?33190:Bt.type===1020?35056:33189:Bt.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Bt.format===1026&&ie===6402&&Bt.type!==1012&&Bt.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Bt.type=1012,Ht=o.convert(Bt.type)),Bt.format===1027&&ie===6402&&(ie=34041,Bt.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Bt.type=1020,Ht=o.convert(Bt.type))),e.texImage2D(3553,0,ie,Ie.width,Ie.height,0,ue,Ht,null);else if(Bt.isDataTexture)if(ae.length>0&&Le){for(let qt=0,ye=ae.length;qt<ye;qt++)bt=ae[qt],e.texImage2D(3553,qt,ie,bt.width,bt.height,0,ue,Ht,bt.data);Bt.generateMipmaps=!1,Ct.__maxMipLevel=ae.length-1}else e.texImage2D(3553,0,ie,Ie.width,Ie.height,0,ue,Ht,Ie.data),Ct.__maxMipLevel=0;else if(Bt.isCompressedTexture){for(let qt=0,ye=ae.length;qt<ye;qt++)bt=ae[qt],Bt.format!==1023&&Bt.format!==1022?ue!==null?e.compressedTexImage2D(3553,qt,ie,bt.width,bt.height,0,bt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):e.texImage2D(3553,qt,ie,bt.width,bt.height,0,ue,Ht,bt.data);Ct.__maxMipLevel=ae.length-1}else if(Bt.isDataTexture2DArray)e.texImage3D(35866,0,ie,Ie.width,Ie.height,Ie.depth,0,ue,Ht,Ie.data),Ct.__maxMipLevel=0;else if(Bt.isDataTexture3D)e.texImage3D(32879,0,ie,Ie.width,Ie.height,Ie.depth,0,ue,Ht,Ie.data),Ct.__maxMipLevel=0;else if(ae.length>0&&Le){for(let qt=0,ye=ae.length;qt<ye;qt++)bt=ae[qt],e.texImage2D(3553,qt,ie,ue,Ht,bt);Bt.generateMipmaps=!1,Ct.__maxMipLevel=ae.length-1}else e.texImage2D(3553,0,ie,ue,Ht,Ie),Ct.__maxMipLevel=0;Z(Bt,Le)&&rt(le,Bt,Ie.width,Ie.height),Ct.__version=Bt.version,Bt.onUpdate&&Bt.onUpdate(Bt)}function $t(Ct,Bt,ve,le,se){const Ie=o.convert(ve.format),Le=o.convert(ve.type),ue=ct(ve.internalFormat,Ie,Le);se===32879||se===35866?e.texImage3D(se,0,ue,Bt.width,Bt.height,Bt.depth,0,Ie,Le,null):e.texImage2D(se,0,ue,Bt.width,Bt.height,0,Ie,Le,null),e.bindFramebuffer(36160,Ct),i.framebufferTexture2D(36160,le,se,n.get(ve).__webglTexture,0),e.bindFramebuffer(36160,null)}function zt(Ct,Bt,ve){if(i.bindRenderbuffer(36161,Ct),Bt.depthBuffer&&!Bt.stencilBuffer){let le=33189;if(ve){const se=Bt.depthTexture;se&&se.isDepthTexture&&(se.type===1015?le=36012:se.type===1014&&(le=33190));const Ie=ge(Bt);i.renderbufferStorageMultisample(36161,Ie,le,Bt.width,Bt.height)}else i.renderbufferStorage(36161,le,Bt.width,Bt.height);i.framebufferRenderbuffer(36160,36096,36161,Ct)}else if(Bt.depthBuffer&&Bt.stencilBuffer){if(ve){const le=ge(Bt);i.renderbufferStorageMultisample(36161,le,35056,Bt.width,Bt.height)}else i.renderbufferStorage(36161,34041,Bt.width,Bt.height);i.framebufferRenderbuffer(36160,33306,36161,Ct)}else{const le=Bt.isWebGLMultipleRenderTargets===!0?Bt.texture[0]:Bt.texture,se=o.convert(le.format),Ie=o.convert(le.type),Le=ct(le.internalFormat,se,Ie);if(ve){const ue=ge(Bt);i.renderbufferStorageMultisample(36161,ue,Le,Bt.width,Bt.height)}else i.renderbufferStorage(36161,Le,Bt.width,Bt.height)}i.bindRenderbuffer(36161,null)}function Yt(Ct){const Bt=n.get(Ct),ve=Ct.isWebGLCubeRenderTarget===!0;if(Ct.depthTexture){if(ve)throw new Error("target.depthTexture not supported in Cube render targets");(function(le,se){if(se&&se.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,le),!se.depthTexture||!se.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(se.depthTexture).__webglTexture&&se.depthTexture.image.width===se.width&&se.depthTexture.image.height===se.height||(se.depthTexture.image.width=se.width,se.depthTexture.image.height=se.height,se.depthTexture.needsUpdate=!0),jt(se.depthTexture,0);const Ie=n.get(se.depthTexture).__webglTexture;if(se.depthTexture.format===1026)i.framebufferTexture2D(36160,36096,3553,Ie,0);else{if(se.depthTexture.format!==1027)throw new Error("Unknown depthTexture format");i.framebufferTexture2D(36160,33306,3553,Ie,0)}})(Bt.__webglFramebuffer,Ct)}else if(ve){Bt.__webglDepthbuffer=[];for(let le=0;le<6;le++)e.bindFramebuffer(36160,Bt.__webglFramebuffer[le]),Bt.__webglDepthbuffer[le]=i.createRenderbuffer(),zt(Bt.__webglDepthbuffer[le],Ct,!1)}else e.bindFramebuffer(36160,Bt.__webglFramebuffer),Bt.__webglDepthbuffer=i.createRenderbuffer(),zt(Bt.__webglDepthbuffer,Ct,!1);e.bindFramebuffer(36160,null)}function ge(Ct){return a&&Ct.isWebGLMultisampleRenderTarget?Math.min(p,Ct.samples):0}let be=!1,Pe=!1;this.allocateTextureUnit=function(){const Ct=mt;return Ct>=l&&console.warn("THREE.WebGLTextures: Trying to use "+Ct+" texture units while this GPU supports only "+l),mt+=1,Ct},this.resetTextureUnits=function(){mt=0},this.setTexture2D=jt,this.setTexture2DArray=function(Ct,Bt){const ve=n.get(Ct);Ct.version>0&&ve.__version!==Ct.version?ne(ve,Ct,Bt):(e.activeTexture(33984+Bt),e.bindTexture(35866,ve.__webglTexture))},this.setTexture3D=function(Ct,Bt){const ve=n.get(Ct);Ct.version>0&&ve.__version!==Ct.version?ne(ve,Ct,Bt):(e.activeTexture(33984+Bt),e.bindTexture(32879,ve.__webglTexture))},this.setTextureCube=Ft,this.setupRenderTarget=function(Ct){const Bt=Ct.texture,ve=n.get(Ct),le=n.get(Bt);Ct.addEventListener("dispose",ht),Ct.isWebGLMultipleRenderTargets!==!0&&(le.__webglTexture=i.createTexture(),le.__version=Bt.version,s.memory.textures++);const se=Ct.isWebGLCubeRenderTarget===!0,Ie=Ct.isWebGLMultipleRenderTargets===!0,Le=Ct.isWebGLMultisampleRenderTarget===!0,ue=Bt.isDataTexture3D||Bt.isDataTexture2DArray,bt=j(Ct)||a;if(!a||Bt.format!==1022||Bt.type!==1015&&Bt.type!==1016||(Bt.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),se){ve.__webglFramebuffer=[];for(let Ht=0;Ht<6;Ht++)ve.__webglFramebuffer[Ht]=i.createFramebuffer()}else if(ve.__webglFramebuffer=i.createFramebuffer(),Ie)if(r.drawBuffers){const Ht=Ct.texture;for(let ie=0,ae=Ht.length;ie<ae;ie++){const qt=n.get(Ht[ie]);qt.__webglTexture===void 0&&(qt.__webglTexture=i.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Le)if(a){ve.__webglMultisampledFramebuffer=i.createFramebuffer(),ve.__webglColorRenderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(36161,ve.__webglColorRenderbuffer);const Ht=o.convert(Bt.format),ie=o.convert(Bt.type),ae=ct(Bt.internalFormat,Ht,ie),qt=ge(Ct);i.renderbufferStorageMultisample(36161,qt,ae,Ct.width,Ct.height),e.bindFramebuffer(36160,ve.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064,36161,ve.__webglColorRenderbuffer),i.bindRenderbuffer(36161,null),Ct.depthBuffer&&(ve.__webglDepthRenderbuffer=i.createRenderbuffer(),zt(ve.__webglDepthRenderbuffer,Ct,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(se){e.bindTexture(34067,le.__webglTexture),Pt(34067,Bt,bt);for(let Ht=0;Ht<6;Ht++)$t(ve.__webglFramebuffer[Ht],Ct,Bt,36064,34069+Ht);Z(Bt,bt)&&rt(34067,Bt,Ct.width,Ct.height),e.bindTexture(34067,null)}else if(Ie){const Ht=Ct.texture;for(let ie=0,ae=Ht.length;ie<ae;ie++){const qt=Ht[ie],ye=n.get(qt);e.bindTexture(3553,ye.__webglTexture),Pt(3553,qt,bt),$t(ve.__webglFramebuffer,Ct,qt,36064+ie,3553),Z(qt,bt)&&rt(3553,qt,Ct.width,Ct.height)}e.bindTexture(3553,null)}else{let Ht=3553;ue&&(a?Ht=Bt.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),e.bindTexture(Ht,le.__webglTexture),Pt(Ht,Bt,bt),$t(ve.__webglFramebuffer,Ct,Bt,36064,Ht),Z(Bt,bt)&&rt(Ht,Bt,Ct.width,Ct.height,Ct.depth),e.bindTexture(Ht,null)}Ct.depthBuffer&&Yt(Ct)},this.updateRenderTargetMipmap=function(Ct){const Bt=j(Ct)||a,ve=Ct.isWebGLMultipleRenderTargets===!0?Ct.texture:[Ct.texture];for(let le=0,se=ve.length;le<se;le++){const Ie=ve[le];if(Z(Ie,Bt)){const Le=Ct.isWebGLCubeRenderTarget?34067:3553,ue=n.get(Ie).__webglTexture;e.bindTexture(Le,ue),rt(Le,Ie,Ct.width,Ct.height),e.bindTexture(Le,null)}}},this.updateMultisampleRenderTarget=function(Ct){if(Ct.isWebGLMultisampleRenderTarget)if(a){const Bt=Ct.width,ve=Ct.height;let le=16384;Ct.depthBuffer&&(le|=256),Ct.stencilBuffer&&(le|=1024);const se=n.get(Ct);e.bindFramebuffer(36008,se.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,se.__webglFramebuffer),i.blitFramebuffer(0,0,Bt,ve,0,0,Bt,ve,le,9728),e.bindFramebuffer(36008,null),e.bindFramebuffer(36009,se.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Ct,Bt){Ct&&Ct.isWebGLRenderTarget&&(be===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),be=!0),Ct=Ct.texture),jt(Ct,Bt)},this.safeSetTextureCube=function(Ct,Bt){Ct&&Ct.isWebGLCubeRenderTarget&&(Pe===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Pe=!0),Ct=Ct.texture),Ft(Ct,Bt)}}function ny(i,t,e){const n=e.isWebGL2;return{convert:function(r){let o;if(r===1009)return 5121;if(r===1017)return 32819;if(r===1018)return 32820;if(r===1019)return 33635;if(r===1010)return 5120;if(r===1011)return 5122;if(r===1012)return 5123;if(r===1013)return 5124;if(r===1014)return 5125;if(r===1015)return 5126;if(r===1016)return n?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(r===1021)return 6406;if(r===1022)return 6407;if(r===1023)return 6408;if(r===1024)return 6409;if(r===1025)return 6410;if(r===1026)return 6402;if(r===1027)return 34041;if(r===1028)return 6403;if(r===1029)return 36244;if(r===1030)return 33319;if(r===1031)return 33320;if(r===1032)return 36248;if(r===1033)return 36249;if(r===33776||r===33777||r===33778||r===33779){if(o=t.get("WEBGL_compressed_texture_s3tc"),o===null)return null;if(r===33776)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===33777)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===33778)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===33779)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(r===35840||r===35841||r===35842||r===35843){if(o=t.get("WEBGL_compressed_texture_pvrtc"),o===null)return null;if(r===35840)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===35841)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===35842)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===35843)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===36196)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if((r===37492||r===37496)&&(o=t.get("WEBGL_compressed_texture_etc"),o!==null)){if(r===37492)return o.COMPRESSED_RGB8_ETC2;if(r===37496)return o.COMPRESSED_RGBA8_ETC2_EAC}return r===37808||r===37809||r===37810||r===37811||r===37812||r===37813||r===37814||r===37815||r===37816||r===37817||r===37818||r===37819||r===37820||r===37821||r===37840||r===37841||r===37842||r===37843||r===37844||r===37845||r===37846||r===37847||r===37848||r===37849||r===37850||r===37851||r===37852||r===37853?(o=t.get("WEBGL_compressed_texture_astc"),o!==null?r:null):r===36492?(o=t.get("EXT_texture_compression_bptc"),o!==null?r:null):r===1020?n?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class tp extends un{constructor(t=[]){super(),this.cameras=t}}tp.prototype.isArrayCamera=!0;class As extends kn{constructor(){super(),this.type="Group"}}As.prototype.isGroup=!0;const iy={type:"move"};class uu{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new As,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new As,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new U,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new U),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new As,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new U,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new U),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,n){let r=null,o=null,s=null;const a=this._targetRay,l=this._grip,h=this._hand;if(t&&e.session.visibilityState!=="visible-blurred")if(a!==null&&(r=e.getPose(t.targetRaySpace,n),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(iy))),h&&t.hand){s=!0;for(const w of t.hand.values()){const C=e.getJointPose(w,n);if(h.joints[w.jointName]===void 0){const Z=new As;Z.matrixAutoUpdate=!1,Z.visible=!1,h.joints[w.jointName]=Z,h.add(Z)}const j=h.joints[w.jointName];C!==null&&(j.matrix.fromArray(C.transform.matrix),j.matrix.decompose(j.position,j.rotation,j.scale),j.jointRadius=C.radius),j.visible=C!==null}const u=h.joints["index-finger-tip"],p=h.joints["thumb-tip"],y=u.position.distanceTo(p.position),x=.02,E=.005;h.inputState.pinching&&y>x+E?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!h.inputState.pinching&&y<=x-E&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else l!==null&&t.gripSpace&&(o=e.getPose(t.gripSpace,n),o!==null&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1));return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=o!==null),h!==null&&(h.visible=s!==null),this}}class ry extends D{constructor(t,e){super();const n=this,r=t.state;let o=null,s=1,a=null,l="local-floor",h=null,u=null,p=null,y=null;const x=[],E=new Map,w=new un;w.layers.enable(1),w.viewport=new Ot;const C=new un;C.layers.enable(2),C.viewport=new Ot;const j=[w,C],Z=new tp;Z.layers.enable(1),Z.layers.enable(2);let rt=null,ct=null;function nt(Pt){const Nt=E.get(Pt.inputSource);Nt&&Nt.dispatchEvent({type:Pt.type,data:Pt.inputSource})}function vt(){E.forEach(function(Pt,Nt){Pt.disconnect(Nt)}),E.clear(),rt=null,ct=null,r.bindXRFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),wt.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function ht(Pt){const Nt=o.inputSources;for(let ne=0;ne<x.length;ne++)E.set(Nt[ne],x[ne]);for(let ne=0;ne<Pt.removed.length;ne++){const $t=Pt.removed[ne],zt=E.get($t);zt&&(zt.dispatchEvent({type:"disconnected",data:$t}),E.delete($t))}for(let ne=0;ne<Pt.added.length;ne++){const $t=Pt.added[ne],zt=E.get($t);zt&&zt.dispatchEvent({type:"connected",data:$t})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Pt){let Nt=x[Pt];return Nt===void 0&&(Nt=new uu,x[Pt]=Nt),Nt.getTargetRaySpace()},this.getControllerGrip=function(Pt){let Nt=x[Pt];return Nt===void 0&&(Nt=new uu,x[Pt]=Nt),Nt.getGripSpace()},this.getHand=function(Pt){let Nt=x[Pt];return Nt===void 0&&(Nt=new uu,x[Pt]=Nt),Nt.getHandSpace()},this.setFramebufferScaleFactor=function(Pt){s=Pt,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Pt){l=Pt,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return o},this.setSession=async function(Pt){if(o=Pt,o!==null){o.addEventListener("select",nt),o.addEventListener("selectstart",nt),o.addEventListener("selectend",nt),o.addEventListener("squeeze",nt),o.addEventListener("squeezestart",nt),o.addEventListener("squeezeend",nt),o.addEventListener("end",vt),o.addEventListener("inputsourceschange",ht);const Nt=e.getContextAttributes();if(Nt.xrCompatible!==!0&&await e.makeXRCompatible(),o.renderState.layers===void 0){const ne={antialias:Nt.antialias,alpha:Nt.alpha,depth:Nt.depth,stencil:Nt.stencil,framebufferScaleFactor:s},$t=new XRWebGLLayer(o,e,ne);o.updateRenderState({baseLayer:$t})}else{let ne=0;Nt.depth&&(ne=Nt.stencil?34041:6402);const $t={colorFormat:Nt.alpha?6408:6407,depthFormat:ne,scaleFactor:s};u=new XRWebGLBinding(o,e),y=u.createProjectionLayer($t),p=e.createFramebuffer(),o.updateRenderState({layers:[y]})}a=await o.requestReferenceSpace(l),wt.setContext(o),wt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const mt=new U,jt=new U;function Ft(Pt,Nt){Nt===null?Pt.matrixWorld.copy(Pt.matrix):Pt.matrixWorld.multiplyMatrices(Nt.matrixWorld,Pt.matrix),Pt.matrixWorldInverse.copy(Pt.matrixWorld).invert()}this.updateCamera=function(Pt){if(o===null)return;Z.near=C.near=w.near=Pt.near,Z.far=C.far=w.far=Pt.far,rt===Z.near&&ct===Z.far||(o.updateRenderState({depthNear:Z.near,depthFar:Z.far}),rt=Z.near,ct=Z.far);const Nt=Pt.parent,ne=Z.cameras;Ft(Z,Nt);for(let zt=0;zt<ne.length;zt++)Ft(ne[zt],Nt);Z.matrixWorld.decompose(Z.position,Z.quaternion,Z.scale),Pt.position.copy(Z.position),Pt.quaternion.copy(Z.quaternion),Pt.scale.copy(Z.scale),Pt.matrix.copy(Z.matrix),Pt.matrixWorld.copy(Z.matrixWorld);const $t=Pt.children;for(let zt=0,Yt=$t.length;zt<Yt;zt++)$t[zt].updateMatrixWorld(!0);ne.length===2?function(zt,Yt,ge){mt.setFromMatrixPosition(Yt.matrixWorld),jt.setFromMatrixPosition(ge.matrixWorld);const be=mt.distanceTo(jt),Pe=Yt.projectionMatrix.elements,Ct=ge.projectionMatrix.elements,Bt=Pe[14]/(Pe[10]-1),ve=Pe[14]/(Pe[10]+1),le=(Pe[9]+1)/Pe[5],se=(Pe[9]-1)/Pe[5],Ie=(Pe[8]-1)/Pe[0],Le=(Ct[8]+1)/Ct[0],ue=Bt*Ie,bt=Bt*Le,Ht=be/(-Ie+Le),ie=Ht*-Ie;Yt.matrixWorld.decompose(zt.position,zt.quaternion,zt.scale),zt.translateX(ie),zt.translateZ(Ht),zt.matrixWorld.compose(zt.position,zt.quaternion,zt.scale),zt.matrixWorldInverse.copy(zt.matrixWorld).invert();const ae=Bt+Ht,qt=ve+Ht,ye=ue-ie,nn=bt+(be-ie),on=le*ve/qt*ae,rn=se*ve/qt*ae;zt.projectionMatrix.makePerspective(ye,nn,on,rn,ae,qt)}(Z,w,C):Z.projectionMatrix.copy(w.projectionMatrix)},this.getCamera=function(){return Z};let Mt=null;const wt=new rs;wt.setAnimationLoop(function(Pt,Nt){if(h=Nt.getViewerPose(a),h!==null){const $t=h.views,zt=o.renderState.baseLayer;o.renderState.layers===void 0&&r.bindXRFramebuffer(zt.framebuffer);let Yt=!1;$t.length!==Z.cameras.length&&(Z.cameras.length=0,Yt=!0);for(let ge=0;ge<$t.length;ge++){const be=$t[ge];let Pe=null;if(o.renderState.layers===void 0)Pe=zt.getViewport(be);else{const Bt=u.getViewSubImage(y,be);r.bindXRFramebuffer(p),e.framebufferTexture2D(36160,36064,3553,Bt.colorTexture,0),Bt.depthStencilTexture!==void 0&&e.framebufferTexture2D(36160,36096,3553,Bt.depthStencilTexture,0),Pe=Bt.viewport}const Ct=j[ge];Ct.matrix.fromArray(be.transform.matrix),Ct.projectionMatrix.fromArray(be.projectionMatrix),Ct.viewport.set(Pe.x,Pe.y,Pe.width,Pe.height),ge===0&&Z.matrix.copy(Ct.matrix),Yt===!0&&Z.cameras.push(Ct)}}const ne=o.inputSources;for(let $t=0;$t<x.length;$t++){const zt=x[$t],Yt=ne[$t];zt.update(Yt,Nt,a)}Mt&&Mt(Pt,Nt)}),this.setAnimationLoop=function(Pt){Mt=Pt},this.dispose=function(){}}}function oy(i){function t(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map),r.alphaMap&&(n.alphaMap.value=r.alphaMap),r.specularMap&&(n.specularMap.value=r.specularMap);const o=i.get(r).envMap;if(o){n.envMap.value=o,n.flipEnvMap.value=o.isCubeTexture&&o._needsFlipEnvMap?-1:1,n.reflectivity.value=r.reflectivity,n.refractionRatio.value=r.refractionRatio;const l=i.get(o).__maxMipLevel;l!==void 0&&(n.maxMipLevel.value=l)}let s,a;r.lightMap&&(n.lightMap.value=r.lightMap,n.lightMapIntensity.value=r.lightMapIntensity),r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity),r.map?s=r.map:r.specularMap?s=r.specularMap:r.displacementMap?s=r.displacementMap:r.normalMap?s=r.normalMap:r.bumpMap?s=r.bumpMap:r.roughnessMap?s=r.roughnessMap:r.metalnessMap?s=r.metalnessMap:r.alphaMap?s=r.alphaMap:r.emissiveMap?s=r.emissiveMap:r.clearcoatMap?s=r.clearcoatMap:r.clearcoatNormalMap?s=r.clearcoatNormalMap:r.clearcoatRoughnessMap&&(s=r.clearcoatRoughnessMap),s!==void 0&&(s.isWebGLRenderTarget&&(s=s.texture),s.matrixAutoUpdate===!0&&s.updateMatrix(),n.uvTransform.value.copy(s.matrix)),r.aoMap?a=r.aoMap:r.lightMap&&(a=r.lightMap),a!==void 0&&(a.isWebGLRenderTarget&&(a=a.texture),a.matrixAutoUpdate===!0&&a.updateMatrix(),n.uv2Transform.value.copy(a.matrix))}function e(n,r){n.roughness.value=r.roughness,n.metalness.value=r.metalness,r.roughnessMap&&(n.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(n.metalnessMap.value=r.metalnessMap),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap),r.bumpMap&&(n.bumpMap.value=r.bumpMap,n.bumpScale.value=r.bumpScale,r.side===1&&(n.bumpScale.value*=-1)),r.normalMap&&(n.normalMap.value=r.normalMap,n.normalScale.value.copy(r.normalScale),r.side===1&&n.normalScale.value.negate()),r.displacementMap&&(n.displacementMap.value=r.displacementMap,n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),i.get(r).envMap&&(n.envMapIntensity.value=r.envMapIntensity)}return{refreshFogUniforms:function(n,r){n.fogColor.value.copy(r.color),r.isFog?(n.fogNear.value=r.near,n.fogFar.value=r.far):r.isFogExp2&&(n.fogDensity.value=r.density)},refreshMaterialUniforms:function(n,r,o,s,a){r.isMeshBasicMaterial?t(n,r):r.isMeshLambertMaterial?(t(n,r),function(l,h){h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap)}(n,r)):r.isMeshToonMaterial?(t(n,r),function(l,h){h.gradientMap&&(l.gradientMap.value=h.gradientMap),h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshPhongMaterial?(t(n,r),function(l,h){l.specular.value.copy(h.specular),l.shininess.value=Math.max(h.shininess,1e-4),h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshStandardMaterial?(t(n,r),r.isMeshPhysicalMaterial?function(l,h,u){e(l,h),l.reflectivity.value=h.reflectivity,l.clearcoat.value=h.clearcoat,l.clearcoatRoughness.value=h.clearcoatRoughness,h.sheen&&l.sheen.value.copy(h.sheen),h.clearcoatMap&&(l.clearcoatMap.value=h.clearcoatMap),h.clearcoatRoughnessMap&&(l.clearcoatRoughnessMap.value=h.clearcoatRoughnessMap),h.clearcoatNormalMap&&(l.clearcoatNormalScale.value.copy(h.clearcoatNormalScale),l.clearcoatNormalMap.value=h.clearcoatNormalMap,h.side===1&&l.clearcoatNormalScale.value.negate()),l.transmission.value=h.transmission,h.transmissionMap&&(l.transmissionMap.value=h.transmissionMap),h.transmission>0&&(l.transmissionSamplerMap.value=u.texture,l.transmissionSamplerSize.value.set(u.width,u.height)),l.thickness.value=h.thickness,h.thicknessMap&&(l.thicknessMap.value=h.thicknessMap),l.attenuationDistance.value=h.attenuationDistance,l.attenuationColor.value.copy(h.attenuationColor)}(n,r,a):e(n,r)):r.isMeshMatcapMaterial?(t(n,r),function(l,h){h.matcap&&(l.matcap.value=h.matcap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshDepthMaterial?(t(n,r),function(l,h){h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isMeshDistanceMaterial?(t(n,r),function(l,h){h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias),l.referencePosition.value.copy(h.referencePosition),l.nearDistance.value=h.nearDistance,l.farDistance.value=h.farDistance}(n,r)):r.isMeshNormalMaterial?(t(n,r),function(l,h){h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===1&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===1&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(n,r)):r.isLineBasicMaterial?(function(l,h){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity}(n,r),r.isLineDashedMaterial&&function(l,h){l.dashSize.value=h.dashSize,l.totalSize.value=h.dashSize+h.gapSize,l.scale.value=h.scale}(n,r)):r.isPointsMaterial?function(l,h,u,p){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity,l.size.value=h.size*u,l.scale.value=.5*p,h.map&&(l.map.value=h.map),h.alphaMap&&(l.alphaMap.value=h.alphaMap);let y;h.map?y=h.map:h.alphaMap&&(y=h.alphaMap),y!==void 0&&(y.matrixAutoUpdate===!0&&y.updateMatrix(),l.uvTransform.value.copy(y.matrix))}(n,r,o,s):r.isSpriteMaterial?function(l,h){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity,l.rotation.value=h.rotation,h.map&&(l.map.value=h.map),h.alphaMap&&(l.alphaMap.value=h.alphaMap);let u;h.map?u=h.map:h.alphaMap&&(u=h.alphaMap),u!==void 0&&(u.matrixAutoUpdate===!0&&u.updateMatrix(),l.uvTransform.value.copy(u.matrix))}(n,r):r.isShadowMaterial?(n.color.value.copy(r.color),n.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function ni(i={}){const t=i.canvas!==void 0?i.canvas:function(){const Gt=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return Gt.style.display="block",Gt}(),e=i.context!==void 0?i.context:null,n=i.alpha!==void 0&&i.alpha,r=i.depth===void 0||i.depth,o=i.stencil===void 0||i.stencil,s=i.antialias!==void 0&&i.antialias,a=i.premultipliedAlpha===void 0||i.premultipliedAlpha,l=i.preserveDrawingBuffer!==void 0&&i.preserveDrawingBuffer,h=i.powerPreference!==void 0?i.powerPreference:"default",u=i.failIfMajorPerformanceCaveat!==void 0&&i.failIfMajorPerformanceCaveat;let p=null,y=null;const x=[],E=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const w=this;let C=!1,j=0,Z=0,rt=null,ct=-1,nt=null;const vt=new Ot,ht=new Ot;let mt=null,jt=t.width,Ft=t.height,Mt=1,wt=null,Pt=null;const Nt=new Ot(0,0,jt,Ft),ne=new Ot(0,0,jt,Ft);let $t=!1;const zt=[],Yt=new kr;let ge=!1,be=!1,Pe=null;const Ct=new tn,Bt=new U,ve={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function le(){return rt===null?Mt:1}let se,Ie,Le,ue,bt,Ht,ie,ae,qt,ye,nn,on,rn,Sn,Mi,Kn,fr,tl,el,nl,ur,mr,He=e;function jv(Gt,Ce){for(let fe=0;fe<Gt.length;fe++){const Re=Gt[fe],We=t.getContext(Re,Ce);if(We!==null)return We}return null}try{const Gt={alpha:n,depth:r,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:h,failIfMajorPerformanceCaveat:u};if(t.addEventListener("webglcontextlost",Vv,!1),t.addEventListener("webglcontextrestored",Wv,!1),He===null){const Ce=["webgl2","webgl","experimental-webgl"];if(w.isWebGL1Renderer===!0&&Ce.shift(),He=jv(Ce,Gt),He===null)throw jv(Ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}He.getShaderPrecisionFormat===void 0&&(He.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Gt){throw console.error("THREE.WebGLRenderer: "+Gt.message),Gt}function zv(){se=new dl(He),Ie=new Kh(He,se,i),se.init(Ie),ur=new ny(He,se,Ie),Le=new ty(He,se,Ie),zt[0]=1029,ue=new eu,bt=new X_,Ht=new ey(He,se,Le,bt,Ie,ur,ue),ie=new Qh(w),ae=new os(He,Ie),mr=new uo(He,se,ae,Ie),qt=new $h(He,ae,ue,mr),ye=new ru(He,qt,ae,ue),tl=new iu(He),Mi=new Zh(bt),nn=new W_(w,ie,se,Ie,mr,Mi),on=new oy(bt),rn=new q_(bt),Sn=new $_(se,Ie),fr=new Jh(w,ie,Le,ye,a),Kn=new $d(w,ye,Ie),el=new ss(He,se,ue,Ie),nl=new tu(He,se,ue,Ie),ue.programs=nn.programs,w.capabilities=Ie,w.extensions=se,w.properties=bt,w.renderLists=rn,w.shadowMap=Kn,w.state=Le,w.info=ue}zv();const Sr=new ry(w,He);function Vv(Gt){Gt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function Wv(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;const Gt=ue.autoReset,Ce=Kn.enabled,fe=Kn.autoUpdate,Re=Kn.needsUpdate,We=Kn.type;zv(),ue.autoReset=Gt,Kn.enabled=Ce,Kn.autoUpdate=fe,Kn.needsUpdate=Re,Kn.type=We}function Xv(Gt){const Ce=Gt.target;Ce.removeEventListener("dispose",Xv),function(fe){(function(Re){const We=bt.get(Re).programs;We!==void 0&&We.forEach(function(Wn){nn.releaseProgram(Wn)})})(fe),bt.remove(fe)}(Ce)}this.xr=Sr,this.getContext=function(){return He},this.getContextAttributes=function(){return He.getContextAttributes()},this.forceContextLoss=function(){const Gt=se.get("WEBGL_lose_context");Gt&&Gt.loseContext()},this.forceContextRestore=function(){const Gt=se.get("WEBGL_lose_context");Gt&&Gt.restoreContext()},this.getPixelRatio=function(){return Mt},this.setPixelRatio=function(Gt){Gt!==void 0&&(Mt=Gt,this.setSize(jt,Ft,!1))},this.getSize=function(Gt){return Gt.set(jt,Ft)},this.setSize=function(Gt,Ce,fe){Sr.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(jt=Gt,Ft=Ce,t.width=Math.floor(Gt*Mt),t.height=Math.floor(Ce*Mt),fe!==!1&&(t.style.width=Gt+"px",t.style.height=Ce+"px"),this.setViewport(0,0,Gt,Ce))},this.getDrawingBufferSize=function(Gt){return Gt.set(jt*Mt,Ft*Mt).floor()},this.setDrawingBufferSize=function(Gt,Ce,fe){jt=Gt,Ft=Ce,Mt=fe,t.width=Math.floor(Gt*fe),t.height=Math.floor(Ce*fe),this.setViewport(0,0,Gt,Ce)},this.getCurrentViewport=function(Gt){return Gt.copy(vt)},this.getViewport=function(Gt){return Gt.copy(Nt)},this.setViewport=function(Gt,Ce,fe,Re){Gt.isVector4?Nt.set(Gt.x,Gt.y,Gt.z,Gt.w):Nt.set(Gt,Ce,fe,Re),Le.viewport(vt.copy(Nt).multiplyScalar(Mt).floor())},this.getScissor=function(Gt){return Gt.copy(ne)},this.setScissor=function(Gt,Ce,fe,Re){Gt.isVector4?ne.set(Gt.x,Gt.y,Gt.z,Gt.w):ne.set(Gt,Ce,fe,Re),Le.scissor(ht.copy(ne).multiplyScalar(Mt).floor())},this.getScissorTest=function(){return $t},this.setScissorTest=function(Gt){Le.setScissorTest($t=Gt)},this.setOpaqueSort=function(Gt){wt=Gt},this.setTransparentSort=function(Gt){Pt=Gt},this.getClearColor=function(Gt){return Gt.copy(fr.getClearColor())},this.setClearColor=function(){fr.setClearColor.apply(fr,arguments)},this.getClearAlpha=function(){return fr.getClearAlpha()},this.setClearAlpha=function(){fr.setClearAlpha.apply(fr,arguments)},this.clear=function(Gt,Ce,fe){let Re=0;(Gt===void 0||Gt)&&(Re|=16384),(Ce===void 0||Ce)&&(Re|=256),(fe===void 0||fe)&&(Re|=1024),He.clear(Re)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Vv,!1),t.removeEventListener("webglcontextrestored",Wv,!1),rn.dispose(),Sn.dispose(),bt.dispose(),ie.dispose(),ye.dispose(),mr.dispose(),Sr.dispose(),Sr.removeEventListener("sessionstart",Yv),Sr.removeEventListener("sessionend",qv),Pe&&(Pe.dispose(),Pe=null),ys.stop()},this.renderBufferImmediate=function(Gt,Ce){mr.initAttributes();const fe=bt.get(Gt);Gt.hasPositions&&!fe.position&&(fe.position=He.createBuffer()),Gt.hasNormals&&!fe.normal&&(fe.normal=He.createBuffer()),Gt.hasUvs&&!fe.uv&&(fe.uv=He.createBuffer()),Gt.hasColors&&!fe.color&&(fe.color=He.createBuffer());const Re=Ce.getAttributes();Gt.hasPositions&&(He.bindBuffer(34962,fe.position),He.bufferData(34962,Gt.positionArray,35048),mr.enableAttribute(Re.position),He.vertexAttribPointer(Re.position,3,5126,!1,0,0)),Gt.hasNormals&&(He.bindBuffer(34962,fe.normal),He.bufferData(34962,Gt.normalArray,35048),mr.enableAttribute(Re.normal),He.vertexAttribPointer(Re.normal,3,5126,!1,0,0)),Gt.hasUvs&&(He.bindBuffer(34962,fe.uv),He.bufferData(34962,Gt.uvArray,35048),mr.enableAttribute(Re.uv),He.vertexAttribPointer(Re.uv,2,5126,!1,0,0)),Gt.hasColors&&(He.bindBuffer(34962,fe.color),He.bufferData(34962,Gt.colorArray,35048),mr.enableAttribute(Re.color),He.vertexAttribPointer(Re.color,3,5126,!1,0,0)),mr.disableUnusedAttributes(),He.drawArrays(4,0,Gt.count),Gt.count=0},this.renderBufferDirect=function(Gt,Ce,fe,Re,We,Wn){Ce===null&&(Ce=ve);const wn=We.isMesh&&We.matrixWorld.determinant()<0,Ze=Zv(Gt,Ce,Re,We);Le.setMaterial(Re,wn);let Ln=fe.index;const mn=fe.attributes.position;if(Ln===null){if(mn===void 0||mn.count===0)return}else if(Ln.count===0)return;let Vn,En=1;Re.wireframe===!0&&(Ln=qt.getWireframeAttribute(fe),En=2),(Re.morphTargets||Re.morphNormals)&&tl.update(We,fe,Re,Ze),mr.setup(We,Re,Ze,fe,Ln);let jn=el;Ln!==null&&(Vn=ae.get(Ln),jn=nl,jn.setIndex(Vn));const Li=Ln!==null?Ln.count:mn.count,hi=fe.drawRange.start*En,Xr=fe.drawRange.count*En,ai=Wn!==null?Wn.start*En:0,ro=Wn!==null?Wn.count*En:1/0,zi=Math.max(hi,ai),wr=Math.min(Li,hi+Xr,ai+ro)-1,or=Math.max(0,wr-zi+1);if(or!==0){if(We.isMesh)Re.wireframe===!0?(Le.setLineWidth(Re.wireframeLinewidth*le()),jn.setMode(1)):jn.setMode(4);else if(We.isLine){let il=Re.linewidth;il===void 0&&(il=1),Le.setLineWidth(il*le()),We.isLineSegments?jn.setMode(1):We.isLineLoop?jn.setMode(2):jn.setMode(3)}else We.isPoints?jn.setMode(0):We.isSprite&&jn.setMode(4);if(We.isInstancedMesh)jn.renderInstances(zi,or,We.count);else if(fe.isInstancedBufferGeometry){const il=Math.min(fe.instanceCount,fe._maxInstanceCount);jn.renderInstances(zi,or,il)}else jn.render(zi,or)}},this.compile=function(Gt,Ce){y=Sn.get(Gt),y.init(),Gt.traverseVisible(function(fe){fe.isLight&&fe.layers.test(Ce.layers)&&(y.pushLight(fe),fe.castShadow&&y.pushShadow(fe))}),y.setupLights(),Gt.traverse(function(fe){const Re=fe.material;if(Re)if(Array.isArray(Re))for(let We=0;We<Re.length;We++)Yc(Re[We],Gt,fe);else Yc(Re,Gt,fe)})};let Xc=null;function Yv(){ys.stop()}function qv(){ys.start()}const ys=new rs;function Ch(Gt,Ce,fe){const Re=Ce.isScene===!0?Ce.overrideMaterial:null;for(let We=0,Wn=Gt.length;We<Wn;We++){const wn=Gt[We],Ze=wn.object,Ln=wn.geometry,mn=Re===null?wn.material:Re,Vn=wn.group;if(fe.isArrayCamera){const En=fe.cameras;for(let jn=0,Li=En.length;jn<Li;jn++){const hi=En[jn];Ze.layers.test(hi.layers)&&(Le.viewport(vt.copy(hi.viewport)),y.setupLightsView(hi),Jv(Ze,Ce,hi,Ln,mn,Vn))}}else Jv(Ze,Ce,fe,Ln,mn,Vn)}}function Jv(Gt,Ce,fe,Re,We,Wn){if(Gt.onBeforeRender(w,Ce,fe,Re,We,Wn),Gt.modelViewMatrix.multiplyMatrices(fe.matrixWorldInverse,Gt.matrixWorld),Gt.normalMatrix.getNormalMatrix(Gt.modelViewMatrix),Gt.isImmediateRenderObject){const wn=Zv(fe,Ce,We,Gt);Le.setMaterial(We),mr.reset(),function(Ze,Ln){Ze.render(function(mn){w.renderBufferImmediate(mn,Ln)})}(Gt,wn)}else We.transparent===!0&&We.side===2?(We.side=1,We.needsUpdate=!0,w.renderBufferDirect(fe,Ce,Re,We,Gt,Wn),We.side=0,We.needsUpdate=!0,w.renderBufferDirect(fe,Ce,Re,We,Gt,Wn),We.side=2):w.renderBufferDirect(fe,Ce,Re,We,Gt,Wn);Gt.onAfterRender(w,Ce,fe,Re,We,Wn)}function Yc(Gt,Ce,fe){Ce.isScene!==!0&&(Ce=ve);const Re=bt.get(Gt),We=y.state.lights,Wn=y.state.shadowsArray,wn=We.state.version,Ze=nn.getParameters(Gt,We.state,Wn,Ce,fe),Ln=nn.getProgramCacheKey(Ze);let mn=Re.programs;Re.environment=Gt.isMeshStandardMaterial?Ce.environment:null,Re.fog=Ce.fog,Re.envMap=ie.get(Gt.envMap||Re.environment),mn===void 0&&(Gt.addEventListener("dispose",Xv),mn=new Map,Re.programs=mn);let Vn=mn.get(Ln);if(Vn!==void 0){if(Re.currentProgram===Vn&&Re.lightsStateVersion===wn)return Kv(Gt,Ze),Vn}else Ze.uniforms=nn.getUniforms(Gt),Gt.onBuild(Ze,w),Gt.onBeforeCompile(Ze,w),Vn=nn.acquireProgram(Ze,Ln),mn.set(Ln,Vn),Re.uniforms=Ze.uniforms;const En=Re.uniforms;(Gt.isShaderMaterial||Gt.isRawShaderMaterial)&&Gt.clipping!==!0||(En.clippingPlanes=Mi.uniform),Kv(Gt,Ze),Re.needsLights=function(hi){return hi.isMeshLambertMaterial||hi.isMeshToonMaterial||hi.isMeshPhongMaterial||hi.isMeshStandardMaterial||hi.isShadowMaterial||hi.isShaderMaterial&&hi.lights===!0}(Gt),Re.lightsStateVersion=wn,Re.needsLights&&(En.ambientLightColor.value=We.state.ambient,En.lightProbe.value=We.state.probe,En.directionalLights.value=We.state.directional,En.directionalLightShadows.value=We.state.directionalShadow,En.spotLights.value=We.state.spot,En.spotLightShadows.value=We.state.spotShadow,En.rectAreaLights.value=We.state.rectArea,En.ltc_1.value=We.state.rectAreaLTC1,En.ltc_2.value=We.state.rectAreaLTC2,En.pointLights.value=We.state.point,En.pointLightShadows.value=We.state.pointShadow,En.hemisphereLights.value=We.state.hemi,En.directionalShadowMap.value=We.state.directionalShadowMap,En.directionalShadowMatrix.value=We.state.directionalShadowMatrix,En.spotShadowMap.value=We.state.spotShadowMap,En.spotShadowMatrix.value=We.state.spotShadowMatrix,En.pointShadowMap.value=We.state.pointShadowMap,En.pointShadowMatrix.value=We.state.pointShadowMatrix);const jn=Vn.getUniforms(),Li=oi.seqWithValue(jn.seq,En);return Re.currentProgram=Vn,Re.uniformsList=Li,Vn}function Kv(Gt,Ce){const fe=bt.get(Gt);fe.outputEncoding=Ce.outputEncoding,fe.instancing=Ce.instancing,fe.skinning=Ce.skinning,fe.numClippingPlanes=Ce.numClippingPlanes,fe.numIntersection=Ce.numClipIntersection,fe.vertexAlphas=Ce.vertexAlphas}function Zv(Gt,Ce,fe,Re){Ce.isScene!==!0&&(Ce=ve),Ht.resetTextureUnits();const We=Ce.fog,Wn=fe.isMeshStandardMaterial?Ce.environment:null,wn=rt===null?w.outputEncoding:rt.texture.encoding,Ze=ie.get(fe.envMap||Wn),Ln=fe.vertexColors===!0&&Re.geometry&&Re.geometry.attributes.color&&Re.geometry.attributes.color.itemSize===4,mn=bt.get(fe),Vn=y.state.lights;if(ge===!0&&(be===!0||Gt!==nt)){const or=Gt===nt&&fe.id===ct;Mi.setState(fe,Gt,or)}let En=!1;fe.version===mn.__version?mn.needsLights&&mn.lightsStateVersion!==Vn.state.version||mn.outputEncoding!==wn||Re.isInstancedMesh&&mn.instancing===!1?En=!0:Re.isInstancedMesh||mn.instancing!==!0?Re.isSkinnedMesh&&mn.skinning===!1?En=!0:Re.isSkinnedMesh||mn.skinning!==!0?mn.envMap!==Ze||fe.fog&&mn.fog!==We?En=!0:mn.numClippingPlanes===void 0||mn.numClippingPlanes===Mi.numPlanes&&mn.numIntersection===Mi.numIntersection?mn.vertexAlphas!==Ln&&(En=!0):En=!0:En=!0:En=!0:(En=!0,mn.__version=fe.version);let jn=mn.currentProgram;En===!0&&(jn=Yc(fe,Ce,Re));let Li=!1,hi=!1,Xr=!1;const ai=jn.getUniforms(),ro=mn.uniforms;if(Le.useProgram(jn.program)&&(Li=!0,hi=!0,Xr=!0),fe.id!==ct&&(ct=fe.id,hi=!0),Li||nt!==Gt){if(ai.setValue(He,"projectionMatrix",Gt.projectionMatrix),Ie.logarithmicDepthBuffer&&ai.setValue(He,"logDepthBufFC",2/(Math.log(Gt.far+1)/Math.LN2)),nt!==Gt&&(nt=Gt,hi=!0,Xr=!0),fe.isShaderMaterial||fe.isMeshPhongMaterial||fe.isMeshToonMaterial||fe.isMeshStandardMaterial||fe.envMap){const or=ai.map.cameraPosition;or!==void 0&&or.setValue(He,Bt.setFromMatrixPosition(Gt.matrixWorld))}(fe.isMeshPhongMaterial||fe.isMeshToonMaterial||fe.isMeshLambertMaterial||fe.isMeshBasicMaterial||fe.isMeshStandardMaterial||fe.isShaderMaterial)&&ai.setValue(He,"isOrthographic",Gt.isOrthographicCamera===!0),(fe.isMeshPhongMaterial||fe.isMeshToonMaterial||fe.isMeshLambertMaterial||fe.isMeshBasicMaterial||fe.isMeshStandardMaterial||fe.isShaderMaterial||fe.isShadowMaterial||Re.isSkinnedMesh)&&ai.setValue(He,"viewMatrix",Gt.matrixWorldInverse)}if(Re.isSkinnedMesh){ai.setOptional(He,Re,"bindMatrix"),ai.setOptional(He,Re,"bindMatrixInverse");const or=Re.skeleton;or&&(Ie.floatVertexTextures?(or.boneTexture===null&&or.computeBoneTexture(),ai.setValue(He,"boneTexture",or.boneTexture,Ht),ai.setValue(He,"boneTextureSize",or.boneTextureSize)):ai.setOptional(He,or,"boneMatrices"))}var zi,wr;return(hi||mn.receiveShadow!==Re.receiveShadow)&&(mn.receiveShadow=Re.receiveShadow,ai.setValue(He,"receiveShadow",Re.receiveShadow)),hi&&(ai.setValue(He,"toneMappingExposure",w.toneMappingExposure),mn.needsLights&&(wr=Xr,(zi=ro).ambientLightColor.needsUpdate=wr,zi.lightProbe.needsUpdate=wr,zi.directionalLights.needsUpdate=wr,zi.directionalLightShadows.needsUpdate=wr,zi.pointLights.needsUpdate=wr,zi.pointLightShadows.needsUpdate=wr,zi.spotLights.needsUpdate=wr,zi.spotLightShadows.needsUpdate=wr,zi.rectAreaLights.needsUpdate=wr,zi.hemisphereLights.needsUpdate=wr),We&&fe.fog&&on.refreshFogUniforms(ro,We),on.refreshMaterialUniforms(ro,fe,Mt,Ft,Pe),oi.upload(He,mn.uniformsList,ro,Ht)),fe.isShaderMaterial&&fe.uniformsNeedUpdate===!0&&(oi.upload(He,mn.uniformsList,ro,Ht),fe.uniformsNeedUpdate=!1),fe.isSpriteMaterial&&ai.setValue(He,"center",Re.center),ai.setValue(He,"modelViewMatrix",Re.modelViewMatrix),ai.setValue(He,"normalMatrix",Re.normalMatrix),ai.setValue(He,"modelMatrix",Re.matrixWorld),jn}ys.setAnimationLoop(function(Gt){Xc&&Xc(Gt)}),typeof window!="undefined"&&ys.setContext(window),this.setAnimationLoop=function(Gt){Xc=Gt,Sr.setAnimationLoop(Gt),Gt===null?ys.stop():ys.start()},Sr.addEventListener("sessionstart",Yv),Sr.addEventListener("sessionend",qv),this.render=function(Gt,Ce){if(Ce!==void 0&&Ce.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(C===!0)return;Gt.autoUpdate===!0&&Gt.updateMatrixWorld(),Ce.parent===null&&Ce.updateMatrixWorld(),Sr.enabled===!0&&Sr.isPresenting===!0&&(Sr.cameraAutoUpdate===!0&&Sr.updateCamera(Ce),Ce=Sr.getCamera()),Gt.isScene===!0&&Gt.onBeforeRender(w,Gt,Ce,rt),y=Sn.get(Gt,E.length),y.init(),E.push(y),Ct.multiplyMatrices(Ce.projectionMatrix,Ce.matrixWorldInverse),Yt.setFromProjectionMatrix(Ct),be=this.localClippingEnabled,ge=Mi.init(this.clippingPlanes,be,Ce),p=rn.get(Gt,x.length),p.init(),x.push(p),function wn(Ze,Ln,mn,Vn){if(Ze.visible===!1)return;if(Ze.layers.test(Ln.layers)){if(Ze.isGroup)mn=Ze.renderOrder;else if(Ze.isLOD)Ze.autoUpdate===!0&&Ze.update(Ln);else if(Ze.isLight)y.pushLight(Ze),Ze.castShadow&&y.pushShadow(Ze);else if(Ze.isSprite){if(!Ze.frustumCulled||Yt.intersectsSprite(Ze)){Vn&&Bt.setFromMatrixPosition(Ze.matrixWorld).applyMatrix4(Ct);const jn=ye.update(Ze),Li=Ze.material;Li.visible&&p.push(Ze,jn,Li,mn,Bt.z,null)}}else if(Ze.isImmediateRenderObject)Vn&&Bt.setFromMatrixPosition(Ze.matrixWorld).applyMatrix4(Ct),p.push(Ze,null,Ze.material,mn,Bt.z,null);else if((Ze.isMesh||Ze.isLine||Ze.isPoints)&&(Ze.isSkinnedMesh&&Ze.skeleton.frame!==ue.render.frame&&(Ze.skeleton.update(),Ze.skeleton.frame=ue.render.frame),!Ze.frustumCulled||Yt.intersectsObject(Ze))){Vn&&Bt.setFromMatrixPosition(Ze.matrixWorld).applyMatrix4(Ct);const jn=ye.update(Ze),Li=Ze.material;if(Array.isArray(Li)){const hi=jn.groups;for(let Xr=0,ai=hi.length;Xr<ai;Xr++){const ro=hi[Xr],zi=Li[ro.materialIndex];zi&&zi.visible&&p.push(Ze,jn,zi,mn,Bt.z,ro)}}else Li.visible&&p.push(Ze,jn,Li,mn,Bt.z,null)}}const En=Ze.children;for(let jn=0,Li=En.length;jn<Li;jn++)wn(En[jn],Ln,mn,Vn)}(Gt,Ce,0,w.sortObjects),p.finish(),w.sortObjects===!0&&p.sort(wt,Pt),ge===!0&&Mi.beginShadows();const fe=y.state.shadowsArray;Kn.render(fe,Gt,Ce),y.setupLights(),y.setupLightsView(Ce),ge===!0&&Mi.endShadows(),this.info.autoReset===!0&&this.info.reset(),fr.render(p,Gt);const Re=p.opaque,We=p.transmissive,Wn=p.transparent;Re.length>0&&Ch(Re,Gt,Ce),We.length>0&&function(wn,Ze,Ln,mn){if(Pe===null){const jn=s===!0&&Ie.isWebGL2===!0;Pe=new(jn?st:Vt)(1024,1024,{generateMipmaps:!0,type:ur.convert(1016)!==null?1016:1009,minFilter:1008,magFilter:1003,wrapS:1001,wrapT:1001})}const Vn=w.getRenderTarget();w.setRenderTarget(Pe),w.clear();const En=w.toneMapping;w.toneMapping=0,Ch(wn,Ln,mn),w.toneMapping=En,Ht.updateMultisampleRenderTarget(Pe),Ht.updateRenderTargetMipmap(Pe),w.setRenderTarget(Vn),Ch(Ze,Ln,mn)}(Re,We,Gt,Ce),Wn.length>0&&Ch(Wn,Gt,Ce),rt!==null&&(Ht.updateMultisampleRenderTarget(rt),Ht.updateRenderTargetMipmap(rt)),Gt.isScene===!0&&Gt.onAfterRender(w,Gt,Ce),Le.buffers.depth.setTest(!0),Le.buffers.depth.setMask(!0),Le.buffers.color.setMask(!0),Le.setPolygonOffset(!1),mr.resetDefaultState(),ct=-1,nt=null,E.pop(),y=E.length>0?E[E.length-1]:null,x.pop(),p=x.length>0?x[x.length-1]:null},this.getActiveCubeFace=function(){return j},this.getActiveMipmapLevel=function(){return Z},this.getRenderTarget=function(){return rt},this.setRenderTarget=function(Gt,Ce=0,fe=0){rt=Gt,j=Ce,Z=fe,Gt&&bt.get(Gt).__webglFramebuffer===void 0&&Ht.setupRenderTarget(Gt);let Re=null,We=!1,Wn=!1;if(Gt){const wn=Gt.texture;(wn.isDataTexture3D||wn.isDataTexture2DArray)&&(Wn=!0);const Ze=bt.get(Gt).__webglFramebuffer;Gt.isWebGLCubeRenderTarget?(Re=Ze[Ce],We=!0):Re=Gt.isWebGLMultisampleRenderTarget?bt.get(Gt).__webglMultisampledFramebuffer:Ze,vt.copy(Gt.viewport),ht.copy(Gt.scissor),mt=Gt.scissorTest}else vt.copy(Nt).multiplyScalar(Mt).floor(),ht.copy(ne).multiplyScalar(Mt).floor(),mt=$t;if(Le.bindFramebuffer(36160,Re)&&Ie.drawBuffers){let wn=!1;if(Gt)if(Gt.isWebGLMultipleRenderTargets){const Ze=Gt.texture;if(zt.length!==Ze.length||zt[0]!==36064){for(let Ln=0,mn=Ze.length;Ln<mn;Ln++)zt[Ln]=36064+Ln;zt.length=Ze.length,wn=!0}}else zt.length===1&&zt[0]===36064||(zt[0]=36064,zt.length=1,wn=!0);else zt.length===1&&zt[0]===1029||(zt[0]=1029,zt.length=1,wn=!0);wn&&(Ie.isWebGL2?He.drawBuffers(zt):se.get("WEBGL_draw_buffers").drawBuffersWEBGL(zt))}if(Le.viewport(vt),Le.scissor(ht),Le.setScissorTest(mt),We){const wn=bt.get(Gt.texture);He.framebufferTexture2D(36160,36064,34069+Ce,wn.__webglTexture,fe)}else if(Wn){const wn=bt.get(Gt.texture),Ze=Ce||0;He.framebufferTextureLayer(36160,36064,wn.__webglTexture,fe||0,Ze)}},this.readRenderTargetPixels=function(Gt,Ce,fe,Re,We,Wn,wn){if(!Gt||!Gt.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ze=bt.get(Gt).__webglFramebuffer;if(Gt.isWebGLCubeRenderTarget&&wn!==void 0&&(Ze=Ze[wn]),Ze){Le.bindFramebuffer(36160,Ze);try{const Ln=Gt.texture,mn=Ln.format,Vn=Ln.type;if(mn!==1023&&ur.convert(mn)!==He.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const En=Vn===1016&&(se.has("EXT_color_buffer_half_float")||Ie.isWebGL2&&se.has("EXT_color_buffer_float"));if(!(Vn===1009||ur.convert(Vn)===He.getParameter(35738)||Vn===1015&&(Ie.isWebGL2||se.has("OES_texture_float")||se.has("WEBGL_color_buffer_float"))||En))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");He.checkFramebufferStatus(36160)===36053?Ce>=0&&Ce<=Gt.width-Re&&fe>=0&&fe<=Gt.height-We&&He.readPixels(Ce,fe,Re,We,ur.convert(mn),ur.convert(Vn),Wn):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Ln=rt!==null?bt.get(rt).__webglFramebuffer:null;Le.bindFramebuffer(36160,Ln)}}},this.copyFramebufferToTexture=function(Gt,Ce,fe=0){const Re=Math.pow(2,-fe),We=Math.floor(Ce.image.width*Re),Wn=Math.floor(Ce.image.height*Re);let wn=ur.convert(Ce.format);Ie.isWebGL2&&(wn===6407&&(wn=32849),wn===6408&&(wn=32856)),Ht.setTexture2D(Ce,0),He.copyTexImage2D(3553,fe,wn,Gt.x,Gt.y,We,Wn,0),Le.unbindTexture()},this.copyTextureToTexture=function(Gt,Ce,fe,Re=0){const We=Ce.image.width,Wn=Ce.image.height,wn=ur.convert(fe.format),Ze=ur.convert(fe.type);Ht.setTexture2D(fe,0),He.pixelStorei(37440,fe.flipY),He.pixelStorei(37441,fe.premultiplyAlpha),He.pixelStorei(3317,fe.unpackAlignment),Ce.isDataTexture?He.texSubImage2D(3553,Re,Gt.x,Gt.y,We,Wn,wn,Ze,Ce.image.data):Ce.isCompressedTexture?He.compressedTexSubImage2D(3553,Re,Gt.x,Gt.y,Ce.mipmaps[0].width,Ce.mipmaps[0].height,wn,Ce.mipmaps[0].data):He.texSubImage2D(3553,Re,Gt.x,Gt.y,wn,Ze,Ce.image),Re===0&&fe.generateMipmaps&&He.generateMipmap(3553),Le.unbindTexture()},this.copyTextureToTexture3D=function(Gt,Ce,fe,Re,We=0){if(w.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Wn=Gt.max.x-Gt.min.x+1,wn=Gt.max.y-Gt.min.y+1,Ze=Gt.max.z-Gt.min.z+1,Ln=ur.convert(Re.format),mn=ur.convert(Re.type);let Vn;if(Re.isDataTexture3D)Ht.setTexture3D(Re,0),Vn=32879;else{if(!Re.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Ht.setTexture2DArray(Re,0),Vn=35866}He.pixelStorei(37440,Re.flipY),He.pixelStorei(37441,Re.premultiplyAlpha),He.pixelStorei(3317,Re.unpackAlignment);const En=He.getParameter(3314),jn=He.getParameter(32878),Li=He.getParameter(3316),hi=He.getParameter(3315),Xr=He.getParameter(32877),ai=fe.isCompressedTexture?fe.mipmaps[0]:fe.image;He.pixelStorei(3314,ai.width),He.pixelStorei(32878,ai.height),He.pixelStorei(3316,Gt.min.x),He.pixelStorei(3315,Gt.min.y),He.pixelStorei(32877,Gt.min.z),fe.isDataTexture||fe.isDataTexture3D?He.texSubImage3D(Vn,We,Ce.x,Ce.y,Ce.z,Wn,wn,Ze,Ln,mn,ai.data):fe.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),He.compressedTexSubImage3D(Vn,We,Ce.x,Ce.y,Ce.z,Wn,wn,Ze,Ln,ai.data)):He.texSubImage3D(Vn,We,Ce.x,Ce.y,Ce.z,Wn,wn,Ze,Ln,mn,ai),He.pixelStorei(3314,En),He.pixelStorei(32878,jn),He.pixelStorei(3316,Li),He.pixelStorei(3315,hi),He.pixelStorei(32877,Xr),We===0&&Re.generateMipmaps&&He.generateMipmap(Vn),Le.unbindTexture()},this.initTexture=function(Gt){Ht.setTexture2D(Gt,0),Le.unbindTexture()},this.resetState=function(){j=0,Z=0,rt=null,Le.reset(),mr.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends ni{}).prototype.isWebGL1Renderer=!0;class cu extends kn{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),e}}cu.prototype.isScene=!0;class ga{constructor(t,e){this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=V()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,o=this.stride;r<o;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=V()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=V()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}ga.prototype.isInterleavedBuffer=!0;const Pi=new U;class va{constructor(t,e,n,r=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=r===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)Pi.x=this.getX(e),Pi.y=this.getY(e),Pi.z=this.getZ(e),Pi.applyMatrix4(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Pi.x=this.getX(e),Pi.y=this.getY(e),Pi.z=this.getZ(e),Pi.applyNormalMatrix(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Pi.x=this.getX(e),Pi.y=this.getY(e),Pi.z=this.getZ(e),Pi.transformDirection(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,o){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=o,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)e.push(this.data.array[r+o])}return new qn(new this.array.constructor(e),this.itemSize,this.normalized)}return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new va(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)e.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}va.prototype.isInterleavedBufferAttribute=!0;class ep extends Ri{constructor(t){super(),this.type="SpriteMaterial",this.color=new fn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let Ms;ep.prototype.isSpriteMaterial=!0;const _a=new U,Cs=new U,Rs=new U,Is=new R,ya=new R,np=new tn,wl=new U,xa=new U,Al=new U,ip=new R,du=new R,rp=new R;class sy extends kn{constructor(t){if(super(),this.type="Sprite",Ms===void 0){Ms=new Xn;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new ga(e,5);Ms.setIndex([0,1,2,0,2,3]),Ms.setAttribute("position",new va(n,3,0,!1)),Ms.setAttribute("uv",new va(n,2,3,!1))}this.geometry=Ms,this.material=t!==void 0?t:new ep,this.center=new R(.5,.5)}raycast(t,e){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Cs.setFromMatrixScale(this.matrixWorld),np.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Rs.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Cs.multiplyScalar(-Rs.z);const n=this.material.rotation;let r,o;n!==0&&(o=Math.cos(n),r=Math.sin(n));const s=this.center;Ml(wl.set(-.5,-.5,0),Rs,s,Cs,r,o),Ml(xa.set(.5,-.5,0),Rs,s,Cs,r,o),Ml(Al.set(.5,.5,0),Rs,s,Cs,r,o),ip.set(0,0),du.set(1,0),rp.set(1,1);let a=t.ray.intersectTriangle(wl,xa,Al,!1,_a);if(a===null&&(Ml(xa.set(-.5,.5,0),Rs,s,Cs,r,o),du.set(0,1),a=t.ray.intersectTriangle(wl,Al,xa,!1,_a),a===null))return;const l=t.ray.origin.distanceTo(_a);l<t.near||l>t.far||e.push({distance:l,point:_a.clone(),uv:ci.getUV(_a,wl,xa,Al,ip,du,rp,new R),face:null,object:this})}copy(t){return super.copy(t),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}}function Ml(i,t,e,n,r,o){Is.subVectors(i,e).addScalar(.5).multiply(n),r!==void 0?(ya.x=o*Is.x-r*Is.y,ya.y=r*Is.x+o*Is.y):ya.copy(Is),i.copy(t),i.x+=ya.x,i.y+=ya.y,i.applyMatrix4(np)}sy.prototype.isSprite=!0;const op=new U,sp=new Ot,ap=new Ot,ay=new U,lp=new tn;class hp extends Tt{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new tn,this.bindMatrixInverse=new tn}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Ot,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const o=1/t.manhattanLength();o!==1/0?t.multiplyScalar(o):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,r=this.geometry;sp.fromBufferAttribute(r.attributes.skinIndex,t),ap.fromBufferAttribute(r.attributes.skinWeight,t),op.fromBufferAttribute(r.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let o=0;o<4;o++){const s=ap.getComponent(o);if(s!==0){const a=sp.getComponent(o);lp.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),e.addScaledVector(ay.copy(op).applyMatrix4(lp),s)}}return e.applyMatrix4(this.bindMatrixInverse)}}hp.prototype.isSkinnedMesh=!0;class ly extends kn{constructor(){super(),this.type="Bone"}}ly.prototype.isBone=!0;class up extends tt{constructor(t=null,e=1,n=1,r,o,s,a,l,h=1003,u=1003,p,y){super(null,s,a,l,h,u,r,o,p,y),this.image={data:t,width:e,height:n},this.magFilter=h,this.minFilter=u,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}up.prototype.isDataTexture=!0;const cp=new tn,dp=new tn,Cl=[],ba=new Tt;class hy extends Tt{constructor(t,e,n){super(t,e),this.instanceMatrix=new qn(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,r=this.count;if(ba.geometry=this.geometry,ba.material=this.material,ba.material!==void 0)for(let o=0;o<r;o++){this.getMatrixAt(o,cp),dp.multiplyMatrices(n,cp),ba.matrixWorld=dp,ba.raycast(t,Cl);for(let s=0,a=Cl.length;s<a;s++){const l=Cl[s];l.instanceId=o,l.object=this,e.push(l)}Cl.length=0}}setColorAt(t,e){this.instanceColor===null&&(this.instanceColor=new qn(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}hy.prototype.isInstancedMesh=!0;class Ta extends Ri{constructor(t){super(),this.type="LineBasicMaterial",this.color=new fn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this}}Ta.prototype.isLineBasicMaterial=!0;const pp=new U,fp=new U,mp=new tn,pu=new fi,Rl=new Ge;class fu extends kn{constructor(t=new Xn,e=new Ta){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const e=t.attributes.position,n=[0];for(let r=1,o=e.count;r<o;r++)pp.fromBufferAttribute(e,r-1),fp.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=pp.distanceTo(fp);t.setAttribute("lineDistance",new An(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,o=t.params.Line.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Rl.copy(n.boundingSphere),Rl.applyMatrix4(r),Rl.radius+=o,t.ray.intersectsSphere(Rl)===!1)return;mp.copy(r).invert(),pu.copy(t.ray).applyMatrix4(mp);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,h=new U,u=new U,p=new U,y=new U,x=this.isLineSegments?2:1;if(n.isBufferGeometry){const E=n.index,w=n.attributes.position;if(E!==null)for(let C=Math.max(0,s.start),j=Math.min(E.count,s.start+s.count)-1;C<j;C+=x){const Z=E.getX(C),rt=E.getX(C+1);if(h.fromBufferAttribute(w,Z),u.fromBufferAttribute(w,rt),pu.distanceSqToSegment(h,u,y,p)>l)continue;y.applyMatrix4(this.matrixWorld);const ct=t.ray.origin.distanceTo(y);ct<t.near||ct>t.far||e.push({distance:ct,point:p.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}else for(let C=Math.max(0,s.start),j=Math.min(w.count,s.start+s.count)-1;C<j;C+=x){if(h.fromBufferAttribute(w,C),u.fromBufferAttribute(w,C+1),pu.distanceSqToSegment(h,u,y,p)>l)continue;y.applyMatrix4(this.matrixWorld);const Z=t.ray.origin.distanceTo(y);Z<t.near||Z>t.far||e.push({distance:Z,point:p.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}fu.prototype.isLine=!0;const gp=new U,vp=new U;class mu extends fu{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const e=t.attributes.position,n=[];for(let r=0,o=e.count;r<o;r+=2)gp.fromBufferAttribute(e,r),vp.fromBufferAttribute(e,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+gp.distanceTo(vp);t.setAttribute("lineDistance",new An(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}mu.prototype.isLineSegments=!0;class uy extends fu{constructor(t,e){super(t,e),this.type="LineLoop"}}uy.prototype.isLineLoop=!0;class _p extends Ri{constructor(t){super(),this.type="PointsMaterial",this.color=new fn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this}}_p.prototype.isPointsMaterial=!0;const yp=new tn,gu=new fi,Il=new Ge,Pl=new U;class cy extends kn{constructor(t=new Xn,e=new _p){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,o=t.params.Points.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Il.copy(n.boundingSphere),Il.applyMatrix4(r),Il.radius+=o,t.ray.intersectsSphere(Il)===!1)return;yp.copy(r).invert(),gu.copy(t.ray).applyMatrix4(yp);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a;if(n.isBufferGeometry){const h=n.index,u=n.attributes.position;if(h!==null)for(let p=Math.max(0,s.start),y=Math.min(h.count,s.start+s.count);p<y;p++){const x=h.getX(p);Pl.fromBufferAttribute(u,x),xp(Pl,x,l,r,t,e,this)}else for(let p=Math.max(0,s.start),y=Math.min(u.count,s.start+s.count);p<y;p++)Pl.fromBufferAttribute(u,p),xp(Pl,p,l,r,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const r=e[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function xp(i,t,e,n,r,o,s){const a=gu.distanceSqToPoint(i);if(a<e){const l=new U;gu.closestPointToPoint(i,l),l.applyMatrix4(n);const h=r.ray.origin.distanceTo(l);if(h<r.near||h>r.far)return;o.push({distance:h,distanceToRay:Math.sqrt(a),point:l,index:t,face:null,object:s})}}cy.prototype.isPoints=!0,class extends tt{constructor(i,t,e,n,r,o,s,a,l){super(i,t,e,n,r,o,s,a,l),this.format=s!==void 0?s:1022,this.minFilter=o!==void 0?o:1006,this.magFilter=r!==void 0?r:1006,this.generateMipmaps=!1;const h=this;"requestVideoFrameCallback"in i&&i.requestVideoFrameCallback(function u(){h.needsUpdate=!0,i.requestVideoFrameCallback(u)})}clone(){return new this.constructor(this.image).copy(this)}update(){const i=this.image;!("requestVideoFrameCallback"in i)&&i.readyState>=i.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0;class dy extends tt{constructor(t,e,n,r,o,s,a,l,h,u,p,y){super(null,s,a,l,h,u,r,o,p,y),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}dy.prototype.isCompressedTexture=!0,class extends tt{constructor(i,t,e,n,r,o,s,a,l){super(i,t,e,n,r,o,s,a,l),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,class extends tt{constructor(i,t,e,n,r,o,s,a,l,h){if((h=h!==void 0?h:1026)!==1026&&h!==1027)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");e===void 0&&h===1026&&(e=1012),e===void 0&&h===1027&&(e=1020),super(null,n,r,o,s,a,h,e,l),this.image={width:i,height:t},this.magFilter=s!==void 0?s:1003,this.minFilter=a!==void 0?a:1003,this.flipY=!1,this.generateMipmaps=!1}}.prototype.isDepthTexture=!0,new U,new U,new U,new ci;class Nr{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),o=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),o+=n.distanceTo(r),e.push(o),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let r=0;const o=n.length;let s;s=e||t*n[o-1];let a,l=0,h=o-1;for(;l<=h;)if(r=Math.floor(l+(h-l)/2),a=n[r]-s,a<0)l=r+1;else{if(!(a>0)){h=r;break}h=r-1}if(r=h,n[r]===s)return r/(o-1);const u=n[r];return(r+(s-u)/(n[r+1]-u))/(o-1)}getTangent(t,e){let n=t-1e-4,r=t+1e-4;n<0&&(n=0),r>1&&(r=1);const o=this.getPoint(n),s=this.getPoint(r),a=e||(o.isVector2?new R:new U);return a.copy(s).sub(o).normalize(),a}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new U,r=[],o=[],s=[],a=new U,l=new tn;for(let x=0;x<=t;x++){const E=x/t;r[x]=this.getTangentAt(E,new U),r[x].normalize()}o[0]=new U,s[0]=new U;let h=Number.MAX_VALUE;const u=Math.abs(r[0].x),p=Math.abs(r[0].y),y=Math.abs(r[0].z);u<=h&&(h=u,n.set(1,0,0)),p<=h&&(h=p,n.set(0,1,0)),y<=h&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),o[0].crossVectors(r[0],a),s[0].crossVectors(r[0],o[0]);for(let x=1;x<=t;x++){if(o[x]=o[x-1].clone(),s[x]=s[x-1].clone(),a.crossVectors(r[x-1],r[x]),a.length()>Number.EPSILON){a.normalize();const E=Math.acos(et(r[x-1].dot(r[x]),-1,1));o[x].applyMatrix4(l.makeRotationAxis(a,E))}s[x].crossVectors(r[x],o[x])}if(e===!0){let x=Math.acos(et(o[0].dot(o[t]),-1,1));x/=t,r[0].dot(a.crossVectors(o[0],o[t]))>0&&(x=-x);for(let E=1;E<=t;E++)o[E].applyMatrix4(l.makeRotationAxis(r[E],x*E)),s[E].crossVectors(r[E],o[E])}return{tangents:r,normals:o,binormals:s}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Ol extends Nr{constructor(t=0,e=0,n=1,r=1,o=0,s=2*Math.PI,a=!1,l=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=s,this.aClockwise=a,this.aRotation=l}getPoint(t,e){const n=e||new R,r=2*Math.PI;let o=this.aEndAngle-this.aStartAngle;const s=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(o=s?0:r),this.aClockwise!==!0||s||(o===r?o=-r:o-=r);const a=this.aStartAngle+t*o;let l=this.aX+this.xRadius*Math.cos(a),h=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),p=Math.sin(this.aRotation),y=l-this.aX,x=h-this.aY;l=y*u-x*p+this.aX,h=y*p+x*u+this.aY}return n.set(l,h)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}Ol.prototype.isEllipseCurve=!0;class bp extends Ol{constructor(t,e,n,r,o,s){super(t,e,n,n,r,o,s),this.type="ArcCurve"}}function vu(){let i=0,t=0,e=0,n=0;function r(o,s,a,l){i=o,t=a,e=-3*o+3*s-2*a-l,n=2*o-2*s+a+l}return{initCatmullRom:function(o,s,a,l,h){r(s,a,h*(a-o),h*(l-s))},initNonuniformCatmullRom:function(o,s,a,l,h,u,p){let y=(s-o)/h-(a-o)/(h+u)+(a-s)/u,x=(a-s)/u-(l-s)/(u+p)+(l-a)/p;y*=u,x*=u,r(s,a,y,x)},calc:function(o){const s=o*o;return i+t*o+e*s+n*(s*o)}}}bp.prototype.isArcCurve=!0;const Nl=new U,_u=new vu,yu=new vu,xu=new vu;class Tp extends Nr{constructor(t=[],e=!1,n="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t,e=new U){const n=e,r=this.points,o=r.length,s=(o-(this.closed?0:1))*t;let a,l,h=Math.floor(s),u=s-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/o)+1)*o:u===0&&h===o-1&&(h=o-2,u=1),this.closed||h>0?a=r[(h-1)%o]:(Nl.subVectors(r[0],r[1]).add(r[0]),a=Nl);const p=r[h%o],y=r[(h+1)%o];if(this.closed||h+2<o?l=r[(h+2)%o]:(Nl.subVectors(r[o-1],r[o-2]).add(r[o-1]),l=Nl),this.curveType==="centripetal"||this.curveType==="chordal"){const x=this.curveType==="chordal"?.5:.25;let E=Math.pow(a.distanceToSquared(p),x),w=Math.pow(p.distanceToSquared(y),x),C=Math.pow(y.distanceToSquared(l),x);w<1e-4&&(w=1),E<1e-4&&(E=w),C<1e-4&&(C=w),_u.initNonuniformCatmullRom(a.x,p.x,y.x,l.x,E,w,C),yu.initNonuniformCatmullRom(a.y,p.y,y.y,l.y,E,w,C),xu.initNonuniformCatmullRom(a.z,p.z,y.z,l.z,E,w,C)}else this.curveType==="catmullrom"&&(_u.initCatmullRom(a.x,p.x,y.x,l.x,this.tension),yu.initCatmullRom(a.y,p.y,y.y,l.y,this.tension),xu.initCatmullRom(a.z,p.z,y.z,l.z,this.tension));return n.set(_u.calc(u),yu.calc(u),xu.calc(u)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(new U().fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Ep(i,t,e,n,r){const o=.5*(n-t),s=.5*(r-e),a=i*i;return(2*e-2*n+o+s)*(i*a)+(-3*e+3*n-2*o-s)*a+o*i+e}function Ea(i,t,e,n){return function(r,o){const s=1-r;return s*s*o}(i,t)+function(r,o){return 2*(1-r)*r*o}(i,e)+function(r,o){return r*r*o}(i,n)}function Sa(i,t,e,n,r){return function(o,s){const a=1-o;return a*a*a*s}(i,t)+function(o,s){const a=1-o;return 3*a*a*o*s}(i,e)+function(o,s){return 3*(1-o)*o*o*s}(i,n)+function(o,s){return o*o*o*s}(i,r)}Tp.prototype.isCatmullRomCurve3=!0;class bu extends Nr{constructor(t=new R,e=new R,n=new R,r=new R){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new R){const n=e,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(Sa(t,r.x,o.x,s.x,a.x),Sa(t,r.y,o.y,s.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}bu.prototype.isCubicBezierCurve=!0;class Sp extends Nr{constructor(t=new U,e=new U,n=new U,r=new U){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new U){const n=e,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(Sa(t,r.x,o.x,s.x,a.x),Sa(t,r.y,o.y,s.y,a.y),Sa(t,r.z,o.z,s.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Sp.prototype.isCubicBezierCurve3=!0;class Ll extends Nr{constructor(t=new R,e=new R){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new R){const n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new R;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Ll.prototype.isLineCurve=!0;class Tu extends Nr{constructor(t=new R,e=new R,n=new R){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new R){const n=e,r=this.v0,o=this.v1,s=this.v2;return n.set(Ea(t,r.x,o.x,s.x),Ea(t,r.y,o.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Tu.prototype.isQuadraticBezierCurve=!0;class wp extends Nr{constructor(t=new U,e=new U,n=new U){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new U){const n=e,r=this.v0,o=this.v1,s=this.v2;return n.set(Ea(t,r.x,o.x,s.x),Ea(t,r.y,o.y,s.y),Ea(t,r.z,o.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}wp.prototype.isQuadraticBezierCurve3=!0;class Eu extends Nr{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new R){const n=e,r=this.points,o=(r.length-1)*t,s=Math.floor(o),a=o-s,l=r[s===0?s:s-1],h=r[s],u=r[s>r.length-2?r.length-1:s+1],p=r[s>r.length-3?r.length-1:s+2];return n.set(Ep(a,l.x,h.x,u.x,p.x),Ep(a,l.y,h.y,u.y,p.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const r=this.points[e];t.points.push(r.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const r=t.points[e];this.points.push(new R().fromArray(r))}return this}}Eu.prototype.isSplineCurve=!0;var Ap=Object.freeze({__proto__:null,ArcCurve:bp,CatmullRomCurve3:Tp,CubicBezierCurve:bu,CubicBezierCurve3:Sp,EllipseCurve:Ol,LineCurve:Ll,LineCurve3:class extends Nr{constructor(i=new U,t=new U){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=i,this.v2=t}getPoint(i,t=new U){const e=t;return i===1?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(i).add(this.v1)),e}getPointAt(i,t){return this.getPoint(i,t)}copy(i){return super.copy(i),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){const i=super.toJSON();return i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}},QuadraticBezierCurve:Tu,QuadraticBezierCurve3:wp,SplineCurve:Eu});const py=function(i,t,e=2){const n=t&&t.length,r=n?t[0]*e:i.length;let o=Mp(i,0,r,e,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,h,u,p,y,x;if(n&&(o=function(E,w,C,j){const Z=[];let rt,ct,nt,vt,ht;for(rt=0,ct=w.length;rt<ct;rt++)nt=w[rt]*j,vt=rt<ct-1?w[rt+1]*j:E.length,ht=Mp(E,nt,vt,j,!1),ht===ht.next&&(ht.steiner=!0),Z.push(by(ht));for(Z.sort(_y),rt=0;rt<Z.length;rt++)yy(Z[rt],C),C=Do(C,C.next);return C}(i,t,o,e)),i.length>80*e){a=h=i[0],l=u=i[1];for(let E=e;E<r;E+=e)p=i[E],y=i[E+1],p<a&&(a=p),y<l&&(l=y),p>h&&(h=p),y>u&&(u=y);x=Math.max(h-a,u-l),x=x!==0?1/x:0}return wa(o,s,e,a,l,x),s};function Mp(i,t,e,n,r){let o,s;if(r===function(a,l,h,u){let p=0;for(let y=l,x=h-u;y<h;y+=u)p+=(a[x]-a[y])*(a[y+1]+a[x+1]),x=y;return p}(i,t,e,n)>0)for(o=t;o<e;o+=n)s=Ip(o,i[o],i[o+1],s);else for(o=e-n;o>=t;o-=n)s=Ip(o,i[o],i[o+1],s);return s&&Dl(s,s.next)&&(Ma(s),s=s.next),s}function Do(i,t){if(!i)return i;t||(t=i);let e,n=i;do if(e=!1,n.steiner||!Dl(n,n.next)&&yi(n.prev,n,n.next)!==0)n=n.next;else{if(Ma(n),n=t=n.prev,n===n.next)break;e=!0}while(e||n!==t);return t}function wa(i,t,e,n,r,o,s){if(!i)return;!s&&o&&function(u,p,y,x){let E=u;do E.z===null&&(E.z=Su(E.x,E.y,p,y,x)),E.prevZ=E.prev,E.nextZ=E.next,E=E.next;while(E!==u);E.prevZ.nextZ=null,E.prevZ=null,function(w){let C,j,Z,rt,ct,nt,vt,ht,mt=1;do{for(j=w,w=null,ct=null,nt=0;j;){for(nt++,Z=j,vt=0,C=0;C<mt&&(vt++,Z=Z.nextZ,Z);C++);for(ht=mt;vt>0||ht>0&&Z;)vt!==0&&(ht===0||!Z||j.z<=Z.z)?(rt=j,j=j.nextZ,vt--):(rt=Z,Z=Z.nextZ,ht--),ct?ct.nextZ=rt:w=rt,rt.prevZ=ct,ct=rt;j=Z}ct.nextZ=null,mt*=2}while(nt>1)}(E)}(i,n,r,o);let a,l,h=i;for(;i.prev!==i.next;)if(a=i.prev,l=i.next,o?my(i,n,r,o):fy(i))t.push(a.i/e),t.push(i.i/e),t.push(l.i/e),Ma(i),i=l.next,h=l.next;else if((i=l)===h){s?s===1?wa(i=gy(Do(i),t,e),t,e,n,r,o,2):s===2&&vy(i,t,e,n,r,o):wa(Do(i),t,e,n,r,o,1);break}}function fy(i){const t=i.prev,e=i,n=i.next;if(yi(t,e,n)>=0)return!1;let r=i.next.next;for(;r!==i.prev;){if(Ps(t.x,t.y,e.x,e.y,n.x,n.y,r.x,r.y)&&yi(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function my(i,t,e,n){const r=i.prev,o=i,s=i.next;if(yi(r,o,s)>=0)return!1;const a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,h=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,u=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,p=Su(a,l,t,e,n),y=Su(h,u,t,e,n);let x=i.prevZ,E=i.nextZ;for(;x&&x.z>=p&&E&&E.z<=y;){if(x!==i.prev&&x!==i.next&&Ps(r.x,r.y,o.x,o.y,s.x,s.y,x.x,x.y)&&yi(x.prev,x,x.next)>=0||(x=x.prevZ,E!==i.prev&&E!==i.next&&Ps(r.x,r.y,o.x,o.y,s.x,s.y,E.x,E.y)&&yi(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;x&&x.z>=p;){if(x!==i.prev&&x!==i.next&&Ps(r.x,r.y,o.x,o.y,s.x,s.y,x.x,x.y)&&yi(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;E&&E.z<=y;){if(E!==i.prev&&E!==i.next&&Ps(r.x,r.y,o.x,o.y,s.x,s.y,E.x,E.y)&&yi(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function gy(i,t,e){let n=i;do{const r=n.prev,o=n.next.next;!Dl(r,o)&&Cp(r,n,n.next,o)&&Aa(r,o)&&Aa(o,r)&&(t.push(r.i/e),t.push(n.i/e),t.push(o.i/e),Ma(n),Ma(n.next),n=i=o),n=n.next}while(n!==i);return Do(n)}function vy(i,t,e,n,r,o){let s=i;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&Ty(s,a)){let l=Rp(s,a);return s=Do(s,s.next),l=Do(l,l.next),wa(s,t,e,n,r,o),void wa(l,t,e,n,r,o)}a=a.next}s=s.next}while(s!==i)}function _y(i,t){return i.x-t.x}function yy(i,t){if(t=function(e,n){let r=n;const o=e.x,s=e.y;let a,l=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){const E=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(E<=o&&E>l){if(l=E,E===o){if(s===r.y)return r;if(s===r.next.y)return r.next}a=r.x<r.next.x?r:r.next}}r=r.next}while(r!==n);if(!a)return null;if(o===l)return a;const h=a,u=a.x,p=a.y;let y,x=1/0;r=a;do o>=r.x&&r.x>=u&&o!==r.x&&Ps(s<p?o:l,s,u,p,s<p?l:o,s,r.x,r.y)&&(y=Math.abs(s-r.y)/(o-r.x),Aa(r,e)&&(y<x||y===x&&(r.x>a.x||r.x===a.x&&xy(a,r)))&&(a=r,x=y)),r=r.next;while(r!==h);return a}(i,t)){const e=Rp(t,i);Do(t,t.next),Do(e,e.next)}}function xy(i,t){return yi(i.prev,i,t.prev)<0&&yi(t.next,i,i.next)<0}function Su(i,t,e,n,r){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-e)*r)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function by(i){let t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Ps(i,t,e,n,r,o,s,a){return(r-s)*(t-a)-(i-s)*(o-a)>=0&&(i-s)*(n-a)-(e-s)*(t-a)>=0&&(e-s)*(o-a)-(r-s)*(n-a)>=0}function Ty(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(e,n){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==n.i&&r.next.i!==n.i&&Cp(r,r.next,e,n))return!0;r=r.next}while(r!==e);return!1}(i,t)&&(Aa(i,t)&&Aa(t,i)&&function(e,n){let r=e,o=!1;const s=(e.x+n.x)/2,a=(e.y+n.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&s<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(o=!o),r=r.next;while(r!==e);return o}(i,t)&&(yi(i.prev,i,t.prev)||yi(i,t.prev,t))||Dl(i,t)&&yi(i.prev,i,i.next)>0&&yi(t.prev,t,t.next)>0)}function yi(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function Dl(i,t){return i.x===t.x&&i.y===t.y}function Cp(i,t,e,n){const r=Bl(yi(i,t,e)),o=Bl(yi(i,t,n)),s=Bl(yi(e,n,i)),a=Bl(yi(e,n,t));return r!==o&&s!==a||!(r!==0||!Fl(i,e,t))||!(o!==0||!Fl(i,n,t))||!(s!==0||!Fl(e,i,n))||!(a!==0||!Fl(e,t,n))}function Fl(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function Bl(i){return i>0?1:i<0?-1:0}function Aa(i,t){return yi(i.prev,i,i.next)<0?yi(i,t,i.next)>=0&&yi(i,i.prev,t)>=0:yi(i,t,i.prev)<0||yi(i,i.next,t)<0}function Rp(i,t){const e=new wu(i.i,i.x,i.y),n=new wu(t.i,t.x,t.y),r=i.next,o=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,n.next=e,e.prev=n,o.next=n,n.prev=o,n}function Ip(i,t,e,n){const r=new wu(i,t,e);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Ma(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function wu(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Fo{static area(t){const e=t.length;let n=0;for(let r=e-1,o=0;o<e;r=o++)n+=t[r].x*t[o].y-t[o].x*t[r].y;return .5*n}static isClockWise(t){return Fo.area(t)<0}static triangulateShape(t,e){const n=[],r=[],o=[];Pp(t),Op(n,t);let s=t.length;e.forEach(Pp);for(let l=0;l<e.length;l++)r.push(s),s+=e[l].length,Op(n,e[l]);const a=py(n,r);for(let l=0;l<a.length;l+=3)o.push(a.slice(l,l+3));return o}}function Pp(i){const t=i.length;t>2&&i[t-1].equals(i[0])&&i.pop()}function Op(i,t){for(let e=0;e<t.length;e++)i.push(t[e].x),i.push(t[e].y)}class Os extends Xn{constructor(t,e){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],o=[];for(let a=0,l=t.length;a<l;a++)s(t[a]);function s(a){const l=[],h=e.curveSegments!==void 0?e.curveSegments:12,u=e.steps!==void 0?e.steps:1;let p=e.depth!==void 0?e.depth:100,y=e.bevelEnabled===void 0||e.bevelEnabled,x=e.bevelThickness!==void 0?e.bevelThickness:6,E=e.bevelSize!==void 0?e.bevelSize:x-2,w=e.bevelOffset!==void 0?e.bevelOffset:0,C=e.bevelSegments!==void 0?e.bevelSegments:3;const j=e.extrudePath,Z=e.UVGenerator!==void 0?e.UVGenerator:Ey;e.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),p=e.amount);let rt,ct,nt,vt,ht,mt=!1;j&&(rt=j.getSpacedPoints(u),mt=!0,y=!1,ct=j.computeFrenetFrames(u,!1),nt=new U,vt=new U,ht=new U),y||(C=0,x=0,E=0,w=0);const jt=a.extractPoints(h);let Ft=jt.shape;const Mt=jt.holes;if(!Fo.isClockWise(Ft)){Ft=Ft.reverse();for(let ue=0,bt=Mt.length;ue<bt;ue++){const Ht=Mt[ue];Fo.isClockWise(Ht)&&(Mt[ue]=Ht.reverse())}}const wt=Fo.triangulateShape(Ft,Mt),Pt=Ft;for(let ue=0,bt=Mt.length;ue<bt;ue++){const Ht=Mt[ue];Ft=Ft.concat(Ht)}function Nt(ue,bt,Ht){return bt||console.error("THREE.ExtrudeGeometry: vec does not exist"),bt.clone().multiplyScalar(Ht).add(ue)}const ne=Ft.length,$t=wt.length;function zt(ue,bt,Ht){let ie,ae,qt;const ye=ue.x-bt.x,nn=ue.y-bt.y,on=Ht.x-ue.x,rn=Ht.y-ue.y,Sn=ye*ye+nn*nn,Mi=ye*rn-nn*on;if(Math.abs(Mi)>Number.EPSILON){const Kn=Math.sqrt(Sn),fr=Math.sqrt(on*on+rn*rn),tl=bt.x-nn/Kn,el=bt.y+ye/Kn,nl=((Ht.x-rn/fr-tl)*rn-(Ht.y+on/fr-el)*on)/(ye*rn-nn*on);ie=tl+ye*nl-ue.x,ae=el+nn*nl-ue.y;const ur=ie*ie+ae*ae;if(ur<=2)return new R(ie,ae);qt=Math.sqrt(ur/2)}else{let Kn=!1;ye>Number.EPSILON?on>Number.EPSILON&&(Kn=!0):ye<-Number.EPSILON?on<-Number.EPSILON&&(Kn=!0):Math.sign(nn)===Math.sign(rn)&&(Kn=!0),Kn?(ie=-nn,ae=ye,qt=Math.sqrt(Sn)):(ie=ye,ae=nn,qt=Math.sqrt(Sn/2))}return new R(ie/qt,ae/qt)}const Yt=[];for(let ue=0,bt=Pt.length,Ht=bt-1,ie=ue+1;ue<bt;ue++,Ht++,ie++)Ht===bt&&(Ht=0),ie===bt&&(ie=0),Yt[ue]=zt(Pt[ue],Pt[Ht],Pt[ie]);const ge=[];let be,Pe=Yt.concat();for(let ue=0,bt=Mt.length;ue<bt;ue++){const Ht=Mt[ue];be=[];for(let ie=0,ae=Ht.length,qt=ae-1,ye=ie+1;ie<ae;ie++,qt++,ye++)qt===ae&&(qt=0),ye===ae&&(ye=0),be[ie]=zt(Ht[ie],Ht[qt],Ht[ye]);ge.push(be),Pe=Pe.concat(be)}for(let ue=0;ue<C;ue++){const bt=ue/C,Ht=x*Math.cos(bt*Math.PI/2),ie=E*Math.sin(bt*Math.PI/2)+w;for(let ae=0,qt=Pt.length;ae<qt;ae++){const ye=Nt(Pt[ae],Yt[ae],ie);ve(ye.x,ye.y,-Ht)}for(let ae=0,qt=Mt.length;ae<qt;ae++){const ye=Mt[ae];be=ge[ae];for(let nn=0,on=ye.length;nn<on;nn++){const rn=Nt(ye[nn],be[nn],ie);ve(rn.x,rn.y,-Ht)}}}const Ct=E+w;for(let ue=0;ue<ne;ue++){const bt=y?Nt(Ft[ue],Pe[ue],Ct):Ft[ue];mt?(vt.copy(ct.normals[0]).multiplyScalar(bt.x),nt.copy(ct.binormals[0]).multiplyScalar(bt.y),ht.copy(rt[0]).add(vt).add(nt),ve(ht.x,ht.y,ht.z)):ve(bt.x,bt.y,0)}for(let ue=1;ue<=u;ue++)for(let bt=0;bt<ne;bt++){const Ht=y?Nt(Ft[bt],Pe[bt],Ct):Ft[bt];mt?(vt.copy(ct.normals[ue]).multiplyScalar(Ht.x),nt.copy(ct.binormals[ue]).multiplyScalar(Ht.y),ht.copy(rt[ue]).add(vt).add(nt),ve(ht.x,ht.y,ht.z)):ve(Ht.x,Ht.y,p/u*ue)}for(let ue=C-1;ue>=0;ue--){const bt=ue/C,Ht=x*Math.cos(bt*Math.PI/2),ie=E*Math.sin(bt*Math.PI/2)+w;for(let ae=0,qt=Pt.length;ae<qt;ae++){const ye=Nt(Pt[ae],Yt[ae],ie);ve(ye.x,ye.y,p+Ht)}for(let ae=0,qt=Mt.length;ae<qt;ae++){const ye=Mt[ae];be=ge[ae];for(let nn=0,on=ye.length;nn<on;nn++){const rn=Nt(ye[nn],be[nn],ie);mt?ve(rn.x,rn.y+rt[u-1].y,rt[u-1].x+Ht):ve(rn.x,rn.y,p+Ht)}}}function Bt(ue,bt){let Ht=ue.length;for(;--Ht>=0;){const ie=Ht;let ae=Ht-1;ae<0&&(ae=ue.length-1);for(let qt=0,ye=u+2*C;qt<ye;qt++){const nn=ne*qt,on=ne*(qt+1);se(bt+ie+nn,bt+ae+nn,bt+ae+on,bt+ie+on)}}}function ve(ue,bt,Ht){l.push(ue),l.push(bt),l.push(Ht)}function le(ue,bt,Ht){Ie(ue),Ie(bt),Ie(Ht);const ie=r.length/3,ae=Z.generateTopUV(n,r,ie-3,ie-2,ie-1);Le(ae[0]),Le(ae[1]),Le(ae[2])}function se(ue,bt,Ht,ie){Ie(ue),Ie(bt),Ie(ie),Ie(bt),Ie(Ht),Ie(ie);const ae=r.length/3,qt=Z.generateSideWallUV(n,r,ae-6,ae-3,ae-2,ae-1);Le(qt[0]),Le(qt[1]),Le(qt[3]),Le(qt[1]),Le(qt[2]),Le(qt[3])}function Ie(ue){r.push(l[3*ue+0]),r.push(l[3*ue+1]),r.push(l[3*ue+2])}function Le(ue){o.push(ue.x),o.push(ue.y)}(function(){const ue=r.length/3;if(y){let bt=0,Ht=ne*bt;for(let ie=0;ie<$t;ie++){const ae=wt[ie];le(ae[2]+Ht,ae[1]+Ht,ae[0]+Ht)}bt=u+2*C,Ht=ne*bt;for(let ie=0;ie<$t;ie++){const ae=wt[ie];le(ae[0]+Ht,ae[1]+Ht,ae[2]+Ht)}}else{for(let bt=0;bt<$t;bt++){const Ht=wt[bt];le(Ht[2],Ht[1],Ht[0])}for(let bt=0;bt<$t;bt++){const Ht=wt[bt];le(Ht[0]+ne*u,Ht[1]+ne*u,Ht[2]+ne*u)}}n.addGroup(ue,r.length/3-ue,0)})(),function(){const ue=r.length/3;let bt=0;Bt(Pt,bt),bt+=Pt.length;for(let Ht=0,ie=Mt.length;Ht<ie;Ht++){const ae=Mt[Ht];Bt(ae,bt),bt+=ae.length}n.addGroup(ue,r.length/3-ue,1)}()}this.setAttribute("position",new An(r,3)),this.setAttribute("uv",new An(o,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(e,n,r){if(r.shapes=[],Array.isArray(e))for(let o=0,s=e.length;o<s;o++){const a=e[o];r.shapes.push(a.uuid)}else r.shapes.push(e.uuid);return n.extrudePath!==void 0&&(r.options.extrudePath=n.extrudePath.toJSON()),r}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let o=0,s=t.shapes.length;o<s;o++){const a=e[t.shapes[o]];n.push(a)}const r=t.options.extrudePath;return r!==void 0&&(t.options.extrudePath=new Ap[r.type]().fromJSON(r)),new Os(n,t.options)}}const Ey={generateTopUV:function(i,t,e,n,r){const o=t[3*e],s=t[3*e+1],a=t[3*n],l=t[3*n+1],h=t[3*r],u=t[3*r+1];return[new R(o,s),new R(a,l),new R(h,u)]},generateSideWallUV:function(i,t,e,n,r,o){const s=t[3*e],a=t[3*e+1],l=t[3*e+2],h=t[3*n],u=t[3*n+1],p=t[3*n+2],y=t[3*r],x=t[3*r+1],E=t[3*r+2],w=t[3*o],C=t[3*o+1],j=t[3*o+2];return Math.abs(a-u)<Math.abs(s-h)?[new R(s,1-l),new R(h,1-p),new R(y,1-E),new R(w,1-j)]:[new R(a,1-l),new R(u,1-p),new R(x,1-E),new R(C,1-j)]}};class Au extends Xn{constructor(t,e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],o=[],s=[];let a=0,l=0;if(Array.isArray(t)===!1)h(t);else for(let u=0;u<t.length;u++)h(t[u]),this.addGroup(a,l,u),a+=l,l=0;function h(u){const p=r.length/3,y=u.extractPoints(e);let x=y.shape;const E=y.holes;Fo.isClockWise(x)===!1&&(x=x.reverse());for(let C=0,j=E.length;C<j;C++){const Z=E[C];Fo.isClockWise(Z)===!0&&(E[C]=Z.reverse())}const w=Fo.triangulateShape(x,E);for(let C=0,j=E.length;C<j;C++){const Z=E[C];x=x.concat(Z)}for(let C=0,j=x.length;C<j;C++){const Z=x[C];r.push(Z.x,Z.y,0),o.push(0,0,1),s.push(Z.x,Z.y)}for(let C=0,j=w.length;C<j;C++){const Z=w[C],rt=Z[0]+p,ct=Z[1]+p,nt=Z[2]+p;n.push(rt,ct,nt),l+=3}}this.setIndex(n),this.setAttribute("position",new An(r,3)),this.setAttribute("normal",new An(o,3)),this.setAttribute("uv",new An(s,2))}toJSON(){const t=super.toJSON();return function(e,n){if(n.shapes=[],Array.isArray(e))for(let r=0,o=e.length;r<o;r++){const s=e[r];n.shapes.push(s.uuid)}else n.shapes.push(e.uuid);return n}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let r=0,o=t.shapes.length;r<o;r++){const s=e[t.shapes[r]];n.push(s)}return new Au(n,t.curveSegments)}}class Sy extends Ri{constructor(t){super(),this.type="ShadowMaterial",this.color=new fn(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}Sy.prototype.isShadowMaterial=!0;class wy extends hn{constructor(t){super(t),this.type="RawShaderMaterial"}}wy.prototype.isRawShaderMaterial=!0;class Np extends Ri{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new fn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new R(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this}}Np.prototype.isMeshStandardMaterial=!0;class Ay extends Np{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new R(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=et(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new fn(1,1,1),this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new fn).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this}}Ay.prototype.isMeshPhysicalMaterial=!0;class Lp extends Ri{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new fn(16777215),this.specular=new fn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new R(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}Lp.prototype.isMeshPhongMaterial=!0;class My extends Ri{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new fn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new R(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}My.prototype.isMeshToonMaterial=!0;class Cy extends Ri{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new R(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}Cy.prototype.isMeshNormalMaterial=!0;class Ry extends Ri{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}Ry.prototype.isMeshLambertMaterial=!0;class Iy extends Ri{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new fn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new R(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}Iy.prototype.isMeshMatcapMaterial=!0;class Py extends Ta{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}Py.prototype.isLineDashedMaterial=!0;const di={arraySlice:function(i,t,e){return di.isTypedArray(i)?new i.constructor(i.subarray(t,e!==void 0?e:i.length)):i.slice(t,e)},convertArray:function(i,t,e){return!i||!e&&i.constructor===t?i:typeof t.BYTES_PER_ELEMENT=="number"?new t(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){const t=i.length,e=new Array(t);for(let n=0;n!==t;++n)e[n]=n;return e.sort(function(n,r){return i[n]-i[r]}),e},sortedArray:function(i,t,e){const n=i.length,r=new i.constructor(n);for(let o=0,s=0;s!==n;++o){const a=e[o]*t;for(let l=0;l!==t;++l)r[s++]=i[a+l]}return r},flattenJSON:function(i,t,e,n){let r=1,o=i[0];for(;o!==void 0&&o[n]===void 0;)o=i[r++];if(o===void 0)return;let s=o[n];if(s!==void 0)if(Array.isArray(s))do s=o[n],s!==void 0&&(t.push(o.time),e.push.apply(e,s)),o=i[r++];while(o!==void 0);else if(s.toArray!==void 0)do s=o[n],s!==void 0&&(t.push(o.time),s.toArray(e,e.length)),o=i[r++];while(o!==void 0);else do s=o[n],s!==void 0&&(t.push(o.time),e.push(s)),o=i[r++];while(o!==void 0)},subclip:function(i,t,e,n,r=30){const o=i.clone();o.name=t;const s=[];for(let l=0;l<o.tracks.length;++l){const h=o.tracks[l],u=h.getValueSize(),p=[],y=[];for(let x=0;x<h.times.length;++x){const E=h.times[x]*r;if(!(E<e||E>=n)){p.push(h.times[x]);for(let w=0;w<u;++w)y.push(h.values[x*u+w])}}p.length!==0&&(h.times=di.convertArray(p,h.times.constructor),h.values=di.convertArray(y,h.values.constructor),s.push(h))}o.tracks=s;let a=1/0;for(let l=0;l<o.tracks.length;++l)a>o.tracks[l].times[0]&&(a=o.tracks[l].times[0]);for(let l=0;l<o.tracks.length;++l)o.tracks[l].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(i,t=0,e=i,n=30){n<=0&&(n=30);const r=e.tracks.length,o=t/n;for(let s=0;s<r;++s){const a=e.tracks[s],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const h=i.tracks.find(function(j){return j.name===a.name&&j.ValueTypeName===l});if(h===void 0)continue;let u=0;const p=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=p/3);let y=0;const x=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=x/3);const E=a.times.length-1;let w;if(o<=a.times[0]){const j=u,Z=p-u;w=di.arraySlice(a.values,j,Z)}else if(o>=a.times[E]){const j=E*p+u,Z=j+p-u;w=di.arraySlice(a.values,j,Z)}else{const j=a.createInterpolant(),Z=u,rt=p-u;j.evaluate(o),w=di.arraySlice(j.resultBuffer,Z,rt)}l==="quaternion"&&new z().fromArray(w).normalize().conjugate().toArray(w);const C=h.times.length;for(let j=0;j<C;++j){const Z=j*x+y;if(l==="quaternion")z.multiplyQuaternionsFlat(h.values,Z,w,0,h.values,Z);else{const rt=x-2*y;for(let ct=0;ct<rt;++ct)h.values[Z+ct]-=w[ct]}}}return i.blendMode=2501,i}};class Bo{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],o=e[n-1];t:{e:{let s;n:{i:if(!(t<r)){for(let a=n+2;;){if(r===void 0){if(t<o)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,o)}if(n===a)break;if(o=r,r=e[++n],t<r)break e}s=e.length;break n}if(t>=o)break t;{const a=e[1];t<a&&(n=2,o=a);for(let l=n-2;;){if(o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===l)break;if(r=o,o=e[--n-1],t>=o)break e}s=n,n=0}}for(;n<s;){const a=n+s>>>1;t<e[a]?s=a:n=a+1}if(r=e[n],o=e[n-1],o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(r===void 0)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,o,t)}this._cachedIndex=n,this.intervalChanged_(n,o,r)}return this.interpolate_(n,o,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=t*r;for(let s=0;s!==r;++s)e[s]=n[o+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Bo.prototype.beforeStart_=Bo.prototype.copySampleValue_,Bo.prototype.afterEnd_=Bo.prototype.copySampleValue_;class Oy extends Bo{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(t,e,n){const r=this.parameterPositions;let o=t-2,s=t+1,a=r[o],l=r[s];if(a===void 0)switch(this.getSettings_().endingStart){case 2401:o=t,a=2*e-n;break;case 2402:o=r.length-2,a=e+r[o]-r[o+1];break;default:o=t,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case 2401:s=t,l=2*n-e;break;case 2402:s=1,l=n+r[1]-r[0];break;default:s=t-1,l=e}const h=.5*(n-e),u=this.valueSize;this._weightPrev=h/(e-a),this._weightNext=h/(l-n),this._offsetPrev=o*u,this._offsetNext=s*u}interpolate_(t,e,n,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=t*a,h=l-a,u=this._offsetPrev,p=this._offsetNext,y=this._weightPrev,x=this._weightNext,E=(n-e)/(r-e),w=E*E,C=w*E,j=-y*C+2*y*w-y*E,Z=(1+y)*C+(-1.5-2*y)*w+(-.5+y)*E+1,rt=(-1-x)*C+(1.5+x)*w+.5*E,ct=x*C-x*w;for(let nt=0;nt!==a;++nt)o[nt]=j*s[u+nt]+Z*s[h+nt]+rt*s[l+nt]+ct*s[p+nt];return o}}class Dp extends Bo{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=t*a,h=l-a,u=(n-e)/(r-e),p=1-u;for(let y=0;y!==a;++y)o[y]=s[h+y]*p+s[l+y]*u;return o}}class Ny extends Bo{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class Jr{constructor(t,e,n,r){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=di.convertArray(e,this.TimeBufferType),this.values=di.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:di.convertArray(t.times,Array),values:di.convertArray(t.values,Array)};const r=t.getInterpolation();r!==t.DefaultInterpolation&&(n.interpolation=r)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new Ny(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Dp(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Oy(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(e===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(t!==1){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let o=0,s=r-1;for(;o!==r&&n[o]<t;)++o;for(;s!==-1&&n[s]>e;)--s;if(++s,o!==0||s!==r){o>=s&&(s=Math.max(s,1),o=s-1);const a=this.getValueSize();this.times=di.arraySlice(n,o,s),this.values=di.arraySlice(this.values,o*a,s*a)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,o=n.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let a=0;a!==o;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),t=!1;break}if(s!==null&&s>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,s),t=!1;break}s=l}if(r!==void 0&&di.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){const h=r[a];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,h),t=!1;break}}return t}optimize(){const t=di.arraySlice(this.times),e=di.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===2302,o=t.length-1;let s=1;for(let a=1;a<o;++a){let l=!1;const h=t[a];if(h!==t[a+1]&&(a!==1||h!==t[0]))if(r)l=!0;else{const u=a*n,p=u-n,y=u+n;for(let x=0;x!==n;++x){const E=e[u+x];if(E!==e[p+x]||E!==e[y+x]){l=!0;break}}}if(l){if(a!==s){t[s]=t[a];const u=a*n,p=s*n;for(let y=0;y!==n;++y)e[p+y]=e[u+y]}++s}}if(o>0){t[s]=t[o];for(let a=o*n,l=s*n,h=0;h!==n;++h)e[l+h]=e[a+h];++s}return s!==t.length?(this.times=di.arraySlice(t,0,s),this.values=di.arraySlice(e,0,s*n)):(this.times=t,this.values=e),this}clone(){const t=di.arraySlice(this.times,0),e=di.arraySlice(this.values,0),n=new this.constructor(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}Jr.prototype.TimeBufferType=Float32Array,Jr.prototype.ValueBufferType=Float32Array,Jr.prototype.DefaultInterpolation=2301;class Ns extends Jr{}Ns.prototype.ValueTypeName="bool",Ns.prototype.ValueBufferType=Array,Ns.prototype.DefaultInterpolation=2300,Ns.prototype.InterpolantFactoryMethodLinear=void 0,Ns.prototype.InterpolantFactoryMethodSmooth=void 0;class Fp extends Jr{}Fp.prototype.ValueTypeName="color";class Ul extends Jr{}Ul.prototype.ValueTypeName="number";class Ly extends Bo{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=(n-e)/(r-e);let h=t*a;for(let u=h+a;h!==u;h+=4)z.slerpFlat(o,0,s,h-a,s,h,l);return o}}class Ca extends Jr{InterpolantFactoryMethodLinear(t){return new Ly(this.times,this.values,this.getValueSize(),t)}}Ca.prototype.ValueTypeName="quaternion",Ca.prototype.DefaultInterpolation=2301,Ca.prototype.InterpolantFactoryMethodSmooth=void 0;class Ls extends Jr{}Ls.prototype.ValueTypeName="string",Ls.prototype.ValueBufferType=Array,Ls.prototype.DefaultInterpolation=2300,Ls.prototype.InterpolantFactoryMethodLinear=void 0,Ls.prototype.InterpolantFactoryMethodSmooth=void 0;class kl extends Jr{}kl.prototype.ValueTypeName="vector";class Bp{constructor(t,e=-1,n,r=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=V(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let s=0,a=n.length;s!==a;++s)e.push(Dy(n[s]).scale(r));const o=new this(t.name,t.duration,e,t.blendMode);return o.uuid=t.uuid,o}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let o=0,s=n.length;o!==s;++o)e.push(Jr.toJSON(n[o]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const o=e.length,s=[];for(let a=0;a<o;a++){let l=[],h=[];l.push((a+o-1)%o,a,(a+1)%o),h.push(0,1,0);const u=di.getKeyframeOrder(l);l=di.sortedArray(l,1,u),h=di.sortedArray(h,1,u),r||l[0]!==0||(l.push(o),h.push(h[0])),s.push(new Ul(".morphTargetInfluences["+e[a].name+"]",l,h).scale(1/n))}return new this(t,-1,s)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const r=t;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,l=t.length;a<l;a++){const h=t[a],u=h.name.match(o);if(u&&u.length>1){const p=u[1];let y=r[p];y||(r[p]=y=[]),y.push(h)}}const s=[];for(const a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],e,n));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(u,p,y,x,E){if(y.length!==0){const w=[],C=[];di.flattenJSON(y,w,C,x),w.length!==0&&E.push(new u(p,w,C))}},r=[],o=t.name||"default",s=t.fps||30,a=t.blendMode;let l=t.length||-1;const h=t.hierarchy||[];for(let u=0;u<h.length;u++){const p=h[u].keys;if(p&&p.length!==0)if(p[0].morphTargets){const y={};let x;for(x=0;x<p.length;x++)if(p[x].morphTargets)for(let E=0;E<p[x].morphTargets.length;E++)y[p[x].morphTargets[E]]=-1;for(const E in y){const w=[],C=[];for(let j=0;j!==p[x].morphTargets.length;++j){const Z=p[x];w.push(Z.time),C.push(Z.morphTarget===E?1:0)}r.push(new Ul(".morphTargetInfluence["+E+"]",w,C))}l=y.length*(s||1)}else{const y=".bones["+e[u].name+"]";n(kl,y+".position",p,"pos",r),n(Ca,y+".quaternion",p,"rot",r),n(kl,y+".scale",p,"scl",r)}}return r.length===0?null:new this(o,l,r,a)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Dy(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ul;case"vector":case"vector2":case"vector3":case"vector4":return kl;case"color":return Fp;case"quaternion":return Ca;case"bool":case"boolean":return Ns;case"string":return Ls}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(i.type);if(i.times===void 0){const e=[],n=[];di.flattenJSON(i.keys,e,n,"value"),i.times=e,i.values=n}return t.parse!==void 0?t.parse(i):new t(i.name,i.times,i.values,i.interpolation)}const Ds={enabled:!1,files:{},add:function(i,t){this.enabled!==!1&&(this.files[i]=t)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class Fy{constructor(t,e,n){const r=this;let o=!1,s=0,a=0,l;const h=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(u){a++,o===!1&&r.onStart!==void 0&&r.onStart(u,s,a),o=!0},this.itemEnd=function(u){s++,r.onProgress!==void 0&&r.onProgress(u,s,a),s===a&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,p){return h.push(u,p),this},this.removeHandler=function(u){const p=h.indexOf(u);return p!==-1&&h.splice(p,2),this},this.getHandler=function(u){for(let p=0,y=h.length;p<y;p+=2){const x=h[p],E=h[p+1];if(x.global&&(x.lastIndex=0),x.test(u))return E}return null}}}const By=new Fy;class Uo{constructor(t){this.manager=t!==void 0?t:By,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(r,o){n.load(t,r,e,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Gr={};class Uy extends Uo{constructor(t){super(t)}load(t,e,n,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const o=this,s=Ds.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){e&&e(s),o.manager.itemEnd(t)},0),s;if(Gr[t]!==void 0)return void Gr[t].push({onLoad:e,onProgress:n,onError:r});const a=t.match(/^data:(.*?)(;base64)?,(.*)$/);let l;if(a){const h=a[1],u=!!a[2];let p=a[3];p=decodeURIComponent(p),u&&(p=atob(p));try{let y;const x=(this.responseType||"").toLowerCase();switch(x){case"arraybuffer":case"blob":const E=new Uint8Array(p.length);for(let C=0;C<p.length;C++)E[C]=p.charCodeAt(C);y=x==="blob"?new Blob([E.buffer],{type:h}):E.buffer;break;case"document":y=new DOMParser().parseFromString(p,h);break;case"json":y=JSON.parse(p);break;default:y=p}setTimeout(function(){e&&e(y),o.manager.itemEnd(t)},0)}catch(y){setTimeout(function(){r&&r(y),o.manager.itemError(t),o.manager.itemEnd(t)},0)}}else{Gr[t]=[],Gr[t].push({onLoad:e,onProgress:n,onError:r}),l=new XMLHttpRequest,l.open("GET",t,!0),l.addEventListener("load",function(h){const u=this.response,p=Gr[t];if(delete Gr[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ds.add(t,u);for(let y=0,x=p.length;y<x;y++){const E=p[y];E.onLoad&&E.onLoad(u)}o.manager.itemEnd(t)}else{for(let y=0,x=p.length;y<x;y++){const E=p[y];E.onError&&E.onError(h)}o.manager.itemError(t),o.manager.itemEnd(t)}},!1),l.addEventListener("progress",function(h){const u=Gr[t];for(let p=0,y=u.length;p<y;p++){const x=u[p];x.onProgress&&x.onProgress(h)}},!1),l.addEventListener("error",function(h){const u=Gr[t];delete Gr[t];for(let p=0,y=u.length;p<y;p++){const x=u[p];x.onError&&x.onError(h)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),l.addEventListener("abort",function(h){const u=Gr[t];delete Gr[t];for(let p=0,y=u.length;p<y;p++){const x=u[p];x.onError&&x.onError(h)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),this.responseType!==void 0&&(l.responseType=this.responseType),this.withCredentials!==void 0&&(l.withCredentials=this.withCredentials),l.overrideMimeType&&l.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const h in this.requestHeader)l.setRequestHeader(h,this.requestHeader[h]);l.send(null)}return o.manager.itemStart(t),l}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class Up extends Uo{constructor(t){super(t)}load(t,e,n,r){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const o=this,s=Ds.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){e&&e(s),o.manager.itemEnd(t)},0),s;const a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function l(){a.removeEventListener("load",l,!1),a.removeEventListener("error",h,!1),Ds.add(t,this),e&&e(this),o.manager.itemEnd(t)}function h(u){a.removeEventListener("load",l,!1),a.removeEventListener("error",h,!1),r&&r(u),o.manager.itemError(t),o.manager.itemEnd(t)}return a.addEventListener("load",l,!1),a.addEventListener("error",h,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(t),a.src=t,a}}class ky extends Uo{constructor(t){super(t)}load(t,e,n,r){const o=new gi,s=new Up(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function l(h){s.load(t[h],function(u){o.images[h]=u,a++,a===6&&(o.needsUpdate=!0,e&&e(o))},void 0,r)}for(let h=0;h<t.length;++h)l(h);return o}}class Gy extends Uo{constructor(t){super(t)}load(t,e,n,r){const o=new tt,s=new Up(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(a){o.image=a;const l=t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0;o.format=l?1022:1023,o.needsUpdate=!0,e!==void 0&&e(o)},n,r),o}}class Hy extends Nr{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Ll(e,t))}getPoint(t){const e=t*this.getLength(),n=this.getCurveLengths();let r=0;for(;r<n.length;){if(n[r]>=e){const o=n[r]-e,s=this.curves[r],a=s.getLength(),l=a===0?0:1-o/a;return s.getPointAt(l)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let r=0,o=this.curves;r<o.length;r++){const s=o[r],a=s&&s.isEllipseCurve?2*t:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t,l=s.getPoints(a);for(let h=0;h<l.length;h++){const u=l[h];n&&n.equals(u)||(e.push(u),n=u)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const r=this.curves[e];t.curves.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const r=t.curves[e];this.curves.push(new Ap[r.type]().fromJSON(r))}return this}}class Fs extends Hy{constructor(t){super(),this.type="Path",this.currentPoint=new R,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Ll(this.currentPoint.clone(),new R(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){const o=new Tu(this.currentPoint.clone(),new R(t,e),new R(n,r));return this.curves.push(o),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,o,s){const a=new bu(this.currentPoint.clone(),new R(t,e),new R(n,r),new R(o,s));return this.curves.push(a),this.currentPoint.set(o,s),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new Eu(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,o,s){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(t+a,e+l,n,r,o,s),this}absarc(t,e,n,r,o,s){return this.absellipse(t,e,n,n,r,o,s),this}ellipse(t,e,n,r,o,s,a,l){const h=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+h,e+u,n,r,o,s,a,l),this}absellipse(t,e,n,r,o,s,a,l){const h=new Ol(t,e,n,r,o,s,a,l);if(this.curves.length>0){const p=h.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(h);const u=h.getPoint(1);return this.currentPoint.copy(u),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Mu extends Fs{constructor(t){super(t),this.uuid=V(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const r=t.holes[e];this.holes.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const r=this.holes[e];t.holes.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const r=t.holes[e];this.holes.push(new Fs().fromJSON(r))}return this}}class Kr extends kn{constructor(t,e=1){super(),this.type="Light",this.color=new fn(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}}Kr.prototype.isLight=!0;class jy extends Kr{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.groundColor=new fn(e)}copy(t){return Kr.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}jy.prototype.isHemisphereLight=!0;const kp=new tn,Gp=new U,Hp=new U;class Cu{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new R(512,512),this.map=null,this.mapPass=null,this.matrix=new tn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new kr,this._frameExtents=new R(1,1),this._viewportCount=1,this._viewports=[new Ot(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;Gp.setFromMatrixPosition(t.matrixWorld),e.position.copy(Gp),Hp.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Hp),e.updateMatrixWorld(),kp.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(kp),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class jp extends Cu{constructor(){super(new un(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,n=2*X*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=t.distance||e.far;n===e.fov&&r===e.aspect&&o===e.far||(e.fov=n,e.aspect=r,e.far=o,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}jp.prototype.isSpotLightShadow=!0;class zy extends Kr{constructor(t,e,n=0,r=Math.PI/3,o=0,s=1){super(t,e),this.type="SpotLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.target=new kn,this.distance=n,this.angle=r,this.penumbra=o,this.decay=s,this.shadow=new jp}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}zy.prototype.isSpotLight=!0;const zp=new tn,Ra=new U,Ru=new U;class Vp extends Cu{constructor(){super(new un(90,1,.5,500)),this._frameExtents=new R(4,2),this._viewportCount=6,this._viewports=[new Ot(2,1,1,1),new Ot(0,1,1,1),new Ot(3,1,1,1),new Ot(1,1,1,1),new Ot(3,0,1,1),new Ot(1,0,1,1)],this._cubeDirections=[new U(1,0,0),new U(-1,0,0),new U(0,0,1),new U(0,0,-1),new U(0,1,0),new U(0,-1,0)],this._cubeUps=[new U(0,1,0),new U(0,1,0),new U(0,1,0),new U(0,1,0),new U(0,0,1),new U(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,o=t.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),Ra.setFromMatrixPosition(t.matrixWorld),n.position.copy(Ra),Ru.copy(n.position),Ru.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(Ru),n.updateMatrixWorld(),r.makeTranslation(-Ra.x,-Ra.y,-Ra.z),zp.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zp)}}Vp.prototype.isPointLightShadow=!0;class Vy extends Kr{constructor(t,e,n=0,r=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Vp}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}Vy.prototype.isPointLight=!0;class Iu extends vn{constructor(t=-1,e=1,n=1,r=-1,o=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,o,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=n-t,s=n+t,a=r+e,l=r-e;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=h*this.view.offsetX,s=o+h*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}}Iu.prototype.isOrthographicCamera=!0;class Wp extends Cu{constructor(){super(new Iu(-5,5,5,-5,.5,500))}}Wp.prototype.isDirectionalLightShadow=!0;class Wy extends Kr{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.target=new kn,this.shadow=new Wp}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}Wy.prototype.isDirectionalLight=!0;class Xy extends Kr{constructor(t,e){super(t,e),this.type="AmbientLight"}}Xy.prototype.isAmbientLight=!0;class Yy extends Kr{constructor(t,e,n=10,r=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=r}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}Yy.prototype.isRectAreaLight=!0;class Xp{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new U)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,o=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*r),e.addScaledVector(s[2],.488603*o),e.addScaledVector(s[3],.488603*n),e.addScaledVector(s[4],n*r*1.092548),e.addScaledVector(s[5],r*o*1.092548),e.addScaledVector(s[6],.315392*(3*o*o-1)),e.addScaledVector(s[7],n*o*1.092548),e.addScaledVector(s[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,o=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*r),e.addScaledVector(s[2],1.023328*o),e.addScaledVector(s[3],1.023328*n),e.addScaledVector(s[4],.858086*n*r),e.addScaledVector(s[5],.858086*r*o),e.addScaledVector(s[6],.743125*o*o-.247708),e.addScaledVector(s[7],.858086*n*o),e.addScaledVector(s[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this}toArray(t=[],e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}static getBasisAt(t,e){const n=t.x,r=t.y,o=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*o,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*o,e[6]=.315392*(3*o*o-1),e[7]=1.092548*n*o,e[8]=.546274*(n*n-r*r)}}Xp.prototype.isSphericalHarmonics3=!0;class Pu extends Kr{constructor(t=new Xp,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}Pu.prototype.isLightProbe=!0;class qy{static decodeText(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch{return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return e===-1?"./":t.substr(0,e+1)}}class Jy extends Xn{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}Jy.prototype.isInstancedBufferGeometry=!0;class Ky extends qn{constructor(t,e,n,r=1){typeof n=="number"&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}Ky.prototype.isInstancedBufferAttribute=!0,class extends Uo{constructor(i){super(i),typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(i){return this.options=i,this}load(i,t,e,n){i===void 0&&(i=""),this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);const r=this,o=Ds.get(i);if(o!==void 0)return r.manager.itemStart(i),setTimeout(function(){t&&t(o),r.manager.itemEnd(i)},0),o;const s={};s.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",s.headers=this.requestHeader,fetch(i,s).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(a){Ds.add(i,a),t&&t(a),r.manager.itemEnd(i)}).catch(function(a){n&&n(a),r.manager.itemError(i),r.manager.itemEnd(i)}),r.manager.itemStart(i)}}.prototype.isImageBitmapLoader=!0;let Ou;const Zy=function(){return Ou===void 0&&(Ou=new(window.AudioContext||window.webkitAudioContext)),Ou};class Qy extends Uo{constructor(t){super(t)}load(t,e,n,r){const o=this,s=new Uy(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(a){try{const l=a.slice(0);Zy().decodeAudioData(l,function(h){e(h)})}catch(l){r?r(l):console.error(l),o.manager.itemError(t)}},n,r)}}(class extends Pu{constructor(i,t,e=1){super(void 0,e);const n=new fn().set(i),r=new fn().set(t),o=new U(n.r,n.g,n.b),s=new U(r.r,r.g,r.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(s).multiplyScalar(a),this.sh.coefficients[1].copy(o).sub(s).multiplyScalar(l)}}).prototype.isHemisphereLightProbe=!0,class extends Pu{constructor(i,t=1){super(void 0,t);const e=new fn().set(i);this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class $y extends kn{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),this._connected===!0?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl!==!1)return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(this.hasPlaybackControl!==!1)return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}class tx{constructor(t,e,n){let r,o,s;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,o=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,o=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,o=t*r+r;let s=this.cumulativeWeight;if(s===0){for(let a=0;a!==r;++a)n[o+a]=n[a];s=e}else{s+=e;const a=e/s;this._mixBufferRegion(n,o,0,a,r)}this.cumulativeWeight=s}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,o=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const l=e*this._origIndex;this._mixBufferRegion(n,r,l,1-o,e)}s>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let l=e,h=e+e;l!==h;++l)if(n[l]!==n[l+e]){a.setValue(n,r);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let o=n,s=r;o!==s;++o)e[o]=e[r+o%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,o){if(r>=.5)for(let s=0;s!==o;++s)t[e+s]=t[n+s]}_slerp(t,e,n,r){z.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,o){const s=this._workIndex*o;z.multiplyQuaternionsFlat(t,s,t,e,t,n),z.slerpFlat(t,e,t,e,t,s,r)}_lerp(t,e,n,r,o){const s=1-r;for(let a=0;a!==o;++a){const l=e+a;t[l]=t[l]*s+t[n+a]*r}}_lerpAdditive(t,e,n,r,o){for(let s=0;s!==o;++s){const a=e+s;t[a]=t[a]+t[n+s]*r}}}const ex=new RegExp("[\\[\\]\\.:\\/]","g"),nx="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",ix=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),rx=/(WCOD+)?/.source.replace("WCOD",nx),ox=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),sx=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),ax=new RegExp("^"+ix+rx+ox+sx+"$"),lx=["material","materials","bones"];class ti{constructor(t,e,n){this.path=e,this.parsedPath=n||ti.parseTrackName(e),this.node=ti.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new ti.Composite(t,e,n):new ti(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(ex,"")}static parseTrackName(t){const e=ax.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const o=n.nodeName.substring(r+1);lx.indexOf(o)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=o)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(n!==void 0)return n}if(t.children){const n=function(o){for(let s=0;s<o.length;s++){const a=o[s];if(a.name===e||a.uuid===e)return a;const l=n(a.children);if(l)return l}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.node[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let o=e.propertyIndex;if(t||(t=ti.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let h=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===h){h=u;break}break;default:if(t[n]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(h!==void 0){if(t[h]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[h]}}const s=t[r];if(s===void 0){const h=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",t)}let a=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(o!==void 0){if(r==="morphTargetInfluences"){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=o}else s.fromArray!==void 0&&s.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ti.Composite=class{constructor(i,t,e){const n=e||ti.parseTrackName(t);this._targetGroup=i,this._bindings=i.subscribe_(t,n)}getValue(i,t){this.bind();const e=this._targetGroup.nCachedObjects_,n=this._bindings[e];n!==void 0&&n.getValue(i,t)}setValue(i,t){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].setValue(i,t)}bind(){const i=this._bindings;for(let t=this._targetGroup.nCachedObjects_,e=i.length;t!==e;++t)i[t].bind()}unbind(){const i=this._bindings;for(let t=this._targetGroup.nCachedObjects_,e=i.length;t!==e;++t)i[t].unbind()}},ti.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ti.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ti.prototype.GetterByBindingType=[ti.prototype._getValue_direct,ti.prototype._getValue_array,ti.prototype._getValue_arrayElement,ti.prototype._getValue_toArray],ti.prototype.SetterByBindingTypeAndVersioning=[[ti.prototype._setValue_direct,ti.prototype._setValue_direct_setNeedsUpdate,ti.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ti.prototype._setValue_array,ti.prototype._setValue_array_setNeedsUpdate,ti.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ti.prototype._setValue_arrayElement,ti.prototype._setValue_arrayElement_setNeedsUpdate,ti.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ti.prototype._setValue_fromArray,ti.prototype._setValue_fromArray_setNeedsUpdate,ti.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class hx{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const o=e.tracks,s=o.length,a=new Array(s),l={endingStart:2400,endingEnd:2400};for(let h=0;h!==s;++h){const u=o[h].createInterpolant(null);a[h]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const r=this._clip.duration,o=t._clip.duration,s=o/r,a=r/o;t.warp(1,s,e),this.warp(a,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,o=r.time,s=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,h=a.sampleValues;return l[0]=o,l[1]=o+n,h[0]=t/s,h[1]=e/s,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const o=this._startTime;if(o!==null){const l=(t-o)*n;if(l<0||n===0)return;this._startTime=null,e=n*l}e*=this._updateTimeScale(t);const s=this._updateTime(e),a=this._updateWeight(t);if(a>0){const l=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case 2501:for(let u=0,p=l.length;u!==p;++u)l[u].evaluate(s),h[u].accumulateAdditive(a);break;case 2500:default:for(let u=0,p=l.length;u!==p;++u)l[u].evaluate(s),h[u].accumulate(r,a)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,o=this._loopCount;const s=n===2202;if(t===0)return o===-1?r:s&&(1&o)==1?e-r:r;if(n===2200){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(o===-1&&(t>=0?(o=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),r>=e||r<0){const a=Math.floor(r/e);r-=e*a,o+=Math.abs(a);const l=this.repetitions-o;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(l===1){const h=t<0;this._setEndings(h,!h,s)}else this._setEndings(!1,!1,s);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(s&&(1&o)==1)return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(t,e,n){const r=this._mixer,o=r.time;let s=this._weightInterpolant;s===null&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);const a=s.parameterPositions,l=s.sampleValues;return a[0]=o,l[0]=e,a[1]=o+t,l[1]=n,this}}(class extends D{constructor(i){super(),this._root=i,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(i,t){const e=i._localRoot||this._root,n=i._clip.tracks,r=n.length,o=i._propertyBindings,s=i._interpolants,a=e.uuid,l=this._bindingsByRootAndName;let h=l[a];h===void 0&&(h={},l[a]=h);for(let u=0;u!==r;++u){const p=n[u],y=p.name;let x=h[y];if(x!==void 0)o[u]=x;else{if(x=o[u],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,a,y));continue}const E=t&&t._propertyBindings[u].binding.parsedPath;x=new tx(ti.create(e,y,E),p.ValueTypeName,p.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,a,y),o[u]=x}s[u].resultBuffer=x.buffer}}_activateAction(i){if(!this._isActiveAction(i)){if(i._cacheIndex===null){const e=(i._localRoot||this._root).uuid,n=i._clip.uuid,r=this._actionsByClip[n];this._bindAction(i,r&&r.knownActions[0]),this._addInactiveAction(i,n,e)}const t=i._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const r=t[e];r.useCount++==0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(i)}}_deactivateAction(i){if(this._isActiveAction(i)){const t=i._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const r=t[e];--r.useCount==0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(i)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const i=this;this.stats={actions:{get total(){return i._actions.length},get inUse(){return i._nActiveActions}},bindings:{get total(){return i._bindings.length},get inUse(){return i._nActiveBindings}},controlInterpolants:{get total(){return i._controlInterpolants.length},get inUse(){return i._nActiveControlInterpolants}}}}_isActiveAction(i){const t=i._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(i,t,e){const n=this._actions,r=this._actionsByClip;let o=r[t];if(o===void 0)o={knownActions:[i],actionByRoot:{}},i._byClipCacheIndex=0,r[t]=o;else{const s=o.knownActions;i._byClipCacheIndex=s.length,s.push(i)}i._cacheIndex=n.length,n.push(i),o.actionByRoot[e]=i}_removeInactiveAction(i){const t=this._actions,e=t[t.length-1],n=i._cacheIndex;e._cacheIndex=n,t[n]=e,t.pop(),i._cacheIndex=null;const r=i._clip.uuid,o=this._actionsByClip,s=o[r],a=s.knownActions,l=a[a.length-1],h=i._byClipCacheIndex;l._byClipCacheIndex=h,a[h]=l,a.pop(),i._byClipCacheIndex=null,delete s.actionByRoot[(i._localRoot||this._root).uuid],a.length===0&&delete o[r],this._removeInactiveBindingsForAction(i)}_removeInactiveBindingsForAction(i){const t=i._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const r=t[e];--r.referenceCount==0&&this._removeInactiveBinding(r)}}_lendAction(i){const t=this._actions,e=i._cacheIndex,n=this._nActiveActions++,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_takeBackAction(i){const t=this._actions,e=i._cacheIndex,n=--this._nActiveActions,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_addInactiveBinding(i,t,e){const n=this._bindingsByRootAndName,r=this._bindings;let o=n[t];o===void 0&&(o={},n[t]=o),o[e]=i,i._cacheIndex=r.length,r.push(i)}_removeInactiveBinding(i){const t=this._bindings,e=i.binding,n=e.rootNode.uuid,r=e.path,o=this._bindingsByRootAndName,s=o[n],a=t[t.length-1],l=i._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete s[r],Object.keys(s).length===0&&delete o[n]}_lendBinding(i){const t=this._bindings,e=i._cacheIndex,n=this._nActiveBindings++,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_takeBackBinding(i){const t=this._bindings,e=i._cacheIndex,n=--this._nActiveBindings,r=t[n];i._cacheIndex=n,t[n]=i,r._cacheIndex=e,t[e]=r}_lendControlInterpolant(){const i=this._controlInterpolants,t=this._nActiveControlInterpolants++;let e=i[t];return e===void 0&&(e=new Dp(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),e.__cacheIndex=t,i[t]=e),e}_takeBackControlInterpolant(i){const t=this._controlInterpolants,e=i.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];i.__cacheIndex=n,t[n]=i,r.__cacheIndex=e,t[e]=r}clipAction(i,t,e){const n=t||this._root,r=n.uuid;let o=typeof i=="string"?Bp.findByName(n,i):i;const s=o!==null?o.uuid:i,a=this._actionsByClip[s];let l=null;if(e===void 0&&(e=o!==null?o.blendMode:2500),a!==void 0){const u=a.actionByRoot[r];if(u!==void 0&&u.blendMode===e)return u;l=a.knownActions[0],o===null&&(o=l._clip)}if(o===null)return null;const h=new hx(this,o,t,e);return this._bindAction(h,l),this._addInactiveAction(h,s,r),h}existingAction(i,t){const e=t||this._root,n=e.uuid,r=typeof i=="string"?Bp.findByName(e,i):i,o=r?r.uuid:i,s=this._actionsByClip[o];return s!==void 0&&s.actionByRoot[n]||null}stopAllAction(){const i=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)i[t].stop();return this}update(i){i*=this.timeScale;const t=this._actions,e=this._nActiveActions,n=this.time+=i,r=Math.sign(i),o=this._accuIndex^=1;for(let l=0;l!==e;++l)t[l]._update(n,i,r,o);const s=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)s[l].apply(o);return this}setTime(i){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(i)}getRoot(){return this._root}uncacheClip(i){const t=this._actions,e=i.uuid,n=this._actionsByClip,r=n[e];if(r!==void 0){const o=r.knownActions;for(let s=0,a=o.length;s!==a;++s){const l=o[s];this._deactivateAction(l);const h=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=h,t[h]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete n[e]}}uncacheRoot(i){const t=i.uuid,e=this._actionsByClip;for(const r in e){const o=e[r].actionByRoot[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}const n=this._bindingsByRootAndName[t];if(n!==void 0)for(const r in n){const o=n[r];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(i,t){const e=this.existingAction(i,t);e!==null&&(this._deactivateAction(e),this._removeInactiveAction(e))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1),class extends ga{constructor(i,t,e=1){super(i,t),this.meshPerAttribute=e}copy(i){return super.copy(i),this.meshPerAttribute=i.meshPerAttribute,this}clone(i){const t=super.clone(i);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(i){const t=super.toJSON(i);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}.prototype.isInstancedInterleavedBuffer=!0,new R,new U,new U,class extends kn{constructor(i){super(),this.material=i,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}.prototype.isImmediateRenderObject=!0;const ko=new U,Gl=new tn,Nu=new tn,ux=new Float32Array(1);new Int32Array(ux.buffer);const Yp=[.125,.215,.35,.446,.526,.582],cx=5+Yp.length,dx=new Qi({side:1,depthWrite:!1,depthTest:!1});new Tt(new ee,dx),px();function px(){const i=[],t=[],e=[];let n=8;for(let r=0;r<cx;r++){const o=Math.pow(2,n);t.push(o);let s=1/o;r>4?s=Yp[r-8+4-1]:r==0&&(s=0),e.push(s);const a=1/(o-1),l=-a/2,h=1+a/2,u=[l,l,h,l,h,h,l,l,h,h,l,h],p=6,y=6,x=3,E=2,w=1,C=new Float32Array(x*y*p),j=new Float32Array(E*y*p),Z=new Float32Array(w*y*p);for(let ct=0;ct<p;ct++){const nt=ct%3*2/3-1,vt=ct>2?0:-1,ht=[nt,vt,0,nt+2/3,vt,0,nt+2/3,vt+1,0,nt,vt,0,nt+2/3,vt+1,0,nt,vt+1,0];C.set(ht,x*y*ct),j.set(u,E*y*ct);const mt=[ct,ct,ct,ct,ct,ct];Z.set(mt,w*y*ct)}const rt=new Xn;rt.setAttribute("position",new qn(C,x)),rt.setAttribute("uv",new qn(j,E)),rt.setAttribute("faceIndex",new qn(Z,w)),i.push(rt),n>4&&n--}return{_lodPlanes:i,_sizeLods:t,_sigmas:e}}Nr.create=function(i,t){return console.log("THREE.Curve.create() has been deprecated"),i.prototype=Object.create(Nr.prototype),i.prototype.constructor=i,i.prototype.getPoint=t,i},Fs.prototype.fromPoints=function(i){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(i)},class extends mu{constructor(i=10,t=10,e=4473924,n=8947848){e=new fn(e),n=new fn(n);const r=t/2,o=i/t,s=i/2,a=[],l=[];for(let u=0,p=0,y=-s;u<=t;u++,y+=o){a.push(-s,0,y,s,0,y),a.push(y,0,-s,y,0,s);const x=u===r?e:n;x.toArray(l,p),p+=3,x.toArray(l,p),p+=3,x.toArray(l,p),p+=3,x.toArray(l,p),p+=3}const h=new Xn;h.setAttribute("position",new An(a,3)),h.setAttribute("color",new An(l,3)),super(h,new Ta({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends mu{constructor(i){const t=function a(l){const h=[];l&&l.isBone&&h.push(l);for(let u=0;u<l.children.length;u++)h.push.apply(h,a(l.children[u]));return h}(i),e=new Xn,n=[],r=[],o=new fn(0,0,1),s=new fn(0,1,0);for(let a=0;a<t.length;a++){const l=t[a];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(o.r,o.g,o.b),r.push(s.r,s.g,s.b))}e.setAttribute("position",new An(n,3)),e.setAttribute("color",new An(r,3)),super(e,new Ta({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=i,this.bones=t,this.matrix=i.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(i){const t=this.bones,e=this.geometry,n=e.getAttribute("position");Nu.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){const s=t[r];s.parent&&s.parent.isBone&&(Gl.multiplyMatrices(Nu,s.matrixWorld),ko.setFromMatrixPosition(Gl),n.setXYZ(o,ko.x,ko.y,ko.z),Gl.multiplyMatrices(Nu,s.parent.matrixWorld),ko.setFromMatrixPosition(Gl),n.setXYZ(o+1,ko.x,ko.y,ko.z),o+=2)}e.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(i)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Uo.prototype.extractUrlBase=function(i){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),qy.extractUrlBase(i)},Uo.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},gt.prototype.center=function(i){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(i)},gt.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},gt.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)},gt.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)},gt.prototype.size=function(i){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(i)},Ge.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},kr.prototype.setFromMatrix=function(i){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(i)},F.prototype.flattenToArrayOffset=function(i,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,t)},F.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)},F.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},F.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)},F.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},F.prototype.getInverse=function(i){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()},tn.prototype.extractPosition=function(i){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(i)},tn.prototype.flattenToArrayOffset=function(i,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,t)},tn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new U().setFromMatrixColumn(this,3)},tn.prototype.setRotationFromQuaternion=function(i){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(i)},tn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},tn.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.multiplyVector4=function(i){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},tn.prototype.rotateAxis=function(i){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),i.transformDirection(this)},tn.prototype.crossVector=function(i){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},tn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},tn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},tn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},tn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},tn.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)},tn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},tn.prototype.makeFrustum=function(i,t,e,n,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(i,t,n,e,r,o)},tn.prototype.getInverse=function(i){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()},ui.prototype.isIntersectionLine=function(i){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(i)},z.prototype.multiplyVector3=function(i){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),i.applyQuaternion(this)},z.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},fi.prototype.isIntersectionBox=function(i){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)},fi.prototype.isIntersectionPlane=function(i){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(i)},fi.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)},ci.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},ci.prototype.barycoordFromPoint=function(i,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(i,t)},ci.prototype.midpoint=function(i){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(i)},ci.prototypenormal=function(i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(i)},ci.prototype.plane=function(i){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(i)},ci.barycoordFromPoint=function(i,t,e,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ci.getBarycoord(i,t,e,n,r)},ci.normal=function(i,t,e,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ci.getNormal(i,t,e,n)},Mu.prototype.extractAllPoints=function(i){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(i)},Mu.prototype.extrude=function(i){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Os(this,i)},Mu.prototype.makeGeometry=function(i){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Au(this,i)},R.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},R.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)},R.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},U.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},U.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},U.prototype.getPositionFromMatrix=function(i){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(i)},U.prototype.getScaleFromMatrix=function(i){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(i)},U.prototype.getColumnFromMatrix=function(i,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,i)},U.prototype.applyProjection=function(i){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(i)},U.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},U.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)},U.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ot.prototype.fromAttribute=function(i,t,e){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,t,e)},Ot.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},kn.prototype.getChildByName=function(i){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(i)},kn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},kn.prototype.translate=function(i,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,i)},kn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},kn.prototype.applyMatrix=function(i){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)},Object.defineProperties(kn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(i){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=i}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Tt.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Tt.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),hp.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},un.prototype.setLens=function(i,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(i)},Object.defineProperties(Kr.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(i){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=i}},shadowCameraLeft:{set:function(i){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=i}},shadowCameraRight:{set:function(i){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=i}},shadowCameraTop:{set:function(i){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=i}},shadowCameraBottom:{set:function(i){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=i}},shadowCameraNear:{set:function(i){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=i}},shadowCameraFar:{set:function(i){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=i}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(i){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=i}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(i){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=i}},shadowMapHeight:{set:function(i){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=i}}}),Object.defineProperties(qn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===35048},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),qn.prototype.setDynamic=function(i){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?35048:35044),this},qn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},qn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Xn.prototype.addIndex=function(i){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(i)},Xn.prototype.addAttribute=function(i,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?i==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(i,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(i,new qn(arguments[1],arguments[2])))},Xn.prototype.addDrawCall=function(i,t,e){e!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(i,t)},Xn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Xn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Xn.prototype.removeAttribute=function(i){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(i)},Xn.prototype.applyMatrix=function(i){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)},Object.defineProperties(Xn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),ga.prototype.setDynamic=function(i){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?35048:35044),this},ga.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Os.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Os.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Os.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},cu.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Object.defineProperties(Ri.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new fn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(i){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(i){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=i}}}),Object.defineProperties(hn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(i){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=i}}}),ni.prototype.clearTarget=function(i,t,e,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(i),this.clear(t,e,n)},ni.prototype.animate=function(i){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(i)},ni.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},ni.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},ni.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},ni.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},ni.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},ni.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},ni.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},ni.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},ni.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},ni.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},ni.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},ni.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},ni.prototype.enableScissorTest=function(i){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(i)},ni.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},ni.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},ni.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},ni.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},ni.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},ni.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},ni.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},ni.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},ni.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},ni.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(ni.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=i}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=i}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(i){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=i===!0?3001:3e3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties($d.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Vt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=i}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=i}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=i}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=i}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(i){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=i}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(i){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=i}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(i){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=i}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(i){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=i}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(i){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=i}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(i){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=i}}}),$y.prototype.load=function(i){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return new Qy().load(i,function(e){t.setBuffer(e)}),this},$n.prototype.updateCubeMap=function(i,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(i,t)},$n.prototype.clear=function(i,t,e,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(i,t,e,n)},O.crossOrigin=void 0,O.loadTexture=function(i,t,e,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new Gy;r.setCrossOrigin(this.crossOrigin);const o=r.load(i,e,void 0,n);return t&&(o.mapping=t),o},O.loadTextureCube=function(i,t,e,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new ky;r.setCrossOrigin(this.crossOrigin);const o=r.load(i,e,void 0,n);return t&&(o.mapping=t),o},O.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},O.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"130"}})),typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="130");var fx=v(6),xi=v.n(fx),mx=v(33),gx=v.n(mx),vx=v(11),ji=v.n(vx);class _x{constructor(){this.camera=new Iu(10,10,10,10),this.camera.position.z=100,this.camera.position.x=0,this.camera.position.y=0}focus(t,e){t.position.z=50}updateAspect(t,e){this.camera.left=-1*t/2,this.camera.right=t/2,this.camera.top=e/2,this.camera.bottom=-1*e/2,this.camera.updateProjectionMatrix()}}const qp={linear:(i,t,e,n)=>e*i/n+t,easeIn:(i,t,e,n)=>e*(i/=n)*i+t,strongEaseIn:(i,t,e,n)=>e*(i/=n)*i*i*i*i+t,strongEaseOut:(i,t,e,n)=>e*((i=i/n-1)*i*i*i*i+1)+t,sineaseIn:(i,t,e,n)=>e*(i/=n)*i*i+t,sineaseOut:(i,t,e,n)=>e*((i=i/n-1)*i*i+1)+t},xr=new tt;class qi{constructor(){this.camera=new _x,this.mesh=new Tt,this.material=null,this.geometry=null}applyOptions(t){}addObjects(t){this.mesh.position.z=50,t.add(this.mesh)}setSize(t,e){this.camera.updateAspect(t,e),this.geometry=new Pr(t,e,1,1),this.material=new hn({fragmentShader:this.fragmentShader,vertexShader:`
varying vec2 vUv;
void main(){
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`}),this.material.uniforms={width:{value:t},height:{value:e},timePercent:{value:0},texturePrev:{value:xr},textureNext:{value:xr}},this.applyOptions(this.options),this.mesh.geometry=this.geometry,this.mesh.material=this.material}setPrevTexture(t){this.material.uniforms.texturePrev.value=t}setNextTexture(t){this.material.uniforms.textureNext.value=t}updateAnimation(t){this.material.uniforms.timePercent.value=t}dispose(){var t,e;(t=this.geometry)===null||t===void 0||t.dispose(),(e=this.material)===null||e===void 0||e.dispose()}}var yx=v(72),xx=v.n(yx),bx=v(73),Tx=v.n(bx),Ex=v(74),Sx=v.n(Ex),wx=v(75),Ax=v.n(wx),Mx=v(76),Cx=v.n(Mx),Rx=v(77),Ix=v.n(Rx),Px=v(78),Ox=v.n(Px),Nx=v(79),Lx=v.n(Nx),Dx=v(80),Fx=v.n(Dx),Bx=v(81),Ux=v.n(Bx),kx=v(82),Gx=v.n(kx),Hx=v(83),jx=v.n(Hx),zx=v(84),Vx=v.n(zx),Wx=v(85),Xx=v.n(Wx);class ls{constructor(){this.camera=new un(60,1,1,2e3),this.camera.position.z=1e3,this.camera.position.x=0,this.camera.position.y=0}updateAspect(t,e){this.camera.aspect=t/e,this.camera.updateProjectionMatrix()}focus(t,e){const n=.5*e/Math.tan(Math.PI/6);t.position.z=1e3-n}}class Ia{constructor(){this.prevTexture=xr,this.nextTexture=xr,this.geometry=new Xn,this.material=null,this.camera=new ls,this.mesh=new Tt,this.textureWidth=0,this.textureHeight=0}horizontalSegments(){return Math.ceil(this.verticalSegments*this.textureWidth/this.textureHeight)}applyOptions(t){this.options=t}initMesh(t,e){const n=[],r=[],o=[],s=this.verticalSegments,a=this.horizontalSegments(),l=t/2,h=e/2,u=t/a,p=e/s,y=this.extraAttributes(),x=Object.keys(y),E=x.reduce((w,C)=>(w[C]=[],w),{});for(let w=0;w<s;w++){const C=w*p-h;for(let j=0;j<a;j++){const Z=j*u-l;r.push(Z,-C,0),o.push(1*j/a,1-1*w/s),x.forEach(rt=>E[rt].push(...y[rt].generator(w,j))),r.push(Z+u,-C,0),o.push(1*(j+1)/a,1-1*w/s),x.forEach(rt=>E[rt].push(...y[rt].generator(w,j))),r.push(Z,-C-p,0),o.push(1*j/a,1-1*(w+1)/s),x.forEach(rt=>E[rt].push(...y[rt].generator(w,j))),r.push(Z+u,-C-p,0),o.push(1*(j+1)/a,1-1*(w+1)/s),x.forEach(rt=>E[rt].push(...y[rt].generator(w,j)))}}for(let w=0;w<s*a;w++){const C=4*w,j=C+1,Z=C+2,rt=C+3;n.push(j,C,rt),n.push(C,Z,rt)}return this.geometry.setIndex(n),this.geometry.setAttribute("position",new An(r,3)),this.geometry.setAttribute("uv",new An(new Float32Array(o),2)),x.forEach(w=>{const{threeType:C,jsType:j,itemSize:Z}=y[w];this.geometry.setAttribute(w,new C(new j(E[w]),Z))}),{verticalSegments:s,horizontalSegments:a,segmentWidth:u,segmentHeight:p}}setSize(t,e){this.textureWidth=t,this.textureHeight=e,this.camera.updateAspect(t,e),this.camera.focus(this.mesh,e),this.material=new hn({fragmentShader:this.fragmentShader,vertexShader:this.vertexShader,side:2}),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material;const{verticalSegments:n,horizontalSegments:r,segmentWidth:o,segmentHeight:s}=this.initMesh(t,e);this.material.uniforms={segmentWidth:{value:o},segmentHeight:{value:s},verticalSegments:{value:n},horizontalSegments:{value:r},timePercent:{value:0},texturePrev:{value:xr},textureNext:{value:xr}},this.applyOptions(this.options)}setPrevTexture(t){this.prevTexture=t,this.material.uniforms.texturePrev.value=t}setNextTexture(t){this.nextTexture=t,this.material.uniforms.textureNext.value=t}addObjects(t){t.add(this.mesh)}updateAnimation(t){this.material.uniforms.timePercent.value=t}dispose(){var t,e;(t=this.geometry)===null||t===void 0||t.dispose(),(e=this.material)===null||e===void 0||e.dispose()}}var Yx=v(86),qx=v.n(Yx),Jx=v(87),Kx=v.n(Jx),Zx=v(88),Qx=v.n(Zx),$x=v(89),tb=v.n($x),eb=v(90),nb=v.n(eb),ib=v(91),rb=v.n(ib),ob=v(92),sb=v.n(ob),ab=v(93),lb=v.n(ab),hb=v(94),ub=v.n(hb),cb=v(95),db=v.n(cb),pb=v(96),fb=v.n(pb),mb=v(97),gb=v.n(mb);class Jp extends Ia{constructor(){super(...arguments),this.duration=1250,this.options=[],this.fragmentShader=gb.a,this.vertexShader=fb.a,this.verticalSegments=100}addObjects(t){t.add(this.mesh),t.background=this.nextTexture}extraAttributes(){return{}}applyOptions(t){super.applyOptions(t);const e=this.options.find(n=>n.name==="invX");this.material.uniforms.option={value:e!=null&&e.value?Number(e.value):0}}}var vb=v(98),_b=v.n(vb),yb=v(99),xb=v.n(yb),bb=v(100),Tb=v.n(bb),Eb=v(101),Sb=v.n(Eb),wb=v(102),Ab=v.n(wb),Mb=v(103),Cb=v.n(Mb),Rb=v(104),Ib=v.n(Rb),Pb=v(105),Ob=v.n(Pb),Nb=v(46),Kp=v.n(Nb),Lb=v(47),Zp=v.n(Lb),Db=v(106),Fb=v.n(Db),Bb=v(107),Ub=v.n(Bb);const kb={RandomLines:class extends qi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Tx.a,this.options=[{name:"dir",value:"horz"}]}genRandomLines(){let i=[1];for(let e=20;e--;){let n=i.sort((l,h)=>h-l)[0],r=i.indexOf(n),o=Math.random(),s=n*o,a=n*(1-o);i.splice(r,1),i.push(s,a)}let t=i.length;for(;t;){let e=Math.floor(Math.random()*t--);[i[e],i[t]]=[i[t],i[e]]}return i}applyOptions(i){var t,e;super.applyOptions(i),this.material.uniforms.direction={value:((e=(t=this.options)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.value)==="horz"?0:1}}setSize(i,t){super.setSize(i,t),this.material.uniforms.lines={value:this.genRandomLines()},this.material.vertexShader=xx.a}},Shape:class extends qi{constructor(){super(...arguments),this.duration=800,this.fragmentShader=Sx.a,this.options=[]}},Ripples:class extends qi{constructor(){super(...arguments),this.duration=1400,this.fragmentShader=Ax.a,this.options=[{name:"dir",value:"center"}],this.optionsMap={center:0,ru:1,lu:2,ld:3,rd:4}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:"center"]}}},Erase:class extends qi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Cx.a,this.options=[],this.defaultDir="right",this.optionsMap={[this.defaultDir]:0,d:1,r:2,u:3}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:this.defaultDir]}}},Dissolve:class extends qi{constructor(){super(...arguments),this.duration=1200,this.fragmentShader=Ix.a,this.options=[],this.dissolveIndices={}}random40(){return Math.ceil(40*Math.random())}setSize(i,t){super.setSize(i,t);for(let e=0;e<1600;e++){let n=this.random40(),r=this.random40();for(;this.dissolveIndices[`${n}_${r}`]!==void 0;)n=this.random40(),r=this.random40();this.dissolveIndices[`${n}_${r}`]=0}this.material.uniforms.dissolveTexture={value:this.genDissolveToTexture()}}genDissolveToTexture(){var i=new Uint8Array(4800);for(let t=0;t<1600;t++){const e=t%40+1,n=Math.floor(t/40)+1,r=3*t;this.dissolveIndices[`${e}_${n}`]===0?(i[r]=0,i[r+1]=0,i[r+2]=0):(i[r]=255,i[r+1]=255,i[r+2]=255)}return new up(i,40,40,1022)}updateAnimation(i){const t=1600*i-Object.keys(this.dissolveIndices).filter(e=>this.dissolveIndices[e]===1).length;for(let e=0;e<t;e++){const n=Object.keys(this.dissolveIndices).filter(o=>this.dissolveIndices[o]===0),r=Math.ceil(Math.random()*n.length)-1;this.dissolveIndices[n[r]]=1}this.material.uniforms.dissolveTexture.value=this.genDissolveToTexture()}},Smooth:class extends qi{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=Ox.a,this.options=[]}},FadeInOut:class extends qi{constructor(){super(...arguments),this.duration=700,this.fragmentShader=Lx.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(e=>e.name==="thruBlk");this.material.uniforms.option={value:(t==null?void 0:t.value)==="1"?1:0}}},Push:class extends qi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Fx.a,this.options=[],this.optionsMap={u:0,r:1,d:2,l:3}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:"l"]}}},Separation:class extends qi{constructor(){super(...arguments),this.duration=1500,this.fragmentShader=Ux.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(n=>n.name==="orient"),e=this.options.find(n=>n.name==="dir");this.material.uniforms.orient={value:(t==null?void 0:t.value)==="vert"},this.material.uniforms.direction={value:(e==null?void 0:e.value)==="in"}}},Display:class extends qi{constructor(){super(...arguments),this.duration=3400,this.fragmentShader=Gx.a,this.options=[]}applyOptions(i){const t=this.options.find(n=>n.name==="dir"),e=this.options.find(n=>n.name==="thruBlk");this.material.uniforms.direction={value:(t==null?void 0:t.value)==="r"},this.material.uniforms.thruBlk={value:(e==null?void 0:e.value)==="1"}}},Uncover:class extends qi{constructor(){super(...arguments),this.duration=750,this.fragmentShader=jx.a,this.options=[],this.defaultDir="right",this.optionsMap={[this.defaultDir]:0,d:1,r:2,u:3,ld:4,lu:5,rd:6,ru:7},this.selfOptionsList=[{x:-1,y:0},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:-1},{x:-1,y:1},{x:1,y:-1},{x:1,y:1}]}applyOptions(i){var t;super.applyOptions(i);const e=this.options.find(o=>o.name==="dir"),n=this.optionsMap[(t=e==null?void 0:e.value)!==null&&t!==void 0?t:this.defaultDir],r=this.selfOptionsList[n];this.material.uniforms.optionX={value:r.x},this.material.uniforms.optionY={value:r.y}}},Cover:class extends qi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Vx.a,this.options=[],this.defaultDir="right",this.optionsMap={[this.defaultDir]:0,d:1,r:2,u:3,ld:4,lu:5,rd:6,ru:7},this.selfOptionsList=[{x:-1,y:0},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:-1},{x:-1,y:1},{x:1,y:-1},{x:1,y:1}]}applyOptions(i){var t;super.applyOptions(i);const e=this.options.find(o=>o.name==="dir"),n=this.optionsMap[(t=e==null?void 0:e.value)!==null&&t!==void 0?t:this.defaultDir],r=this.selfOptionsList[n];this.material.uniforms.optionX={value:r.x},this.material.uniforms.optionY={value:r.y}}},Flash:class extends qi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Xx.a,this.options=[]}},Checkerboard:class extends Ia{constructor(){super(...arguments),this.duration=2500,this.options=[{name:"dir",value:"horz"}],this.fragmentShader=Kx.a,this.vertexShader=qx.a,this.vIndex="",this.delay=0,this.verticalSegments=5}extraAttributes(){return{times:{threeType:An,jsType:Float32Array,itemSize:1,generator:(i,t)=>(this.vIndex!==`${i}${t}`&&(this.delay=.3*Math.random(),this.vIndex=`${i}${t}`),[this.delay])},segment:{threeType:An,jsType:Float32Array,itemSize:2,generator:(i,t)=>[t,i]},option:{threeType:da,jsType:Int32Array,itemSize:1,generator:()=>[this.options.find(i=>i.name==="dir"&&i.value==="horz")?0:1]}}}},Vortex:class{constructor(){this.duration=4e3,this.geometry=new Xn,this.material=new hn({fragmentShader:tb.a,vertexShader:Qx.a,side:2}),this.camera=new ls,this.mesh=new Tt}initData(i,t){const e=[],n=[],r=[],o=[],s=[],a=[],l=Math.ceil(124*i/t),h=i/2,u=t/2,p=i/l,y=t/124;for(let x=0;x<124;x++){const E=x*y-u;for(let w=0;w<l;w++){const C=w*p-h,j=Math.ceil((w+1)/((l+1)/12)),Z=.4/j,rt=(j-1)*Z+Math.random()*Z;n.push(C,-E,0),o.push(1*w/l,1-1*x/124),r.push(0,0,1),s.push(w,x),a.push(rt),n.push(C+p,-E,0),o.push(1*(w+1)/l,1-1*x/124),r.push(0,0,1),s.push(w,x),a.push(rt),n.push(C,-E-y,0),o.push(1*w/l,1-1*(x+1)/124),r.push(0,0,1),s.push(w,x),a.push(rt),n.push(C+p,-E-y,0),o.push(1*(w+1)/l,1-1*(x+1)/124),r.push(0,0,1),s.push(w,x),a.push(rt)}}for(let x=0;x<124*l;x++){const E=4*x,w=E+1,C=E+2,j=E+3;e.push(w,E,j),e.push(E,C,j)}return this.geometry.setIndex(e),this.geometry.setAttribute("position",new An(n,3)),this.geometry.setAttribute("normal",new An(r,3)),this.geometry.setAttribute("uv",new An(new Float32Array(o),2)),this.geometry.setAttribute("segment",new An(new Float32Array(s),2)),this.geometry.setAttribute("times",new An(new Float32Array(a),1)),{verticalSegments:124,horizontalSegments:l,segmentWidth:p,segmentHeight:y}}setSize(i,t){const{verticalSegments:e,horizontalSegments:n,segmentWidth:r,segmentHeight:o}=this.initData(i,t);this.material.uniforms={duration:{value:this.duration},segmentWidth:{value:r},segmentHeight:{value:o},verticalSegments:{value:e},horizontalSegments:{value:n},timePercent:{value:0},texturePrev:{value:xr},textureNext:{value:xr}},this.camera.updateAspect(i,t),this.camera.focus(this.mesh,t),this.mesh.geometry=this.geometry,new Lp({side:2,vertexColors:!0}).wireframe=!0,this.material.transparent=!0,this.mesh.material=this.material}setPrevTexture(i){this.material.uniforms.texturePrev.value=i}setNextTexture(i){this.material.uniforms.textureNext.value=i}addObjects(i){i.add(this.mesh)}updateAnimation(i){this.material.uniforms.timePercent.value=i}dispose(){var i,t;(i=this.geometry)===null||i===void 0||i.dispose(),(t=this.material)===null||t===void 0||t.dispose()}},WindowShades:class{constructor(){this.duration=1600,this.geometry=new Xn,this.material=new hn({fragmentShader:rb.a,vertexShader:nb.a,side:2}),this.horizontalSegments=16,this.meshToCameraDistance=0,this.camera=new ls,this.mesh=new Tt}initData(i,t){const e=[],n=[],r=[],o=[],s=[],a=[],l=i/2,h=t/2,u=i/this.horizontalSegments;for(let p=0;p<this.horizontalSegments;p++){const y=Math.abs(p-Math.ceil(this.horizontalSegments/2))*(.3/Math.ceil(this.horizontalSegments/2)),x=p*u-l;n.push(x,h,0),r.push(0),o.push(p/this.horizontalSegments,1),s.push(p),a.push(y),n.push(x+u,h,0),r.push(0),o.push((p+1)/this.horizontalSegments,1),s.push(p),a.push(y),n.push(x,-1*h,0),r.push(0),o.push(p/this.horizontalSegments,0),s.push(p),a.push(y),n.push(x+u,-1*h,0),o.push((p+1)/this.horizontalSegments,0),r.push(0),s.push(p),a.push(y),n.push(x+u,h,0),r.push(1),o.push(p/this.horizontalSegments,1),s.push(p),a.push(y),n.push(x+u,h,-1*u),r.push(1),o.push((p+1)/this.horizontalSegments,1),s.push(p),a.push(y),n.push(x+u,-1*h,0),r.push(1),o.push(p/this.horizontalSegments,0),s.push(p),a.push(y),n.push(x+u,-1*h,-1*u),o.push((p+1)/this.horizontalSegments,0),r.push(1),s.push(p),a.push(y)}for(let p=0;p<this.horizontalSegments;p++){const y=8*p,x=y+1,E=y+2,w=y+3,C=y+4,j=y+5,Z=y+6,rt=y+7;e.push(x,y,w),e.push(y,E,w),e.push(j,C,rt),e.push(C,Z,rt)}this.geometry.setIndex(e),this.geometry.setAttribute("position",new An(n,3)),this.geometry.setAttribute("uv",new An(new Float32Array(o),2)),this.geometry.setAttribute("index",new An(new Float32Array(s),1)),this.geometry.setAttribute("type",new An(new Float32Array(r),1)),this.geometry.setAttribute("delay",new An(new Float32Array(a),1))}setPrevTexture(i){this.material.uniforms.texturePrev.value=i}setNextTexture(i){this.material.uniforms.textureNext.value=i}setSize(i,t){this.initData(i,t),this.material.uniforms={segments:{value:this.horizontalSegments},segmentWidth:{value:i/this.horizontalSegments},timePercent:{value:0},texturePrev:{value:xr},textureNext:{value:xr}},this.meshToCameraDistance=.5*t/Math.tan(Math.PI/6),this.camera.updateAspect(i,t),this.camera.focus(this.mesh,t),this.mesh.geometry=this.geometry,this.material.transparent=!0,this.mesh.material=this.material}addObjects(i){i.add(this.mesh)}updateAnimation(i){this.material.uniforms.timePercent.value=i}dispose(){var i,t;(i=this.geometry)===null||i===void 0||i.dispose(),(t=this.material)===null||t===void 0||t.dispose()}},Curtain:class extends Ia{constructor(){super(...arguments),this.duration=6e3,this.options=[],this.fragmentShader=lb.a,this.vertexShader=sb.a,this.verticalSegments=100}extraAttributes(){return{isLeft:{threeType:An,jsType:Float32Array,itemSize:1,generator:(i,t)=>[t<this.horizontalSegments()/2?1:0]}}}addObjects(i){super.addObjects(i),this.mesh.position.z+=20,i.background=this.nextTexture}},Fall:class extends Ia{constructor(){super(...arguments),this.zCurveLimit=100,this.duration=2e3,this.options=[{name:"invX",value:"0"}],this.verticalSegments=100,this.fragmentShader=db.a,this.vertexShader=ub.a}extraAttributes(){return{}}setSize(i,t){var e;super.setSize(i,t);const n=this.options.find(r=>r.name==="invX");this.material.uniforms.zCurveLimit={value:this.zCurveLimit},this.material.uniforms.aCoefficient={value:this.zCurveLimit/(this.textureHeight/2*(this.textureHeight/2))},this.material.uniforms.option={value:(e=n==null?void 0:n.value)!==null&&e!==void 0?e:0}}addObjects(i){i.add(this.mesh),i.background=this.nextTexture}updateAnimation(i){this.material.uniforms.timePercent.value=i}},Suspension:class extends Jp{constructor(){super(...arguments),this.duration=2e3,this.fragmentShader=xb.a,this.vertexShader=_b.a}addObjects(i){i.add(this.mesh),i.background=this.prevTexture}},Clock:class extends qi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Tb.a,this.options=[]}},Combing:class extends qi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Sb.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(e=>e.name==="dir");this.material.uniforms.option={value:(t==null?void 0:t.value)==="vert"?1:0}}},Scale:class extends qi{constructor(){super(...arguments),this.duration=900,this.fragmentShader=Ab.a,this.options=[]}applyOptions(i){super.applyOptions(i);const t=this.options.find(e=>e.name==="dir");this.material.uniforms.option={value:(t==null?void 0:t.value)==="in"?0:1}}},PeelOff:Jp,Flip:class extends Ia{constructor(){super(...arguments),this.duration=1250,this.options=[],this.fragmentShader=Ib.a,this.vertexShader=Cb.a,this.verticalSegments=1}extraAttributes(){return{}}applyOptions(i){const t=this.options.find(e=>e.name==="dir");this.material.uniforms.option={value:(t==null?void 0:t.value)==="l"?1:0}}},Strips:class extends qi{constructor(){super(...arguments),this.duration=1e3,this.fragmentShader=Ob.a,this.options=[],this.defaultDir="lu",this.optionsMap={[this.defaultDir]:0,ld:1,rd:2,ru:3}}applyOptions(i){var t,e;super.applyOptions(i);const n=this.options.find(r=>r.name==="dir");this.material.uniforms.option={value:(t=this.optionsMap)===null||t===void 0?void 0:t[(e=n==null?void 0:n.value)!==null&&e!==void 0?e:this.defaultDir]}}},Gallery:class{constructor(){this.camera=new ls,this.duration=1600,this.options=[],this.gap=10,this.group=new As,this.prevMesh=new Tt,this.nextMesh=new Tt,this.width=100,this.height=100,this.prevMaterial=new hn({vertexShader:Kp.a,fragmentShader:Zp.a,side:2,uniforms:{galleryTexture:{value:xr},galleryHeight:{value:1}}}),this.nextMaterial=new hn({vertexShader:Kp.a,fragmentShader:Zp.a,side:2,uniforms:{galleryTexture:{value:xr},galleryHeight:{value:1}}})}get isRight(){const i=this.options.find(t=>t.name==="dir");return!i||i.value==="r"}addObjects(i){this.group.add(this.prevMesh),this.group.add(this.nextMesh),i.add(this.group)}dispose(){this.prevMaterial.dispose(),this.nextMaterial.dispose(),this.prevMesh.geometry.dispose(),this.nextMesh.geometry.dispose()}setNextTexture(i){this.nextMaterial.uniforms.galleryTexture.value=i,this.nextMesh.material=this.nextMaterial}setPrevTexture(i){this.prevMaterial.uniforms.galleryTexture.value=i,this.prevMesh.material=this.prevMaterial}setSize(i,t){this.camera.updateAspect(i,t),this.camera.focus(this.prevMesh,t),this.width=i,this.height=t,this.gap=this.width/20,this.prevMaterial.uniforms.galleryHeight.value=t,this.nextMaterial.uniforms.galleryHeight.value=t;const e=new Pr(i,1.2*t+8,1,1);this.prevMesh.geometry=e;const n=new Pr(i,1.2*t+8,1,1);this.nextMesh.geometry=n,this.nextMesh.position.z=this.prevMesh.position.z,this.isRight?this.nextMesh.position.x=i+this.gap:this.nextMesh.position.x=-1*(i+this.gap)}updateAnimation(i){if(i<.3){const t=i/.3;this.isRight?(this.group.position.z=.25*this.height*-1*t,this.group.rotation.y=Math.PI/12*-1*t):(this.group.position.z=.25*this.height*-1*t,this.group.rotation.y=Math.PI/12*t)}else if(i>=.3&&i<.7){const t=(i-.3)/.4;this.isRight?(this.group.position.z=-1*(.25*this.height+.55*this.height*t),this.group.position.x=-1*(this.width+this.gap)*t):(this.group.position.z=-1*(.25*this.height+.55*this.height*t),this.group.position.x=(this.width+this.gap)*t)}else{const t=(i-.7)/.3;this.isRight?(this.group.position.x=-1*(this.width+this.gap),this.group.position.z=.8*this.height*-1*(1-t),this.group.rotation.y=Math.PI/12*-1*(1-t)):(this.group.position.x=this.width+this.gap,this.group.position.z=.8*this.height*-1*(1-t),this.group.rotation.y=Math.PI/12*(1-t))}}},Switch:class{constructor(){this.camera=new ls,this.duration=6e3,this.options=[],this.prevMesh=new Tt,this.nextMesh=new Tt,this.width=100,this.height=100,this.depth=1,this.prevDepth=1}addObjects(i){i.add(this.prevMesh),i.add(this.nextMesh)}dispose(){Array.isArray(this.prevMesh.material)?this.prevMesh.material.forEach(i=>i.dispose()):this.prevMesh.material.dispose(),this.prevMesh.geometry.dispose(),Array.isArray(this.nextMesh.material)?this.nextMesh.material.forEach(i=>i.dispose()):this.nextMesh.material.dispose(),this.nextMesh.geometry.dispose()}setNextTexture(i){const t=new Qi({map:i});this.nextMesh.material=t}setPrevTexture(i){const t=new Qi({map:i});this.prevMesh.material=t}setSize(i,t){this.camera.updateAspect(i,t),this.camera.focus(this.prevMesh,t),this.width=i,this.height=t,this.depth=t/2;const e=new Pr(i,t,1,1);this.prevMesh.geometry=e;const n=new Pr(i,t,1,1);this.nextMesh.geometry=n,this.prevDepth=this.prevMesh.position.z}updateAnimation(i){const t=this.options.find(e=>e.name==="dir");if(i<.5){const e=i/.5;this.prevMesh.position.x=this.width/2*e,this.prevMesh.rotation.y=-Math.PI/10*e,this.nextMesh.position.x=-this.width/2*e,this.nextMesh.rotation.y=Math.PI/10*e,this.nextMesh.position.z=this.prevDepth-this.depth*(1-e)}else{const e=(i-.5)/.5;this.prevMesh.position.x=this.width/2*(1-e),this.prevMesh.rotation.y=-Math.PI/10*(1-e),this.prevMesh.position.z=this.prevDepth-this.depth*e,this.nextMesh.position.x=-this.width/2*(1-e),this.nextMesh.rotation.y=Math.PI/10*(1-e)}if(t&&t.value==="l")if(i<.5){const e=i/.5;this.prevMesh.position.x=-this.width/2*e,this.prevMesh.rotation.y=Math.PI/10*e,this.nextMesh.position.x=this.width/2*e,this.nextMesh.rotation.y=-Math.PI/10*e}else{const e=(i-.5)/.5;this.prevMesh.position.x=-this.width/2*(1-e),this.prevMesh.rotation.y=Math.PI/10*(1-e),this.nextMesh.position.x=this.width/2*(1-e),this.nextMesh.rotation.y=-Math.PI/10*(1-e)}}},Prism:class{constructor(){this.camera=new ls,this.duration=6e3,this.preset=null,this.presetZ=0,this.mesh=new Tt,this.width=100,this.height=100}addObjects(i){this.mesh.geometry=this.box,i.add(this.mesh)}dispose(){Array.isArray(this.mesh.material)?this.mesh.material.forEach(i=>i.dispose()):this.mesh.material.dispose(),this.mesh.geometry.dispose()}setNextTexture(i){const t=Array.isArray(this.mesh.material)?this.mesh.material:[];t.push(new Qi({map:i})),t.push(new Qi({map:i})),t.push(new Qi({map:i})),this.mesh.material=t}setPrevTexture(i){const t=Array.isArray(this.mesh.material)?this.mesh.material:[];t.push(new Qi({map:i})),t.push(new Qi({map:i})),t.push(new Qi({map:i})),this.mesh.material=t}setSize(i,t){this.camera.updateAspect(i,t),this.camera.focus(this.mesh,t),this.mesh.position.z-=i/2,this.width=i,this.height=t,this.box=new ee(i,t,i,1,1,1),this.mesh.geometry=this.box}updateAnimation(i){this.preset===null&&(this.preset=i>0?0:Math.PI/2,this.presetZ=this.mesh.position.z);const t=Math.PI/2*i,e=(Math.sqrt(2)-1)*(this.width/2);this.mesh.rotation.y=this.preset+t,this.mesh.position.z=i<=.5?this.presetZ-i/.5*e:this.presetZ-(1-(i-.5)/.5)*e}},Doors:class{constructor(){this.camera=new ls,this.duration=1600,this.options=[],this.width=100,this.preMaterial=new hn({fragmentShader:Ub.a,vertexShader:Fb.a,uniforms:{prevTexture:{value:xr},timePercent:{value:0},offset:{value:0}}}),this.prevGeometry=new Xn,this.prevMesh=new Tt,this.nextMesh=new Tt}addObjects(i){this.prevMesh.material=this.preMaterial,this.prevMesh.geometry=this.prevGeometry,this.prevMesh.material.transparent=!0,i.add(this.prevMesh),i.add(this.nextMesh)}setNextTexture(i){this.nextMesh.material=new Qi({map:i})}setPrevTexture(i){this.preMaterial.uniforms.prevTexture.value=i}setSize(i,t){this.width=i,this.camera.updateAspect(i,t),this.camera.focus(this.prevMesh,t);const e=i/2,n=t/2;this.preMaterial.uniforms.offset.value=i/2,this.prevGeometry.setIndex([0,1,2,3,4,5,6,7,8,9,10,11]);const r=this.options.find(s=>s.name==="dir"),o=r&&r.value==="vert"?0:1;this.preMaterial.uniforms.option={value:o},o===1?(this.prevGeometry.setAttribute("position",new An([-e,n,0,-e,0,0,e,n,0,-e,0,0,e,0,0,e,n,0,-e,0,0,-e,-n,0,e,0,0,-e,-n,0,e,-n,0,e,0,0],3)),this.prevGeometry.setAttribute("uv",new An([0,1,0,.5,1,1,0,.5,1,.5,1,1,0,.5,0,0,1,.5,0,0,1,0,1,.5],2))):(this.prevGeometry.setAttribute("position",new An([-e,n,0,-e,-n,0,0,n,0,-e,-n,0,0,-n,0,0,n,0,0,n,0,0,-n,0,e,n,0,0,-n,0,e,-n,0,e,n,0],3)),this.prevGeometry.setAttribute("uv",new An([0,1,0,0,.5,1,0,0,.5,0,.5,1,.5,1,.5,0,1,1,.5,0,1,0,1,1],2))),this.prevGeometry.setAttribute("left",new An([1,1,1,1,1,1,0,0,0,0,0,0],1)),this.nextMesh.geometry=new Pr(i,t,1,1),this.nextMesh.position.z=this.prevMesh.position.z-i/4}updateAnimation(i){this.preMaterial.uniforms.timePercent.value=i,this.nextMesh.position.z=this.prevMesh.position.z-(1-i)*(this.width/4)}dispose(){}}};class Gb{constructor(){this.startTime=0,this.lastTime=0,this.lastFPSTime=0,this.renderingDuration=16,this.reverse=!1,this.scene=new cu,this.delay=0,this.easeFn=qp.linear,this.preset=null,this.onTransactionEnd=()=>{},this.isTransactionStartApplied=!1,this.prevTexture=null,this.nextTexture=null,this.animationId=null,this.config=null,this.renderer=new ni({alpha:!0,premultipliedAlpha:!0}),this.isPlaying=!1,this.animate=(t=-1)=>{var e,n,r;if(!this.fps(t))return void(this.animationId=window.requestAnimationFrame(this.animate));this.renderer.clear(),t>this.delay&&this.lastTime===0&&(this.lastTime=t,this.startTime=t);let o=0;this.lastTime>0&&o<1&&(o=this.easeFn(t-this.startTime,0,1,(n=(e=this.preset)===null||e===void 0?void 0:e.duration)!==null&&n!==void 0?n:0)),o>1&&(o=1),(r=this.preset)===null||r===void 0||r.updateAnimation(this.reverse?1-o:o),this.rerender(),this.isTransactionStartApplied||(this.isTransactionStartApplied=!0),o<1?this.animationId=window.requestAnimationFrame(this.animate):this.onTransactionEnd()}}initPlayer(t){this.config=t,this.reverse=t.reverse,t.delay&&Number.isInteger(t.delay)&&(this.delay=t.delay),t.easeFn&&(this.easeFn=qp[t.easeFn]),t.maxFPS&&Number.isInteger(t.maxFPS)&&t.maxFPS>0&&(this.renderingDuration=Math.ceil(1e3/t.maxFPS)),this.startTime=0,this.lastTime=0,this.scene.clear(),this.renderer.shadowMap.enabled=!0,this.renderer.autoClear=!1,this.renderer.setClearColor(t.clearColor||0),this.isTransactionStartApplied=!1,this.renderer.setSize(t.stageWidth,t.stageHeight),this.preset=new kb[t.presetType],t.options&&(this.preset.options=t.options),t.duration&&Number.isInteger(t.duration)&&(this.preset.duration=t.duration),this.preset.setSize(t.stageWidth,t.stageHeight)}setPrevTexture(t){var e,n,r,o;t.needsUpdate=!0,this.reverse?(this.nextTexture=t,(e=this.preset)===null||e===void 0||e.setNextTexture(t)):(this.prevTexture=t,(n=this.preset)===null||n===void 0||n.setPrevTexture(t)),(r=this.preset)===null||r===void 0||r.addObjects(this.scene),(o=this.preset)===null||o===void 0||o.updateAnimation(this.reverse?1:0),this.rerender()}setNextTexture(t){var e,n;t.needsUpdate=!0,this.reverse?(this.prevTexture=t,(e=this.preset)===null||e===void 0||e.setPrevTexture(t)):(this.nextTexture=t,(n=this.preset)===null||n===void 0||n.setNextTexture(t))}play(){return new Promise(t=>{this.onTransactionEnd=t,this.animate(),this.isPlaying=!0})}rerender(){var t;this.renderer.clear(),!((t=this.preset)===null||t===void 0)&&t.camera.camera&&this.renderer.render(this.scene,this.preset.camera.camera)}fps(t){return t<=0?!0:this.lastFPSTime<0?(this.lastFPSTime=t,!0):t-this.lastFPSTime>=this.renderingDuration&&(this.lastFPSTime=t,!0)}skip(){var t;(t=this.preset)===null||t===void 0||t.updateAnimation(this.reverse?0:1),this.rerender(),this.dispose(),this.onTransactionEnd()}dispose(){var t,e,n;window.cancelAnimationFrame(this.animationId),this.renderer.clear(),this.isPlaying=!1,(t=this.preset)===null||t===void 0||t.dispose(),(e=this.prevTexture)===null||e===void 0||e.dispose(),(n=this.nextTexture)===null||n===void 0||n.dispose();for(let r=this.scene.children.length-1;r>=0;r--){const o=this.scene.children[r];this.scene.remove(o)}this.scene.background=null}destroy(){this.dispose(),this.renderer.forceContextLoss(),this.renderer.dispose()}}v(139);var xn=v(3),Cn=v(5);Cn.c.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var Qp=function(){function i(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(xn.isMobile.tablet||xn.isMobile.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2 .toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(i.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),i.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2 .toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e},i.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},i.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)===null||t===void 0||t.appendChild(this.div))},i.prototype.deactivate=function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)===null||t===void 0||t.removeChild(this.div))},i.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var e=t.children;if(e)for(var n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},i.prototype.update=function(){var t=performance.now();if(!(xn.isMobile.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=e.left,r=e.top,o=e.width,s=e.height,a=this.renderer,l=a.width,h=a.height,u=a.resolution,p=o/l*u,y=s/h*u,x=this.div;x.style.left=n+"px",x.style.top=r+"px",x.style.width=l+"px",x.style.height=h+"px";for(var E=0;E<this.children.length;E++){var w=this.children[E];if(w.renderId!==this.renderId)w._accessibleActive=!1,Object(xn.removeItems)(this.children,E,1),this.div.removeChild(w._accessibleDiv),this.pool.push(w._accessibleDiv),w._accessibleDiv=null,E--;else{x=w._accessibleDiv;var C=w.hitArea,j=w.worldTransform;w.hitArea?(x.style.left=(j.tx+C.x*j.a)*p+"px",x.style.top=(j.ty+C.y*j.d)*y+"px",x.style.width=C.width*j.a*p+"px",x.style.height=C.height*j.d*y+"px"):(C=w.getBounds(),this.capHitArea(C),x.style.left=C.x*p+"px",x.style.top=C.y*y+"px",x.style.width=C.width*p+"px",x.style.height=C.height*y+"px",x.title!==w.accessibleTitle&&w.accessibleTitle!==null&&(x.title=w.accessibleTitle),x.getAttribute("aria-label")!==w.accessibleHint&&w.accessibleHint!==null&&x.setAttribute("aria-label",w.accessibleHint)),w.accessibleTitle===x.title&&w.tabIndex===x.tabIndex||(x.title=w.accessibleTitle,x.tabIndex=w.tabIndex,this.debug&&this.updateDebugHTML(x))}}this.renderId++}},i.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},i.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,n=e.width,r=e.height;t.x+t.width>n&&(t.width=n-t.x),t.y+t.height>r&&(t.height=r-t.y)},i.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2 .toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:t.accessibleHint&&t.accessibleHint!==null||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},i.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"click",r),e.dispatchEvent(n,"pointertap",r),e.dispatchEvent(n,"tap",r)},i.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"mouseover",r)},i.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,n=t.target.displayObject,r=e.eventData;e.dispatchEvent(n,"mouseout",r)},i.prototype._onKeyDown=function(t){t.keyCode===9&&this.activate()},i.prototype._onMouseMove=function(t){t.movementX===0&&t.movementY===0||this.deactivate()},i.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},i}(),De=v(1),tr=v(7),$p=function(){function i(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new De.g,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(i.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),i.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},i.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},i.prototype.reset=function(){this.isPrimary=!1},i}(),tf=function(i,t){return(tf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},Hb=function(){function i(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return i.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},i.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},i}(),Lu=function(){function i(t){this._pointerId=t,this._flags=i.FLAGS.NONE}return i.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(i.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"none",{get:function(){return this._flags===i.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"over",{get:function(){return(this._flags&i.FLAGS.OVER)!=0},set:function(t){this._doSet(i.FLAGS.OVER,t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rightDown",{get:function(){return(this._flags&i.FLAGS.RIGHT_DOWN)!=0},set:function(t){this._doSet(i.FLAGS.RIGHT_DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"leftDown",{get:function(){return(this._flags&i.FLAGS.LEFT_DOWN)!=0},set:function(t){this._doSet(i.FLAGS.LEFT_DOWN,t)},enumerable:!1,configurable:!0}),i.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),i}(),jb=function(){function i(){this._tempPoint=new De.g}return i.prototype.recursiveFindHit=function(t,e,n,r,o){if(!e||!e.visible)return!1;var s=t.data.global,a=!1,l=o=e.interactive||o,h=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?a=!0:(r=!1,h=!1)),l=!1):e._mask&&r&&(e._mask.containsPoint&&e._mask.containsPoint(s)||(r=!1)),h&&e.interactiveChildren&&e.children)for(var u=e.children,p=u.length-1;p>=0;p--){var y=u[p],x=this.recursiveFindHit(t,y,n,r,l);if(x){if(!y.parent)continue;l=!1,x&&(t.target&&(r=!1),a=!0)}}return o&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(a=!0),e.interactive&&(a&&!t.target&&(t.target=e),n&&n(t,e,!!a))),a},i.prototype.findHit=function(t,e,n,r){this.recursiveFindHit(t,e,n,r,!1)},i}(),zb={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(i){i?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};Cn.c.mixin(zb);var Hl={target:null,data:{global:null}},ef=function(i){function t(e,n){var r=i.call(this)||this;return n=n||{},r.renderer=e,r.autoPreventDefault=n.autoPreventDefault===void 0||n.autoPreventDefault,r.interactionFrequency=n.interactionFrequency||10,r.mouse=new $p,r.mouse.identifier=1,r.mouse.global.set(-999999),r.activeInteractionData={},r.activeInteractionData[1]=r.mouse,r.interactionDataPool=[],r.eventData=new Hb,r.interactionDOMElement=null,r.moveWhenInside=!1,r.eventsAdded=!1,r.tickerAdded=!1,r.mouseOverRenderer=!("PointerEvent"in globalThis),r.supportsTouchEvents="ontouchstart"in globalThis,r.supportsPointerEvents=!!globalThis.PointerEvent,r.onPointerUp=r.onPointerUp.bind(r),r.processPointerUp=r.processPointerUp.bind(r),r.onPointerCancel=r.onPointerCancel.bind(r),r.processPointerCancel=r.processPointerCancel.bind(r),r.onPointerDown=r.onPointerDown.bind(r),r.processPointerDown=r.processPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.processPointerMove=r.processPointerMove.bind(r),r.onPointerOut=r.onPointerOut.bind(r),r.processPointerOverOut=r.processPointerOverOut.bind(r),r.onPointerOver=r.onPointerOver.bind(r),r.cursorStyles={default:"inherit",pointer:"pointer"},r.currentCursorMode=null,r.cursor=null,r.resolution=1,r.delayedEvents=[],r.search=new jb,r._tempDisplayObject=new Cn.d,r._eventListenerOptions={capture:!0,passive:!1},r._useSystemTicker=n.useSystemTicker===void 0||n.useSystemTicker,r.setTargetElement(r.renderer.view,r.renderer.resolution),r}return function(e,n){function r(){this.constructor=e}tf(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),Object.defineProperty(t.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(e,n){return Hl.target=null,Hl.data.global=e,n||(n=this.lastObjectRendered),this.processInteractive(Hl,n,null,!0),Hl.target},t.prototype.setTargetElement=function(e,n){n===void 0&&(n=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=n,this.addEvents(),this.addTickerListener()},t.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(tr.a.system.add(this.tickerUpdate,this,tr.c.INTERACTION),this.tickerAdded=!0)},t.prototype.removeTickerListener=function(){this.tickerAdded&&(tr.a.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},t.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},t.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},t.prototype.tickerUpdate=function(e){this._deltaTime+=e,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},t.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var n=this.activeInteractionData[e];if(n.originalEvent&&n.pointerType!=="touch"){var r=this.configureInteractionEventForDOMEvent(this.eventData,n.originalEvent,n);this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){e=e||"default";var n=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(n=!1),this.currentCursorMode!==e){this.currentCursorMode=e;var r=this.cursorStyles[e];if(r)switch(typeof r){case"string":n&&(this.interactionDOMElement.style.cursor=r);break;case"function":r(e);break;case"object":n&&Object.assign(this.interactionDOMElement.style,r)}else n&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,n,r){r.stopPropagationHint&&e!==r.stopsPropagatingAt||(r.currentTarget=e,r.type=n,e.emit(n,r),e[n]&&e[n](r))},t.prototype.delayDispatchEvent=function(e,n,r){this.delayedEvents.push({displayObject:e,eventString:n,eventData:r})},t.prototype.mapPositionToPoint=function(e,n,r){var o;o=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var s=1/this.resolution;e.x=(n-o.left)*(this.interactionDOMElement.width/o.width)*s,e.y=(r-o.top)*(this.interactionDOMElement.height/o.height)*s},t.prototype.processInteractive=function(e,n,r,o){var s=this.search.findHit(e,n,r,o),a=this.delayedEvents;if(!a.length)return s;e.stopPropagationHint=!1;var l=a.length;this.delayedEvents=[];for(var h=0;h<l;h++){var u=a[h],p=u.displayObject,y=u.eventString,x=u.eventData;x.stopsPropagatingAt===p&&(x.stopPropagationHint=!0),this.dispatchEvent(p,y,x)}return s},t.prototype.onPointerDown=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var n=this.normalizeToPointerData(e);this.autoPreventDefault&&n[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(var r=n.length,o=0;o<r;o++){var s=n[o],a=this.getInteractionDataForPointerId(s),l=this.configureInteractionEventForDOMEvent(this.eventData,s,a);if(l.data.originalEvent=e,this.processInteractive(l,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",l),s.pointerType==="touch")this.emit("touchstart",l);else if(s.pointerType==="mouse"||s.pointerType==="pen"){var h=s.button===2;this.emit(h?"rightdown":"mousedown",this.eventData)}}}},t.prototype.processPointerDown=function(e,n,r){var o=e.data,s=e.data.identifier;if(r){if(n.trackedPointers[s]||(n.trackedPointers[s]=new Lu(s)),this.dispatchEvent(n,"pointerdown",e),o.pointerType==="touch")this.dispatchEvent(n,"touchstart",e);else if(o.pointerType==="mouse"||o.pointerType==="pen"){var a=o.button===2;a?n.trackedPointers[s].rightDown=!0:n.trackedPointers[s].leftDown=!0,this.dispatchEvent(n,a?"rightdown":"mousedown",e)}}},t.prototype.onPointerComplete=function(e,n,r){for(var o=this.normalizeToPointerData(e),s=o.length,a=e.target!==this.interactionDOMElement?"outside":"",l=0;l<s;l++){var h=o[l],u=this.getInteractionDataForPointerId(h),p=this.configureInteractionEventForDOMEvent(this.eventData,h,u);if(p.data.originalEvent=e,this.processInteractive(p,this.lastObjectRendered,r,n||!a),this.emit(n?"pointercancel":"pointerup"+a,p),h.pointerType==="mouse"||h.pointerType==="pen"){var y=h.button===2;this.emit(y?"rightup"+a:"mouseup"+a,p)}else h.pointerType==="touch"&&(this.emit(n?"touchcancel":"touchend"+a,p),this.releaseInteractionDataForPointerId(h.pointerId))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,n){var r=e.data,o=e.data.identifier;n.trackedPointers[o]!==void 0&&(delete n.trackedPointers[o],this.dispatchEvent(n,"pointercancel",e),r.pointerType==="touch"&&this.dispatchEvent(n,"touchcancel",e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,n,r){var o=e.data,s=e.data.identifier,a=n.trackedPointers[s],l=o.pointerType==="touch",h=o.pointerType==="mouse"||o.pointerType==="pen",u=!1;if(h){var p=o.button===2,y=Lu.FLAGS,x=p?y.RIGHT_DOWN:y.LEFT_DOWN,E=a!==void 0&&a.flags&x;r?(this.dispatchEvent(n,p?"rightup":"mouseup",e),E&&(this.dispatchEvent(n,p?"rightclick":"click",e),u=!0)):E&&this.dispatchEvent(n,p?"rightupoutside":"mouseupoutside",e),a&&(p?a.rightDown=!1:a.leftDown=!1)}r?(this.dispatchEvent(n,"pointerup",e),l&&this.dispatchEvent(n,"touchend",e),a&&(h&&!u||this.dispatchEvent(n,"pointertap",e),l&&(this.dispatchEvent(n,"tap",e),a.over=!1))):a&&(this.dispatchEvent(n,"pointerupoutside",e),l&&this.dispatchEvent(n,"touchendoutside",e)),a&&a.none&&delete n.trackedPointers[s]},t.prototype.onPointerMove=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var n=this.normalizeToPointerData(e);n[0].pointerType!=="mouse"&&n[0].pointerType!=="pen"||(this._didMove=!0,this.cursor=null);for(var r=n.length,o=0;o<r;o++){var s=n[o],a=this.getInteractionDataForPointerId(s),l=this.configureInteractionEventForDOMEvent(this.eventData,s,a);l.data.originalEvent=e,this.processInteractive(l,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",l),s.pointerType==="touch"&&this.emit("touchmove",l),s.pointerType!=="mouse"&&s.pointerType!=="pen"||this.emit("mousemove",l)}n[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,n,r){var o=e.data,s=o.pointerType==="touch",a=o.pointerType==="mouse"||o.pointerType==="pen";a&&this.processPointerOverOut(e,n,r),this.moveWhenInside&&!r||(this.dispatchEvent(n,"pointermove",e),s&&this.dispatchEvent(n,"touchmove",e),a&&this.dispatchEvent(n,"mousemove",e))},t.prototype.onPointerOut=function(e){if(!this.supportsTouchEvents||e.pointerType!=="touch"){var n=this.normalizeToPointerData(e)[0];n.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var r=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,r);o.data.originalEvent=n,this.processInteractive(o,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",o),n.pointerType==="mouse"||n.pointerType==="pen"?this.emit("mouseout",o):this.releaseInteractionDataForPointerId(r.identifier)}},t.prototype.processPointerOverOut=function(e,n,r){var o=e.data,s=e.data.identifier,a=o.pointerType==="mouse"||o.pointerType==="pen",l=n.trackedPointers[s];r&&!l&&(l=n.trackedPointers[s]=new Lu(s)),l!==void 0&&(r&&this.mouseOverRenderer?(l.over||(l.over=!0,this.delayDispatchEvent(n,"pointerover",e),a&&this.delayDispatchEvent(n,"mouseover",e)),a&&this.cursor===null&&(this.cursor=n.cursor)):l.over&&(l.over=!1,this.dispatchEvent(n,"pointerout",this.eventData),a&&this.dispatchEvent(n,"mouseout",e),l.none&&delete n.trackedPointers[s]))},t.prototype.onPointerOver=function(e){var n=this.normalizeToPointerData(e)[0],r=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,r);o.data.originalEvent=n,n.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",o),n.pointerType!=="mouse"&&n.pointerType!=="pen"||this.emit("mouseover",o)},t.prototype.getInteractionDataForPointerId=function(e){var n,r=e.pointerId;return r===1||e.pointerType==="mouse"?n=this.mouse:this.activeInteractionData[r]?n=this.activeInteractionData[r]:((n=this.interactionDataPool.pop()||new $p).identifier=r,this.activeInteractionData[r]=n),n.copyEvent(e),n},t.prototype.releaseInteractionDataForPointerId=function(e){var n=this.activeInteractionData[e];n&&(delete this.activeInteractionData[e],n.reset(),this.interactionDataPool.push(n))},t.prototype.configureInteractionEventForDOMEvent=function(e,n,r){return e.data=r,this.mapPositionToPoint(r.global,n.clientX,n.clientY),n.pointerType==="touch"&&(n.globalX=r.global.x,n.globalY=r.global.y),r.originalEvent=n,e.reset(),e},t.prototype.normalizeToPointerData=function(e){var n=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var r=0,o=e.changedTouches.length;r<o;r++){var s=e.changedTouches[r];s.button===void 0&&(s.button=e.touches.length?1:0),s.buttons===void 0&&(s.buttons=e.touches.length?1:0),s.isPrimary===void 0&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),s.width===void 0&&(s.width=s.radiusX||1),s.height===void 0&&(s.height=s.radiusY||1),s.tiltX===void 0&&(s.tiltX=0),s.tiltY===void 0&&(s.tiltY=0),s.pointerType===void 0&&(s.pointerType="touch"),s.pointerId===void 0&&(s.pointerId=s.identifier||0),s.pressure===void 0&&(s.pressure=s.force||.5),s.twist===void 0&&(s.twist=0),s.tangentialPressure===void 0&&(s.tangentialPressure=0),s.layerX===void 0&&(s.layerX=s.offsetX=s.clientX),s.layerY===void 0&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,n.push(s)}else if(globalThis.MouseEvent&&(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof globalThis.PointerEvent))n.push(e);else{var a=e;a.isPrimary===void 0&&(a.isPrimary=!0),a.width===void 0&&(a.width=1),a.height===void 0&&(a.height=1),a.tiltX===void 0&&(a.tiltX=0),a.tiltY===void 0&&(a.tiltY=0),a.pointerType===void 0&&(a.pointerType="mouse"),a.pointerId===void 0&&(a.pointerId=1),a.pressure===void 0&&(a.pressure=.5),a.twist===void 0&&(a.twist=0),a.tangentialPressure===void 0&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}return n},t.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},t}(xn.EventEmitter),ce=v(2),jl=function(){function i(t){var e=this;this.stage=new Cn.b,t=Object.assign({forceCanvas:!1},t),this.renderer=Object(ce.y)(t),i._plugins.forEach(function(n){n.init.call(e,t)})}return i.registerPlugin=function(t){i._plugins.push(t)},i.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(i.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),i.prototype.destroy=function(t,e){var n=this,r=i._plugins.slice(0);r.reverse(),r.forEach(function(o){o.destroy.call(n)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null},i._plugins=[],i}(),Vb=function(){function i(){}return i.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(n){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=n,n&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame(function(){return e.resize()}))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var n,r;if(e.cancelResize(),e._resizeTo===globalThis.window)n=globalThis.innerWidth,r=globalThis.innerHeight;else{var o=e._resizeTo;n=o.clientWidth,r=o.clientHeight}e.renderer.resize(n,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},i.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},i}();jl.registerPlugin(Vb);/*!
 * @pixi/extract - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Du=/iPhone/i,nf=/iPod/i,rf=/iPad/i,of=/\biOS-universal(?:.+)Mac\b/i,Fu=/\bAndroid(?:.+)Mobile\b/i,sf=/Android/i,Bs=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,zl=/Silk/i,co=/Windows Phone/i,af=/\bWindows(?:.+)ARM\b/i,lf=/BlackBerry/i,hf=/BB10/i,uf=/Opera Mini/i,cf=/\b(CriOS|Chrome)(?:.+)Mobile/i,df=/Mobile(?:.+)Firefox\b/i,pf=function(i){return i!==void 0&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream=="undefined"};/*!
 * @pixi/settings - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ff,mf,gf,vf,_f,yf,xf,bf,Tf,Bu,Uu,ku,Ef,Sf,Gu,Pa,wf,Hu,Af,Us=function(i){var t={userAgent:"",platform:"",maxTouchPoints:0};i||typeof navigator=="undefined"?typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var e=t.userAgent,n=e.split("[FBAN");n[1]!==void 0&&(e=n[0]),(n=e.split("Twitter"))[1]!==void 0&&(e=n[0]);var r=function(s){return function(a){return a.test(s)}}(e),o={apple:{phone:r(Du)&&!r(co),ipod:r(nf),tablet:!r(Du)&&(r(rf)||pf(t))&&!r(co),universal:r(of),device:(r(Du)||r(nf)||r(rf)||r(of)||pf(t))&&!r(co)},amazon:{phone:r(Bs),tablet:!r(Bs)&&r(zl),device:r(Bs)||r(zl)},android:{phone:!r(co)&&r(Bs)||!r(co)&&r(Fu),tablet:!r(co)&&!r(Bs)&&!r(Fu)&&(r(zl)||r(sf)),device:!r(co)&&(r(Bs)||r(zl)||r(Fu)||r(sf))||r(/\bokhttp\b/i)},windows:{phone:r(co),tablet:r(af),device:r(co)||r(af)},other:{blackberry:r(lf),blackberry10:r(hf),opera:r(uf),firefox:r(df),chrome:r(cf),device:r(lf)||r(hf)||r(uf)||r(df)||r(cf)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}(globalThis.navigator);(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(ff||(ff={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(mf||(mf={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(gf||(gf={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(vf||(vf={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(_f||(_f={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(yf||(yf={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(xf||(xf={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(bf||(bf={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(Tf||(Tf={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(Bu||(Bu={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Uu||(Uu={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(ku||(ku={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Ef||(Ef={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(Sf||(Sf={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(Gu||(Gu={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(Pa||(Pa={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(wf||(wf={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(Hu||(Hu={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Af||(Af={}));var Wb={MIPMAP_TEXTURES:ku.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:Hu.NONE,SPRITE_MAX_TEXTURES:function(i){var t=!0;if(Us.tablet||Us.phone){var e;Us.apple.device&&(e=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(e[1],10)<11&&(t=!1),Us.android.device&&(e=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(e[1],10)<7&&(t=!1)}return t?i:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:Gu.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:Uu.CLAMP,SCALE_MODE:Bu.LINEAR,PRECISION_VERTEX:Pa.HIGH,PRECISION_FRAGMENT:Us.apple.device?Pa.HIGH:Pa.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!Us.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1,SORTABLE_CHILDREN:!1},Mf=function(){function i(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return i.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},i.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},i.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?De.j.EMPTY:((t=t||new De.j(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},i.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},i.prototype.addPointMatrix=function(t,e){var n=t.a,r=t.b,o=t.c,s=t.d,a=t.tx,l=t.ty,h=n*e.x+o*e.y+a,u=r*e.x+s*e.y+l;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)},i.prototype.addQuad=function(t){var e=this.minX,n=this.minY,r=this.maxX,o=this.maxY,s=t[0],a=t[1];e=s<e?s:e,n=a<n?a:n,r=s>r?s:r,o=a>o?a:o,e=(s=t[2])<e?s:e,n=(a=t[3])<n?a:n,r=s>r?s:r,o=a>o?a:o,e=(s=t[4])<e?s:e,n=(a=t[5])<n?a:n,r=s>r?s:r,o=a>o?a:o,e=(s=t[6])<e?s:e,n=(a=t[7])<n?a:n,r=s>r?s:r,o=a>o?a:o,this.minX=e,this.minY=n,this.maxX=r,this.maxY=o},i.prototype.addFrame=function(t,e,n,r,o){this.addFrameMatrix(t.worldTransform,e,n,r,o)},i.prototype.addFrameMatrix=function(t,e,n,r,o){var s=t.a,a=t.b,l=t.c,h=t.d,u=t.tx,p=t.ty,y=this.minX,x=this.minY,E=this.maxX,w=this.maxY,C=s*e+l*n+u,j=a*e+h*n+p;y=C<y?C:y,x=j<x?j:x,E=C>E?C:E,w=j>w?j:w,y=(C=s*r+l*n+u)<y?C:y,x=(j=a*r+h*n+p)<x?j:x,E=C>E?C:E,w=j>w?j:w,y=(C=s*e+l*o+u)<y?C:y,x=(j=a*e+h*o+p)<x?j:x,E=C>E?C:E,w=j>w?j:w,y=(C=s*r+l*o+u)<y?C:y,x=(j=a*r+h*o+p)<x?j:x,E=C>E?C:E,w=j>w?j:w,this.minX=y,this.minY=x,this.maxX=E,this.maxY=w},i.prototype.addVertexData=function(t,e,n){for(var r=this.minX,o=this.minY,s=this.maxX,a=this.maxY,l=e;l<n;l+=2){var h=t[l],u=t[l+1];r=h<r?h:r,o=u<o?u:o,s=h>s?h:s,a=u>a?u:a}this.minX=r,this.minY=o,this.maxX=s,this.maxY=a},i.prototype.addVertices=function(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)},i.prototype.addVerticesMatrix=function(t,e,n,r,o,s){o===void 0&&(o=0),s===void 0&&(s=o);for(var a=t.a,l=t.b,h=t.c,u=t.d,p=t.tx,y=t.ty,x=this.minX,E=this.minY,w=this.maxX,C=this.maxY,j=n;j<r;j+=2){var Z=e[j],rt=e[j+1],ct=a*Z+h*rt+p,nt=u*rt+l*Z+y;x=Math.min(x,ct-o),w=Math.max(w,ct+o),E=Math.min(E,nt-s),C=Math.max(C,nt+s)}this.minX=x,this.minY=E,this.maxX=w,this.maxY=C},i.prototype.addBounds=function(t){var e=this.minX,n=this.minY,r=this.maxX,o=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>o?t.maxY:o},i.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,o=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=o&&r<=s){var a=this.minX,l=this.minY,h=this.maxX,u=this.maxY;this.minX=n<a?n:a,this.minY=r<l?r:l,this.maxX=o>h?o:h,this.maxY=s>u?s:u}},i.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},i.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,o=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=o&&r<=s){var a=this.minX,l=this.minY,h=this.maxX,u=this.maxY;this.minX=n<a?n:a,this.minY=r<l?r:l,this.maxX=o>h?o:h,this.maxY=s>u?s:u}},i.prototype.pad=function(t,e){t===void 0&&(t=0),e===void 0&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},i.prototype.addFramePad=function(t,e,n,r,o,s){t-=o,e-=s,n+=o,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r},i}(),Cf=function(i,t){return(Cf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function ju(i,t){function e(){this.constructor=i}Cf(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Rf,If,Pf,Of,Nf,Lf,Df,Ff,Bf,Uf,kf,Gf,Hf,jf,zf,Vf,zu,Wf,Xf,Oa=function(i){function t(){var e=i.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new De.m,e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Mf,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return ju(t,i),t.mixin=function(e){for(var n=Object.keys(e),r=0;r<n.length;++r){var o=n[r];Object.defineProperty(t.prototype,o,Object.getOwnPropertyDescriptor(e,o))}},Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},t.prototype.getBounds=function(e,n){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),n||(this._boundsRect||(this._boundsRect=new De.j),n=this._boundsRect),this._bounds.getRectangle(n)},t.prototype.getLocalBounds=function(e){e||(this._localBoundsRect||(this._localBoundsRect=new De.j),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Mf);var n=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var o=this._bounds,s=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,e);return this.parent=r,this.transform=n,this._bounds=o,this._bounds.updateID+=this._boundsID-s,a},t.prototype.toGlobal=function(e,n,r){return r===void 0&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,n)},t.prototype.toLocal=function(e,n,r,o){return n&&(e=n.toGlobal(e,r,o)),o||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)},t.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},t.prototype.setTransform=function(e,n,r,o,s,a,l,h,u){return e===void 0&&(e=0),n===void 0&&(n=0),r===void 0&&(r=1),o===void 0&&(o=1),s===void 0&&(s=0),a===void 0&&(a=0),l===void 0&&(l=0),h===void 0&&(h=0),u===void 0&&(u=0),this.position.x=e,this.position.y=n,this.scale.x=r||1,this.scale.y=o||1,this.rotation=s,this.skew.x=a,this.skew.y=l,this.pivot.x=h,this.pivot.y=u,this},t.prototype.destroy=function(e){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(t.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Xb),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),t.prototype.enableTempParent=function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e},t.prototype.disableTempParent=function(e){this.parent=e},Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.transform.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.transform.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skew",{get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.transform.rotation*De.i},set:function(e){this.transform.rotation=e*De.b},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(e){if(this._mask!==e){var n;this._mask&&((n=this._mask.maskObject||this._mask)._maskRefCount--,n._maskRefCount===0&&(n.renderable=!0,n.isMask=!1)),this._mask=e,this._mask&&((n=this._mask.maskObject||this._mask)._maskRefCount===0&&(n.renderable=!1,n.isMask=!0),n._maskRefCount++)}},enumerable:!1,configurable:!0}),t}(xn.EventEmitter),Xb=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.sortDirty=null,e}return ju(t,i),t}(Oa);function Yb(i,t){return i.zIndex===t.zIndex?i._lastSortedIndex-t._lastSortedIndex:i.zIndex-t.zIndex}Oa.prototype.displayObjectUpdateTransform=Oa.prototype.updateTransform,function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"}(Rf||(Rf={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(If||(If={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(Pf||(Pf={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(Of||(Of={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Nf||(Nf={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Lf||(Lf={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Df||(Df={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(Ff||(Ff={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(Bf||(Bf={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(Uf||(Uf={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(kf||(kf={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(Gf||(Gf={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Hf||(Hf={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(jf||(jf={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(zf||(zf={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(Vf||(Vf={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(zu||(zu={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(Wf||(Wf={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Xf||(Xf={}));var Yf=function(i){function t(){var e=i.call(this)||this;return e.children=[],e.sortableChildren=Wb.SORTABLE_CHILDREN,e.sortDirty=!1,e}return ju(t,i),t.prototype.onChildrenChange=function(e){},t.prototype.addChild=function(){for(var e=arguments,n=[],r=0;r<arguments.length;r++)n[r]=e[r];if(n.length>1)for(var o=0;o<n.length;o++)this.addChild(n[o]);else{var s=n[0];s.parent&&s.parent.removeChild(s),s.parent=this,this.sortDirty=!0,s.transform._parentID=-1,this.children.push(s),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",s,this,this.children.length-1),s.emit("added",this)}return n[0]},t.prototype.addChildAt=function(e,n){if(n<0||n>this.children.length)throw new Error(e+"addChildAt: The index "+n+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(n,0,e),this._boundsID++,this.onChildrenChange(n),e.emit("added",this),this.emit("childAdded",e,this,n),e},t.prototype.swapChildren=function(e,n){if(e!==n){var r=this.getChildIndex(e),o=this.getChildIndex(n);this.children[r]=n,this.children[o]=e,this.onChildrenChange(r<o?r:o)}},t.prototype.getChildIndex=function(e){var n=this.children.indexOf(e);if(n===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return n},t.prototype.setChildIndex=function(e,n){if(n<0||n>=this.children.length)throw new Error("The index "+n+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(e);Object(xn.removeItems)(this.children,r,1),this.children.splice(n,0,e),this.onChildrenChange(n)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},t.prototype.removeChild=function(){for(var e=arguments,n=[],r=0;r<arguments.length;r++)n[r]=e[r];if(n.length>1)for(var o=0;o<n.length;o++)this.removeChild(n[o]);else{var s=n[0],a=this.children.indexOf(s);if(a===-1)return null;s.parent=null,s.transform._parentID=-1,Object(xn.removeItems)(this.children,a,1),this._boundsID++,this.onChildrenChange(a),s.emit("removed",this),this.emit("childRemoved",s,this,a)}return n[0]},t.prototype.removeChildAt=function(e){var n=this.getChildAt(e);return n.parent=null,n.transform._parentID=-1,Object(xn.removeItems)(this.children,e,1),this._boundsID++,this.onChildrenChange(e),n.emit("removed",this),this.emit("childRemoved",n,this,e),n},t.prototype.removeChildren=function(e,n){e===void 0&&(e=0),n===void 0&&(n=this.children.length);var r,o=e,s=n-o;if(s>0&&s<=n){r=this.children.splice(o,s);for(var a=0;a<r.length;++a)r[a].parent=null,r[a].transform&&(r[a].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(e),a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var e=!1,n=0,r=this.children.length;n<r;++n){var o=this.children[n];o._lastSortedIndex=n,e||o.zIndex===0||(e=!0)}e&&this.children.length>1&&this.children.sort(Yb),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,n=this.children.length;e<n;++e){var r=this.children[e];r.visible&&r.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var n=this.children[e];if(n.visible&&n.renderable)if(n.calculateBounds(),n._mask){var r=n._mask.maskObject||n._mask;r.calculateBounds(),this._bounds.addBoundsMask(n._bounds,r._bounds)}else n.filterArea?this._bounds.addBoundsArea(n._bounds,n.filterArea):this._bounds.addBounds(n._bounds)}this._bounds.updateID=this._boundsID},t.prototype.getLocalBounds=function(e,n){n===void 0&&(n=!1);var r=i.prototype.getLocalBounds.call(this,e);if(!n)for(var o=0,s=this.children.length;o<s;++o){var a=this.children[o];a.visible&&a.updateTransform()}return r},t.prototype._calculateBounds=function(){},t.prototype._renderWithCulling=function(e){var n=e.renderTexture.sourceFrame;if(n.width>0&&n.height>0){var r,o;if(this.cullArea?(r=this.cullArea,o=this.worldTransform):this._render!==t.prototype._render&&(r=this.getBounds(!0)),r&&n.intersects(r,o))this._render(e);else if(this.cullArea)return;for(var s=0,a=this.children.length;s<a;++s){var l=this.children[s],h=l.cullable;l.cullable=h||!this.cullArea,l.render(e),l.cullable=h}}},t.prototype.render=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(var n=0,r=this.children.length;n<r;++n)this.children[n].render(e)}},t.prototype.renderAdvanced=function(e){var n=this.filters,r=this._mask;if(n){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var o=0;o<n.length;o++)n[o].enabled&&this._enabledFilters.push(n[o])}var s=n&&this._enabledFilters&&this._enabledFilters.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==zu.NONE));if(s&&e.batch.flush(),n&&this._enabledFilters&&this._enabledFilters.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e),o=0;for(var a=this.children.length;o<a;++o)this.children[o].render(e)}s&&e.batch.flush(),r&&e.mask.pop(this),n&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},t.prototype._render=function(e){},t.prototype.destroy=function(e){i.prototype.destroy.call(this),this.sortDirty=!1;var n=typeof e=="boolean"?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(n)for(var o=0;o<r.length;++o)r[o].destroy(e)},Object.defineProperty(t.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var n=this.getLocalBounds().width;this.scale.x=n!==0?e/n:1,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var n=this.getLocalBounds().height;this.scale.y=n!==0?e/n:1,this._height=e},enumerable:!1,configurable:!0}),t}(Oa);Yf.prototype.containerUpdateTransform=Yf.prototype.updateTransform;var Vu=new De.j,qb=function(){function i(t){this.renderer=t}return i.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},i.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},i.prototype.canvas=function(t){var e,n,r,o=this.renderer,s=!1,a=!1;t&&(t instanceof ce.p?r=t:(r=this.renderer.generateTexture(t),a=!0)),r?(e=r.baseTexture.resolution,n=r.frame,s=!1,o.renderTexture.bind(r)):(e=this.renderer.resolution,s=!0,(n=Vu).width=this.renderer.width,n.height=this.renderer.height,o.renderTexture.bind(null));var l=Math.floor(n.width*e+1e-4),h=Math.floor(n.height*e+1e-4),u=new xn.CanvasRenderTarget(l,h,1),p=new Uint8Array(4*l*h),y=o.gl;y.readPixels(n.x*e,n.y*e,l,h,y.RGBA,y.UNSIGNED_BYTE,p);var x=u.context.getImageData(0,0,l,h);if(i.arrayPostDivide(p,x.data),u.context.putImageData(x,0,0),s){var E=new xn.CanvasRenderTarget(u.width,u.height,1);E.context.scale(1,-1),E.context.drawImage(u.canvas,0,-h),u.destroy(),u=E}return a&&r.destroy(!0),u.canvas},i.prototype.pixels=function(t,e){var n,r,o,s=this.renderer,a=!1;t&&(t instanceof ce.p?o=t:t instanceof Oa&&(o=this.renderer.generateTexture(t),a=!0)),o?e?(n=e.resolution,r=o.frame,s.renderTexture.bind(o)):(n=o.baseTexture.resolution,r=o.frame,s.renderTexture.bind(o)):e?(n=e.resolution,(r=Vu).width=e.width,r.height=e.height,s.renderTexture.bind(null)):(n=s.resolution,(r=Vu).width=s.width,r.height=s.height,s.renderTexture.bind(null));var l=r.width*n,h=r.height*n,u=new Uint8Array(4*l*h),p=s.gl;return p.readPixels(r.x*n,r.y*n,l,h,p.RGBA,p.UNSIGNED_BYTE,u),a&&o.destroy(!0),i.arrayPostDivide(u,u),u},i.prototype.destroy=function(){this.renderer=null},i.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var r=e[n+3]=t[n+3];r!==0?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}},i}(),Vl=function(){function i(t,e,n){e===void 0&&(e=!1),this._fn=t,this._once=e,this._thisArg=n,this._next=this._prev=this._owner=null}return i.prototype.detach=function(){return this._owner!==null&&(this._owner.detach(this),!0)},i}();function qf(i,t){return i._head?(i._tail._next=t,t._prev=i._tail,i._tail=t):(i._head=t,i._tail=t),t._owner=i,t}var Wu,po=function(){function i(){this._head=this._tail=void 0}return i.prototype.handlers=function(t){t===void 0&&(t=!1);var e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n},i.prototype.has=function(t){if(!(t instanceof Vl))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},i.prototype.dispatch=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var r=this._head;if(!r)return!1;for(;r;)r._once&&this.detach(r),r._fn.apply(r._thisArg,e),r=r._next;return!0},i.prototype.add=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return qf(this,new Vl(t,!1,e))},i.prototype.once=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return qf(this,new Vl(t,!0,e))},i.prototype.detach=function(t){if(!(t instanceof Vl))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,t._next===null&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this},i.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},i}();function Jf(i,t){t=t||{};for(var e={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=e.parser[t.strictMode?"strict":"loose"].exec(i),r={},o=14;o--;)r[e.key[o]]=n[o]||"";return r[e.q.name]={},r[e.key[12]].replace(e.q.parser,function(s,a,l){a&&(r[e.q.name][a]=l)}),r}var Wl=null;function Kf(){}function Zf(i,t,e){t&&t.indexOf(".")===0&&(t=t.substring(1)),t&&(i[t]=e)}function Xu(i){return i.toString().replace("object ","")}var wi=function(){function i(t,e,n){if(this._dequeue=Kf,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,typeof t!="string"||typeof e!="string")throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(i.STATUS_FLAGS.DATA_URL,e.indexOf("data:")===0),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=n.crossOrigin===!0?"anonymous":n.crossOrigin,this.timeout=n.timeout||0,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=i.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Kf,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new po,this.onProgress=new po,this.onComplete=new po,this.onAfterMiddleware=new po}return i.setExtensionLoadType=function(t,e){Zf(i._loadTypeMap,t,e)},i.setExtensionXhrType=function(t,e){Zf(i._xhrTypeMap,t,e)},Object.defineProperty(i.prototype,"isDataUrl",{get:function(){return this._hasFlag(i.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isComplete",{get:function(){return this._hasFlag(i.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isLoading",{get:function(){return this._hasFlag(i.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),i.prototype.complete=function(){this._clearEvents(),this._finish()},i.prototype.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=i.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},i.prototype.load=function(t){var e=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout(function(){return t(e)},1);else switch(t&&this.onComplete.once(t),this._setFlag(i.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),this.crossOrigin!==!1&&typeof this.crossOrigin=="string"||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case i.LOAD_TYPE.IMAGE:this.type=i.TYPE.IMAGE,this._loadElement("image");break;case i.LOAD_TYPE.AUDIO:this.type=i.TYPE.AUDIO,this._loadSourceElement("audio");break;case i.LOAD_TYPE.VIDEO:this.type=i.TYPE.VIDEO,this._loadSourceElement("video");break;case i.LOAD_TYPE.XHR:default:Wu===void 0&&(Wu=!(!globalThis.XDomainRequest||"withCredentials"in new XMLHttpRequest)),Wu&&this.crossOrigin?this._loadXdr():this._loadXhr()}},i.prototype._hasFlag=function(t){return(this._flags&t)!=0},i.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},i.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},i.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(i.STATUS_FLAGS.COMPLETE,!0),this._setFlag(i.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},i.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:t==="image"&&globalThis.Image!==void 0?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},i.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:t==="audio"&&globalThis.Audio!==void 0?this.data=new Audio:this.data=document.createElement(t),this.data!==null){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else e=this.metadata.mimeType,this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e));this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},i.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;this.crossOrigin==="use-credentials"&&(t.withCredentials=!0),t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===i.XHR_RESPONSE_TYPE.JSON||this.xhrType===i.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=i.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},i.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new globalThis.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},i.prototype._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=n,r},i.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},i.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},i.prototype._onTimeout=function(){this.abort("Load timed out.")},i.prototype._xhrOnError=function(){var t=this.xhr;this.abort(Xu(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},i.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(Xu(t)+" Request timed out.")},i.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(Xu(t)+" Request was aborted by the user.")},i.prototype._xhrOnLoad=function(){var t=this.xhr,e="",n=t.status===void 0?200:t.status;if(t.responseType!==""&&t.responseType!=="text"&&t.responseType!==void 0||(e=t.responseText),n===0&&(e.length>0||t.responseType===i.XHR_RESPONSE_TYPE.BUFFER)?n=200:n===1223&&(n=204),(n/100|0)===2){if(this.xhrType===i.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=i.TYPE.TEXT;else if(this.xhrType===i.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),this.type=i.TYPE.JSON}catch(s){return void this.abort("Error trying to parse loaded json: "+s)}else if(this.xhrType===i.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var r=new DOMParser;this.data=r.parseFromString(e,"text/xml")}else{var o=document.createElement("div");o.innerHTML=e,this.data=o}this.type=i.TYPE.XML}catch(s){return void this.abort("Error trying to parse loaded xml: "+s)}else this.data=t.response||e;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},i.prototype._determineCrossOrigin=function(t,e){if(t.indexOf("data:")===0)return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";e=e||globalThis.location,Wl||(Wl=document.createElement("a")),Wl.href=t;var n=Jf(Wl.href,{strictMode:!0}),r=!n.port&&e.port===""||n.port===e.port,o=n.protocol?n.protocol+":":"";return n.host===e.hostname&&r&&o===e.protocol?"":"anonymous"},i.prototype._determineXhrType=function(){return i._xhrTypeMap[this.extension]||i.XHR_RESPONSE_TYPE.TEXT},i.prototype._determineLoadType=function(){return i._loadTypeMap[this.extension]||i.LOAD_TYPE.XHR},i.prototype._getExtension=function(t){t===void 0&&(t=this.url);var e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var r=t.indexOf("?"),o=t.indexOf("#"),s=Math.min(r>-1?r:t.length,o>-1?o:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},i.prototype._getMimeFromXhrType=function(t){switch(t){case i.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case i.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case i.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case i.XHR_RESPONSE_TYPE.JSON:return"application/json";case i.XHR_RESPONSE_TYPE.DEFAULT:case i.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},i}();function hs(){}function Jb(i){return function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(i===null)throw new Error("Callback was already called.");var r=i;i=null,r.apply(this,e)}}(function(i){var t,e,n,r;(t=i.STATUS_FLAGS||(i.STATUS_FLAGS={}))[t.NONE=0]="NONE",t[t.DATA_URL=1]="DATA_URL",t[t.COMPLETE=2]="COMPLETE",t[t.LOADING=4]="LOADING",(e=i.TYPE||(i.TYPE={}))[e.UNKNOWN=0]="UNKNOWN",e[e.JSON=1]="JSON",e[e.XML=2]="XML",e[e.IMAGE=3]="IMAGE",e[e.AUDIO=4]="AUDIO",e[e.VIDEO=5]="VIDEO",e[e.TEXT=6]="TEXT",(n=i.LOAD_TYPE||(i.LOAD_TYPE={}))[n.XHR=1]="XHR",n[n.IMAGE=2]="IMAGE",n[n.AUDIO=3]="AUDIO",n[n.VIDEO=4]="VIDEO",(r=i.XHR_RESPONSE_TYPE||(i.XHR_RESPONSE_TYPE={})).DEFAULT="text",r.BUFFER="arraybuffer",r.BLOB="blob",r.DOCUMENT="document",r.JSON="json",r.TEXT="text",i._loadTypeMap={gif:i.LOAD_TYPE.IMAGE,png:i.LOAD_TYPE.IMAGE,bmp:i.LOAD_TYPE.IMAGE,jpg:i.LOAD_TYPE.IMAGE,jpeg:i.LOAD_TYPE.IMAGE,tif:i.LOAD_TYPE.IMAGE,tiff:i.LOAD_TYPE.IMAGE,webp:i.LOAD_TYPE.IMAGE,tga:i.LOAD_TYPE.IMAGE,svg:i.LOAD_TYPE.IMAGE,"svg+xml":i.LOAD_TYPE.IMAGE,mp3:i.LOAD_TYPE.AUDIO,ogg:i.LOAD_TYPE.AUDIO,wav:i.LOAD_TYPE.AUDIO,mp4:i.LOAD_TYPE.VIDEO,webm:i.LOAD_TYPE.VIDEO},i._xhrTypeMap={xhtml:i.XHR_RESPONSE_TYPE.DOCUMENT,html:i.XHR_RESPONSE_TYPE.DOCUMENT,htm:i.XHR_RESPONSE_TYPE.DOCUMENT,xml:i.XHR_RESPONSE_TYPE.DOCUMENT,tmx:i.XHR_RESPONSE_TYPE.DOCUMENT,svg:i.XHR_RESPONSE_TYPE.DOCUMENT,tsx:i.XHR_RESPONSE_TYPE.DOCUMENT,gif:i.XHR_RESPONSE_TYPE.BLOB,png:i.XHR_RESPONSE_TYPE.BLOB,bmp:i.XHR_RESPONSE_TYPE.BLOB,jpg:i.XHR_RESPONSE_TYPE.BLOB,jpeg:i.XHR_RESPONSE_TYPE.BLOB,tif:i.XHR_RESPONSE_TYPE.BLOB,tiff:i.XHR_RESPONSE_TYPE.BLOB,webp:i.XHR_RESPONSE_TYPE.BLOB,tga:i.XHR_RESPONSE_TYPE.BLOB,json:i.XHR_RESPONSE_TYPE.JSON,text:i.XHR_RESPONSE_TYPE.TEXT,txt:i.XHR_RESPONSE_TYPE.TEXT,ttf:i.XHR_RESPONSE_TYPE.BUFFER,otf:i.XHR_RESPONSE_TYPE.BUFFER},i.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})(wi||(wi={}));var Kb=function(i,t){this.data=i,this.callback=t},Yu=function(){function i(t,e){var n=this;if(e===void 0&&(e=1),this.workers=0,this.saturated=hs,this.unsaturated=hs,this.empty=hs,this.drain=hs,this.error=hs,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(r,o,s){if(s&&typeof s!="function")throw new Error("task callback must be a function");if(n.started=!0,r==null&&n.idle())setTimeout(function(){return n.drain()},1);else{var a=new Kb(r,typeof s=="function"?s:hs);o?n._tasks.unshift(a):n._tasks.push(a),setTimeout(n.process,1)}},this.process=function(){for(;!n.paused&&n.workers<n.concurrency&&n._tasks.length;){var r=n._tasks.shift();n._tasks.length===0&&n.empty(),n.workers+=1,n.workers===n.concurrency&&n.saturated(),n._worker(r.data,Jb(n._next(r)))}},this._worker=t,e===0)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return i.prototype._next=function(t){var e=this;return function(){for(var n=arguments,r=[],o=0;o<arguments.length;o++)r[o]=n[o];e.workers-=1,t.callback.apply(t,r),r[0]!=null&&e.error(r[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},i.prototype.push=function(t,e){this._insert(t,!1,e)},i.prototype.kill=function(){this.workers=0,this.drain=hs,this.started=!1,this._tasks=[]},i.prototype.unshift=function(t,e){this._insert(t,!0,e)},i.prototype.length=function(){return this._tasks.length},i.prototype.running=function(){return this.workers},i.prototype.idle=function(){return this._tasks.length+this.workers===0},i.prototype.pause=function(){this.paused!==!0&&(this.paused=!0)},i.prototype.resume=function(){if(this.paused!==!1){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},i.eachSeries=function(t,e,n,r){var o=0,s=t.length;(function a(l){l||o===s?n&&n(l):r?setTimeout(function(){e(t[o++],a)},1):e(t[o++],a)})()},i.queue=function(t,e){return new i(t,e)},i}(),Zb=/(#[\w-]+)?$/,Zr=function(){function i(t,e){var n=this;t===void 0&&(t=""),e===void 0&&(e=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(l,h){return n._loadResource(l,h)},this.resources={},this.baseUrl=t,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(l,h){return n._loadResource(l,h)},this._queue=Yu.queue(this._boundLoadResource,e),this._queue.pause(),this.resources={},this.onProgress=new po,this.onError=new po,this.onLoad=new po,this.onStart=new po,this.onComplete=new po;for(var r=0;r<i._plugins.length;++r){var o=i._plugins[r],s=o.pre,a=o.use;s&&this.pre(s),a&&this.use(a)}this._protected=!1}return i.prototype._add=function(t,e,n,r){if(this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new wi(t,e,n),typeof r=="function"&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var o=n.parentResource,s=[],a=0;a<o.children.length;++a)o.children[a].isComplete||s.push(o.children[a]);var l=o.progressChunk*(s.length+1)/(s.length+2);for(o.children.push(this.resources[t]),o.progressChunk=l,a=0;a<s.length;++a)s[a].progressChunk=l;this.resources[t].progressChunk=l}return this._queue.push(this.resources[t]),this},i.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},i.prototype.use=function(t){return this._afterMiddleware.push(t),this},i.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},i.prototype.load=function(t){if(typeof t=="function"&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Object.defineProperty(i.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),i.prototype._prepareUrl=function(t){var e,n=Jf(t,{strictMode:!0});if(e=n.protocol||!n.path||t.indexOf("//")===0?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&t.charAt(0)!=="/"?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=Zb.exec(e)[0];(e=e.slice(0,e.length-r.length)).indexOf("?")!==-1?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=r}return e},i.prototype._loadResource=function(t,e){var n=this;t._dequeue=e,Yu.eachSeries(this._beforeMiddleware,function(r,o){r.call(n,t,function(){o(t.isComplete?{}:null)})},function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())},!0)},i.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},i.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},i.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),Yu.eachSeries(this._afterMiddleware,function(n,r){n.call(e,t,r)},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&e._resourcesParsing.length===0&&e._onComplete()},!0)},i.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(i,"shared",{get:function(){var t=i._shared;return t||((t=new i)._protected=!0,i._shared=t),t},enumerable:!1,configurable:!0}),i.registerPlugin=function(t){return i._plugins.push(t),t.add&&t.add(),i},i._plugins=[],i}();Zr.prototype.add=function(i,t,e,n){if(Array.isArray(i)){for(var r=0;r<i.length;++r)this.add(i[r]);return this}if(typeof i=="object"&&(e=i,n=t||e.callback||e.onComplete,t=e.url,i=e.name||e.key||e.url),typeof t!="string"&&(n=e,e=t,t=i),typeof t!="string")throw new Error("No url passed to add resource to loader.");return typeof e=="function"&&(n=e,e=null),this._add(i,t,e,n)};var Qb=function(){function i(){}return i.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?Zr.shared:new Zr},i.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},i}(),$b=function(){function i(){}return i.add=function(){wi.setExtensionLoadType("svg",wi.LOAD_TYPE.XHR),wi.setExtensionXhrType("svg",wi.XHR_RESPONSE_TYPE.TEXT)},i.use=function(t,e){if(!t.data||t.type!==wi.TYPE.IMAGE&&t.extension!=="svg")e();else{var n=t.data,r=t.url,o=t.name,s=t.metadata;ce.t.fromLoader(n,r,o,s).then(function(a){t.texture=a,e()}).catch(e)}},i}();Zr.registerPlugin({use:function(i,t){if(i.data){if(i.xhr&&i.xhrType===wi.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&typeof i.data!="string"){if(i.data.type.indexOf("image")===0){var e=globalThis.URL||globalThis.webkitURL,n=e.createObjectURL(i.data);return i.blob=i.data,i.data=new Image,i.data.src=n,i.type=wi.TYPE.IMAGE,void(i.data.onload=function(){e.revokeObjectURL(n),i.data.onload=null,t()})}}else{var r=i.xhr.getResponseHeader("content-type");if(r&&r.indexOf("image")===0)return i.data=new Image,i.data.src="data:"+r+";base64,"+function(o){for(var s="",a=0;a<o.length;){for(var l=[0,0,0],h=[0,0,0,0],u=0;u<l.length;++u)a<o.length?l[u]=255&o.charCodeAt(a++):l[u]=0;switch(h[0]=l[0]>>2,h[1]=(3&l[0])<<4|l[1]>>4,h[2]=(15&l[1])<<2|l[2]>>6,h[3]=63&l[2],a-(o.length-1)){case 2:h[3]=64,h[2]=64;break;case 1:h[3]=64}for(u=0;u<h.length;++u)s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h[u])}return s}(i.xhr.responseText),i.type=wi.TYPE.IMAGE,void(i.data.onload=function(){i.data.onload=null,t()})}t()}else t()}}),Zr.registerPlugin($b);var si,Nn,gn=v(0);/*!
 * @pixi/compressed-textures - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/compressed-textures is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */(function(i){i[i.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",i[i.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",i[i.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",i[i.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",i[i.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",i[i.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",i[i.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",i[i.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",i[i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",i[i.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",i[i.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",i[i.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"})(Nn||(Nn={}));var Xl=((si={})[Nn.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,si[Nn.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,si[Nn.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,si[Nn.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,si[Nn.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,si[Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,si[Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,si[Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,si[Nn.COMPRESSED_R11_EAC]=.5,si[Nn.COMPRESSED_SIGNED_R11_EAC]=.5,si[Nn.COMPRESSED_RG11_EAC]=1,si[Nn.COMPRESSED_SIGNED_RG11_EAC]=1,si[Nn.COMPRESSED_RGB8_ETC2]=.5,si[Nn.COMPRESSED_RGBA8_ETC2_EAC]=1,si[Nn.COMPRESSED_SRGB8_ETC2]=.5,si[Nn.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,si[Nn.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,si[Nn.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,si[Nn.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,si[Nn.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,si[Nn.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,si[Nn.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,si[Nn.COMPRESSED_RGB_ETC1_WEBGL]=.5,si[Nn.COMPRESSED_RGB_ATC_WEBGL]=.5,si[Nn.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,si[Nn.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,si),Qf=function(i,t){return(Qf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */function $f(i,t){function e(){this.constructor=i}Qf(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function t1(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}}var Yl,Qr,qu=function(i){function t(e,n){var r=i.call(this,e,n)||this;return r.format=n.format,r.levels=n.levels||1,r._width=n.width,r._height=n.height,r._extension=t._formatToExtension(r.format),(n.levelBuffers||r.buffer)&&(r._levelBuffers=n.levelBuffers||t._createLevelBuffers(e instanceof Uint8Array?e:r.buffer.uint8View,r.format,r.levels,4,4,r.width,r.height)),r}return $f(t,i),t.prototype.upload=function(e,n,r){var o=e.gl;if(!e.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var s=0,a=this.levels;s<a;s++){var l=this._levelBuffers[s],h=l.levelID,u=l.levelWidth,p=l.levelHeight,y=l.levelBuffer;o.compressedTexImage2D(o.TEXTURE_2D,h,this.format,u,p,0,y)}return!0},t.prototype.onBlobLoaded=function(){this._levelBuffers=t._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},t._formatToExtension=function(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},t._createLevelBuffers=function(e,n,r,o,s,a,l){for(var h=new Array(r),u=e.byteOffset,p=a,y=l,x=p+o-1&~(o-1),E=y+s-1&~(s-1),w=x*E*Xl[n],C=0;C<r;C++)h[C]={levelID:C,levelWidth:r>1?p:x,levelHeight:r>1?y:E,levelBuffer:new Uint8Array(e.buffer,u,w)},u+=w,w=(x=(p=p>>1||1)+o-1&~(o-1))*(E=(y=y>>1||1)+s-1&~(s-1))*Xl[n];return h},t}(function(i){function t(e,n){n===void 0&&(n={width:1,height:1,autoLoad:!0});var r,o,s=this;return typeof e=="string"?(r=e,o=new Uint8Array):(r=null,o=e),(s=i.call(this,o,n)||this).origin=r,s.buffer=o?new ce.x(o):null,s.origin&&n.autoLoad!==!1&&s.load(),o&&o.length&&(s.loaded=!0,s.onBlobLoaded(s.buffer.rawBinaryData)),s}return $f(t,i),t.prototype.onBlobLoaded=function(e){},t.prototype.load=function(){return e=this,n=void 0,o=function(){var s;return t1(this,function(a){switch(a.label){case 0:return[4,fetch(this.origin)];case 1:return[4,a.sent().blob()];case 2:return[4,a.sent().arrayBuffer()];case 3:return s=a.sent(),this.data=new Uint32Array(s),this.buffer=new ce.x(s),this.loaded=!0,this.onBlobLoaded(s),this.update(),[2,this]}})},new((r=Promise)||(r=Promise))(function(s,a){function l(p){try{u(o.next(p))}catch(y){a(y)}}function h(p){try{u(o.throw(p))}catch(y){a(y)}}function u(p){p.done?s(p.value):new r(function(y){y(p.value)}).then(l,h)}u((o=o.apply(e,n||[])).next())});var e,n,r,o},t}(ce.i)),e1=function(){function i(){}return i.use=function(t,e){var n=t.data;if(t.type===wi.TYPE.JSON&&n&&n.cacheID&&n.textures){for(var r=n.textures,o=void 0,s=void 0,a=0,l=r.length;a<l;a++){var h=r[a],u=h.src,p=h.format;if(p||(s=u),i.textureFormats[p]){o=u;break}}if(!(o=o||s))return void e(new Error("Cannot load compressed-textures in "+t.url+", make sure you provide a fallback"));if(o===t.url)return void e(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var y={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},x=xn.url.resolve(t.url.replace(this.baseUrl,""),o),E=n.cacheID;this.add(E,x,y,function(w){if(w.error)e(w.error);else{var C=w.texture,j=C===void 0?null:C,Z=w.textures,rt=Z===void 0?{}:Z;Object.assign(t,{texture:j,textures:rt}),e()}})}else e()},Object.defineProperty(i,"textureExtensions",{get:function(){if(!i._textureExtensions){var t=document.createElement("canvas").getContext("webgl");if(!t)return console.warn("WebGL not available for compressed textures. Silently failing."),{};var e={s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};i._textureExtensions=e}return i._textureExtensions},enumerable:!1,configurable:!0}),Object.defineProperty(i,"textureFormats",{get:function(){if(!i._textureFormats){var t=i.textureExtensions;for(var e in i._textureFormats={},t){var n=t[e];n&&Object.assign(i._textureFormats,Object.getPrototypeOf(n))}}return i._textureFormats},enumerable:!1,configurable:!0}),i}();function tm(i,t,e){var n={textures:{},texture:null};return t&&t.map(function(r){return new ce.t(new ce.c(r,Object.assign({mipmap:gn.k.OFF,alphaMode:gn.a.NO_PREMULTIPLIED_ALPHA},e)))}).forEach(function(r,o){var s=r.baseTexture,a=i+"-"+(o+1);ce.c.addToCache(s,a),ce.t.addToCache(r,a),o===0&&(ce.c.addToCache(s,i),ce.t.addToCache(r,i),n.texture=r),n.textures[a]=r}),n}wi.setExtensionXhrType("dds",wi.XHR_RESPONSE_TYPE.BUFFER);var Hr,Ju,n1=3,i1=4,r1=7,o1=19,s1=2,a1=0,l1=1,h1=2,u1=3;(function(i){i[i.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",i[i.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",i[i.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",i[i.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",i[i.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",i[i.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",i[i.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",i[i.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",i[i.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",i[i.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",i[i.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",i[i.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",i[i.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",i[i.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",i[i.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",i[i.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",i[i.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",i[i.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",i[i.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",i[i.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",i[i.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",i[i.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",i[i.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",i[i.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",i[i.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",i[i.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",i[i.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",i[i.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",i[i.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",i[i.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",i[i.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",i[i.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",i[i.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",i[i.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",i[i.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",i[i.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",i[i.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",i[i.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",i[i.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",i[i.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",i[i.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",i[i.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",i[i.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",i[i.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",i[i.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",i[i.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",i[i.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",i[i.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",i[i.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",i[i.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",i[i.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",i[i.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",i[i.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",i[i.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",i[i.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",i[i.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",i[i.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",i[i.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",i[i.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",i[i.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",i[i.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",i[i.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",i[i.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",i[i.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",i[i.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",i[i.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",i[i.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",i[i.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",i[i.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",i[i.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",i[i.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",i[i.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",i[i.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",i[i.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",i[i.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",i[i.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",i[i.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",i[i.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",i[i.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",i[i.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",i[i.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",i[i.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",i[i.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",i[i.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",i[i.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",i[i.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",i[i.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",i[i.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",i[i.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",i[i.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",i[i.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",i[i.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",i[i.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",i[i.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",i[i.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",i[i.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",i[i.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",i[i.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",i[i.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",i[i.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",i[i.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",i[i.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",i[i.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",i[i.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",i[i.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",i[i.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",i[i.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",i[i.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",i[i.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",i[i.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",i[i.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",i[i.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",i[i.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",i[i.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",i[i.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",i[i.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",i[i.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",i[i.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",i[i.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",i[i.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",i[i.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",i[i.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"})(Hr||(Hr={})),function(i){i[i.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",i[i.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",i[i.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(Ju||(Ju={}));var us,Go,ql,c1=((Yl={})[827611204]=Nn.COMPRESSED_RGBA_S3TC_DXT1_EXT,Yl[861165636]=Nn.COMPRESSED_RGBA_S3TC_DXT3_EXT,Yl[894720068]=Nn.COMPRESSED_RGBA_S3TC_DXT5_EXT,Yl),d1=((Qr={})[Hr.DXGI_FORMAT_BC1_TYPELESS]=Nn.COMPRESSED_RGBA_S3TC_DXT1_EXT,Qr[Hr.DXGI_FORMAT_BC1_UNORM]=Nn.COMPRESSED_RGBA_S3TC_DXT1_EXT,Qr[Hr.DXGI_FORMAT_BC2_TYPELESS]=Nn.COMPRESSED_RGBA_S3TC_DXT3_EXT,Qr[Hr.DXGI_FORMAT_BC2_UNORM]=Nn.COMPRESSED_RGBA_S3TC_DXT3_EXT,Qr[Hr.DXGI_FORMAT_BC3_TYPELESS]=Nn.COMPRESSED_RGBA_S3TC_DXT5_EXT,Qr[Hr.DXGI_FORMAT_BC3_UNORM]=Nn.COMPRESSED_RGBA_S3TC_DXT5_EXT,Qr[Hr.DXGI_FORMAT_BC1_UNORM_SRGB]=Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,Qr[Hr.DXGI_FORMAT_BC2_UNORM_SRGB]=Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,Qr[Hr.DXGI_FORMAT_BC3_UNORM_SRGB]=Nn.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,Qr),p1=function(){function i(){}return i.use=function(t,e){if(t.extension==="dds"&&t.data)try{Object.assign(t,tm(t.name||t.url,i.parse(t.data),t.metadata))}catch(n){return void e(n)}e()},i.parse=function(t){var e=new Uint32Array(t);if(e[0]!==542327876)throw new Error("Invalid DDS file magic word");var n=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),r=n[n1],o=n[i1],s=n[r1],a=new Uint32Array(t,o1*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),l=a[1];if(4&l){var h=a[s1];if(h!==808540228){var u=c1[h],p=new Uint8Array(t,128);return[new qu(p,{format:u,width:o,height:r,levels:s})]}var y=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),x=y[a1],E=y[l1],w=y[h1],C=y[u1],j=d1[x];if(j===void 0)throw new Error("DDSLoader cannot parse texture data with DXGI format "+x);if(w===4)throw new Error("DDSLoader does not support cubemap textures");if(E===Ju.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var Z=new Array;if(C===1)Z.push(new Uint8Array(t,148));else{for(var rt=Xl[j],ct=0,nt=o,vt=r,ht=0;ht<s;ht++)ct+=Math.max(1,nt+3&-4)*Math.max(1,vt+3&-4)*rt,nt>>>=1,vt>>>=1;var mt=148;for(ht=0;ht<C;ht++)Z.push(new Uint8Array(t,mt,ct)),mt+=ct}return Z.map(function(jt){return new qu(jt,{format:j,width:o,height:r,levels:s})})}throw 64&l?new Error("DDSLoader does not support uncompressed texture data."):512&l?new Error("DDSLoader does not supported YUV uncompressed texture data."):131072&l?new Error("DDSLoader does not support single-channel (lumninance) texture data!"):2&l?new Error("DDSLoader does not support single-channel (alpha) texture data!"):new Error("DDSLoader failed to load a texture file due to an unknown reason!")},i}();wi.setExtensionXhrType("ktx",wi.XHR_RESPONSE_TYPE.BUFFER);var em=[171,75,84,88,32,49,49,187,13,10,26,10],f1=12,m1=16,g1=24,v1=28,_1=36,y1=40,x1=44,b1=48,T1=52,E1=56,S1=60,nm=((us={})[gn.r.UNSIGNED_BYTE]=1,us[gn.r.UNSIGNED_SHORT]=2,us[gn.r.INT]=4,us[gn.r.UNSIGNED_INT]=4,us[gn.r.FLOAT]=4,us[gn.r.HALF_FLOAT]=8,us),w1=((Go={})[gn.h.RGBA]=4,Go[gn.h.RGB]=3,Go[gn.h.RG]=2,Go[gn.h.RED]=1,Go[gn.h.LUMINANCE]=1,Go[gn.h.LUMINANCE_ALPHA]=2,Go[gn.h.ALPHA]=1,Go),A1=((ql={})[gn.r.UNSIGNED_SHORT_4_4_4_4]=2,ql[gn.r.UNSIGNED_SHORT_5_5_5_1]=2,ql[gn.r.UNSIGNED_SHORT_5_6_5]=2,ql),M1=function(){function i(){}return i.use=function(t,e){if(t.extension==="ktx"&&t.data)try{var n=t.name||t.url,r=i.parse(n,t.data),o=r.compressed,s=r.uncompressed,a=r.kvData;if(o){var l=tm(n,o,t.metadata);if(a&&l.textures)for(var h in l.textures)l.textures[h].baseTexture.ktxKeyValueData=a;Object.assign(t,l)}else if(s){var u={};s.forEach(function(p,y){var x=new ce.t(new ce.c(p.resource,{mipmap:gn.k.OFF,alphaMode:gn.a.NO_PREMULTIPLIED_ALPHA,type:p.type,format:p.format})),E=n+"-"+(y+1);a&&(x.baseTexture.ktxKeyValueData=a),ce.c.addToCache(x.baseTexture,E),ce.t.addToCache(x,E),y===0&&(u[n]=x,ce.c.addToCache(x.baseTexture,n),ce.t.addToCache(x,n)),u[E]=x}),Object.assign(t,{textures:u})}}catch(p){return void e(p)}e()},i.parse=function(t,e){var n=new DataView(e);if(!i.validate(t,n))return null;var r=n.getUint32(f1,!0)===67305985,o=n.getUint32(m1,r),s=n.getUint32(g1,r),a=n.getUint32(v1,r),l=n.getUint32(_1,r),h=n.getUint32(y1,r)||1,u=n.getUint32(x1,r)||1,p=n.getUint32(b1,r)||1,y=n.getUint32(T1,r),x=n.getUint32(E1,r),E=n.getUint32(S1,r);if(h===0||u!==1)throw new Error("Only 2D textures are supported");if(y!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(p!==1)throw new Error("WebGL does not support array textures");var w,C=l+3&-4,j=h+3&-4,Z=new Array(p),rt=l*h;if(o===0&&(rt=C*j),(w=o!==0?nm[o]?nm[o]*w1[s]:A1[o]:Xl[a])===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var ct=i.loadKeyValueData?i.parseKvData(n,E,r):null,nt=rt*w,vt=l,ht=h,mt=C,jt=j,Ft=64+E,Mt=0;Mt<x;Mt++){for(var wt=n.getUint32(Ft,r),Pt=Ft+4,Nt=0;Nt<p;Nt++){var ne=Z[Nt];ne||(ne=Z[Nt]=new Array(x)),ne[Mt]={levelID:Mt,levelWidth:x>1||o!==0?vt:mt,levelHeight:x>1||o!==0?ht:jt,levelBuffer:new Uint8Array(e,Pt,nt)},Pt+=nt}Ft=(Ft+=wt+4)%4!=0?Ft+4-Ft%4:Ft,nt=(mt=(vt=vt>>1||1)+4-1&-4)*(jt=(ht=ht>>1||1)+4-1&-4)*w}return o!==0?{uncompressed:Z.map(function($t){var zt=$t[0].levelBuffer,Yt=!1;return o===gn.r.FLOAT?zt=new Float32Array($t[0].levelBuffer.buffer,$t[0].levelBuffer.byteOffset,$t[0].levelBuffer.byteLength/4):o===gn.r.UNSIGNED_INT?(Yt=!0,zt=new Uint32Array($t[0].levelBuffer.buffer,$t[0].levelBuffer.byteOffset,$t[0].levelBuffer.byteLength/4)):o===gn.r.INT&&(Yt=!0,zt=new Int32Array($t[0].levelBuffer.buffer,$t[0].levelBuffer.byteOffset,$t[0].levelBuffer.byteLength/4)),{resource:new ce.i(zt,{width:$t[0].levelWidth,height:$t[0].levelHeight}),type:o,format:Yt?i.convertFormatToInteger(s):s}}),kvData:ct}:{compressed:Z.map(function($t){return new qu(null,{format:a,width:l,height:h,levels:x,levelBuffers:$t})}),kvData:ct}},i.validate=function(t,e){for(var n=0;n<em.length;n++)if(e.getUint8(n)!==em[n])return console.error(t+" is not a valid *.ktx file!"),!1;return!0},i.convertFormatToInteger=function(t){switch(t){case gn.h.RGBA:return gn.h.RGBA_INTEGER;case gn.h.RGB:return gn.h.RGB_INTEGER;case gn.h.RG:return gn.h.RG_INTEGER;case gn.h.RED:return gn.h.RED_INTEGER;default:return t}},i.parseKvData=function(t,e,n){for(var r=new Map,o=0;o<e;){var s=t.getUint32(64+o,n),a=64+o+4,l=3-(s+3)%4;if(s===0||s>e-o){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}for(var h=0;h<s&&t.getUint8(a+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}var u=new TextDecoder().decode(new Uint8Array(t.buffer,a,h)),p=new DataView(t.buffer,a+h+1,s-h-1);r.set(u,p),o+=4+s+l}return r},i.loadKeyValueData=!1,i}(),im=function(i,t){return(im=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function rm(i,t){function e(){this.constructor=i}im(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Ho,jo,C1=function(i){function t(e,n,r,o){e===void 0&&(e=1500),r===void 0&&(r=16384),o===void 0&&(o=!1);var s=i.call(this)||this;return r>16384&&(r=16384),s._properties=[!1,!0,!1,!1,!1],s._maxSize=e,s._batchSize=r,s._buffers=null,s._bufferUpdateIDs=[],s._updateID=0,s.interactiveChildren=!1,s.blendMode=gn.b.NORMAL,s.autoResize=o,s.roundPixels=!0,s.baseTexture=null,s.setProperties(n),s._tint=0,s.tintRgb=new Float32Array(4),s.tint=16777215,s}return rm(t,i),t.prototype.setProperties=function(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])},t.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,Object(xn.hex2rgb)(e,this.tintRgb)},enumerable:!1,configurable:!0}),t.prototype.render=function(e){var n=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return n.onChildrenChange(0)})),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},t.prototype.onChildrenChange=function(e){for(var n=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<n;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[n]=++this._updateID},t.prototype.dispose=function(){if(this._buffers){for(var e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}},t.prototype.destroy=function(e){i.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},t}(Cn.b),om=function(){function i(t,e,n){this.geometry=new ce.l,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var o=t[r];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||gn.r.FLOAT,offset:o.offset},e[r]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return i.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new ce.h(Object(xn.createIndicesForQuads)(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n)(a=this.dynamicProperties[n]).offset=e,e+=a.size,this.dynamicStride+=a.size;var r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new ce.h(this.dynamicData,!1,!1);var o=0;for(this.staticStride=0,n=0;n<this.staticProperties.length;++n)(a=this.staticProperties[n]).offset=o,o+=a.size,this.staticStride+=a.size;var s=new ArrayBuffer(this.size*this.staticStride*4*4);for(this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new ce.h(this.staticData,!0,!1),n=0;n<this.dynamicProperties.length;++n){var a=this.dynamicProperties[n];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===gn.r.UNSIGNED_BYTE,a.type,4*this.dynamicStride,4*a.offset)}for(n=0;n<this.staticProperties.length;++n)a=this.staticProperties[n],t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===gn.r.UNSIGNED_BYTE,a.type,4*this.staticStride,4*a.offset)},i.prototype.uploadDynamic=function(t,e,n){for(var r=0;r<this.dynamicProperties.length;r++){var o=this.dynamicProperties[r];o.uploadFunction(t,e,n,o.type===gn.r.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++},i.prototype.uploadStatic=function(t,e,n){for(var r=0;r<this.staticProperties.length;r++){var o=this.staticProperties[r];o.uploadFunction(t,e,n,o.type===gn.r.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++},i.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},i}(),R1=function(i){function t(e){var n=i.call(this,e)||this;return n.shader=null,n.properties=null,n.tempMatrix=new De.d,n.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:n.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:n.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:n.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:n.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:gn.r.UNSIGNED_BYTE,uploadFunction:n.uploadTint,offset:0}],n.shader=ce.r.from(`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`,`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,{}),n.state=ce.s.for2d(),n}return rm(t,i),t.prototype.render=function(e){var n=e.children,r=e._maxSize,o=e._batchSize,s=this.renderer,a=n.length;if(a!==0){a>r&&!e.autoResize&&(a=r);var l=e._buffers;l||(l=e._buffers=this.generateBuffers(e));var h=n[0]._texture.baseTexture;this.state.blendMode=Object(xn.correctBlendMode)(e.blendMode,h.alphaMode),s.state.set(this.state);var u=s.gl,p=e.worldTransform.copyTo(this.tempMatrix);p.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=p.toArray(!0),this.shader.uniforms.uColor=Object(xn.premultiplyRgba)(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,h.alphaMode),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);for(var y=!1,x=0,E=0;x<a;x+=o,E+=1){var w=a-x;w>o&&(w=o),E>=l.length&&l.push(this._generateOneMoreBuffer(e));var C=l[E];C.uploadDynamic(n,x,w);var j=e._bufferUpdateIDs[E]||0;(y=y||C._updateID<j)&&(C._updateID=e._updateID,C.uploadStatic(n,x,w)),s.geometry.bind(C.geometry),u.drawElements(u.TRIANGLES,6*w,u.UNSIGNED_SHORT,0)}}},t.prototype.generateBuffers=function(e){for(var n=[],r=e._maxSize,o=e._batchSize,s=e._properties,a=0;a<r;a+=o)n.push(new om(this.properties,s,o));return n},t.prototype._generateOneMoreBuffer=function(e){var n=e._batchSize,r=e._properties;return new om(this.properties,r,n)},t.prototype.uploadVertices=function(e,n,r,o,s,a){for(var l=0,h=0,u=0,p=0,y=0;y<r;++y){var x=e[n+y],E=x._texture,w=x.scale.x,C=x.scale.y,j=E.trim,Z=E.orig;j?(l=(h=j.x-x.anchor.x*Z.width)+j.width,u=(p=j.y-x.anchor.y*Z.height)+j.height):(l=Z.width*(1-x.anchor.x),h=Z.width*-x.anchor.x,u=Z.height*(1-x.anchor.y),p=Z.height*-x.anchor.y),o[a]=h*w,o[a+1]=p*C,o[a+s]=l*w,o[a+s+1]=p*C,o[a+2*s]=l*w,o[a+2*s+1]=u*C,o[a+3*s]=h*w,o[a+3*s+1]=u*C,a+=4*s}},t.prototype.uploadPosition=function(e,n,r,o,s,a){for(var l=0;l<r;l++){var h=e[n+l].position;o[a]=h.x,o[a+1]=h.y,o[a+s]=h.x,o[a+s+1]=h.y,o[a+2*s]=h.x,o[a+2*s+1]=h.y,o[a+3*s]=h.x,o[a+3*s+1]=h.y,a+=4*s}},t.prototype.uploadRotation=function(e,n,r,o,s,a){for(var l=0;l<r;l++){var h=e[n+l].rotation;o[a]=h,o[a+s]=h,o[a+2*s]=h,o[a+3*s]=h,a+=4*s}},t.prototype.uploadUvs=function(e,n,r,o,s,a){for(var l=0;l<r;++l){var h=e[n+l]._texture._uvs;h?(o[a]=h.x0,o[a+1]=h.y0,o[a+s]=h.x1,o[a+s+1]=h.y1,o[a+2*s]=h.x2,o[a+2*s+1]=h.y2,o[a+3*s]=h.x3,o[a+3*s+1]=h.y3,a+=4*s):(o[a]=0,o[a+1]=0,o[a+s]=0,o[a+s+1]=0,o[a+2*s]=0,o[a+2*s+1]=0,o[a+3*s]=0,o[a+3*s+1]=0,a+=4*s)}},t.prototype.uploadTint=function(e,n,r,o,s,a){for(var l=0;l<r;++l){var h=e[n+l],u=h._texture.baseTexture.alphaMode>0,p=h.alpha,y=p<1&&u?Object(xn.premultiplyTint)(h._tintRGB,p):h._tintRGB+(255*p<<24);o[a]=y,o[a+s]=y,o[a+2*s]=y,o[a+3*s]=y,a+=4*s}},t.prototype.destroy=function(){i.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},t}(ce.m),br=v(4);(function(i){i.MITER="miter",i.BEVEL="bevel",i.ROUND="round"})(Ho||(Ho={})),function(i){i.BUTT="butt",i.ROUND="round",i.SQUARE="square"}(jo||(jo={}));var Na={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(i,t){if(t===void 0&&(t=20),!this.adaptive||!i||isNaN(i))return t;var e=Math.ceil(i/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},sm=function(){function i(){this.color=16777215,this.alpha=1,this.texture=ce.t.WHITE,this.matrix=null,this.visible=!1,this.reset()}return i.prototype.clone=function(){var t=new i;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},i.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=ce.t.WHITE,this.matrix=null,this.visible=!1},i.prototype.destroy=function(){this.texture=null,this.matrix=null},i}(),am=function(i,t){return(am=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function Ku(i,t){function e(){this.constructor=i}am(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function lm(i,t){var e,n;t===void 0&&(t=!1);var r=i.length;if(!(r<6)){for(var o=0,s=0,a=i[r-2],l=i[r-1];s<r;s+=2){var h=i[s],u=i[s+1];o+=(h-a)*(u+l),a=h,l=u}if(!t&&o>0||t&&o<=0){var p=r/2;for(s=p+p%2;s<r;s+=2){var y=r-s-2,x=r-s-1,E=s,w=s+1;e=[i[E],i[y]],i[y]=e[0],i[E]=e[1],n=[i[w],i[x]],i[x]=n[0],i[w]=n[1]}}}}var hm={build:function(i){i.points=i.shape.points.slice()},triangulate:function(i,t){var e=i.points,n=i.holes,r=t.points,o=t.indices;if(e.length>=6){lm(e,!1);for(var s=[],a=0;a<n.length;a++){var l=n[a];lm(l.points,!0),s.push(e.length/2),e=e.concat(l.points)}var h=Object(xn.earcut)(e,s,2);if(!h)return;var u=r.length/2;for(a=0;a<h.length;a+=3)o.push(h[a]+u),o.push(h[a+1]+u),o.push(h[a+2]+u);for(a=0;a<e.length;a++)r.push(e[a])}}},Jl={build:function(i){var t,e,n,r,o,s,a=i.points;if(i.type===De.l.CIRC){var l=i.shape;t=l.x,e=l.y,o=s=l.radius,n=r=0}else if(i.type===De.l.ELIP){var h=i.shape;t=h.x,e=h.y,o=h.width,s=h.height,n=r=0}else{var u=i.shape,p=u.width/2,y=u.height/2;t=u.x+p,e=u.y+y,n=p-(o=s=Math.max(0,Math.min(u.radius,Math.min(p,y)))),r=y-s}if(o>=0&&s>=0&&n>=0&&r>=0){var x=Math.ceil(2.3*Math.sqrt(o+s)),E=8*x+(n?4:0)+(r?4:0);if(a.length=E,E!==0){if(x===0)return a.length=8,a[0]=a[6]=t+n,a[1]=a[3]=e+r,a[2]=a[4]=t-n,void(a[5]=a[7]=e-r);var w=0,C=4*x+(n?2:0)+2,j=C,Z=E,rt=t+(jt=n+o),ct=t-jt,nt=e+(Ft=r);if(a[w++]=rt,a[w++]=nt,a[--C]=nt,a[--C]=ct,r){var vt=e-Ft;a[j++]=ct,a[j++]=vt,a[--Z]=vt,a[--Z]=rt}for(var ht=1;ht<x;ht++){var mt=Math.PI/2*(ht/x);rt=t+(jt=n+Math.cos(mt)*o),ct=t-jt,nt=e+(Ft=r+Math.sin(mt)*s),vt=e-Ft,a[w++]=rt,a[w++]=nt,a[--C]=nt,a[--C]=ct,a[j++]=ct,a[j++]=vt,a[--Z]=vt,a[--Z]=rt}var jt,Ft;rt=t+(jt=n),ct=t-jt,nt=e+(Ft=r+s),vt=e-Ft,a[w++]=rt,a[w++]=nt,a[--Z]=vt,a[--Z]=rt,n&&(a[w++]=ct,a[w++]=nt,a[--Z]=vt,a[--Z]=ct)}}else a.length=0},triangulate:function(i,t){var e,n,r=i.points,o=t.points,s=t.indices,a=o.length/2,l=a;if(i.type!==De.l.RREC){var h=i.shape;e=h.x,n=h.y}else{var u=i.shape;e=u.x+u.width/2,n=u.y+u.height/2}var p=i.matrix;o.push(i.matrix?p.a*e+p.c*n+p.tx:e,i.matrix?p.b*e+p.d*n+p.ty:n),a++,o.push(r[0],r[1]);for(var y=2;y<r.length;y+=2)o.push(r[y],r[y+1]),s.push(a++,l,a);s.push(l+1,l,a)}},I1={build:function(i){var t=i.shape,e=t.x,n=t.y,r=t.width,o=t.height,s=i.points;s.length=0,s.push(e,n,e+r,n,e+r,n+o,e,n+o)},triangulate:function(i,t){var e=i.points,n=t.points,r=n.length/2;n.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}};function ks(i,t,e){return i+(t-i)*e}function Kl(i,t,e,n,r,o,s){s===void 0&&(s=[]);for(var a=s,l=0,h=0,u=0,p=0,y=0,x=0,E=0,w=0;E<=20;++E)l=ks(i,e,w=E/20),h=ks(t,n,w),u=ks(e,r,w),p=ks(n,o,w),y=ks(l,u,w),x=ks(h,p,w),E===0&&a[a.length-2]===y&&a[a.length-1]===x||a.push(y,x);return a}var P1={build:function(i){if(er.nextRoundedRectBehavior)Jl.build(i);else{var t=i.shape,e=i.points,n=t.x,r=t.y,o=t.width,s=t.height,a=Math.max(0,Math.min(t.radius,Math.min(o,s)/2));e.length=0,a?(Kl(n,r+a,n,r,n+a,r,e),Kl(n+o-a,r,n+o,r,n+o,r+a,e),Kl(n+o,r+s-a,n+o,r+s,n+o-a,r+s,e),Kl(n+a,r+s,n,r+s,n,r+s-a,e)):e.push(n,r,n+o,r,n+o,r+s,n,r+s)}},triangulate:function(i,t){if(er.nextRoundedRectBehavior)Jl.triangulate(i,t);else{for(var e=i.points,n=t.points,r=t.indices,o=n.length/2,s=Object(xn.earcut)(e,null,2),a=0,l=s.length;a<l;a+=3)r.push(s[a]+o),r.push(s[a+1]+o),r.push(s[a+2]+o);for(a=0,l=e.length;a<l;a++)n.push(e[a],e[++a])}}};function um(i,t,e,n,r,o,s,a){var l,h;s?(l=n,h=-e):(l=-n,h=e);var u=i-e*r+l,p=t-n*r+h,y=i+e*o+l,x=t+n*o+h;return a.push(u,p),a.push(y,x),2}function Gs(i,t,e,n,r,o,s,a){var l=e-i,h=n-t,u=Math.atan2(l,h),p=Math.atan2(r-i,o-t);a&&u<p?u+=2*Math.PI:!a&&u>p&&(p+=2*Math.PI);var y=u,x=p-u,E=Math.abs(x),w=Math.sqrt(l*l+h*h),C=1+(15*E*Math.sqrt(w)/Math.PI>>0),j=x/C;if(y+=j,a){s.push(i,t),s.push(e,n);for(var Z=1,rt=y;Z<C;Z++,rt+=j)s.push(i,t),s.push(i+Math.sin(rt)*w,t+Math.cos(rt)*w);s.push(i,t),s.push(r,o)}else{for(s.push(e,n),s.push(i,t),Z=1,rt=y;Z<C;Z++,rt+=j)s.push(i+Math.sin(rt)*w,t+Math.cos(rt)*w),s.push(i,t);s.push(r,o),s.push(i,t)}return 2*C}function cm(i,t){i.lineStyle.native?function(e,n){var r=0,o=e.shape,s=e.points||o.points,a=o.type!==De.l.POLY||o.closeStroke;if(s.length!==0){var l=n.points,h=n.indices,u=s.length/2,p=l.length/2,y=p;for(l.push(s[0],s[1]),r=1;r<u;r++)l.push(s[2*r],s[2*r+1]),h.push(y,y+1),y++;a&&h.push(y,p)}}(i,t):function(e,n){var r=e.shape,o=e.points||r.points.slice(),s=n.closePointEps;if(o.length!==0){var a=e.lineStyle,l=new De.g(o[0],o[1]),h=new De.g(o[o.length-2],o[o.length-1]),u=r.type!==De.l.POLY||r.closeStroke,p=Math.abs(l.x-h.x)<s&&Math.abs(l.y-h.y)<s;if(u){o=o.slice(),p&&(o.pop(),o.pop(),h.set(o[o.length-2],o[o.length-1]));var y=.5*(l.x+h.x),x=.5*(h.y+l.y);o.unshift(y,x),o.push(y,x)}var E=n.points,w=o.length/2,C=o.length,j=E.length/2,Z=a.width/2,rt=Z*Z,ct=a.miterLimit*a.miterLimit,nt=o[0],vt=o[1],ht=o[2],mt=o[3],jt=0,Ft=0,Mt=-(vt-mt),wt=nt-ht,Pt=0,Nt=0,ne=Math.sqrt(Mt*Mt+wt*wt);Mt/=ne,wt/=ne,Mt*=Z,wt*=Z;var $t=a.alignment,zt=2*(1-$t),Yt=2*$t;u||(a.cap===jo.ROUND?C+=Gs(nt-Mt*(zt-Yt)*.5,vt-wt*(zt-Yt)*.5,nt-Mt*zt,vt-wt*zt,nt+Mt*Yt,vt+wt*Yt,E,!0)+2:a.cap===jo.SQUARE&&(C+=um(nt,vt,Mt,wt,zt,Yt,!0,E))),E.push(nt-Mt*zt,vt-wt*zt),E.push(nt+Mt*Yt,vt+wt*Yt);for(var ge=1;ge<w-1;++ge){nt=o[2*(ge-1)],vt=o[2*(ge-1)+1],ht=o[2*ge],mt=o[2*ge+1],jt=o[2*(ge+1)],Ft=o[2*(ge+1)+1],Mt=-(vt-mt),wt=nt-ht,Mt/=ne=Math.sqrt(Mt*Mt+wt*wt),wt/=ne,Mt*=Z,wt*=Z,Pt=-(mt-Ft),Nt=ht-jt,Pt/=ne=Math.sqrt(Pt*Pt+Nt*Nt),Nt/=ne,Pt*=Z,Nt*=Z;var be=ht-nt,Pe=vt-mt,Ct=ht-jt,Bt=Ft-mt,ve=Pe*Ct-Bt*be,le=ve<0;if(Math.abs(ve)<.1)E.push(ht-Mt*zt,mt-wt*zt),E.push(ht+Mt*Yt,mt+wt*Yt);else{var se=(-Mt+nt)*(-wt+mt)-(-Mt+ht)*(-wt+vt),Ie=(-Pt+jt)*(-Nt+mt)-(-Pt+ht)*(-Nt+Ft),Le=(be*Ie-Ct*se)/ve,ue=(Bt*se-Pe*Ie)/ve,bt=(Le-ht)*(Le-ht)+(ue-mt)*(ue-mt),Ht=ht+(Le-ht)*zt,ie=mt+(ue-mt)*zt,ae=ht-(Le-ht)*Yt,qt=mt-(ue-mt)*Yt,ye=le?zt:Yt;bt<=Math.min(be*be+Pe*Pe,Ct*Ct+Bt*Bt)+ye*ye*rt?a.join===Ho.BEVEL||bt/rt>ct?(le?(E.push(Ht,ie),E.push(ht+Mt*Yt,mt+wt*Yt),E.push(Ht,ie),E.push(ht+Pt*Yt,mt+Nt*Yt)):(E.push(ht-Mt*zt,mt-wt*zt),E.push(ae,qt),E.push(ht-Pt*zt,mt-Nt*zt),E.push(ae,qt)),C+=2):a.join===Ho.ROUND?le?(E.push(Ht,ie),E.push(ht+Mt*Yt,mt+wt*Yt),C+=Gs(ht,mt,ht+Mt*Yt,mt+wt*Yt,ht+Pt*Yt,mt+Nt*Yt,E,!0)+4,E.push(Ht,ie),E.push(ht+Pt*Yt,mt+Nt*Yt)):(E.push(ht-Mt*zt,mt-wt*zt),E.push(ae,qt),C+=Gs(ht,mt,ht-Mt*zt,mt-wt*zt,ht-Pt*zt,mt-Nt*zt,E,!1)+4,E.push(ht-Pt*zt,mt-Nt*zt),E.push(ae,qt)):(E.push(Ht,ie),E.push(ae,qt)):(E.push(ht-Mt*zt,mt-wt*zt),E.push(ht+Mt*Yt,mt+wt*Yt),a.join===Ho.ROUND?C+=le?Gs(ht,mt,ht+Mt*Yt,mt+wt*Yt,ht+Pt*Yt,mt+Nt*Yt,E,!0)+2:Gs(ht,mt,ht-Mt*zt,mt-wt*zt,ht-Pt*zt,mt-Nt*zt,E,!1)+2:a.join===Ho.MITER&&bt/rt<=ct&&(le?(E.push(ae,qt),E.push(ae,qt)):(E.push(Ht,ie),E.push(Ht,ie)),C+=2),E.push(ht-Pt*zt,mt-Nt*zt),E.push(ht+Pt*Yt,mt+Nt*Yt),C+=2)}}nt=o[2*(w-2)],vt=o[2*(w-2)+1],ht=o[2*(w-1)],Mt=-(vt-(mt=o[2*(w-1)+1])),wt=nt-ht,Mt/=ne=Math.sqrt(Mt*Mt+wt*wt),wt/=ne,Mt*=Z,wt*=Z,E.push(ht-Mt*zt,mt-wt*zt),E.push(ht+Mt*Yt,mt+wt*Yt),u||(a.cap===jo.ROUND?C+=Gs(ht-Mt*(zt-Yt)*.5,mt-wt*(zt-Yt)*.5,ht-Mt*zt,mt-wt*zt,ht+Mt*Yt,mt+wt*Yt,E,!1)+2:a.cap===jo.SQUARE&&(C+=um(ht,mt,Mt,wt,zt,Yt,!1,E)));var nn=n.indices,on=Na.epsilon*Na.epsilon;for(ge=j;ge<C+j-2;++ge)nt=E[2*ge],vt=E[2*ge+1],ht=E[2*(ge+1)],mt=E[2*(ge+1)+1],jt=E[2*(ge+2)],Ft=E[2*(ge+2)+1],Math.abs(nt*(mt-Ft)+ht*(Ft-vt)+jt*(vt-mt))<on||nn.push(ge,ge+1,ge+2)}}(i,t)}var Hs,dm=function(){function i(){}return i.curveTo=function(t,e,n,r,o,s){var a=s[s.length-2],l=s[s.length-1]-e,h=a-t,u=r-e,p=n-t,y=Math.abs(l*p-h*u);if(y<1e-8||o===0)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var x=l*l+h*h,E=u*u+p*p,w=l*u+h*p,C=o*Math.sqrt(x)/y,j=o*Math.sqrt(E)/y,Z=C*w/x,rt=j*w/E,ct=C*p+j*h,nt=C*u+j*l,vt=h*(j+Z),ht=l*(j+Z),mt=p*(C+rt),jt=u*(C+rt);return{cx:ct+t,cy:nt+e,radius:o,startAngle:Math.atan2(ht-nt,vt-ct),endAngle:Math.atan2(jt-nt,mt-ct),anticlockwise:h*u>p*l}},i.arc=function(t,e,n,r,o,s,a,l,h){for(var u=a-s,p=Na._segmentsCount(Math.abs(u)*o,40*Math.ceil(Math.abs(u)/De.f)),y=u/(2*p),x=2*y,E=Math.cos(y),w=Math.sin(y),C=p-1,j=C%1/C,Z=0;Z<=C;++Z){var rt=y+s+x*(Z+j*Z),ct=Math.cos(rt),nt=-Math.sin(rt);h.push((E*ct+w*nt)*o+n,(E*-nt+w*ct)*o+r)}},i}(),O1=function(){function i(){}return i.curveLength=function(t,e,n,r,o,s,a,l){for(var h=0,u=0,p=0,y=0,x=0,E=0,w=0,C=0,j=0,Z=0,rt=0,ct=t,nt=e,vt=1;vt<=10;++vt)Z=ct-(C=(w=(E=(x=1-(u=vt/10))*x)*x)*t+3*E*u*n+3*x*(p=u*u)*o+(y=p*u)*a),rt=nt-(j=w*e+3*E*u*r+3*x*p*s+y*l),ct=C,nt=j,h+=Math.sqrt(Z*Z+rt*rt);return h},i.curveTo=function(t,e,n,r,o,s,a){var l=a[a.length-2],h=a[a.length-1];a.length-=2;var u=Na._segmentsCount(i.curveLength(l,h,t,e,n,r,o,s)),p=0,y=0,x=0,E=0,w=0;a.push(l,h);for(var C=1,j=0;C<=u;++C)x=(y=(p=1-(j=C/u))*p)*p,w=(E=j*j)*j,a.push(x*l+3*y*j*t+3*p*E*n+w*o,x*h+3*y*j*e+3*p*E*r+w*s)},i}(),N1=function(){function i(){}return i.curveLength=function(t,e,n,r,o,s){var a=t-2*n+o,l=e-2*r+s,h=2*n-2*t,u=2*r-2*e,p=4*(a*a+l*l),y=4*(a*h+l*u),x=h*h+u*u,E=2*Math.sqrt(p+y+x),w=Math.sqrt(p),C=2*p*w,j=2*Math.sqrt(x),Z=y/w;return(C*E+w*y*(E-j)+(4*x*p-y*y)*Math.log((2*w+Z+E)/(Z+j)))/(4*C)},i.curveTo=function(t,e,n,r,o){for(var s=o[o.length-2],a=o[o.length-1],l=Na._segmentsCount(i.curveLength(s,a,t,e,n,r)),h=0,u=0,p=1;p<=l;++p){var y=p/l;h=s+(t-s)*y,u=a+(e-a)*y,o.push(h+(t+(n-t)*y-h)*y,u+(e+(r-e)*y-u)*y)}},i}(),L1=function(){function i(){this.reset()}return i.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},i.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},i.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},i}(),Zu=((Hs={})[De.l.POLY]=hm,Hs[De.l.CIRC]=Jl,Hs[De.l.ELIP]=Jl,Hs[De.l.RECT]=I1,Hs[De.l.RREC]=P1,Hs),pm=[],Zl=[],fm=function(){function i(t,e,n,r){e===void 0&&(e=null),n===void 0&&(n=null),r===void 0&&(r=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=r,this.type=t.type}return i.prototype.clone=function(){return new i(this.shape,this.fillStyle,this.lineStyle,this.matrix)},i.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},i}(),js=new De.g,D1=new Cn.a,F1=function(i){function t(){var e=i.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new Cn.a,e.boundsDirty=-1,e}return Ku(t,i),Object.defineProperty(t.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),t.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Zl.push(this.drawCalls[e]);for(this.drawCalls.length=0,e=0;e<this.batches.length;e++){var n=this.batches[e];n.reset(),pm.push(n)}this.batches.length=0},t.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},t.prototype.drawShape=function(e,n,r,o){n===void 0&&(n=null),r===void 0&&(r=null),o===void 0&&(o=null);var s=new fm(e,n,r,o);return this.graphicsData.push(s),this.dirty++,this},t.prototype.drawHole=function(e,n){if(n===void 0&&(n=null),!this.graphicsData.length)return null;var r=new fm(e,null,null,n),o=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=o.lineStyle,o.holes.push(r),this.dirty++,this},t.prototype.destroy=function(){i.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},t.prototype.containsPoint=function(e){for(var n=this.graphicsData,r=0;r<n.length;++r){var o=n[r];if(o.fillStyle.visible&&o.shape&&(o.matrix?o.matrix.applyInverse(e,js):js.copyFrom(e),o.shape.contains(js.x,js.y))){var s=!1;if(o.holes){for(var a=0;a<o.holes.length;a++)if(o.holes[a].shape.contains(js.x,js.y)){s=!0;break}}if(!s)return!0}}return!1},t.prototype.updateBatches=function(e){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var n=this.uvs,r=this.graphicsData,o=null,s=null;this.batches.length>0&&(s=(o=this.batches[this.batches.length-1]).style);for(var a=this.shapeIndex;a<r.length;a++){this.shapeIndex++;var l=r[a],h=l.fillStyle,u=l.lineStyle;Zu[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(h.visible||u.visible)&&this.processHoles(l.holes);for(var p=0;p<2;p++){var y=p===0?h:u;if(y.visible){var x=y.texture.baseTexture,E=this.indices.length,w=this.points.length/2;x.wrapMode=gn.s.REPEAT,p===0?this.processFill(l):this.processLine(l);var C=this.points.length/2-w;C!==0&&(o&&!this._compareStyles(s,y)&&(o.end(E,w),o=null),o||((o=pm.pop()||new L1).begin(y,E,w),this.batches.push(o),s=y),this.addUvs(this.points,n,y.texture,w,C,y.matrix))}}}var j=this.indices.length,Z=this.points.length/2;if(o&&o.end(j,Z),this.batches.length!==0){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var rt=Z>65535&&e;this.indicesUint16=rt?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},t.prototype._compareStyles=function(e,n){return!(!e||!n)&&e.texture.baseTexture===n.texture.baseTexture&&e.color+e.alpha===n.color+n.alpha&&!!e.native==!!n.native},t.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,n=this.graphicsData.length;e<n;e++){var r=this.graphicsData[e],o=r.fillStyle,s=r.lineStyle;if(o&&!o.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0},t.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,n=0,r=e.length;n<r;n++)for(var o=e[n],s=0;s<o.size;s++){var a=o.start+s;this.indicesUint16[a]=this.indicesUint16[a]-o.attribStart}},t.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var e=this.batches,n=0;n<e.length;n++)if(e[n].style.native)return!1;return this.points.length<2*t.BATCHABLE_SIZE},t.prototype.buildDrawCalls=function(){for(var e=++ce.c._globalBatch,n=0;n<this.drawCalls.length;n++)this.drawCalls[n].texArray.clear(),Zl.push(this.drawCalls[n]);this.drawCalls.length=0;var r=this.colors,o=this.textureIds,s=Zl.pop();s||((s=new ce.d).texArray=new ce.g),s.texArray.count=0,s.start=0,s.size=0,s.type=gn.f.TRIANGLES;var a=0,l=null,h=0,u=!1,p=gn.f.TRIANGLES,y=0;for(this.drawCalls.push(s),n=0;n<this.batches.length;n++){var x=this.batches[n],E=x.style,w=E.texture.baseTexture;u!==!!E.native&&(p=(u=!!E.native)?gn.f.LINES:gn.f.TRIANGLES,l=null,a=8,e++),l!==w&&(l=w,w._batchEnabled!==e&&(a===8&&(e++,a=0,s.size>0&&((s=Zl.pop())||((s=new ce.d).texArray=new ce.g),this.drawCalls.push(s)),s.start=y,s.size=0,s.texArray.count=0,s.type=p),w.touched=1,w._batchEnabled=e,w._batchLocation=a,w.wrapMode=gn.s.REPEAT,s.texArray.elements[s.texArray.count++]=w,a++)),s.size+=x.size,y+=x.size,h=w._batchLocation,this.addColors(r,E.color,E.alpha,x.attribSize,x.attribStart),this.addTextureIds(o,h,x.attribSize,x.attribStart)}ce.c._globalBatch=e,this.packAttributes()},t.prototype.packAttributes=function(){for(var e=this.points,n=this.uvs,r=this.colors,o=this.textureIds,s=new ArrayBuffer(3*e.length*4),a=new Float32Array(s),l=new Uint32Array(s),h=0,u=0;u<e.length/2;u++)a[h++]=e[2*u],a[h++]=e[2*u+1],a[h++]=n[2*u],a[h++]=n[2*u+1],l[h++]=r[u],a[h++]=o[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)},t.prototype.processFill=function(e){e.holes.length?hm.triangulate(e,this):Zu[e.type].triangulate(e,this)},t.prototype.processLine=function(e){cm(e,this);for(var n=0;n<e.holes.length;n++)cm(e.holes[n],this)},t.prototype.processHoles=function(e){for(var n=0;n<e.length;n++){var r=e[n];Zu[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},t.prototype.calculateBounds=function(){var e=this._bounds,n=D1,r=De.d.IDENTITY;this._bounds.clear(),n.clear();for(var o=0;o<this.graphicsData.length;o++){var s=this.graphicsData[o],a=s.shape,l=s.type,h=s.lineStyle,u=s.matrix||De.d.IDENTITY,p=0;if(h&&h.visible&&(p=h.width,l!==De.l.POLY||s.fillStyle.visible?p*=Math.max(0,h.alignment):p*=Math.max(h.alignment,1-h.alignment)),r!==u&&(n.isEmpty()||(e.addBoundsMatrix(n,r),n.clear()),r=u),l===De.l.RECT||l===De.l.RREC){var y=a;n.addFramePad(y.x,y.y,y.x+y.width,y.y+y.height,p,p)}else if(l===De.l.CIRC){var x=a;n.addFramePad(x.x,x.y,x.x,x.y,x.radius+p,x.radius+p)}else if(l===De.l.ELIP){var E=a;n.addFramePad(E.x,E.y,E.x,E.y,E.width+p,E.height+p)}else{var w=a;e.addVerticesMatrix(r,w.points,0,w.points.length,p,p)}}n.isEmpty()||e.addBoundsMatrix(n,r),e.pad(this.boundsPadding,this.boundsPadding)},t.prototype.transformPoints=function(e,n){for(var r=0;r<e.length/2;r++){var o=e[2*r],s=e[2*r+1];e[2*r]=n.a*o+n.c*s+n.tx,e[2*r+1]=n.b*o+n.d*s+n.ty}},t.prototype.addColors=function(e,n,r,o,s){s===void 0&&(s=0);var a=(n>>16)+(65280&n)+((255&n)<<16),l=Object(xn.premultiplyTint)(a,r);e.length=Math.max(e.length,s+o);for(var h=0;h<o;h++)e[s+h]=l},t.prototype.addTextureIds=function(e,n,r,o){o===void 0&&(o=0),e.length=Math.max(e.length,o+r);for(var s=0;s<r;s++)e[o+s]=n},t.prototype.addUvs=function(e,n,r,o,s,a){a===void 0&&(a=null);for(var l=0,h=n.length,u=r.frame;l<s;){var p=e[2*(o+l)],y=e[2*(o+l)+1];if(a){var x=a.a*p+a.c*y+a.tx;y=a.b*p+a.d*y+a.ty,p=x}l++,n.push(p/u.width,y/u.height)}var E=r.baseTexture;(u.width<E.width||u.height<E.height)&&this.adjustUvs(n,r,h,s)},t.prototype.adjustUvs=function(e,n,r,o){for(var s=n.baseTexture,a=1e-6,l=r+2*o,h=n.frame,u=h.width/s.width,p=h.height/s.height,y=h.x/h.width,x=h.y/h.height,E=Math.floor(e[r]+a),w=Math.floor(e[r+1]+a),C=r+2;C<l;C+=2)E=Math.min(E,Math.floor(e[C]+a)),w=Math.min(w,Math.floor(e[C+1]+a));for(y-=E,x-=w,C=r;C<l;C+=2)e[C]=(e[C]+y)*u,e[C+1]=(e[C+1]+x)*p},t.BATCHABLE_SIZE=100,t}(ce.e),B1=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=jo.BUTT,e.join=Ho.MITER,e.miterLimit=10,e}return Ku(t,i),t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e},t.prototype.reset=function(){i.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},t}(sm),U1=new Float32Array(3),Qu={},er=function(i){function t(e){e===void 0&&(e=null);var n=i.call(this)||this;return n.shader=null,n.pluginName="batch",n.currentPath=null,n.batches=[],n.batchTint=-1,n.batchDirty=-1,n.vertexData=null,n._fillStyle=new sm,n._lineStyle=new B1,n._matrix=null,n._holeMode=!1,n.state=ce.s.for2d(),n._geometry=e||new F1,n._geometry.refCount++,n._transformID=-1,n.tint=16777215,n.blendMode=gn.b.NORMAL,n}return Ku(t,i),Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return this.finishPoly(),new t(this._geometry)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),t.prototype.lineStyle=function(e,n,r,o,s){return e===void 0&&(e=null),n===void 0&&(n=0),r===void 0&&(r=1),o===void 0&&(o=.5),s===void 0&&(s=!1),typeof e=="number"&&(e={width:e,color:n,alpha:r,alignment:o,native:s}),this.lineTextureStyle(e)},t.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:ce.t.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:jo.BUTT,join:Ho.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this},t.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,n=this.currentPath.points.length;n>2&&(this.drawShape(this.currentPath),this.currentPath=new De.h,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[n-2],e[n-1]))}else this.currentPath=new De.h,this.currentPath.closeStroke=!1},t.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},t.prototype.moveTo=function(e,n){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=n,this},t.prototype.lineTo=function(e,n){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,o=r[r.length-2],s=r[r.length-1];return o===e&&s===n||r.push(e,n),this},t.prototype._initCurve=function(e,n){e===void 0&&(e=0),n===void 0&&(n=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,n]):this.moveTo(e,n)},t.prototype.quadraticCurveTo=function(e,n,r,o){this._initCurve();var s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),N1.curveTo(e,n,r,o,s),this},t.prototype.bezierCurveTo=function(e,n,r,o,s,a){return this._initCurve(),O1.curveTo(e,n,r,o,s,a,this.currentPath.points),this},t.prototype.arcTo=function(e,n,r,o,s){this._initCurve(e,n);var a=this.currentPath.points,l=dm.curveTo(e,n,r,o,s,a);if(l){var h=l.cx,u=l.cy,p=l.radius,y=l.startAngle,x=l.endAngle,E=l.anticlockwise;this.arc(h,u,p,y,x,E)}return this},t.prototype.arc=function(e,n,r,o,s,a){if(a===void 0&&(a=!1),o===s)return this;if(!a&&s<=o?s+=De.f:a&&o<=s&&(o+=De.f),s-o===0)return this;var l=e+Math.cos(o)*r,h=n+Math.sin(o)*r,u=this._geometry.closePointEps,p=this.currentPath?this.currentPath.points:null;if(p){var y=Math.abs(p[p.length-2]-l),x=Math.abs(p[p.length-1]-h);y<u&&x<u||p.push(l,h)}else this.moveTo(l,h),p=this.currentPath.points;return dm.arc(l,h,e,n,r,o,s,a,p),this},t.prototype.beginFill=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=1),this.beginTextureFill({texture:ce.t.WHITE,color:e,alpha:n})},t.prototype.beginTextureFill=function(e){e=Object.assign({texture:ce.t.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this},t.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},t.prototype.drawRect=function(e,n,r,o){return this.drawShape(new De.j(e,n,r,o))},t.prototype.drawRoundedRect=function(e,n,r,o,s){return this.drawShape(new De.k(e,n,r,o,s))},t.prototype.drawCircle=function(e,n,r){return this.drawShape(new De.a(e,n,r))},t.prototype.drawEllipse=function(e,n,r,o){return this.drawShape(new De.c(e,n,r,o))},t.prototype.drawPolygon=function(){for(var e,n=arguments,r=[],o=0;o<arguments.length;o++)r[o]=n[o];var s=!0,a=r[0];a.points?(s=a.closeStroke,e=a.points):e=Array.isArray(r[0])?r[0]:r;var l=new De.h(e);return l.closeStroke=s,this.drawShape(l),this},t.prototype.drawShape=function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},t.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},t.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return!(e.length!==1||e[0].shape.type!==De.l.RECT||e[0].matrix||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)},t.prototype._render=function(e){this.finishPoly();var n=this._geometry,r=e.context.supports.uint32Indices;n.updateBatches(r),n.batchable?(this.batchDirty!==n.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},t.prototype._populateBatches=function(){var e=this._geometry,n=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(var o=0;o<r;o++){var s=e.batches[o],a=s.style.color,l=new Float32Array(this.vertexData.buffer,4*s.attribStart*2,2*s.attribSize),h=new Float32Array(e.uvsFloat32.buffer,4*s.attribStart*2,2*s.attribSize),u={vertexData:l,blendMode:n,indices:new Uint16Array(e.indicesUint16.buffer,2*s.start,s.size),uvs:h,_batchRGB:Object(xn.hex2rgb)(a),_tintRGB:a,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[o]=u}},t.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var n=0,r=this.batches.length;n<r;n++){var o=this.batches[n];o.worldAlpha=this.worldAlpha*o.alpha,e.plugins[this.pluginName].render(o)}}},t.prototype._renderDirect=function(e){var n=this._resolveDirectShader(e),r=this._geometry,o=this.tint,s=this.worldAlpha,a=n.uniforms,l=r.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(o>>16&255)/255*s,a.tint[1]=(o>>8&255)/255*s,a.tint[2]=(255&o)/255*s,a.tint[3]=s,e.shader.bind(n),e.geometry.bind(r,n),e.state.set(this.state);for(var h=0,u=l.length;h<u;h++)this._renderDrawCallDirect(e,r.drawCalls[h])},t.prototype._renderDrawCallDirect=function(e,n){for(var r=n.texArray,o=n.type,s=n.size,a=n.start,l=r.count,h=0;h<l;h++)e.texture.bind(r.elements[h],h);e.geometry.draw(o,s,a)},t.prototype._resolveDirectShader=function(e){var n=this.shader,r=this.pluginName;if(!n){if(!Qu[r]){for(var o=e.plugins[r].MAX_TEXTURES,s=new Int32Array(o),a=0;a<o;a++)s[a]=a;var l={tint:new Float32Array([1,1,1,1]),translationMatrix:new De.d,default:ce.v.from({uSamplers:s},!0)},h=e.plugins[r]._shader.program;Qu[r]=new ce.r(h,l)}n=Qu[r]}return n},t.prototype._calculateBounds=function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var n=e.bounds,r=n.minX,o=n.minY,s=n.maxX,a=n.maxY;this._bounds.addFrame(this.transform,r,o,s,a)}},t.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)},t.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=Object(xn.hex2rgb)(this.tint,U1),n=0;n<this.batches.length;n++){var r=this.batches[n],o=r._batchRGB,s=(e[0]*o[0]*255<<16)+(e[1]*o[1]*255<<8)+(0|e[2]*o[2]*255);r._tintRGB=(s>>16)+(65280&s)+((255&s)<<16)}}},t.prototype.calculateVertices=function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var n=this.transform.worldTransform,r=n.a,o=n.b,s=n.c,a=n.d,l=n.tx,h=n.ty,u=this._geometry.points,p=this.vertexData,y=0,x=0;x<u.length;x+=2){var E=u[x],w=u[x+1];p[y++]=r*E+s*w+l,p[y++]=a*w+o*E+h}}},t.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this},t.prototype.setMatrix=function(e){return this._matrix=e,this},t.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},t.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},t.prototype.destroy=function(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,i.prototype.destroy.call(this,e)},t.nextRoundedRectBehavior=!1,t._TEMP_POINT=new De.g,t}(Cn.b),mm=function(i,t){return(mm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},La,Da=new De.g,k1=new Uint16Array([0,1,2,0,2,3]),pi=function(i){function t(e){var n=i.call(this)||this;return n._anchor=new De.e(n._onAnchorUpdate,n,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=gn.b.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=e||ce.t.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=k1,n.pluginName="batch",n.isSprite=!0,n._roundPixels=br.b.ROUND_PIXELS,n}return function(e,n){function r(){this.constructor=e}mm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Object(xn.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Object(xn.sign)(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){var e=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==e._updateID){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var n=this.transform.worldTransform,r=n.a,o=n.b,s=n.c,a=n.d,l=n.tx,h=n.ty,u=this.vertexData,p=e.trim,y=e.orig,x=this._anchor,E=0,w=0,C=0,j=0;if(p?(E=(w=p.x-x._x*y.width)+p.width,C=(j=p.y-x._y*y.height)+p.height):(E=(w=-x._x*y.width)+y.width,C=(j=-x._y*y.height)+y.height),u[0]=r*w+s*j+l,u[1]=a*j+o*w+h,u[2]=r*E+s*j+l,u[3]=a*j+o*E+h,u[4]=r*E+s*C+l,u[5]=a*C+o*E+h,u[6]=r*w+s*C+l,u[7]=a*C+o*w+h,this._roundPixels)for(var Z=br.b.RESOLUTION,rt=0;rt<u.length;++rt)u[rt]=Math.round((u[rt]*Z|0)/Z)}},t.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,n=this.vertexTrimmedData,r=e.orig,o=this._anchor,s=this.transform.worldTransform,a=s.a,l=s.b,h=s.c,u=s.d,p=s.tx,y=s.ty,x=-o._x*r.width,E=x+r.width,w=-o._y*r.height,C=w+r.height;n[0]=a*x+h*w+p,n[1]=u*w+l*x+y,n[2]=a*E+h*w+p,n[3]=u*w+l*E+y,n[4]=a*E+h*C+p,n[5]=u*C+l*E+y,n[6]=a*x+h*C+p,n[7]=u*C+l*x+y},t.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,n=this._texture.orig;!e||e.width===n.width&&e.height===n.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Cn.a),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new De.j),e=this._localBoundsRect),this._localBounds.getRectangle(e)):i.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,Da);var n=this._texture.orig.width,r=this._texture.orig.height,o=-n*this.anchor.x,s=0;return Da.x>=o&&Da.x<o+n&&(s=-r*this.anchor.y,Da.y>=s&&Da.y<s+r)},t.prototype.destroy=function(e){if(i.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e&&e.texture){var n=typeof e=="boolean"?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null},t.from=function(e,n){return new t(e instanceof ce.t?e:ce.t.from(e,n))},Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var n=Object(xn.sign)(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var n=Object(xn.sign)(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||ce.t.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),t}(Cn.b),gm=function(i,t){return(gm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};(function(i){i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(La||(La={}));var $u={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:La.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},G1=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],zs=function(){function i(t){this.styleID=0,this.reset(),ec(this,t,t)}return i.prototype.clone=function(){var t={};return ec(t,this,$u),new i(t)},i.prototype.reset=function(){ec(this,$u,$u)},Object.defineProperty(i.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=tc(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=tc(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(e,n){if(!Array.isArray(e)||!Array.isArray(n)||e.length!==n.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=tc(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),i.prototype.toFontString=function(){var t=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var r=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&G1.indexOf(r)<0&&(r='"'+r+'"'),e[n]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},i}();function vm(i){return typeof i=="number"?Object(xn.hex2string)(i):(typeof i=="string"&&i.indexOf("0x")===0&&(i=i.replace("0x","#")),i)}function tc(i){if(Array.isArray(i)){for(var t=0;t<i.length;++t)i[t]=vm(i[t]);return i}return vm(i)}function ec(i,t,e){for(var n in e)Array.isArray(t[n])?i[n]=t[n].slice():i[n]=t[n]}var $r=function(){function i(t,e,n,r,o,s,a,l,h){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=o,this.lineWidths=s,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=h}return i.measureText=function(t,e,n,r){r===void 0&&(r=i._canvas),n=n==null?e.wordWrap:n;var o=e.toFontString(),s=i.measureFont(o);s.fontSize===0&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);var a=r.getContext("2d");a.font=o;for(var l=(n?i.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),h=new Array(l.length),u=0,p=0;p<l.length;p++){var y=a.measureText(l[p]).width+(l[p].length-1)*e.letterSpacing;h[p]=y,u=Math.max(u,y)}var x=u+e.strokeThickness;e.dropShadow&&(x+=e.dropShadowDistance);var E=e.lineHeight||s.fontSize+e.strokeThickness,w=Math.max(E,s.fontSize+e.strokeThickness)+(l.length-1)*(E+e.leading);return e.dropShadow&&(w+=e.dropShadowDistance),new i(t,e,x,w,l,h,E+e.leading,u,s)},i.wordWrap=function(t,e,n){n===void 0&&(n=i._canvas);for(var r=n.getContext("2d"),o=0,s="",a="",l=Object.create(null),h=e.letterSpacing,u=e.whiteSpace,p=i.collapseSpaces(u),y=i.collapseNewlines(u),x=!p,E=e.wordWrapWidth+h,w=i.tokenize(t),C=0;C<w.length;C++){var j=w[C];if(i.isNewline(j)){if(!y){a+=i.addLine(s),x=!p,s="",o=0;continue}j=" "}if(p){var Z=i.isBreakingSpace(j),rt=i.isBreakingSpace(s[s.length-1]);if(Z&&rt)continue}var ct=i.getFromCache(j,h,l,r);if(ct>E)if(s!==""&&(a+=i.addLine(s),s="",o=0),i.canBreakWords(j,e.breakWords))for(var nt=i.wordWrapSplit(j),vt=0;vt<nt.length;vt++){for(var ht=nt[vt],mt=1;nt[vt+mt];){var jt=nt[vt+mt],Ft=ht[ht.length-1];if(i.canBreakChars(Ft,jt,j,vt,e.breakWords))break;ht+=jt,mt++}vt+=ht.length-1;var Mt=i.getFromCache(ht,h,l,r);Mt+o>E&&(a+=i.addLine(s),x=!1,s="",o=0),s+=ht,o+=Mt}else{s.length>0&&(a+=i.addLine(s),s="",o=0);var wt=C===w.length-1;a+=i.addLine(j,!wt),x=!1,s="",o=0}else ct+o>E&&(x=!1,a+=i.addLine(s),s="",o=0),(s.length>0||!i.isBreakingSpace(j)||x)&&(s+=j,o+=ct)}return a+=i.addLine(s,!1)},i.addLine=function(t,e){return e===void 0&&(e=!0),t=i.trimRight(t),t=e?t+`
`:t},i.getFromCache=function(t,e,n,r){var o=n[t];if(typeof o!="number"){var s=t.length*e;o=r.measureText(t).width+s,n[t]=o}return o},i.collapseSpaces=function(t){return t==="normal"||t==="pre-line"},i.collapseNewlines=function(t){return t==="normal"},i.trimRight=function(t){if(typeof t!="string")return"";for(var e=t.length-1;e>=0;e--){var n=t[e];if(!i.isBreakingSpace(n))break;t=t.slice(0,-1)}return t},i.isNewline=function(t){return typeof t=="string"&&i._newlines.indexOf(t.charCodeAt(0))>=0},i.isBreakingSpace=function(t,e){return typeof t=="string"&&i._breakingSpaces.indexOf(t.charCodeAt(0))>=0},i.tokenize=function(t){var e=[],n="";if(typeof t!="string")return e;for(var r=0;r<t.length;r++){var o=t[r],s=t[r+1];i.isBreakingSpace(o,s)||i.isNewline(o)?(n!==""&&(e.push(n),n=""),e.push(o)):n+=o}return n!==""&&e.push(n),e},i.canBreakWords=function(t,e){return e},i.canBreakChars=function(t,e,n,r,o){return!0},i.wordWrapSplit=function(t){return t.split("")},i.measureFont=function(t){if(i._fonts[t])return i._fonts[t];var e={ascent:0,descent:0,fontSize:0},n=i._canvas,r=i._context;r.font=t;var o=i.METRICS_STRING+i.BASELINE_SYMBOL,s=Math.ceil(r.measureText(o).width),a=Math.ceil(r.measureText(i.BASELINE_SYMBOL).width),l=Math.ceil(i.HEIGHT_MULTIPLIER*a);a=a*i.BASELINE_MULTIPLIER|0,n.width=s,n.height=l,r.fillStyle="#f00",r.fillRect(0,0,s,l),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(o,0,a);var h=r.getImageData(0,0,s,l).data,u=h.length,p=4*s,y=0,x=0,E=!1;for(y=0;y<a;++y){for(var w=0;w<p;w+=4)if(h[x+w]!==255){E=!0;break}if(E)break;x+=p}for(e.ascent=a-y,x=u-p,E=!1,y=l;y>a;--y){for(w=0;w<p;w+=4)if(h[x+w]!==255){E=!0;break}if(E)break;x-=p}return e.descent=y-a,e.fontSize=e.ascent+e.descent,i._fonts[t]=e,e},i.clearMetrics=function(t){t===void 0&&(t=""),t?delete i._fonts[t]:i._fonts={}},Object.defineProperty(i,"_canvas",{get:function(){if(!i.__canvas){var t=void 0;try{var e=new OffscreenCanvas(0,0),n=e.getContext("2d");if(n&&n.measureText)return i.__canvas=e,e;t=document.createElement("canvas")}catch{t=document.createElement("canvas")}t.width=t.height=10,i.__canvas=t}return i.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(i,"_context",{get:function(){return i.__context||(i.__context=i._canvas.getContext("2d")),i.__context},enumerable:!1,configurable:!0}),i}();$r._fonts={},$r.METRICS_STRING="|\xC9q\xC5",$r.BASELINE_SYMBOL="M",$r.BASELINE_MULTIPLIER=1.4,$r.HEIGHT_MULTIPLIER=2,$r._newlines=[10,13],$r._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var H1={texture:!0,children:!1,baseTexture:!0},nc=function(i){function t(e,n,r){var o=this,s=!1;r||(r=document.createElement("canvas"),s=!0),r.width=3,r.height=3;var a=ce.t.from(r);return a.orig=new De.j,a.trim=new De.j,(o=i.call(this,a)||this)._ownCanvas=s,o.canvas=r,o.context=o.canvas.getContext("2d"),o._resolution=br.b.RESOLUTION,o._autoResolution=!0,o._text=null,o._style=null,o._styleListener=null,o._font="",o.text=e,o.style=n,o.localStyleID=-1,o}return function(e,n){function r(){this.constructor=e}gm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.updateText=function(e){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!e){this._font=this._style.toFontString();var r,o,s=this.context,a=$r.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),l=a.width,h=a.height,u=a.lines,p=a.lineHeight,y=a.lineWidths,x=a.maxLineWidth,E=a.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,l)+2*n.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,h)+2*n.padding)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=n.strokeThickness,s.textBaseline=n.textBaseline,s.lineJoin=n.lineJoin,s.miterLimit=n.miterLimit;for(var w=n.dropShadow?2:1,C=0;C<w;++C){var j=n.dropShadow&&C===0,Z=j?Math.ceil(Math.max(1,h)+2*n.padding):0,rt=Z*this._resolution;if(j){s.fillStyle="black",s.strokeStyle="black";var ct=n.dropShadowColor,nt=Object(xn.hex2rgb)(typeof ct=="number"?ct:Object(xn.string2hex)(ct)),vt=n.dropShadowBlur*this._resolution,ht=n.dropShadowDistance*this._resolution;s.shadowColor="rgba("+255*nt[0]+","+255*nt[1]+","+255*nt[2]+","+n.dropShadowAlpha+")",s.shadowBlur=vt,s.shadowOffsetX=Math.cos(n.dropShadowAngle)*ht,s.shadowOffsetY=Math.sin(n.dropShadowAngle)*ht+rt}else s.fillStyle=this._generateFillStyle(n,u,a),s.strokeStyle=n.stroke,s.shadowColor="black",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;var mt=(p-E.fontSize)/2;(!t.nextLineHeightBehavior||p-E.fontSize<0)&&(mt=0);for(var jt=0;jt<u.length;jt++)r=n.strokeThickness/2,o=n.strokeThickness/2+jt*p+E.ascent+mt,n.align==="right"?r+=x-y[jt]:n.align==="center"&&(r+=(x-y[jt])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(u[jt],r+n.padding,o+n.padding-Z,!0),n.fill&&this.drawLetterSpacing(u[jt],r+n.padding,o+n.padding-Z)}this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,n,r,o){o===void 0&&(o=!1);var s=this._style.letterSpacing,a=t.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(s===0||a)return a&&(this.context.letterSpacing=s,this.context.textLetterSpacing=s),void(o?this.context.strokeText(e,n,r):this.context.fillText(e,n,r));for(var l=n,h=Array.from?Array.from(e):e.split(""),u=this.context.measureText(e).width,p=0,y=0;y<h.length;++y){var x=h[y];o?this.context.strokeText(x,l,r):this.context.fillText(x,l,r);for(var E="",w=y+1;w<h.length;++w)E+=h[w];l+=u-(p=this.context.measureText(E).width)+s,u=p}},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var n=Object(xn.trimCanvas)(e);n.data&&(e.width=n.width,e.height=n.height,this.context.putImageData(n.data,0,0))}var r=this._texture,o=this._style,s=o.trim?0:o.padding,a=r.baseTexture;r.trim.width=r._frame.width=e.width/this._resolution,r.trim.height=r._frame.height=e.height/this._resolution,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-2*s,r.orig.height=r._frame.height-2*s,this._onTextureUpdate(),a.setRealSize(e.width,e.height,this._resolution),r.updateUvs(),this.dirty=!1},t.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),i.prototype._render.call(this,e)},t.prototype.updateTransform=function(){this.updateText(!0),i.prototype.updateTransform.call(this)},t.prototype.getBounds=function(e,n){return this.updateText(!0),this._textureID===-1&&(e=!1),i.prototype.getBounds.call(this,e,n)},t.prototype.getLocalBounds=function(e){return this.updateText(!0),i.prototype.getLocalBounds.call(this,e)},t.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._generateFillStyle=function(e,n,r){var o,s=e.fill;if(!Array.isArray(s))return s;if(s.length===1)return s[0];var a=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,h=this.canvas.width/this._resolution-a-2*l,u=this.canvas.height/this._resolution-a-2*l,p=s.slice(),y=e.fillGradientStops.slice();if(!y.length)for(var x=p.length+1,E=1;E<x;++E)y.push(E/x);if(p.unshift(s[0]),y.unshift(0),p.push(s[s.length-1]),y.push(1),e.fillGradientType===La.LINEAR_VERTICAL){o=this.context.createLinearGradient(h/2,l,h/2,u+l);var w=r.fontProperties.fontSize+e.strokeThickness;for(E=0;E<n.length;E++){var C=r.lineHeight*(E-1)+w,j=r.lineHeight*E,Z=j;E>0&&C>j&&(Z=(j+C)/2);var rt=j+w,ct=r.lineHeight*(E+1),nt=rt;E+1<n.length&&ct<rt&&(nt=(rt+ct)/2);for(var vt=(nt-Z)/u,ht=0;ht<p.length;ht++){var mt=0;mt=typeof y[ht]=="number"?y[ht]:ht/p.length;var jt=Math.min(1,Math.max(0,Z/u+mt*vt));jt=Number(jt.toFixed(5)),o.addColorStop(jt,p[ht])}}}else{o=this.context.createLinearGradient(l,u/2,h+l,u/2);var Ft=p.length+1,Mt=1;for(E=0;E<p.length;E++){var wt=void 0;wt=typeof y[E]=="number"?y[E]:Mt/Ft,o.addColorStop(wt,p[E]),Mt++}}return o},t.prototype.destroy=function(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},H1,e),i.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var n=Object(xn.sign)(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var n=Object(xn.sign)(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(e){e=e||{},this._style=e instanceof zs?e:new zs(e),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e==null?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.nextLineHeightBehavior=!1,t.experimentalLetterSpacing=!1,t}(pi);/*!
 * @pixi/prepare - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */br.b.UPLOADS_PER_FRAME=4;/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var _m=function(i,t){return(_m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},j1=function(){function i(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return i.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},i.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},i}();function z1(i,t){var e=!1;if(i&&i._textures&&i._textures.length){for(var n=0;n<i._textures.length;n++)if(i._textures[n]instanceof ce.t){var r=i._textures[n].baseTexture;t.indexOf(r)===-1&&(t.push(r),e=!0)}}return e}function V1(i,t){if(i.baseTexture instanceof ce.c){var e=i.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function W1(i,t){if(i._texture&&i._texture instanceof ce.t){var e=i._texture.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function X1(i,t){return t instanceof nc&&(t.updateText(!0),!0)}function Y1(i,t){if(t instanceof zs){var e=t.toFontString();return $r.measureFont(e),!0}return!1}function q1(i,t){if(i instanceof nc){t.indexOf(i.style)===-1&&t.push(i.style),t.indexOf(i)===-1&&t.push(i);var e=i._texture.baseTexture;return t.indexOf(e)===-1&&t.push(e),!0}return!1}function J1(i,t){return i instanceof zs&&(t.indexOf(i)===-1&&t.push(i),!0)}var ym=function(){function i(t){var e=this;this.limiter=new j1(br.b.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(q1),this.registerFindHook(J1),this.registerFindHook(z1),this.registerFindHook(V1),this.registerFindHook(W1),this.registerUploadHook(X1),this.registerUploadHook(Y1)}return i.prototype.upload=function(t,e){typeof t=="function"&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,tr.a.system.addOnce(this.tick,this,tr.c.UTILITY))):e&&e()},i.prototype.tick=function(){setTimeout(this.delayedTick,0)},i.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed){for(var n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)tr.a.system.addOnce(this.tick,this,tr.c.UTILITY);else{this.ticking=!1;var o=this.completes.slice(0);for(this.completes.length=0,n=0,r=o.length;n<r;n++)o[n]()}},i.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},i.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},i.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Cn.b)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},i.prototype.destroy=function(){this.ticking&&tr.a.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},i}();function xm(i,t){return t instanceof ce.c&&(t._glTextures[i.CONTEXT_UID]||i.texture.bind(t),!0)}function K1(i,t){if(!(t instanceof er))return!1;var e=t.geometry;t.finishPoly(),e.updateBatches();for(var n=e.batches,r=0;r<n.length;r++){var o=n[r].style.texture;o&&xm(i,o.baseTexture)}return e.batchable||i.geometry.bind(e,t._resolveDirectShader(i)),!0}function Z1(i,t){return i instanceof er&&(t.push(i),!0)}var Q1=function(i){function t(e){var n=i.call(this,e)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook(Z1),n.registerUploadHook(xm),n.registerUploadHook(K1),n}return function(e,n){function r(){this.constructor=e}_m(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t}(ym),bm=function(){function i(t,e,n){n===void 0&&(n=null),this._texture=t instanceof ce.t?t:null,this.baseTexture=t instanceof ce.c?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var r=this.baseTexture.resource;this.resolution=this._updateResolution(n||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return i.prototype._updateResolution=function(t){t===void 0&&(t=null);var e=this.data.meta.scale,n=Object(xn.getResolutionOfUrl)(t,null);return n===null&&(n=e!==void 0?parseFloat(e):1),n!==1&&this.baseTexture.setResolution(n),n},i.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=i.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},i.prototype._processFrames=function(t){for(var e=t,n=i.BATCH_SIZE;e-t<n&&e<this._frameKeys.length;){var r=this._frameKeys[e],o=this._frames[r],s=o.frame;if(s){var a=null,l=null,h=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,u=new De.j(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);a=o.rotated?new De.j(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new De.j(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(l=new De.j(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[r]=new ce.t(this.baseTexture,a,u,l,o.rotated?2:0,o.anchor),ce.t.addToCache(this.textures[r],r)}e++}},i.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var r=t[e][n];this.animations[e].push(this.textures[r])}}},i.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},i.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*i.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*i.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},i.prototype.destroy=function(t){var e;for(var n in t===void 0&&(t=!1),this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)===null||e===void 0||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},i.BATCH_SIZE=1e3,i}(),$1=function(){function i(){}return i.use=function(t,e){var n,r,o=this,s=t.name+"_image";if(t.data&&t.type===wi.TYPE.JSON&&t.data.frames&&!o.resources[s]){var a=(r=(n=t.data)===null||n===void 0?void 0:n.meta)===null||r===void 0?void 0:r.related_multi_packs;if(Array.isArray(a))for(var l=function(x){if(typeof x!="string")return"continue";var E=x.replace(".json",""),w=xn.url.resolve(t.url.replace(o.baseUrl,""),x);if(o.resources[E]||Object.values(o.resources).some(function(j){return xn.url.format(xn.url.parse(j.url))===w}))return"continue";var C={crossOrigin:t.crossOrigin,loadType:wi.LOAD_TYPE.XHR,xhrType:wi.XHR_RESPONSE_TYPE.JSON,parentResource:t,metadata:t.metadata};o.add(E,w,C)},h=0,u=a;h<u.length;h++)l(u[h]);var p={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},y=i.getResourcePath(t,o.baseUrl);o.add(s,y,p,function(x){if(x.error)e(x.error);else{var E=new bm(x.texture,t.data,t.url);E.parse(function(){t.spritesheet=E,t.textures=E.textures,e()})}})}else e()},i.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:xn.url.resolve(t.url.replace(e,""),t.data.meta.image)},i}(),Tm=function(i,t){return(Tm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function Em(i,t){function e(){this.constructor=i}Tm(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Fa=new De.g,tT=function(i){function t(e,n,r){n===void 0&&(n=100),r===void 0&&(r=100);var o=i.call(this,e)||this;return o.tileTransform=new De.m,o._width=n,o._height=r,o.uvMatrix=o.texture.uvMatrix||new ce.u(e),o.pluginName="tilingSprite",o.uvRespectAnchor=!1,o}return Em(t,i),Object.defineProperty(t.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)},enumerable:!1,configurable:!0}),t.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},t.prototype._render=function(e){var n=this._texture;n&&n.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},t.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,n=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),o=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,n,r,o)},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new De.j),e=this._localBoundsRect),this._bounds.getRectangle(e)):i.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,Fa);var n=this._width,r=this._height,o=-n*this.anchor._x;if(Fa.x>=o&&Fa.x<o+n){var s=-r*this.anchor._y;if(Fa.y>=s&&Fa.y<s+r)return!0}return!1},t.prototype.destroy=function(e){i.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},t.from=function(e,n){return new t(e instanceof ce.t?e:ce.t.from(e,n),n.width,n.height)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!1,configurable:!0}),t}(pi),Sm=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,Ql=new De.d,eT=function(i){function t(e){var n=i.call(this,e)||this;return e.runners.contextChange.add(n),n.quad=new ce.o,n.state=ce.s.for2d(),n}return Em(t,i),t.prototype.contextChange=function(){var e=this.renderer,n={globals:e.globalUniforms};this.simpleShader=ce.r.from(Sm,`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`,n),this.shader=e.context.webGLVersion>1?ce.r.from(`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,n):ce.r.from(Sm,`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,n)},t.prototype.render=function(e){var n=this.renderer,r=this.quad,o=r.vertices;o[0]=o[6]=e._width*-e.anchor.x,o[1]=o[3]=e._height*-e.anchor.y,o[2]=o[4]=e._width*(1-e.anchor.x),o[5]=o[7]=e._height*(1-e.anchor.y);var s=e.uvRespectAnchor?e.anchor.x:0,a=e.uvRespectAnchor?e.anchor.y:0;(o=r.uvs)[0]=o[6]=-s,o[1]=o[3]=-a,o[2]=o[4]=1-s,o[5]=o[7]=1-a,r.invalidate();var l=e._texture,h=l.baseTexture,u=e.tileTransform.localTransform,p=e.uvMatrix,y=h.isPowerOfTwo&&l.frame.width===h.width&&l.frame.height===h.height;y&&(h._glTextures[n.CONTEXT_UID]?y=h.wrapMode!==gn.s.CLAMP:h.wrapMode===gn.s.CLAMP&&(h.wrapMode=gn.s.REPEAT));var x=y?this.simpleShader:this.shader,E=l.width,w=l.height,C=e._width,j=e._height;Ql.set(u.a*E/C,u.b*E/j,u.c*w/C,u.d*w/j,u.tx/C,u.ty/j),Ql.invert(),y?Ql.prepend(p.mapCoord):(x.uniforms.uMapCoord=p.mapCoord.toArray(!0),x.uniforms.uClampFrame=p.uClampFrame,x.uniforms.uClampOffset=p.uClampOffset),x.uniforms.uTransform=Ql.toArray(!0),x.uniforms.uColor=Object(xn.premultiplyTintToRgba)(e.tint,e.worldAlpha,x.uniforms.uColor,h.alphaMode),x.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),x.uniforms.uSampler=l,n.shader.bind(x),n.geometry.bind(r),this.state.blendMode=Object(xn.correctBlendMode)(e.blendMode,h.alphaMode),n.state.set(this.state),n.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},t}(ce.m),Vs=v(8),wm=function(i,t){return(wm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},$l=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]},nT=function(){function i(){}return i.test=function(t){return typeof t=="string"&&t.indexOf("info face=")===0},i.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var r in e){var o=e[r].match(/^[a-z]+/gm)[0],s=e[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var l in s){var h=s[l].split("="),u=h[0],p=h[1].replace(/"/gm,""),y=parseFloat(p),x=isNaN(y)?p:y;a[u]=x}n[o].push(a)}var E=new $l;return n.info.forEach(function(w){return E.info.push({face:w.face,size:parseInt(w.size,10)})}),n.common.forEach(function(w){return E.common.push({lineHeight:parseInt(w.lineHeight,10)})}),n.page.forEach(function(w){return E.page.push({id:parseInt(w.id,10),file:w.file})}),n.char.forEach(function(w){return E.char.push({id:parseInt(w.id,10),page:parseInt(w.page,10),x:parseInt(w.x,10),y:parseInt(w.y,10),width:parseInt(w.width,10),height:parseInt(w.height,10),xoffset:parseInt(w.xoffset,10),yoffset:parseInt(w.yoffset,10),xadvance:parseInt(w.xadvance,10)})}),n.kerning.forEach(function(w){return E.kerning.push({first:parseInt(w.first,10),second:parseInt(w.second,10),amount:parseInt(w.amount,10)})}),n.distanceField.forEach(function(w){return E.distanceField.push({distanceRange:parseInt(w.distanceRange,10),fieldType:w.fieldType})}),E},i}(),ic=function(){function i(){}return i.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},i.parse=function(t){for(var e=new $l,n=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),o=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),l=t.getElementsByTagName("distanceField"),h=0;h<n.length;h++)e.info.push({face:n[h].getAttribute("face"),size:parseInt(n[h].getAttribute("size"),10)});for(h=0;h<r.length;h++)e.common.push({lineHeight:parseInt(r[h].getAttribute("lineHeight"),10)});for(h=0;h<o.length;h++)e.page.push({id:parseInt(o[h].getAttribute("id"),10)||0,file:o[h].getAttribute("file")});for(h=0;h<s.length;h++){var u=s[h];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(h=0;h<a.length;h++)e.kerning.push({first:parseInt(a[h].getAttribute("first"),10),second:parseInt(a[h].getAttribute("second"),10),amount:parseInt(a[h].getAttribute("amount"),10)});for(h=0;h<l.length;h++)e.distanceField.push({fieldType:l[h].getAttribute("fieldType"),distanceRange:parseInt(l[h].getAttribute("distanceRange"),10)});return e},i}(),iT=function(){function i(){}return i.test=function(t){if(typeof t=="string"&&t.indexOf("<font>")>-1){var e=new globalThis.DOMParser().parseFromString(t,"text/xml");return ic.test(e)}return!1},i.parse=function(t){var e=new globalThis.DOMParser().parseFromString(t,"text/xml");return ic.parse(e)},i}(),rc=[nT,ic,iT];function Am(i){for(var t=0;t<rc.length;t++)if(rc[t].test(i))return rc[t];return null}function rT(i,t,e,n,r,o,s){var a=e.text,l=e.fontProperties;t.translate(n,r),t.scale(o,o);var h=s.strokeThickness/2,u=-s.strokeThickness/2;if(t.font=s.toFontString(),t.lineWidth=s.strokeThickness,t.textBaseline=s.textBaseline,t.lineJoin=s.lineJoin,t.miterLimit=s.miterLimit,t.fillStyle=function(w,C,j,Z,rt,ct){var nt,vt=j.fill;if(!Array.isArray(vt))return vt;if(vt.length===1)return vt[0];var ht=j.dropShadow?j.dropShadowDistance:0,mt=j.padding||0,jt=w.width/Z-ht-2*mt,Ft=w.height/Z-ht-2*mt,Mt=vt.slice(),wt=j.fillGradientStops.slice();if(!wt.length)for(var Pt=Mt.length+1,Nt=1;Nt<Pt;++Nt)wt.push(Nt/Pt);if(Mt.unshift(vt[0]),wt.unshift(0),Mt.push(vt[vt.length-1]),wt.push(1),j.fillGradientType===La.LINEAR_VERTICAL){nt=C.createLinearGradient(jt/2,mt,jt/2,Ft+mt);var ne=0,$t=(ct.fontProperties.fontSize+j.strokeThickness)/Ft;for(Nt=0;Nt<rt.length;Nt++)for(var zt=ct.lineHeight*Nt,Yt=0;Yt<Mt.length;Yt++){var ge=zt/Ft+(typeof wt[Yt]=="number"?wt[Yt]:Yt/Mt.length)*$t,be=Math.max(ne,ge);be=Math.min(be,1),nt.addColorStop(be,Mt[Yt]),ne=be}}else{nt=C.createLinearGradient(mt,Ft/2,jt+mt,Ft/2);var Pe=Mt.length+1,Ct=1;for(Nt=0;Nt<Mt.length;Nt++){var Bt=void 0;Bt=typeof wt[Nt]=="number"?wt[Nt]:Ct/Pe,nt.addColorStop(Bt,Mt[Nt]),Ct++}}return nt}(i,t,s,o,[a],e),t.strokeStyle=s.stroke,s.dropShadow){var p=s.dropShadowColor,y=Object(xn.hex2rgb)(typeof p=="number"?p:Object(xn.string2hex)(p)),x=s.dropShadowBlur*o,E=s.dropShadowDistance*o;t.shadowColor="rgba("+255*y[0]+","+255*y[1]+","+255*y[2]+","+s.dropShadowAlpha+")",t.shadowBlur=x,t.shadowOffsetX=Math.cos(s.dropShadowAngle)*E,t.shadowOffsetY=Math.sin(s.dropShadowAngle)*E}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;s.stroke&&s.strokeThickness&&t.strokeText(a,h,u+e.lineHeight-l.descent),s.fill&&t.fillText(a,h,u+e.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Mm(i){return Array.from?Array.from(i):i.split("")}function th(i){return i.codePointAt?i.codePointAt(0):i.charCodeAt(0)}var Ws=function(){function i(t,e,n){var r,o,s=t.info[0],a=t.common[0],l=t.page[0],h=t.distanceField[0],u=Object(xn.getResolutionOfUrl)(l.file),p={};this._ownsTextures=n,this.font=s.face,this.size=s.size,this.lineHeight=a.lineHeight/u,this.chars={},this.pageTextures=p;for(var y=0;y<t.page.length;y++){var x=t.page[y],E=x.id,w=x.file;p[E]=e instanceof Array?e[y]:e[w],(h==null?void 0:h.fieldType)&&h.fieldType!=="none"&&(p[E].baseTexture.alphaMode=gn.a.NO_PREMULTIPLIED_ALPHA)}for(y=0;y<t.char.length;y++){var C=t.char[y],j=(E=C.id,C.page),Z=t.char[y],rt=Z.x,ct=Z.y,nt=Z.width,vt=Z.height,ht=Z.xoffset,mt=Z.yoffset,jt=Z.xadvance;rt/=u,ct/=u,nt/=u,vt/=u,ht/=u,mt/=u,jt/=u;var Ft=new De.j(rt+p[j].frame.x/u,ct+p[j].frame.y/u,nt,vt);this.chars[E]={xOffset:ht,yOffset:mt,xAdvance:jt,kerning:{},texture:new ce.t(p[j].baseTexture,Ft),page:j}}for(y=0;y<t.kerning.length;y++){var Mt=t.kerning[y],wt=Mt.first,Pt=Mt.second,Nt=Mt.amount;wt/=u,Pt/=u,Nt/=u,this.chars[Pt]&&(this.chars[Pt].kerning[wt]=Nt)}this.distanceFieldRange=h==null?void 0:h.distanceRange,this.distanceFieldType=(o=(r=h==null?void 0:h.fieldType)===null||r===void 0?void 0:r.toLowerCase())!==null&&o!==void 0?o:"none"}return i.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},i.install=function(t,e,n){var r;if(t instanceof $l)r=t;else{var o=Am(t);if(!o)throw new Error("Unrecognized data format for font.");r=o.parse(t)}e instanceof ce.t&&(e=[e]);var s=new i(r,e,n);return i.available[s.font]=s,s},i.uninstall=function(t){var e=i.available[t];if(!e)throw new Error("No font found named '"+t+"'");e.destroy(),delete i.available[t]},i.from=function(t,e,n){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var r=Object.assign({},i.defaultOptions,n),o=r.chars,s=r.padding,a=r.resolution,l=r.textureWidth,h=r.textureHeight,u=function(ge){typeof ge=="string"&&(ge=[ge]);for(var be=[],Pe=0,Ct=ge.length;Pe<Ct;Pe++){var Bt=ge[Pe];if(Array.isArray(Bt)){if(Bt.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+Bt.length+".");var ve=Bt[0].charCodeAt(0),le=Bt[1].charCodeAt(0);if(le<ve)throw new Error("[BitmapFont]: Invalid character range.");for(var se=ve,Ie=le;se<=Ie;se++)be.push(String.fromCharCode(se))}else be.push.apply(be,Mm(Bt))}if(be.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return be}(o),p=e instanceof zs?e:new zs(e),y=l,x=new $l;x.info[0]={face:p.fontFamily,size:p.fontSize},x.common[0]={lineHeight:p.fontSize};for(var E,w,C,j=0,Z=0,rt=0,ct=[],nt=0;nt<u.length;nt++){E||((E=document.createElement("canvas")).width=l,E.height=h,w=E.getContext("2d"),C=new ce.c(E,{resolution:a}),ct.push(new ce.t(C)),x.page.push({id:ct.length-1,file:""}));var vt=$r.measureText(u[nt],p,!1,E),ht=vt.width,mt=Math.ceil(vt.height),jt=Math.ceil((p.fontStyle==="italic"?2:1)*ht);if(Z>=h-mt*a){if(Z===0)throw new Error("[BitmapFont] textureHeight "+h+"px is too small for "+p.fontSize+"px fonts");--nt,E=null,w=null,C=null,Z=0,j=0,rt=0}else if(rt=Math.max(mt+vt.fontProperties.descent,rt),jt*a+j>=y)--nt,Z+=rt*a,Z=Math.ceil(Z),j=0,rt=0;else{rT(E,w,vt,j,Z,a,p);var Ft=th(vt.text);x.char.push({id:Ft,page:ct.length-1,x:j/a,y:Z/a,width:jt,height:mt,xoffset:0,yoffset:0,xadvance:Math.ceil(ht-(p.dropShadow?p.dropShadowDistance:0)-(p.stroke?p.strokeThickness:0))}),j+=(jt+2*s)*a,j=Math.ceil(j)}}nt=0;for(var Mt=u.length;nt<Mt;nt++)for(var wt=u[nt],Pt=0;Pt<Mt;Pt++){var Nt=u[Pt],ne=w.measureText(wt).width,$t=w.measureText(Nt).width,zt=w.measureText(wt+Nt).width-(ne+$t);zt&&x.kerning.push({first:th(wt),second:th(Nt),amount:zt})}var Yt=new i(x,ct,!0);return i.available[t]!==void 0&&i.uninstall(t),i.available[t]=Yt,Yt},i.ALPHA=[["a","z"],["A","Z"]," "],i.NUMERIC=[["0","9"]],i.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],i.ASCII=[[" ","~"]],i.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:i.ALPHANUMERIC},i.available={},i}(),oT=[],sT=[],Cm=[],aT=(function(i){function t(e,n){n===void 0&&(n={});var r=i.call(this)||this;r._tint=16777215;var o=Object.assign({},t.styleDefaults,n),s=o.align,a=o.tint,l=o.maxWidth,h=o.letterSpacing,u=o.fontName,p=o.fontSize;if(!Ws.available[u])throw new Error('Missing BitmapFont "'+u+'"');return r._activePagesMeshData=[],r._textWidth=0,r._textHeight=0,r._align=s,r._tint=a,r._fontName=u,r._fontSize=p||Ws.available[u].size,r.text=e,r._maxWidth=l,r._maxLineHeight=0,r._letterSpacing=h,r._anchor=new De.e(function(){r.dirty=!0},r,0,0),r._roundPixels=br.b.ROUND_PIXELS,r.dirty=!0,r._resolution=br.b.RESOLUTION,r._autoResolution=!0,r._textureCache={},r}(function(e,n){function r(){this.constructor=e}wm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)})(t,i),t.prototype.updateText=function(){for(var e,n=Ws.available[this._fontName],r=this._fontSize/n.size,o=new De.g,s=[],a=[],l=[],h=Mm(this._text.replace(/(?:\r\n|\r)/g,`
`)||" "),u=this._maxWidth*n.size/this._fontSize,p=n.distanceFieldType==="none"?oT:sT,y=null,x=0,E=0,w=0,C=-1,j=0,Z=0,rt=0,ct=0,nt=0;nt<h.length;nt++){var vt=th(se=h[nt]);if(/(?:\s)/.test(se)&&(C=nt,j=x,ct++),se!=="\r"&&se!==`
`){var ht=n.chars[vt];if(ht){y&&ht.kerning[y]&&(o.x+=ht.kerning[y]);var mt=Cm.pop()||{texture:ce.t.EMPTY,line:0,charCode:0,prevSpaces:0,position:new De.g};mt.texture=ht.texture,mt.line=w,mt.charCode=vt,mt.position.x=o.x+ht.xOffset+this._letterSpacing/2,mt.position.y=o.y+ht.yOffset,mt.prevSpaces=ct,s.push(mt),x=mt.position.x+Math.max(ht.xAdvance,ht.texture.orig.width),o.x+=ht.xAdvance+this._letterSpacing,rt=Math.max(rt,ht.yOffset+ht.texture.height),y=vt,C!==-1&&u>0&&o.x>u&&(++Z,Object(xn.removeItems)(s,1+C-Z,1+nt-C),nt=C,C=-1,a.push(j),l.push(s.length>0?s[s.length-1].prevSpaces:0),E=Math.max(E,j),w++,o.x=0,o.y+=n.lineHeight,y=null,ct=0)}}else a.push(x),l.push(-1),E=Math.max(E,x),++w,++Z,o.x=0,o.y+=n.lineHeight,y=null,ct=0}var jt=h[h.length-1];jt!=="\r"&&jt!==`
`&&(/(?:\s)/.test(jt)&&(x=j),a.push(x),E=Math.max(E,x),l.push(-1));var Ft=[];for(nt=0;nt<=w;nt++){var Mt=0;this._align==="right"?Mt=E-a[nt]:this._align==="center"?Mt=(E-a[nt])/2:this._align==="justify"&&(Mt=l[nt]<0?0:(E-a[nt])/l[nt]),Ft.push(Mt)}var wt=s.length,Pt={},Nt=[],ne=this._activePagesMeshData;for(nt=0;nt<ne.length;nt++)p.push(ne[nt]);for(nt=0;nt<wt;nt++){var $t=(Le=s[nt].texture).baseTexture.uid;if(!Pt[$t]){if(!(ye=p.pop())){var zt=new Vs.b,Yt=void 0,ge=void 0;n.distanceFieldType==="none"?(Yt=new Vs.c(ce.t.EMPTY),ge=gn.b.NORMAL):(Yt=new Vs.c(ce.t.EMPTY,{program:ce.n.from(`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`,`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`),uniforms:{uFWidth:0}}),ge=gn.b.NORMAL_NPM);var be=new Vs.a(zt,Yt);be.blendMode=ge,ye={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:be,vertices:null,uvs:null,indices:null}}ye.index=0,ye.indexCount=0,ye.vertexCount=0,ye.uvsCount=0,ye.total=0;var Pe=this._textureCache;Pe[$t]=Pe[$t]||new ce.t(Le.baseTexture),ye.mesh.texture=Pe[$t],ye.mesh.tint=this._tint,Nt.push(ye),Pt[$t]=ye}Pt[$t].total++}for(nt=0;nt<ne.length;nt++)Nt.indexOf(ne[nt])===-1&&this.removeChild(ne[nt].mesh);for(nt=0;nt<Nt.length;nt++)Nt[nt].mesh.parent!==this&&this.addChild(Nt[nt].mesh);for(var nt in this._activePagesMeshData=Nt,Pt){var Ct=(ye=Pt[nt]).total;if(!(((e=ye.indices)===null||e===void 0?void 0:e.length)>6*Ct)||ye.vertices.length<2*Vs.a.BATCHABLE_SIZE)ye.vertices=new Float32Array(8*Ct),ye.uvs=new Float32Array(8*Ct),ye.indices=new Uint16Array(6*Ct);else for(var Bt=ye.total,ve=ye.vertices,le=4*Bt*2;le<ve.length;le++)ve[le]=0;ye.mesh.size=6*Ct}for(nt=0;nt<wt;nt++){var se,Ie=(se=s[nt]).position.x+Ft[se.line]*(this._align==="justify"?se.prevSpaces:1);this._roundPixels&&(Ie=Math.round(Ie));var Le,ue=Ie*r,bt=se.position.y*r,Ht=Pt[(Le=se.texture).baseTexture.uid],ie=Le.frame,ae=Le._uvs,qt=Ht.index++;Ht.indices[6*qt+0]=0+4*qt,Ht.indices[6*qt+1]=1+4*qt,Ht.indices[6*qt+2]=2+4*qt,Ht.indices[6*qt+3]=0+4*qt,Ht.indices[6*qt+4]=2+4*qt,Ht.indices[6*qt+5]=3+4*qt,Ht.vertices[8*qt+0]=ue,Ht.vertices[8*qt+1]=bt,Ht.vertices[8*qt+2]=ue+ie.width*r,Ht.vertices[8*qt+3]=bt,Ht.vertices[8*qt+4]=ue+ie.width*r,Ht.vertices[8*qt+5]=bt+ie.height*r,Ht.vertices[8*qt+6]=ue,Ht.vertices[8*qt+7]=bt+ie.height*r,Ht.uvs[8*qt+0]=ae.x0,Ht.uvs[8*qt+1]=ae.y0,Ht.uvs[8*qt+2]=ae.x1,Ht.uvs[8*qt+3]=ae.y1,Ht.uvs[8*qt+4]=ae.x2,Ht.uvs[8*qt+5]=ae.y2,Ht.uvs[8*qt+6]=ae.x3,Ht.uvs[8*qt+7]=ae.y3}for(var nt in this._textWidth=E*r,this._textHeight=(o.y+n.lineHeight)*r,Pt){var ye=Pt[nt];if(this.anchor.x!==0||this.anchor.y!==0)for(var nn=0,on=this._textWidth*this.anchor.x,rn=this._textHeight*this.anchor.y,Sn=0;Sn<ye.total;Sn++)ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn,ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn,ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn,ye.vertices[nn++]-=on,ye.vertices[nn++]-=rn;this._maxLineHeight=rt*r;var Mi=ye.mesh.geometry.getBuffer("aVertexPosition"),Kn=ye.mesh.geometry.getBuffer("aTextureCoord"),fr=ye.mesh.geometry.getIndex();Mi.data=ye.vertices,Kn.data=ye.uvs,fr.data=ye.indices,Mi.update(),Kn.update(),fr.update()}for(nt=0;nt<s.length;nt++)Cm.push(s[nt])},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);var n=Ws.available[this._fontName],r=n.distanceFieldRange,o=n.distanceFieldType,s=n.size;if(o!=="none")for(var a=this.worldTransform,l=a.a,h=a.b,u=a.c,p=a.d,y=Math.sqrt(l*l+h*h),x=Math.sqrt(u*u+p*p),E=(Math.abs(y)+Math.abs(x))/2,w=this._fontSize/s,C=0,j=this._activePagesMeshData;C<j.length;C++)j[C].mesh.shader.uniforms.uFWidth=E*r*w*this._resolution;i.prototype._render.call(this,e)},t.prototype.getLocalBounds=function(){return this.validate(),i.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){if(this._tint!==e){this._tint=e;for(var n=0;n<this._activePagesMeshData.length;n++)this._activePagesMeshData[n].mesh.tint=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(!Ws.available[e])throw new Error('Missing BitmapFont "'+e+'"');this._fontName!==e&&(this._fontName=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e==null?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e){var n=this._textureCache;for(var r in n)n[r].destroy(),delete n[r];this._textureCache=null,i.prototype.destroy.call(this,e)},t.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0}}(Cn.b),function(){function i(){}return i.add=function(){wi.setExtensionXhrType("fnt",wi.XHR_RESPONSE_TYPE.TEXT)},i.use=function(t,e){var n=Am(t.data);if(n)for(var r=i.getBaseUrl(this,t),o=n.parse(t.data),s={},a=function(w){s[w.metadata.pageFile]=w.texture,Object.keys(s).length===o.page.length&&(t.bitmapFont=Ws.install(o,s,!0),e())},l=0;l<o.page.length;++l){var h=o.page[l].file,u=r+h,p=!1;for(var y in this.resources){var x=this.resources[y];if(x.url===u){x.metadata.pageFile=h,x.texture?a(x):x.onAfterMiddleware.add(a),p=!0;break}}if(!p){var E={crossOrigin:t.crossOrigin,loadType:wi.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:h},t.metadata.imageMetadata),parentResource:t};this.add(u,E,a)}}else e()},i.getBaseUrl=function(t,e){var n=e.isDataUrl?"":i.dirname(e.url);return e.isDataUrl&&(n==="."&&(n=""),t.baseUrl&&n&&t.baseUrl.charAt(t.baseUrl.length-1)==="/"&&(n+="/")),(n=n.replace(t.baseUrl,""))&&n.charAt(n.length-1)!=="/"&&(n+="/"),n},i.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":e===""?"/":e},i}()),Rm=function(i,t){return(Rm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},lT=function(i){function t(e){e===void 0&&(e=1);var n=i.call(this,ce.A,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,{uAlpha:1})||this;return n.alpha=e,n}return function(e,n){function r(){this.constructor=e}Rm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(ce.k),Im=function(i,t){return(Im=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function Pm(i,t){function e(){this.constructor=i}Im(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Om,Nm,Lm,Dm,Fm,Bm,Um,km,Gm,Hm,jm,zm,Vm,Ba,Wm,Xm,Ym,qm,Jm,hT={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},uT=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(Om||(Om={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(Nm||(Nm={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(Lm||(Lm={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(Dm||(Dm={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Fm||(Fm={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Bm||(Bm={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Um||(Um={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(km||(km={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(Gm||(Gm={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(Hm||(Hm={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(jm||(jm={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(zm||(zm={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Vm||(Vm={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(Ba||(Ba={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(Wm||(Wm={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(Xm||(Xm={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(Ym||(Ym={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(qm||(qm={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Jm||(Jm={}));var oc=function(i){function t(e,n,r,o,s){n===void 0&&(n=8),r===void 0&&(r=4),o===void 0&&(o=br.b.FILTER_RESOLUTION),s===void 0&&(s=5);var a=this,l=function(u,p){var y,x=Math.ceil(u/2),E=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`,w="";y=p?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var C=0;C<u;C++){var j=y.replace("%index%",C.toString());w+=j=j.replace("%sampleIndex%",C-(x-1)+".0"),w+=`
`}return E=(E=E.replace("%blur%",w)).replace("%size%",u.toString())}(s,e),h=function(u){for(var p,y=hT[u],x=y.length,E=uT,w="",C=0;C<u;C++){var j="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",C.toString());p=C,C>=x&&(p=u-C-1),w+=j=j.replace("%value%",y[p].toString()),w+=`
`}return E=(E=E.replace("%blur%",w)).replace("%size%",u.toString())}(s);return(a=i.call(this,l,h)||this).horizontal=e,a.resolution=o,a._quality=0,a.quality=r,a.blur=n,a}return Pm(t,i),t.prototype.apply=function(e,n,r,o){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/n.width):this.uniforms.strength=1/r.height*(r.height/n.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/n.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/n.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,n,r,o);else{var s=e.getFilterTexture(),a=e.renderer,l=n,h=s;this.state.blend=!1,e.applyFilter(this,l,h,Ba.CLEAR);for(var u=1;u<this.passes-1;u++){e.bindAndClear(l,Ba.BLIT),this.uniforms.uSampler=h;var p=h;h=l,l=p,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,h,r,o),e.returnFilterTexture(s)}},Object.defineProperty(t.prototype,"blur",{get:function(){return this.strength},set:function(e){this.padding=1+2*Math.abs(e),this.strength=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e},enumerable:!1,configurable:!0}),t}(ce.k),cT=function(i){function t(e,n,r,o){e===void 0&&(e=8),n===void 0&&(n=4),r===void 0&&(r=br.b.FILTER_RESOLUTION),o===void 0&&(o=5);var s=i.call(this)||this;return s.blurXFilter=new oc(!0,e,n,r,o),s.blurYFilter=new oc(!1,e,n,r,o),s.resolution=r,s.quality=n,s.blur=e,s.repeatEdgePixels=!1,s}return Pm(t,i),t.prototype.apply=function(e,n,r,o){var s=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(s&&a){var l=e.getFilterTexture();this.blurXFilter.apply(e,n,l,Ba.CLEAR),this.blurYFilter.apply(e,l,r,o),e.returnFilterTexture(l)}else a?this.blurYFilter.apply(e,n,r,o):this.blurXFilter.apply(e,n,r,o)},t.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(t.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(e){this.blurYFilter.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(e){this._repeatEdgePixels=e,this.updatePadding()},enumerable:!1,configurable:!0}),t}(ce.k),Km=function(i,t){return(Km=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},sc=function(i){function t(){var e=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=i.call(this,ce.z,`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,n)||this).alpha=1,e}return function(e,n){function r(){this.constructor=e}Km(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype._loadMatrix=function(e,n){n===void 0&&(n=!1);var r=e;n&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r},t.prototype._multiply=function(e,n,r){return e[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],e[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],e[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],e[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],e[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],e[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],e[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],e[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],e[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],e[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],e[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],e[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],e[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],e[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],e[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],e[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],e[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],e[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],e[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],e[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],e},t.prototype._colorMatrix=function(e){var n=new Float32Array(e);return n[4]/=255,n[9]/=255,n[14]/=255,n[19]/=255,n},t.prototype.brightness=function(e,n){var r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.tint=function(e,n){var r=[(e>>16&255)/255,0,0,0,0,0,(e>>8&255)/255,0,0,0,0,0,(255&e)/255,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.greyscale=function(e,n){var r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.blackAndWhite=function(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)},t.prototype.hue=function(e,n){e=(e||0)/180*Math.PI;var r=Math.cos(e),o=Math.sin(e),s=1/3,a=(0,Math.sqrt)(s),l=[r+(1-r)*s,s*(1-r)-a*o,s*(1-r)+a*o,0,0,s*(1-r)+a*o,r+s*(1-r),s*(1-r)-a*o,0,0,s*(1-r)-a*o,s*(1-r)+a*o,r+s*(1-r),0,0,0,0,0,1,0];this._loadMatrix(l,n)},t.prototype.contrast=function(e,n){var r=(e||0)+1,o=-.5*(r-1),s=[r,0,0,0,o,0,r,0,0,o,0,0,r,0,o,0,0,0,1,0];this._loadMatrix(s,n)},t.prototype.saturate=function(e,n){e===void 0&&(e=0);var r=2*e/3+1,o=-.5*(r-1),s=[r,o,o,0,0,o,r,o,0,0,o,o,r,0,0,0,0,0,1,0];this._loadMatrix(s,n)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)},t.prototype.sepia=function(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)},t.prototype.technicolor=function(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)},t.prototype.polaroid=function(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)},t.prototype.toBGR=function(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)},t.prototype.kodachrome=function(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)},t.prototype.browni=function(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)},t.prototype.vintage=function(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)},t.prototype.colorTone=function(e,n,r,o,s){var a=((r=r||16770432)>>16&255)/255,l=(r>>8&255)/255,h=(255&r)/255,u=((o=o||3375104)>>16&255)/255,p=(o>>8&255)/255,y=(255&o)/255,x=[.3,.59,.11,0,0,a,l,h,e=e||.2,0,u,p,y,n=n||.15,0,a-u,l-p,h-y,0,0];this._loadMatrix(x,s)},t.prototype.night=function(e,n){var r=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.predator=function(e,n){var r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.lsd=function(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)},t.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(t.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(ce.k);sc.prototype.grayscale=sc.prototype.greyscale;/*!
 * @pixi/filter-displacement - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Zm=function(i,t){return(Zm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},dT=function(i){function t(e,n){var r=this,o=new De.d;return e.renderable=!1,(r=i.call(this,`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`,`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,{mapSampler:e._texture,filterMatrix:o,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,r.maskMatrix=o,n==null&&(n=20),r.scale=new De.g(n,n),r}return function(e,n){function r(){this.constructor=e}Zm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.apply=function(e,n,r,o){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var s=this.maskSprite.worldTransform,a=Math.sqrt(s.a*s.a+s.b*s.b),l=Math.sqrt(s.c*s.c+s.d*s.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=s.a/a,this.uniforms.rotation[1]=s.b/a,this.uniforms.rotation[2]=s.c/l,this.uniforms.rotation[3]=s.d/l),e.applyFilter(this,n,r,o)},Object.defineProperty(t.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e},enumerable:!1,configurable:!0}),t}(ce.k),Qm=function(i,t){return(Qm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},pT=function(i){function t(){return i.call(this,`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`)||this}return function(e,n){function r(){this.constructor=e}Qm(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t}(ce.k),$m=function(i,t){return($m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)},tg,eg,ng,ig,rg,og,sg,ag,lg,hg,ug,cg,dg,pg,fg,mg,gg,ac,vg,fT=function(i){function t(e,n){e===void 0&&(e=.5),n===void 0&&(n=Math.random());var r=i.call(this,ce.z,`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`,{uNoise:0,uSeed:0})||this;return r.noise=e,r.seed=n,r}return function(e,n){function r(){this.constructor=e}$m(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),Object.defineProperty(t.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e},enumerable:!1,configurable:!0}),t}(ce.k);(function(i){i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2"})(tg||(tg={})),function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS"}(eg||(eg={})),function(i){i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL"}(ng||(ng={})),function(i){i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR"}(ig||(ig={})),function(i){i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(rg||(rg={})),function(i){i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(og||(og={})),function(i){i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(sg||(sg={})),function(i){i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT"}(ag||(ag={})),function(i){i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT"}(lg||(lg={})),function(i){i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR"}(hg||(hg={})),function(i){i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(ug||(ug={})),function(i){i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL"}(cg||(cg={})),function(i){i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(dg||(dg={})),function(i){i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT"}(pg||(pg={})),function(i){i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL"}(fg||(fg={})),function(i){i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp"}(mg||(mg={})),function(i){i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE"}(gg||(gg={})),function(i){i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH"}(ac||(ac={})),function(i){i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(vg||(vg={}));var _g=new De.d;Cn.c.prototype._cacheAsBitmap=!1,Cn.c.prototype._cacheData=null,Cn.c.prototype._cacheAsBitmapResolution=null,Cn.c.prototype._cacheAsBitmapMultisample=ac.NONE;var mT=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(Cn.c.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(i){i!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(i){i!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(i){var t;this._cacheAsBitmap!==i&&(this._cacheAsBitmap=i,i?(this._cacheData||(this._cacheData=new mT),(t=this._cacheData).originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((t=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea))}}}),Cn.c.prototype._renderCached=function(i){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(i),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(i))},Cn.c.prototype._initCachedDisplayObject=function(i){var t;if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,i.batch.flush();var n=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var r=this.filters[0].padding;n.pad(r)}n.ceil(br.b.RESOLUTION);var o=i.renderTexture.current,s=i.renderTexture.sourceFrame.clone(),a=i.renderTexture.destinationFrame.clone(),l=i.projection.transform,h=ce.p.create({width:n.width,height:n.height,resolution:this.cacheAsBitmapResolution||i.resolution,multisample:(t=this.cacheAsBitmapMultisample)!==null&&t!==void 0?t:i.multisample}),u="cacheAsBitmap_"+Object(xn.uid)();this._cacheData.textureCacheId=u,ce.c.addToCache(h.baseTexture,u),ce.t.addToCache(h,u);var p=this.transform.localTransform.copyTo(_g).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,i.render(this,{renderTexture:h,clear:!0,transform:p,skipUpdateTransform:!1}),i.framebuffer.blit(),i.projection.transform=l,i.renderTexture.bind(o,s,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;var y=new pi(h);y.transform.worldTransform=this.transform.worldTransform,y.anchor.x=-n.x/n.width,y.anchor.y=-n.y/n.height,y.alpha=e,y._bounds=this._bounds,this._cacheData.sprite=y,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=y.containsPoint.bind(y)}},Cn.c.prototype._renderCachedCanvas=function(i){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(i),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(i))},Cn.c.prototype._initCachedDisplayObjectCanvas=function(i){if(!this._cacheData||!this._cacheData.sprite){var t=this.getLocalBounds(null,!0),e=this.alpha;this.alpha=1;var n=i.context,r=i._projTransform;t.ceil(br.b.RESOLUTION);var o=ce.p.create({width:t.width,height:t.height}),s="cacheAsBitmap_"+Object(xn.uid)();this._cacheData.textureCacheId=s,ce.c.addToCache(o.baseTexture,s),ce.t.addToCache(o,s);var a=_g;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=t.x,a.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,i.render(this,{renderTexture:o,clear:!0,transform:a,skipUpdateTransform:!1}),i.context=n,i._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;var l=new pi(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-t.x/t.width,l.anchor.y=-t.y/t.height,l.alpha=e,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=i._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},Cn.c.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},Cn.c.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},Cn.c.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ce.c.removeFromCache(this._cacheData.textureCacheId),ce.t.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},Cn.c.prototype._cacheAsBitmapDestroy=function(i){this.cacheAsBitmap=!1,this.destroy(i)},Cn.c.prototype.name=null,Cn.b.prototype.getChildByName=function(i,t){for(var e=0,n=this.children.length;e<n;e++)if(this.children[e].name===i)return this.children[e];if(t){for(e=0,n=this.children.length;e<n;e++)if(this.children[e].getChildByName){var r=this.children[e].getChildByName(i,!0);if(r)return r}}return null},Cn.c.prototype.getGlobalPosition=function(i,t){return i===void 0&&(i=new De.g),t===void 0&&(t=!1),this.parent?this.parent.toGlobal(this.position,i,t):(i.x=this.position.x,i.y=this.position.y),i};var gT=v(16),yg=(v(12),function(i,t){return(yg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)}),lc=function(i){function t(e,n){n===void 0&&(n=!0);var r=i.call(this,e[0]instanceof ce.t?e[0]:e[0].texture)||this;return r._textures=null,r._durations=null,r._autoUpdate=n,r._isConnectedToTicker=!1,r.animationSpeed=1,r.loop=!0,r.updateAnchor=!1,r.onComplete=null,r.onFrameChange=null,r.onLoop=null,r._currentTime=0,r._playing=!1,r._previousFrame=null,r.textures=e,r}return function(e,n){function r(){this.constructor=e}yg(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(tr.a.shared.remove(this.update,this),this._isConnectedToTicker=!1))},t.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(tr.a.shared.add(this.update,this,tr.c.HIGH),this._isConnectedToTicker=!0))},t.prototype.gotoAndStop=function(e){this.stop();var n=this.currentFrame;this._currentTime=e,n!==this.currentFrame&&this.updateTexture()},t.prototype.gotoAndPlay=function(e){var n=this.currentFrame;this._currentTime=e,n!==this.currentFrame&&this.updateTexture(),this.play()},t.prototype.update=function(e){if(this._playing){var n=this.animationSpeed*e,r=this.currentFrame;if(this._durations!==null){var o=this._currentTime%1*this._durations[this.currentFrame];for(o+=n/60*1e3;o<0;)this._currentTime--,o+=this._durations[this.currentFrame];var s=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);o>=this._durations[this.currentFrame];)o-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=o/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}},t.prototype.updateTexture=function(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},t.prototype.destroy=function(e){this.stop(),i.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},t.fromFrames=function(e){for(var n=[],r=0;r<e.length;++r)n.push(ce.t.from(e[r]));return new t(n)},t.fromImages=function(e){for(var n=[],r=0;r<e.length;++r)n.push(ce.t.from(e[r]));return new t(n)},Object.defineProperty(t.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textures",{get:function(){return this._textures},set:function(e){if(e[0]instanceof ce.t)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var n=0;n<e.length;n++)this._textures.push(e[n].texture),this._durations.push(e[n].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFrame",{get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(tr.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(tr.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),t}(pi);/*!
 * pixi.js - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ce.q.registerPlugin("accessibility",Qp),ce.q.registerPlugin("extract",qb),ce.q.registerPlugin("interaction",ef),ce.q.registerPlugin("particle",R1),ce.q.registerPlugin("prepare",Q1),ce.q.registerPlugin("batch",ce.f),ce.q.registerPlugin("tilingSprite",eT),Zr.registerPlugin(aT),Zr.registerPlugin(e1),Zr.registerPlugin(p1),Zr.registerPlugin(M1),Zr.registerPlugin($1),jl.registerPlugin(tr.b),jl.registerPlugin(Qb);var hc,Xs={AlphaFilter:lT,BlurFilter:cT,BlurFilterPass:oc,ColorMatrixFilter:sc,DisplacementFilter:dT,FXAAFilter:pT,NoiseFilter:fT},jr=v(10),vT=v(34),xg=function(){function i(){}return i.offsetPolygon=function(t,e){var n=[],r=t.length;e=i.isPolygonClockwise(t)?e:-1*e;for(var o=0;o<r;o+=2){var s=o-2;s<0&&(s+=r);var a=(o+2)%r,l=t[o]-t[s],h=t[o+1]-t[s+1],u=Math.sqrt(l*l+h*h);l/=u,h/=u;var p=-(h*=e),y=l*=e,x=[t[s]+p,t[s+1]+y],E=[t[o]+p,t[o+1]+y],w=t[a]-t[o],C=t[a+1]-t[o+1];w/=u=Math.sqrt(w*w+C*C),C/=u;var j=-(C*=e),Z=w*=e,rt=[t[o]+j,t[o+1]+Z],ct=[t[a]+j,t[a+1]+Z],nt=i.findIntersection(x[0],x[1],E[0],E[1],rt[0],rt[1],ct[0],ct[1]);nt&&n.push.apply(n,nt)}return n},i.findIntersection=function(t,e,n,r,o,s,a,l){var h=(l-s)*(n-t)-(a-o)*(r-e),u=(a-o)*(e-s)-(l-s)*(t-o);if(h===0)return u===0&&(n-t)*(e-s)-(r-e)*(t-o)===0?[(t+n)/2,(e+r)/2]:null;var p=u/h;return[t+p*(n-t),e+p*(r-e)]},i.isPolygonClockwise=function(t){for(var e=0,n=0,r=t.length-2;n<t.length;r=n,n+=2)e+=(t[n]-t[r])*(t[n+1]+t[r+1]);return e>0},i}(),_T=function(){function i(t){this._svgMatrix=null,this._tempMatrix=new De.d,this.renderer=t}return i.prototype._calcCanvasStyle=function(t,e){var n;return t.texture&&t.texture.baseTexture!==ce.t.WHITE.baseTexture?t.texture.valid?(n=jr.b.getTintedPattern(t.texture,e),this.setPatternTransform(n,t.matrix||De.d.IDENTITY)):n="#808080":n="#"+("00000"+(0|e).toString(16)).slice(-6),n},i.prototype.render=function(t){var e=this.renderer,n=e.context,r=t.worldAlpha,o=t.transform.worldTransform;e.setContextTransform(o),e.setBlendMode(t.blendMode);for(var s,a,l=t.geometry.graphicsData,h=(t.tint>>16&255)/255,u=(t.tint>>8&255)/255,p=(255&t.tint)/255,y=0;y<l.length;y++){var x=l[y],E=x.shape,w=x.fillStyle,C=x.lineStyle,j=0|x.fillStyle.color,Z=0|x.lineStyle.color;if(x.matrix&&e.setContextTransform(o.copyTo(this._tempMatrix).append(x.matrix)),w.visible){var rt=((j>>16&255)/255*h*255<<16)+((j>>8&255)/255*u*255<<8)+(255&j)/255*p*255;s=this._calcCanvasStyle(w,rt)}if(C.visible){var ct=((Z>>16&255)/255*h*255<<16)+((Z>>8&255)/255*u*255<<8)+(255&Z)/255*p*255;a=this._calcCanvasStyle(C,ct)}if(n.lineWidth=C.width,n.lineCap=C.cap,n.lineJoin=C.join,n.miterLimit=C.miterLimit,x.type===De.l.POLY){n.beginPath();var nt=(Nt=E).points,vt=x.holes,ht=void 0,mt=void 0,jt=void 0,Ft=void 0,Mt=void 0;n.moveTo(nt[0],nt[1]);for(var wt=2;wt<nt.length;wt+=2)n.lineTo(nt[wt],nt[wt+1]);if(Nt.closeStroke&&n.closePath(),vt.length>0){for(Mt=[],ht=0,jt=nt[0],Ft=nt[1],wt=2;wt+2<nt.length;wt+=2)ht+=(nt[wt]-jt)*(nt[wt+3]-Ft)-(nt[wt+2]-jt)*(nt[wt+1]-Ft);for(var Pt=0;Pt<vt.length;Pt++)if(nt=vt[Pt].shape.points){for(mt=0,jt=nt[0],Ft=nt[1],wt=2;wt+2<nt.length;wt+=2)mt+=(nt[wt]-jt)*(nt[wt+3]-Ft)-(nt[wt+2]-jt)*(nt[wt+1]-Ft);if(mt*ht<0)for(n.moveTo(nt[0],nt[1]),wt=2;wt<nt.length;wt+=2)n.lineTo(nt[wt],nt[wt+1]);else for(n.moveTo(nt[nt.length-2],nt[nt.length-1]),wt=nt.length-4;wt>=0;wt-=2)n.lineTo(nt[wt],nt[wt+1]);vt[Pt].shape.closeStroke&&n.closePath(),Mt[Pt]=mt*ht<0}}w.visible&&(n.globalAlpha=w.alpha*r,n.fillStyle=s,n.fill()),C.visible&&this.paintPolygonStroke(Nt,C,a,vt,Mt,r,n)}else if(x.type===De.l.RECT){var Nt=E;if(w.visible&&(n.globalAlpha=w.alpha*r,n.fillStyle=s,n.fillRect(Nt.x,Nt.y,Nt.width,Nt.height)),C.visible){var ne=C.width*(.5-(1-C.alignment)),$t=Nt.width+2*ne,zt=Nt.height+2*ne;n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.strokeRect(Nt.x-ne,Nt.y-ne,$t,zt)}}else if(x.type===De.l.CIRC)Nt=E,n.beginPath(),n.arc(Nt.x,Nt.y,Nt.radius,0,2*Math.PI),n.closePath(),w.visible&&(n.globalAlpha=w.alpha*r,n.fillStyle=s,n.fill()),C.visible&&(C.alignment!==.5&&(ne=C.width*(.5-(1-C.alignment)),n.beginPath(),n.arc(Nt.x,Nt.y,Nt.radius+ne,0,2*Math.PI),n.closePath()),n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.stroke());else if(x.type===De.l.ELIP){if(Nt=E,(Le=C.alignment===1)||this.paintEllipse(Nt,w,C,s,r,n),C.visible){if(C.alignment!==.5){ne=C.width*(.5-(1-C.alignment));var Yt=2*(Nt.width+ne),ge=2*(Nt.height+ne),be=Nt.x-Yt/2,Pe=Nt.y-ge/2,Ct=Yt/2*.5522848,Bt=ge/2*.5522848,ve=be+Yt,le=Pe+ge,se=be+Yt/2,Ie=Pe+ge/2;n.beginPath(),n.moveTo(be,Ie),n.bezierCurveTo(be,Ie-Bt,se-Ct,Pe,se,Pe),n.bezierCurveTo(se+Ct,Pe,ve,Ie-Bt,ve,Ie),n.bezierCurveTo(ve,Ie+Bt,se+Ct,le,se,le),n.bezierCurveTo(se-Ct,le,be,Ie+Bt,be,Ie),n.closePath()}n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.stroke()}Le&&this.paintEllipse(Nt,w,C,s,r,n)}else if(x.type===De.l.RREC){var Le;if(Nt=E,(Le=C.alignment===1)||this.paintRoundedRectangle(Nt,w,C,s,r,n),C.visible){if(C.alignment!==.5){$t=Nt.width,zt=Nt.height,ne=C.width*(.5-(1-C.alignment));var ue=Nt.x-ne,bt=Nt.y-ne,Ht=Nt.width+2*ne,ie=Nt.height+2*ne,ae=ne*(C.alignment>=1?Math.min(Ht/$t,ie/zt):Math.min($t/Ht,zt/ie)),qt=Nt.radius+ae,ye=Math.min(Ht,ie)/2;qt=qt>ye?ye:qt,n.beginPath(),n.moveTo(ue,bt+qt),n.lineTo(ue,bt+ie-qt),n.quadraticCurveTo(ue,bt+ie,ue+qt,bt+ie),n.lineTo(ue+Ht-qt,bt+ie),n.quadraticCurveTo(ue+Ht,bt+ie,ue+Ht,bt+ie-qt),n.lineTo(ue+Ht,bt+qt),n.quadraticCurveTo(ue+Ht,bt,ue+Ht-qt,bt),n.lineTo(ue+qt,bt),n.quadraticCurveTo(ue,bt,ue,bt+qt),n.closePath()}n.globalAlpha=C.alpha*r,n.strokeStyle=a,n.stroke()}Le&&this.paintRoundedRectangle(Nt,w,C,s,r,n)}}},i.prototype.paintPolygonStroke=function(t,e,n,r,o,s,a){if(e.alignment!==.5){var l=e.width*(.5-(1-e.alignment)),h=xg.offsetPolygon(t.points,l),u=void 0;a.beginPath(),a.moveTo(h[0],h[1]);for(var p=2;p<h.length;p+=2)a.lineTo(h[p],h[p+1]);t.closeStroke&&a.closePath();for(var y=0;y<r.length;y++){if(u=r[y].shape.points,h=xg.offsetPolygon(u,l),o[y])for(a.moveTo(h[0],h[1]),p=2;p<h.length;p+=2)a.lineTo(h[p],h[p+1]);else for(a.moveTo(h[h.length-2],h[h.length-1]),p=h.length-4;p>=0;p-=2)a.lineTo(h[p],h[p+1]);r[y].shape.closeStroke&&a.closePath()}}a.globalAlpha=e.alpha*s,a.strokeStyle=n,a.stroke()},i.prototype.paintEllipse=function(t,e,n,r,o,s){var a=2*t.width,l=2*t.height,h=t.x-a/2,u=t.y-l/2,p=a/2*.5522848,y=l/2*.5522848,x=h+a,E=u+l,w=h+a/2,C=u+l/2;n.alignment===0&&s.save(),s.beginPath(),s.moveTo(h,C),s.bezierCurveTo(h,C-y,w-p,u,w,u),s.bezierCurveTo(w+p,u,x,C-y,x,C),s.bezierCurveTo(x,C+y,w+p,E,w,E),s.bezierCurveTo(w-p,E,h,C+y,h,C),s.closePath(),n.alignment===0&&s.clip(),e.visible&&(s.globalAlpha=e.alpha*o,s.fillStyle=r,s.fill()),n.alignment===0&&s.restore()},i.prototype.paintRoundedRectangle=function(t,e,n,r,o,s){var a=t.x,l=t.y,h=t.width,u=t.height,p=t.radius,y=Math.min(h,u)/2;p=p>y?y:p,n.alignment===0&&s.save(),s.beginPath(),s.moveTo(a,l+p),s.lineTo(a,l+u-p),s.quadraticCurveTo(a,l+u,a+p,l+u),s.lineTo(a+h-p,l+u),s.quadraticCurveTo(a+h,l+u,a+h,l+u-p),s.lineTo(a+h,l+p),s.quadraticCurveTo(a+h,l,a+h-p,l),s.lineTo(a+p,l),s.quadraticCurveTo(a,l,a,l+p),s.closePath(),n.alignment===0&&s.clip(),e.visible&&(s.globalAlpha=e.alpha*o,s.fillStyle=r,s.fill()),n.alignment===0&&s.restore()},i.prototype.setPatternTransform=function(t,e){if(this._svgMatrix!==!1){if(!this._svgMatrix){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");if(n&&n.createSVGMatrix&&(this._svgMatrix=n.createSVGMatrix()),!this._svgMatrix||!t.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=e.a,this._svgMatrix.b=e.b,this._svgMatrix.c=e.c,this._svgMatrix.d=e.d,this._svgMatrix.e=e.tx,this._svgMatrix.f=e.ty,t.setTransform(this._svgMatrix.inverse())}},i.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},i}(),Ua=new De.d;er.prototype.generateCanvasTexture=function(i,t){t===void 0&&(t=1);var e=this.getLocalBounds(),n=ce.p.create({width:e.width,height:e.height,scaleMode:i,resolution:t});hc||(hc=new jr.a),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(Ua),Ua.invert(),Ua.tx-=e.x,Ua.ty-=e.y,hc.render(this,{renderTexture:n,clear:!0,transform:Ua});var r=ce.t.from(n.baseTexture._canvasRenderTarget.canvas,{scaleMode:i});return r.baseTexture.setResolution(t),r},er.prototype.cachedGraphicsData=[],er.prototype._renderCanvas=function(i){this.isMask!==!0&&(this.finishPoly(),i.plugins.graphics.render(this))};/*!
 * @pixi/canvas-sprite - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/canvas-sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var bg=new De.d,yT=function(){function i(t){this.renderer=t}return i.prototype.render=function(t){var e=t._texture,n=this.renderer,r=n.context;if(e.valid){var o=e._frame.width,s=e._frame.height,a=t.transform.worldTransform,l=0,h=0,u=e.baseTexture.getDrawableSource();if(!(e.orig.width<=0||e.orig.height<=0)&&e.valid&&u){n.setBlendMode(t.blendMode,!0),n.context.globalAlpha=t.worldAlpha;var p=e.baseTexture.scaleMode===gn.p.LINEAR;n.smoothProperty&&n.context[n.smoothProperty]!==p&&(r[n.smoothProperty]=p),e.trim?(l=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,h=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(l=(.5-t.anchor.x)*e.orig.width,h=(.5-t.anchor.y)*e.orig.height),e.rotate&&(a.copyTo(bg),a=bg,De.n.matrixAppendRotationInv(a,e.rotate,l,h),l=0,h=0),l-=o/2,h-=s/2,n.setContextTransform(a,t.roundPixels,1),t.roundPixels&&(l|=0,h|=0);var y=e.baseTexture.resolution,x=n._outerBlend;x&&(r.save(),r.beginPath(),r.rect(l*n.resolution,h*n.resolution,o*n.resolution,s*n.resolution),r.clip()),t.tint!==16777215?(t._cachedTint===t.tint&&t._tintedCanvas.tintId===t._texture._updateID||(t._cachedTint=t.tint,t._tintedCanvas=jr.b.getTintedCanvas(t,t.tint)),r.drawImage(t._tintedCanvas,0,0,Math.floor(o*y),Math.floor(s*y),Math.floor(l*n.resolution),Math.floor(h*n.resolution),Math.floor(o*n.resolution),Math.floor(s*n.resolution))):r.drawImage(u,e._frame.x*y,e._frame.y*y,Math.floor(o*y),Math.floor(s*y),Math.floor(l*n.resolution),Math.floor(h*n.resolution),Math.floor(o*n.resolution),Math.floor(s*n.resolution)),x&&r.restore(),n.setBlendMode(gn.b.NORMAL)}}},i.prototype.destroy=function(){this.renderer=null},i}();pi.prototype._tintedCanvas=null,pi.prototype._renderCanvas=function(i){i.plugins.sprite.render(this)};/*!
 * @pixi/canvas-extract - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/canvas-extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Tg=new De.j,xT=function(){function i(t){this.renderer=t}return i.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},i.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},i.prototype.canvas=function(t){var e,n,r,o,s=this.renderer;t&&(o=t instanceof ce.p?t:s.generateTexture(t)),o?(e=o.baseTexture._canvasRenderTarget.context,n=o.baseTexture._canvasRenderTarget.resolution,r=o.frame):(e=s.rootContext,n=s.resolution,(r=Tg).width=this.renderer.width,r.height=this.renderer.height);var a=Math.floor(r.width*n+1e-4),l=Math.floor(r.height*n+1e-4),h=new xn.CanvasRenderTarget(a,l,1),u=e.getImageData(r.x*n,r.y*n,a,l);return h.context.putImageData(u,0,0),h.canvas},i.prototype.pixels=function(t){var e,n,r,o,s=this.renderer;t&&(o=t instanceof ce.p?t:s.generateTexture(t)),o?(e=o.baseTexture._canvasRenderTarget.context,n=o.baseTexture._canvasRenderTarget.resolution,r=o.frame):(e=s.rootContext,n=s.resolution,(r=Tg).width=s.width,r.height=s.height);var a=r.x*n,l=r.y*n,h=r.width*n,u=r.height*n;return e.getImageData(a,l,h,u).data},i.prototype.destroy=function(){this.renderer=null},i}(),Eg=function(i,t){return(Eg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])})(i,t)};function bT(i,t){var e=i;if(t instanceof ce.c){var n=t.source,r=n.width===0?e.canvas.width:Math.min(e.canvas.width,n.width),o=n.height===0?e.canvas.height:Math.min(e.canvas.height,n.height);return e.ctx.drawImage(n,0,0,r,o,0,0,e.canvas.width,e.canvas.height),!0}return!1}var nr,TT=function(i){function t(e){var n=i.call(this,e)||this;return n.uploadHookHelper=n,n.canvas=document.createElement("canvas"),n.canvas.width=16,n.canvas.height=16,n.ctx=n.canvas.getContext("2d"),n.registerUploadHook(bT),n}return function(e,n){function r(){this.constructor=e}Eg(e,n),e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(t,i),t.prototype.destroy=function(){i.prototype.destroy.call(this),this.ctx=null,this.canvas=null},t}(ym),eh=new De.d,ka=new De.d,to=[new De.g,new De.g,new De.g,new De.g];/*!
 * @pixi/canvas-sprite-tiling - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/canvas-sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */tT.prototype._renderCanvas=function(i){var t=this._texture;if(t.baseTexture.valid){var e=i.context,n=this.worldTransform,r=t.baseTexture,o=r.getDrawableSource(),s=r.resolution;if(this._textureID!==this._texture._updateID||this._cachedTint!==this.tint){this._textureID=this._texture._updateID;var a=new xn.CanvasRenderTarget(t._frame.width,t._frame.height,s);this.tint!==16777215?(this._tintedCanvas=jr.b.getTintedCanvas(this,this.tint),a.context.drawImage(this._tintedCanvas,0,0)):a.context.drawImage(o,-t._frame.x*s,-t._frame.y*s),this._cachedTint=this.tint,this._canvasPattern=a.context.createPattern(a.canvas,"repeat")}e.globalAlpha=this.worldAlpha,i.setBlendMode(this.blendMode),this.tileTransform.updateLocalTransform();var l=this.tileTransform.localTransform,h=this._width,u=this._height;eh.identity(),ka.copyFrom(l),this.uvRespectAnchor||ka.translate(-this.anchor.x*h,-this.anchor.y*u),ka.scale(this.tileScale.x/s,this.tileScale.y/s),eh.prepend(ka),eh.prepend(n),i.setContextTransform(eh),e.fillStyle=this._canvasPattern;var p=this.anchor.x*-h,y=this.anchor.y*-u;to[0].set(p,y),to[1].set(p+h,y),to[2].set(p+h,y+u),to[3].set(p,y+u);for(var x=0;x<4;x++)ka.applyInverse(to[x],to[x]);for(e.beginPath(),e.moveTo(to[0].x,to[0].y),x=1;x<4;x++)e.lineTo(to[x].x,to[x].y);e.closePath(),e.fill()}},C1.prototype.renderCanvas=function(i){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var t=i.context,e=this.worldTransform,n=!0,r=0,o=0,s=0,a=0;i.setBlendMode(this.blendMode),t.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var l=0;l<this.children.length;++l){var h=this.children[l];if(h.visible&&h._texture.valid){var u=h._texture.frame;if(t.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)==0)n&&(i.setContextTransform(e,!1,1),n=!1),r=h.anchor.x*(-u.width*h.scale.x)+h.position.x+.5,o=h.anchor.y*(-u.height*h.scale.y)+h.position.y+.5,s=u.width*h.scale.x,a=u.height*h.scale.y;else{n||(n=!0),h.displayObjectUpdateTransform();var p=h.worldTransform;i.setContextTransform(p,this.roundPixels,1),r=h.anchor.x*-u.width+.5,o=h.anchor.y*-u.height+.5,s=u.width,a=u.height}var y=h._texture.baseTexture.resolution;t.drawImage(h._texture.baseTexture.getDrawableSource(),u.x*y,u.y*y,u.width*y,u.height*y,r*i.resolution,o*i.resolution,s*i.resolution,a*i.resolution)}}}},Cn.b.prototype._renderCanvas=function(i){},Cn.b.prototype.renderCanvas=function(i){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&i.maskManager.pushMask(this._mask),this._renderCanvas(i);for(var t=0,e=this.children.length;t<e;++t)this.children[t].renderCanvas(i);this._mask&&i.maskManager.popMask(i)}},Cn.c.prototype.renderCanvas=function(i){},nc.prototype._renderCanvas=function(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),pi.prototype._renderCanvas.call(this,i)},jr.a.registerPlugin("accessibility",Qp),jr.a.registerPlugin("extract",xT),jr.a.registerPlugin("graphics",_T),jr.a.registerPlugin("interaction",ef),jr.a.registerPlugin("mesh",vT.a),jr.a.registerPlugin("prepare",TT),jr.a.registerPlugin("sprite",yT);class ET extends xi.a{constructor(){super(),this.prevTime=-1,this.times=0,this.valueTotal=0,this.destroyed=!1,this.value=0,this.calcFps()}calcFps(){requestAnimationFrame(t=>{const e=t-this.prevTime;this.valueTotal+=e,this.times+=1,this.times>20&&(this.value=Math.floor(1e3*this.times/this.valueTotal),this.valueTotal=0,this.times=0,this.destroyed||this.emit("update",this.value)),this.prevTime=t,this.destroyed||this.calcFps()})}destroy(){this.destroyed=!0}}(function(i){i.ResourceError="RESOURCE_ERROR",i.RuntimeError="RUNTIME_ERROR",i.RuntimeWarn="RUNTIME_WARN",i.CanvasCrash="CANVAS_CRASH"})(nr||(nr={}));class Ai extends Error{constructor(t,e){var n,r;super(e),n=this,r=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(n,r):n.__proto__&&(n.__proto__=r),this.errorType=t,this.errorMsg=e}static transform(t){return t instanceof Ai?t:new Ai(nr.RuntimeError,t.message)}}function nh(){return function(i,t,e){const n=e.value;e.value=function(...r){try{return n.apply(this,r)}catch(o){throw new Ai(nr.RuntimeWarn,o.message)}}}}var ST=v(48),Sg=v.n(ST),wg=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function cs(){return M()}const fo="__delay_resolve_result__";function Ag(i){return new Promise(t=>{setTimeout(()=>{t(fo)},i)})}function Ys(i,t){return wg(this,void 0,void 0,function*(){const e=yield Promise.race([i(),Ag(t)]);return e===fo?fo:e})}function ih(i,t){return wg(this,void 0,void 0,function*(){const e=Date.now();for(;!i()&&Date.now()-e<t;)yield Ag(16)})}var uc=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function Mg(i,t){return uc(this,void 0,void 0,function*(){const e=yield Ys(()=>fetch(i),t);if(e===fo)throw new Ai(nr.ResourceError,`"${i}" loaded timeout"`);if(!e.ok)throw new Ai(nr.ResourceError,`"${i}" loaded failed with status "${e.status}"`);return e})}class wT{constructor(t,e,n,r,o,s,a){this.timeout=15e3,this.useCache=!1,this.taskId="",this.delegate=null,this.urlInterrupter=null,this.useCache=e,this.localStorage=t,this.logger=n,this.tracker=r,this.timeout=o,this.delegate=s||null,this.urlInterrupter=a||null}attachTaskId(t){this.taskId=t}fetchJson(t){return uc(this,void 0,void 0,function*(){const e=Date.now();let n=t;const r=t;if(this.urlInterrupter&&typeof this.urlInterrupter=="function"){const s=Date.now();n=yield this.urlInterrupter(n),this.logger.info("use url interrupter, time: "+(Date.now()-s),this.taskId)}let o;if(this.useCache&&(this.logger.info("load resource from cache. "+r,this.taskId||""),o=yield this.localStorage.getItem(r)),o)return this.logger.info("cache hit. "+r,this.taskId||""),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"cache"}}),o;{let s;if(this.delegate){this.logger.info("load resource by delegate. "+r,this.taskId||"");const a=Date.now();try{const l=yield Ys(()=>this.delegate.loadJson(n),this.timeout);if(this.logger.info(`load resource by delegate end. ${r}, time: ${Date.now()-a}`,this.taskId||""),l===fo)throw new Ai(nr.ResourceError,`"${r}" loaded timeout"`);s=JSON.parse(l),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"delegate"}})}catch(l){this.tracker({name:"slideResourceLoad",result:"fail",reason:l+"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"delegate"}})}}else{this.logger.info("load resource from server. "+r,this.taskId||"");const a=Date.now();try{s=yield(yield Mg(""+n,this.timeout)).json()}catch(l){throw this.tracker({name:"slideResourceLoad",result:"fail",reason:l+"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"fetch"}}),l}this.logger.info(`load resource from server end. ${r}, time: ${Date.now()-a}`,this.taskId||""),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-e,url:n,type:"json",channel:"fetch"}})}return this.logger.info("load end. "+r,this.taskId||""),this.useCache&&this.localStorage.setItem(r,s).catch(()=>{}),s}})}fetchPng(t,e){return uc(this,void 0,void 0,function*(){const n=Date.now();let r=t;const o=t;if(this.urlInterrupter&&typeof this.urlInterrupter=="function"){const l=Date.now();r=yield this.urlInterrupter(r),this.logger.info("use url interrupter, time: "+(Date.now()-l),this.taskId)}let s;const a=o+"-v2";if(this.useCache&&(this.logger.info("load resource from cache. "+o,this.taskId||""),s=yield this.localStorage.getItem(a)),s){const{scale:l,scaledBase64:h}=s;this.logger.info("cache hit. "+o,this.taskId||"");const u=new ce.c(h,{resolution:1});return this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"cache"}}),{baseTexture:u,scale:l}}{let l;if(this.delegate)try{this.logger.info("load resource by delegate. "+o,this.taskId||"");const ct=Date.now();if(l=yield Ys(()=>this.delegate.loadImage(r),this.timeout),this.logger.info(`load resource by delegate end. ${o}, time: ${Date.now()-ct}`,this.taskId||""),l===fo)throw new Ai(nr.ResourceError,`"${o}" loaded timeout"`);this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"delegate"}})}catch(ct){this.tracker({name:"slideResourceLoad",result:"fail",reason:ct+"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"delegate"}})}else try{this.logger.info("load resource from server. "+o,this.taskId||"");const ct=Date.now(),nt=yield Mg(r,this.timeout);this.logger.info(`load resource from server end. ${o}, time: ${Date.now()-ct}`,this.taskId||""),l=yield nt.blob(),this.tracker({name:"slideResourceLoad",result:"success",reason:"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"fetch"}})}catch(ct){this.tracker({name:"slideResourceLoad",result:"fail",reason:ct+"",payload:{duration:Date.now()-n,url:r,type:"image",channel:"fetch"}})}s=yield function(ct){return new Promise((nt,vt)=>{const ht=new FileReader;ht.onload=()=>{nt(ht.result)},ht.onerror=()=>{vt(new Ai(nr.ResourceError,"Failed parse blob data."))},ht.readAsDataURL(ct)})}(l);const h=document.createElement("img");h.src=s,yield new Promise((ct,nt)=>{h.onload=()=>ct(""),h.onerror=()=>nt(new Error("load sprite image failed"))});let u=e;const p=h.width||1,y=h.height||1,x=2048,E=2048;if(p>x||y>E){u*=x/p;const ct=u*y;ct>E&&(u*=y/ct)}const w=document.createElement("canvas"),C=Math.ceil(h.width*u),j=Math.ceil(h.height*u);w.width=C,w.height=j,w.getContext("2d").drawImage(h,0,0,C,j);const Z=w.toDataURL("image/png"),rt=new ce.c(Z,{resolution:1});return this.logger.info("load end. "+o,this.taskId||""),this.useCache&&this.localStorage.setItem(a,{scale:u,scaledBase64:Z}).catch(()=>{}),{baseTexture:rt,scale:u}}})}destroy(){}}var AT=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class MT{constructor(t){this.isPaused=!1,this.timestamp=0,this.callbackList=[],this.onTimeUpdate=e=>{const n=e/(br.b.TARGET_FPMS||.06);if(!this.isPaused){this.timestamp+=n,this.callbackList=this.callbackList.filter(o=>o&&!o.applied);let{length:r}=this.callbackList;for(let o=0;o<r;o++){const s=this.callbackList[o];if(s&&!s.applied){if(!(s.triggerTime<=this.timestamp))break;s.running=!0,s.fn(),s.applied=!0,r=this.callbackList.length}}}},this.ticker=t,this.ticker.add(this.onTimeUpdate)}setTimeout(t,e){const n=cs(),r=this.timestamp+Math.max(e||16,16);return this.callbackList.push({fn:t,triggerTime:r,id:n,applied:!1,running:!1}),this.callbackList.sort((o,s)=>o.triggerTime-s.triggerTime),n}clearTimeout(t){const e=this.callbackList.findIndex(n=>n.id===t);e>=0&&!this.callbackList[e].running&&this.callbackList.splice(e,1)}delay(t){return new Promise(e=>{this.setTimeout(e,t)})}waitUntil(t,e){return AT(this,void 0,void 0,function*(){const n=this.timestamp;for(;!t()&&this.timestamp-n<e;)yield this.delay(50)})}pause(){this.isPaused=!0}resume(){this.isPaused=!1}}var CT=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function rh(i,t,e){return e?Math.floor(parseFloat(i)*t):Math.ceil(parseFloat(i)*t)}const oh={w:!1,h:!1,x:!0,y:!0};class RT{constructor(t){this.gifs=Object.create(null),this.textures=Object.create(null),this.frames=Object.create(null),this.spriteSheets=[],this.loader=t}getTexture(t){return this.textures[t]||null}getFrameData(t){return this.frames[t]}getGifFrames(t){return this.gifs[t]?this.gifs[t].filter(e=>!!e):[]}loadSpriteSheetItem(t,e,n,r){return CT(this,void 0,void 0,function*(){const o=yield this.loader.fetchJson(`${t}/${e}/jsonOutput/${n}.json`),{baseTexture:s,scale:a}=yield this.loader.fetchPng(`${t}/${e}/jsonOutput/${n}.png`,r);(function(h,u){h.meta&&h.meta.size&&["w","h"].forEach(p=>{h.meta.size[p]=rh(h.meta.size[p],u,oh[p])}),h.frames&&Object.keys(h.frames).forEach(p=>{h.frames[p].frame&&["x","y","w","h"].forEach(y=>{h.frames[p].frame[y]=rh(h.frames[p].frame[y],u,oh[y])}),h.frames[p].spriteSourceSize&&["x","y","w","h"].forEach(y=>{h.frames[p].spriteSourceSize[y]=rh(h.frames[p].spriteSourceSize[y],u,oh[y])}),h.frames[p].sourceSize&&["w","h"].forEach(y=>{h.frames[p].sourceSize[y]=rh(h.frames[p].sourceSize[y],u,oh[y])})})})(o,a);const l=new bm(s,o);yield new Promise(h=>{l.parse(()=>h(""))}),this.spriteSheets.push(l),Object.keys(l.textures).forEach(h=>{const u=h.match(/^(.+)_gif_(\d+)$/);if(u&&u[1]&&u[2]){const p=u[1];this.gifs[p]||(this.gifs[p]=[]);const y=parseInt(u[2],10);this.gifs[p][y]=l.textures[h]}else this.frames[h]=o.frames[h],this.textures[h]=l.textures[h]})})}destroy(){this.spriteSheets.forEach(t=>t.destroy(!0)),this.spriteSheets=[],this.gifs=Object.create(null),this.textures=Object.create(null),this.frames=Object.create(null)}}var IT=v(18),sh=v.n(IT),PT=v(13),zo=v.n(PT);function Cg(i,t,e){let n,r;const o=Math.round(i)%360;if(o%180==0)n=Math.cos(o*(Math.PI/180))*t,r=0;else if(o%90==0)n=0,r=Math.sin(o*(Math.PI/180))*e;else{const s=function(a){const l=a*Math.PI/180;return Math.tan(l)}(o);n=t*e/Math.sqrt(Math.pow(e,2)+Math.pow(t*s,2)),(o>90&&o<270||o<-90&&o>-270)&&(n=-n),r=s*n}return{x:n,y:r}}function OT(i,t,e,n,r,o){const s=i,a=t;let l,h,u,p,y;if(Math.round(n)===0)l=r,h=o,y=0;else if(Math.round(n)>=360)l=r,h=o,u=r+2*i*Math.abs(Math.cos(-e/180*Math.PI)),p=o+2*t*Math.sin(-e/180*Math.PI),y=1;else{const x=-e,E=-(e+n),{x:w,y:C}=Cg(x,s,a),j=r-w,Z=o+C,{x:rt,y:ct}=Cg(E,s,a);l=rt+j,h=Z-ct,y=n>=-360&&n<-180?1:n>=-180&&n<0||n>0&&n<180?0:1}return{radiusX:s,radiusY:a,xAxisRotation:0,largeArcFlag:y,sweepFlag:n>0?1:0,endX:l,endY:h,middleX:u,middleY:p}}class Rg{constructor(){this.pool=[]}getObject(t){const e=this.pool.find(n=>!n.isUsed);if(e)return e.isUsed=!0,e.obj;{const n={obj:this.createObject(),isUsed:!0,group:t};return this.pool.push(n),n.obj}}collectObject(t){const e=this.pool.find(n=>n.obj===t);e&&(e.isUsed=!1,this.resetObject(e.obj))}collectObjectByGroup(t){this.pool.filter(e=>e.group===t).forEach(e=>this.collectObject(e.obj))}}const cc=new class extends Rg{createObject(){const i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("version","1.1"),i}resetObject(i){i.removeAttribute("viewBox"),i.removeAttribute("width"),i.removeAttribute("height"),i.innerHTML=""}},dc=new class extends Rg{createObject(){return document.createElement("img")}resetObject(i){i.removeAttribute("src")}};var NT=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class LT{constructor(t){this.imgElements=[],this.svgElements=[],this.idToHashMap=Object.create(null),this.textures=Object.create(null),this.graphics=[],this.hashToIdMap=Object.create(null),this.maxResolution=t}render(t,e,n,r){return NT(this,void 0,void 0,function*(){const{items:o,width:s,height:a}=t,l=dc.getObject(n),h=new ce.c(l,{width:s*r,height:a*r,resolution:1}),u=cc.getObject(n);this.imgElements.push(l),this.svgElements.push(u),u.setAttribute("viewBox",`0 0 ${s} ${a}`),u.setAttribute("width",""+s),u.setAttribute("height",""+a);const p={};o.forEach(C=>{const{item:j,x:Z,y:rt}=C,ct=Z+2,nt=rt+2;j.pathsData.forEach(mt=>{let jt="";mt.cmds.forEach(([Ft,Mt])=>{jt+=Ft+" ",jt+=Mt.map(wt=>(zo()(wt)||(wt.x=wt.x+mt.offset.x+ct,wt.y=wt.y+mt.offset.y+nt),wt)).reduce((wt,Pt)=>(zo()(Pt)?wt+=Pt+" ":wt+=`${Pt.x} ${Pt.y} `,wt),""),jt+=" "}),mt.pathElement.setAttribute("d",jt),u.appendChild(mt.pathElement)});const vt=j.width-4-2*j.padding,ht=j.height-4-2*j.padding;this.textures[j.hash]={texture:new ce.t(h,new De.j((ct+2)*r,(nt+2)*r,vt*r,ht*r)),pivot:j.pivot,scale:1/r},p[j.hash]=this.hashToIdMap[j.hash]});const y=(x='<?xml version="1.0" encoding="utf-8"?>'+u.outerHTML,"data:image/svg+xml,"+encodeURIComponent(x).replace(/'/g,"%27").replace(/"/g,"%22"));var x;const E=document.createElement("img");E.src=y,yield new Promise((C,j)=>{E.onload=()=>C(""),E.onerror=()=>j()});const w=document.createElement("canvas");w.width=E.width*r,w.height=E.height*r,w.getContext("2d").drawImage(E,0,0,w.width,w.height),l.src=w.toDataURL("image/png"),yield new Promise((C,j)=>{l.onload=()=>C(""),l.onerror=()=>j()})})}getGraphicsData(t){const e=this.idToHashMap[t]||"";return this.textures[e]||null}addGraphics(t,e,n,r,o,s,a,l,h,u,p){var y,x;if(!a&&!h)return t;const E=sh()(n+((x=(y=a==null?void 0:a.width)===null||y===void 0?void 0:y.toString())!==null&&x!==void 0?x:0)+h+u+p);if(this.hashToIdMap[E]||(this.hashToIdMap[E]=[]),this.hashToIdMap[E].push(t),this.idToHashMap[t]=E,this.graphics.findIndex(w=>w.hash===E)<0){const{graphicsWidth:w,graphicsHeight:C,pathsData:j,pivot:Z,padding:rt}=function(ct,nt,vt,ht,mt,jt,Ft,Mt,wt){var Pt;const Nt=[],ne={x:Math.abs(mt.x),y:Math.abs(mt.y)};let $t=0,zt=0,Yt=0,ge=0,be=0,Pe="none";const Ct=(Pt=ht==null?void 0:ht.width)!==null&&Pt!==void 0?Pt:0;return Ft?($t=nt,zt=vt,be=0):(Pe=wt||"#ff0000",be=Ct,Yt=.5*Ct,ge=.5*Ct,$t=nt+Ct,zt=vt+Ct,ne.x+=.5*Ct,ne.y+=.5*Ct),$t+=Math.abs(mt.x),zt+=Math.abs(mt.y),Yt+=Math.abs(mt.x),ge+=Math.abs(mt.y),$t+=4,zt+=4,Yt+=2,ge+=2,$t=Math.ceil($t),zt=Math.ceil(zt),ct.forEach(Bt=>{const ve=document.createElementNS("http://www.w3.org/2000/svg","path");Bt.fill!=="none"&&Ft?ve.setAttribute("fill",Mt||"#ff0000"):ve.setAttribute("fill","none"),Bt.hasStroke&&!Ft&&(ve.setAttribute("stroke-linecap",(ht==null?void 0:ht.cap)||"butt"),ve.setAttribute("stroke-linejoin",(ht==null?void 0:ht.join)||"miter"),ve.setAttribute("stroke-width",be.toString()),ve.setAttribute("stroke",Pe),ht!=null&&ht.dash&&ve.setAttribute("stroke-dasharray",ht.dash));const{scale:le}=Bt,se=Bt.path.trim().split(" ");let Ie={x:0,y:0};const Le={offset:{x:Yt,y:ge},cmds:[],pathElement:ve};for(let ue=0;ue<se.length;ue+=2){const bt=se[ue],Ht=se[ue+1];if(bt==="M"){let[ie,ae]=Ht.split(",").map(qt=>Number(qt));Ie={x:ie,y:ae},ie=ie/9525*le.x,ae=ae/9525*le.y,Le.cmds.push(["M",[{x:ie,y:ae}]])}else if(bt==="A"){const[ie,ae,qt,ye]=Ht.split(",").map(Sn=>Number(Sn)),nn=qt/Math.PI*180,on=ye/Math.PI*180,rn=OT(ie,ae,nn,on,Ie.x,Ie.y);Math.round(on)>=360?(Ie={x:rn.endX,y:rn.endY},Le.cmds.push(["A",[rn.radiusX/9525*le.x,rn.radiusY/9525*le.y,rn.xAxisRotation,rn.largeArcFlag,rn.sweepFlag,{x:rn.middleX/9525*le.x,y:rn.middleY/9525*le.y}]]),Le.cmds.push(["A",[rn.radiusX/9525*le.x,rn.radiusY/9525*le.y,rn.xAxisRotation,rn.largeArcFlag,rn.sweepFlag,{x:rn.endX/9525*le.x,y:rn.endY/9525*le.y}]])):(Ie={x:rn.endX,y:rn.endY},Le.cmds.push(["A",[rn.radiusX/9525*le.x,rn.radiusY/9525*le.y,rn.xAxisRotation,rn.largeArcFlag,rn.sweepFlag,{x:rn.endX/9525*le.x,y:rn.endY/9525*le.y}]]))}else if(bt==="L"){let[ie,ae]=Ht.split(",").map(qt=>Number(qt));Ie={x:ie,y:ae},ie=ie/9525*le.x,ae=ae/9525*le.y,Le.cmds.push(["L",[{x:ie,y:ae}]])}else if(bt==="QB"){let[ie,ae,qt,ye]=Ht.split(",").map(nn=>Number(nn));Ie={x:qt,y:ye},ie=ie/9525*le.x,ae=ae/9525*le.y,qt=qt/9525*le.x,ye=ye/9525*le.y,Le.cmds.push(["Q",[{x:ie,y:ae},{x:qt,y:ye}]])}else if(bt==="CB"){let[ie,ae,qt,ye,nn,on]=Ht.split(",").map(rn=>Number(rn));Ie={x:nn,y:on},ie=ie/9525*le.x,ae=ae/9525*le.y,qt=qt/9525*le.x,ye=ye/9525*le.y,nn=nn/9525*le.x,on=on/9525*le.y,Le.cmds.push(["C",[{x:ie,y:ae},{x:qt,y:ye},{x:nn,y:on}]])}else bt==="C"&&Le.cmds.push(["Z",[]])}Nt.push(Le)}),{graphicsWidth:$t,graphicsHeight:zt,pivot:ne,padding:2,pathsData:Nt}}(e,o,s,a,r,0,h,u,p);this.graphics.push({hash:E,pathsData:j,pivot:Z,width:w,height:C,padding:rt})}return t}pack(){return this.graphics.forEach(t=>{t.width+=4,t.height+=4}),function t(e){const n=[],r=e.filter(u=>{const p=u.width<2048&&u.height<2048;return p||n.push(u),p}).sort((u,p)=>u.width*u.height-p.width*p.height);let o=r.length+1,s=2050,a=2050;const l=[];let h=null;for(;(s>2048||a>2048)&&r.length>0;)o-=1,h=Sg()(r.slice(0,o)),s=h.width,a=h.height;return h&&l.push(h),n.forEach(u=>{const p=Sg()([u]);l.push(p)}),o<r.length?l.concat(t(r.slice(o))):l}(this.graphics)}destroy(){Object.keys(this.textures).forEach(t=>{var e;(e=this.textures[t])===null||e===void 0||e.texture.destroy(!0)}),this.textures=Object.create(null),this.imgElements.forEach(t=>dc.collectObject(t)),this.svgElements.forEach(t=>cc.collectObject(t)),this.graphics=[]}}class DT{constructor(){this.runningTimeNodes={}}addRunningTimeNode(t,e,n){const r=`${e}_${t}`;if(this.runningTimeNodes[r])try{this.runningTimeNodes[r].dispose(!0)}catch{}this.runningTimeNodes[r]=n}removeRunningTimeNode(t,e){const n=`${e}_${t}`;delete this.runningTimeNodes[n]}}class FT{constructor(t){this.eventHub=t,this.targets=Object.create(null)}getTargets(){return Object.keys(this.targets).map(t=>this.targets[t])}addTarget(t,e){this.targets[t]=e}getTargetById(t){return this.targets[t]}getTarget(t,e,n={type:"el",index:0,id:""}){var r,o;let s=this.targets[t.id];return t.type!=="shape"?s:(t.type==="shape"&&t.txEl&&(s=(r=s==null?void 0:s.getTextElement(t.txEl.type,t.txEl.range))!==null&&r!==void 0?r:null),t.type==="shape"&&t.bg&&n.index===0&&(e=!1,s=(o=s==null?void 0:s.getBgElement())!==null&&o!==void 0?o:null,this.eventHub.emit("IterateTimeNodeEnd",n.id)),e&&s?s.getIterateEntry(n.type,n.index,n.id):(s||this.eventHub.emit("IterateTimeNodeEnd",n.id),s))}clearTargets(){this.targets=Object.create(null)}}class BT{constructor(t){this.target=t}get color(){return this.target.strokeColorFilter.currentColor}set color(t){this.target.strokeColorFilter.color=t}get on(){return this.target.strokeActive?"true":"false"}set on(t){this.target.strokeActive=t==="true"}}class UT{constructor(t){this.applyCommand=(e,n)=>{this.target.applyCommand(e,n)},this.target=t}}class kT{constructor(t){this.target=t}get color(){return this.target.pptColorFilter.currentColor}set color(t){this.target.pptColorActive&&(this.target.pptColorFilter.color=t)}get on(){return this.target.pptColorActive?"true":"false"}set on(t){this.target.pptColorActive=t==="true"}get designColor(){return this.target.pptColorFilter.designColor}toString(){return this.color}}class Ig{constructor(t){this.target=t}get color(){return this.target.fillColorFilter.currentColor}set color(t){this.target.fillActive&&(this.target.fillColorFilter.color=t)}get on(){return this.target.fillActive?"true":"false"}set on(t){this.target.fillActive=t==="true"}get designColor(){return this.target.fillColorFilter.designColor}}class GT{constructor(t,e,n){this.hardHidden=!1,this.designRotation=0,this.target=t,e===!0&&(this.hardHidden=!0),this.designRotation=n}get opacity(){return this.target.alpha}set opacity(t){this.target.alpha=t}get rotation(){return this.target.rotation/Math.PI*180}set rotation(t){this.target.rotation=t/180*Math.PI+this.designRotation}get visibility(){return this.target.visible?"visible":"hidden"}set visibility(t){this.visibility===t||this.hardHidden||(this.target.visible=t==="visible")}}class Pg{constructor(t,e){this.actions=[],this.ctx=e,this.object=t,this.object.interactive=!0}reset(t){this.object.interactive=!1,this.object.removeAllListeners(),this.object=t,this.object.interactive=!0}addAction(t,e){this.actions.push([t,e]),e==="click"?(this.object.addListener("pointertap",()=>this.handleAction(t)),this.object.cursor="pointer"):e==="hover"&&this.object.addListener("mouseover",()=>this.handleAction(t))}getOriginHitArea(){return this.object.hitArea?this.object.hitArea:new De.k(0,0,this.object.width,this.object.height)}handleAction(t){this.ctx.eventHub.emit(Ke.hyperlinkTrigger,t),this.execAction(t)}execAction(t){var e,n;if(this.ctx.eventHub.emit(Ke.userInput),t.action==="ppaction://hlinksldjump"){const r=((e=t==null?void 0:t.target)!==null&&e!==void 0?e:"").match(/slide(\d+)\.xml/);r&&r[1]&&this.ctx.eventHub.emit(Ke.requestGotoSlide,Number(r[1]))}else if(t.action==="ppaction://hlinkshowjump?jump=nextslide")this.ctx.eventHub.emit(Ke.requestNextSlide);else if(t.action==="ppaction://hlinkshowjump?jump=previousslide")this.ctx.eventHub.emit(Ke.requestPrevSlide);else if(t.action==="ppaction://hlinkshowjump?jump=firstslide")this.ctx.eventHub.emit(Ke.requestGotoSlide,1);else if(t.action==="ppaction://hlinkshowjump?jump=lastslide")this.ctx.eventHub.emit(Ke.requestGotoSlide,-1);else if(t.action==="ppaction://hlinkshowjump?jump=lastslideviewed"){const r=this.ctx.lastViewedIndex;this.ctx.eventHub.emit(Ke.requestGotoSlide,r)}else t.action==="ppaction://hlinkshowjump?jump=endshow"?this.ctx.eventHub.emit(Ke.requestGotoSlide,-1):t.action===""&&((n=t.target)===null||n===void 0?void 0:n.startsWith("http"))&&this.ctx.eventHub.emit(Ke.requestOpenUrl,t.target)}}function Tr(i,t,e=5){return Math.abs(i-t)<=Math.pow(10,-e)}function qs(i){return Math.floor(1e6*i)/1e6}class Vo{constructor(){this.point={x:0,y:0},this.slope=Math.PI/4}static fromPointSlope(t,e){const n=new Vo;return n.point=t,n.slope=e,n}resolveY(t){return Math.tan(this.slope)*(t-this.point.x)+this.point.y}distanceToLinearEquation(t){return Tr(this.slope,t.slope)?this.distanceToPoint(t.point):-1}distanceToPoint(t){let e=0;if(Math.tan(this.slope)*(t.x-this.point.x)+this.point.y===t.y)return 0;e=this.slope>=Math.PI/2?this.slope-Math.PI/2:Math.PI/2+this.slope;const n=Vo.fromPointSlope(t,e),r=this.crossPoint(n);return r?Math.ceil(Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))):0}crossPoint(t){if(Tr(t.slope,this.slope))return null;let e=0,n=0;const r=Math.tan(t.slope),o=Math.tan(this.slope),{x:s,y:a}=this.point,{x:l,y:h}=t.point;return Tr(this.slope,Math.PI/2)?(e=this.point.x,n=r*(e-l)+h):Tr(t.slope,Math.PI/2)?(e=t.point.x,n=o*(e-s)+a):Tr(this.slope,Math.PI)||Tr(this.slope,0)?(n=this.point.y,e=(n-h)/r+l):Tr(t.slope,Math.PI)||Tr(t.slope,0)?(n=t.point.y,e=(n-a)/o+s):(e=(r*l-h+a-o*s)/(r-o),n=o*(e-s)+a),{x:e,y:n}}}class pc{constructor(t,e,n){var r,o,s,a,l,h;this.scaleExt={x:1,y:1},this.scaleOrigin={x:1,y:1},this.designScale={x:1,y:1},this.bound=new De.j(0,0,1,1),this.pptX=0,this.pptY=0,this.presetSubType=0,this.designWidth=0,this.designHeight=0,this.designX=0,this.designY=0,this.hasPreset=!1,this.container=new Cn.b,this.ctx=e,this.style=new GT(this.container,!!t.hardHidden,t.rotation||0),this.designGlobalPosition={x:n.parentGlobalPos.x+((o=(r=t.position)===null||r===void 0?void 0:r.x)!==null&&o!==void 0?o:0),y:n.parentGlobalPos.y+((a=(s=t.position)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0)},(t.hlinkClick||t.hlinkHover)&&(this.hyperlink=new Pg(this.container,this.ctx),t.hlinkHover&&((l=this.hyperlink)===null||l===void 0||l.addAction(t.hlinkHover,"hover")),t.hlinkClick&&((h=this.hyperlink)===null||h===void 0||h.addAction(t.hlinkClick,"click"))),this.ctx.clock.waitUntil(()=>{try{return!!this.container.width}catch{return!1}},3e3).then(()=>{try{this.designWidth=this.designWidth||this.container.width}catch{}}),this.ctx.clock.waitUntil(()=>{try{return!!this.container.height}catch{return!1}},3e3).then(()=>{try{this.designHeight=this.designHeight||this.container.height}catch{}})}updateScale(){this.container&&(this.container.scale.x=this.designScale.x*this.scaleExt.x*this.scaleOrigin.x,this.container.scale.y=this.designScale.y*this.scaleExt.y*this.scaleOrigin.y)}updateTransform(t){var e,n,r,o,s,a,l,h;this.designWidth=t.width,this.designHeight=t.height,this.designX=(n=(e=t.position)===null||e===void 0?void 0:e.x)!==null&&n!==void 0?n:0,this.designY=(o=(r=t.position)===null||r===void 0?void 0:r.y)!==null&&o!==void 0?o:0;const u=this.designWidth/2,p=this.designHeight/2;this.container.width=this.designWidth,this.container.height=this.designHeight,this.container.pivot.x=u,this.container.pivot.y=p;const y=(a=(s=t.position)===null||s===void 0?void 0:s.x)!==null&&a!==void 0?a:0,x=(h=(l=t.position)===null||l===void 0?void 0:l.y)!==null&&h!==void 0?h:0;this.container.x=y+u,this.container.y=x+p,t.scale&&(this.designScale={x:t.scale.x,y:t.scale.y},this.container.scale.x=t.scale.x,this.container.scale.y=t.scale.y),t.rotation&&(this.container.rotation=t.rotation);const E=new er;E.drawRect(0,0,this.designWidth,this.designHeight),this.container.addChild(E),this.json.hardHidden&&(this.container.visible=!1),this.bound.x=y,this.bound.y=x,this.bound.width=this.designWidth,this.bound.height=this.designHeight}get scale(){return this.scaleOrigin}set scale(t){this.scaleOrigin.x=t.x,this.scaleOrigin.y=t.y,this.updateScale()}get design_ppt_w(){return qs(this.designWidth/this.ctx.stageWidth)}get design_ppt_h(){return qs((this.designHeight||this.container.height)/this.ctx.stageHeight)}get design_ppt_x(){return qs(this.designX/this.ctx.stageWidth)}get design_ppt_y(){return qs(this.designY/this.ctx.stageHeight)}get ppt_w(){return this.scaleExt.x*this.scaleOrigin.x*this.designWidth/this.ctx.stageWidth}set ppt_w(t){this.designWidth&&(this.scaleExt.x=t*this.ctx.stageWidth/this.designWidth,this.updateScale())}get ppt_h(){const t=this.designHeight||this.container.height;return this.scaleExt.y*this.scaleOrigin.y*t/this.ctx.stageHeight}set ppt_h(t){this.designHeight&&(this.scaleExt.y=t*this.ctx.stageHeight/this.designHeight,this.updateScale())}get ppt_x(){return(this.container.position.x-this.container.pivot.x)/this.ctx.stageWidth}set ppt_x(t){this.pptX=t;const e=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=t*this.ctx.stageWidth+this.container.pivot.x*e}get ppt_y(){return(this.container.position.y-this.container.pivot.y)/this.ctx.stageHeight}set ppt_y(t){this.pptY=t;const e=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=t*this.ctx.stageHeight+this.container.pivot.y*e}get r(){return this.container.rotation}set r(t){this.container.rotation=t}set xshear(t){this.container.skew.x=t}get xshear(){return this.container.skew.x}set yshear(t){this.container.skew.y=t}get yshear(){return this.container.skew.y}}var HT=v(112),jT=v.n(HT);class ah{constructor(t){if(this._isInit=!1,this.h=0,this.s=0,this.l=0,this.a=1,t){this._isInit=!0;const e=t.match(/-?[0-9]+/g);e&&(this.h=parseInt(e[0],10),this.s=parseInt(e[1],10)/100,this.l=parseInt(e[2],10)/100)}}isInit(){return this._isInit}by(t,e){e.h=Math.max(Math.min(this.h+t.h,359),0),e.s=Math.max(Math.min(this.s+t.s,1),0),e.l=Math.max(Math.min(this.l+t.l,1),0),e.a=Math.max(Math.min(this.a+t.a,1),0)}fromHexString(t){const[e,n,r,o]=Er(t);let s=0,a=0,l=0;const h=Math.max(e,n,r),u=Math.min(e,n,r),p=h-u;l=(h+u)/2,p===0?s=0:h===e?s=(n-r)/p%6*60:h===n?s=60*((r-e)/p+2):h===r&&(s=60*((e-n)/p+4)),a=p===0?0:p/(1-Math.abs(2*l-1)),this.h=s,this.s=a,this.l=l,this.a=o}interpolationFrom(t,e,n){const r=t.h+(this.h-t.h)*e,o=t.s+(this.s-t.s)*e,s=t.l+(this.l-t.l)*e,a=t.a+(this.a-t.a)*e;n.h=Math.max(Math.min(r,359),0),n.s=Math.max(Math.min(o,1),0),n.l=Math.max(Math.min(s,1),0),n.a=Math.max(Math.min(a,1),0)}toHexString(){let t=[0,0,0,0];const{h:e,s:n,l:r}=this;if(e<360&&e>=0&&n<=1&&n>=0&&r<=1&&r>=0){let o,s,a;const l=(1-Math.abs(2*r-1))*n,h=l*(1-Math.abs(e/60%2-1)),u=r-l/2;[o,s,a]=e>=0&&e<60?[l,h,0]:e>=60&&e<120?[h,l,0]:e>=120&&e<180?[0,l,h]:e>=180&&e<240?[0,h,l]:e>=240&&e<300?[h,0,l]:[l,0,h],t=[o+u,s+u,a+u,this.a]}return Ng(t)}}class lh{constructor(t){this._isInit=!1,this.r=0,this.g=0,this.b=0,this.a=0,t&&(this._isInit=!0,this.fromHexString(t))}fromHexString(t){const[e,n,r,o]=Er(t);this.r=e,this.g=n,this.b=r,this.a=o}isInit(){return this._isInit}interpolationFrom(t,e,n){n.r=t.r+(this.r-t.r)*e,n.g=t.g+(this.g-t.g)*e,n.b=t.b+(this.b-t.b)*e,n.a=t.a+(this.a-t.a)*e}by(t,e){e.r=Math.min(Math.max(this.r+t.r,0),255),e.g=Math.min(Math.max(this.g+t.g,0),255),e.b=Math.min(Math.max(this.b+t.b,0),255),e.a=Math.min(Math.max(this.a+t.a,0),1)}toHexString(){return Ng([this.r,this.g,this.b,this.a])}}function Og(i){const t=i.substring(1);return[parseInt(t.substring(0,6),16),parseInt(t.substring(6,8),16)/255]}function Er(i){return(i=i.replace(/^#/,"")).substring(6,8).length===0&&(i+="FF"),[parseInt(i.substring(0,2).padStart(8,"0"),16)/255,parseInt(i.substring(2,4).padStart(8,"0"),16)/255,parseInt(i.substring(4,6).padStart(8,"0"),16)/255,parseInt(i.substring(6,8).padStart(8,"0"),16)/255]}function Ng(i){return"#"+Math.round(255*i[0]).toString(16).padStart(2,"0")+Math.round(255*i[1]).toString(16).padStart(2,"0")+Math.round(255*i[2]).toString(16).padStart(2,"0")+Math.round(255*i[3]).toString(16).padStart(2,"0")}function Ga(i,t,e){const n=Er(i),r=Er(t),o=Math.round(255*(n[0]+(r[0]-n[0])*e)),s=Math.round(255*(n[1]+(r[1]-n[1])*e)),a=Math.round(255*(n[2]+(r[2]-n[2])*e)),l=Math.round(255*(n[3]+(r[3]-n[3])*e));return"#"+o.toString(16).padStart(2,"0")+s.toString(16).padStart(2,"0")+a.toString(16).padStart(2,"0")+l.toString(16).padStart(2,"0")}class ds extends ce.k{constructor(){super(void 0,`
varying vec2 vTextureCoord;

uniform vec4 color;
uniform sampler2D uSampler;

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);

    if (texColor.a > 0.0) {
        vec4 resultColor = color;
        resultColor = resultColor * texColor.a;
        gl_FragColor = resultColor;
    } else {
        gl_FragColor = texColor;
    }
}
`,{color:new Float32Array([0,0,0,0]),active:0}),this.currentColor="#FFFFFFFF",this.designColor="#FFFFFFFF"}set color(t){this.currentColor=t;const e=Er(t);this.uniforms.color=Float32Array.from(e)}get color(){return this.currentColor}}const Lg=new Xs.ColorMatrixFilter;Lg.matrix=[1,0,0,0,-.2,0,1,0,0,-.2,0,0,1,0,-.2,0,0,0,1,0];const Dg=new Xs.ColorMatrixFilter;Dg.matrix=[1,0,0,0,-.1,0,1,0,0,-.1,0,0,1,0,-.1,0,0,0,1,0];const Fg=new Xs.ColorMatrixFilter;Fg.matrix=[1,0,0,0,.2,0,1,0,0,.2,0,0,1,0,.2,0,0,0,1,0];const Bg=new Xs.ColorMatrixFilter;Bg.matrix=[1,0,0,0,.1,0,1,0,0,.1,0,0,1,0,.1,0,0,0,1,0];const zT={darken:Lg,darkenLess:Dg,lightenLess:Bg,lighten:Fg};class fc extends pc{constructor(t,e,n){super({position:{x:t.x,y:t.y},width:t.width,height:t.height},e,n),this.fillColorFilter=new ds,this.fill=new Ig(this),this.json=t,this.ctx=e,this.parentGlobalPos=n.parentGlobalPos,this.global={x:n.parentGlobalPos.x+t.x,y:n.parentGlobalPos.y+t.y},this.updateTransform({position:{x:t.x,y:t.y},width:t.width,height:t.height})}get fillActive(){var t,e;return((e=(t=this.container.filters)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:-1)>0}set fillActive(t){var e,n;t?((n=(e=this.container.filters)===null||e===void 0?void 0:e.indexOf(this.fillColorFilter))!==null&&n!==void 0?n:-1)<0&&(this.container.filters=[this.fillColorFilter]):this.container.filters=[]}get renderContainer(){return this.container}get interactiveContainer(){return this.container}clearOnSlideChange(){}initOnReuse(){}getTextElement(){return null}getBgElement(){return null}get ppt_x(){return this.global.x/this.ctx.stageWidth}set ppt_x(t){const e=t*this.ctx.stageWidth-this.global.x,n=this.presetSubType===544?this.scaleExt.x:1;this.container.position.x=this.designX+e+this.container.pivot.x*n}get ppt_y(){return this.global.y/this.ctx.stageHeight}set ppt_y(t){const e=t*this.ctx.stageHeight-this.global.y,n=this.presetSubType===544?this.scaleExt.y:1;this.container.position.y=this.designY+e+this.container.pivot.y*n}get design_ppt_x(){return qs(this.global.x/this.ctx.stageWidth)}get design_ppt_y(){return qs(this.global.y/this.ctx.stageHeight)}}class VT{constructor(t,e,n,r,o,s,a,l,h,u,p){this.ctx=t,this.type=e,this.lineWidth=n,this.width=r,this.height=o,this.fillColor=s,this.isHorz=a,this.renderContainer=new Cn.b,this.ghcTextureId=`${l}-text-p${h}-l${u}-u${p}-underLine`}createPaths(){if(this.type==="ww")return null;{let t=`M 0,0 L ${9525*this.width},0`,[e,n]=[this.width,this.lineWidth];return this.isHorz||(t="M 0,0 L 0,"+9525*this.height,[e,n]=[this.lineWidth,this.height]),{paths:[{id:cs(),path:t,fill:"norm",hasStroke:!0,scale:{x:1,y:1},hash:sh()(t)}],width:e,height:n}}}getLineStyle(){const t={width:this.lineWidth};return this.type==="dotted"&&(t.dash=""+this.lineWidth),t}preRender(){const t=this.createPaths();if(t){const{paths:e,width:n,height:r}=t,o=e.reduce((s,a)=>s+a.hash,"");this.ctx.graphicsTexture.addGraphics(this.ghcTextureId,e,o,{x:0,y:0},n,r,this.getLineStyle(),this.ctx.objectPoolGroup,!1,null,this.fillColor)}}render(){if(this.ghcTextureId){const t=this.ctx.graphicsTexture.getGraphicsData(this.ghcTextureId);t&&(this.sprite=new pi,this.sprite.texture=t.texture,this.sprite.pivot.x=t.pivot.x,this.sprite.scale.x=t.scale,this.sprite.scale.y=t.scale)}}destroy(){var t;(t=this.sprite)===null||t===void 0||t.destroy({texture:!0})}}const ir=134217729;function mc(i,t,e,n,r){let o,s,a,l,h=t[0],u=n[0],p=0,y=0;u>h==u>-h?(o=h,h=t[++p]):(o=u,u=n[++y]);let x=0;if(p<i&&y<e)for(u>h==u>-h?(s=h+o,a=o-(s-h),h=t[++p]):(s=u+o,a=o-(s-u),u=n[++y]),o=s,a!==0&&(r[x++]=a);p<i&&y<e;)u>h==u>-h?(s=o+h,l=s-o,a=o-(s-l)+(h-l),h=t[++p]):(s=o+u,l=s-o,a=o-(s-l)+(u-l),u=n[++y]),o=s,a!==0&&(r[x++]=a);for(;p<i;)s=o+h,l=s-o,a=o-(s-l)+(h-l),h=t[++p],o=s,a!==0&&(r[x++]=a);for(;y<e;)s=o+u,l=s-o,a=o-(s-l)+(u-l),u=n[++y],o=s,a!==0&&(r[x++]=a);return o===0&&x!==0||(r[x++]=o),x}function WT(i,t){let e=t[0];for(let n=1;n<i;n++)e+=t[n];return e}function Ha(i){return new Float64Array(i)}const Js=Ha(4),Ug=Ha(8),kg=Ha(12),Gg=Ha(16),ar=Ha(4);function hh(i,t,e,n,r,o){const s=(t-o)*(e-r),a=(i-r)*(n-o),l=s-a;if(s===0||a===0||s>0!=a>0)return l;const h=Math.abs(s+a);return Math.abs(l)>=33306690738754716e-32*h?l:-function(u,p,y,x,E,w,C){let j,Z,rt,ct,nt,vt,ht,mt,jt,Ft,Mt,wt,Pt,Nt,ne,$t,zt,Yt;const ge=u-E,be=y-E,Pe=p-w,Ct=x-w;Nt=ge*Ct,vt=ir*ge,ht=vt-(vt-ge),mt=ge-ht,vt=ir*Ct,jt=vt-(vt-Ct),Ft=Ct-jt,ne=mt*Ft-(Nt-ht*jt-mt*jt-ht*Ft),$t=Pe*be,vt=ir*Pe,ht=vt-(vt-Pe),mt=Pe-ht,vt=ir*be,jt=vt-(vt-be),Ft=be-jt,zt=mt*Ft-($t-ht*jt-mt*jt-ht*Ft),Mt=ne-zt,nt=ne-Mt,Js[0]=ne-(Mt+nt)+(nt-zt),wt=Nt+Mt,nt=wt-Nt,Pt=Nt-(wt-nt)+(Mt-nt),Mt=Pt-$t,nt=Pt-Mt,Js[1]=Pt-(Mt+nt)+(nt-$t),Yt=wt+Mt,nt=Yt-wt,Js[2]=wt-(Yt-nt)+(Mt-nt),Js[3]=Yt;let Bt=WT(4,Js),ve=22204460492503146e-32*C;if(Bt>=ve||-Bt>=ve||(nt=u-ge,j=u-(ge+nt)+(nt-E),nt=y-be,rt=y-(be+nt)+(nt-E),nt=p-Pe,Z=p-(Pe+nt)+(nt-w),nt=x-Ct,ct=x-(Ct+nt)+(nt-w),j===0&&Z===0&&rt===0&&ct===0)||(ve=11093356479670487e-47*C+33306690738754706e-32*Math.abs(Bt),Bt+=ge*ct+Ct*j-(Pe*rt+be*Z),Bt>=ve||-Bt>=ve))return Bt;Nt=j*Ct,vt=ir*j,ht=vt-(vt-j),mt=j-ht,vt=ir*Ct,jt=vt-(vt-Ct),Ft=Ct-jt,ne=mt*Ft-(Nt-ht*jt-mt*jt-ht*Ft),$t=Z*be,vt=ir*Z,ht=vt-(vt-Z),mt=Z-ht,vt=ir*be,jt=vt-(vt-be),Ft=be-jt,zt=mt*Ft-($t-ht*jt-mt*jt-ht*Ft),Mt=ne-zt,nt=ne-Mt,ar[0]=ne-(Mt+nt)+(nt-zt),wt=Nt+Mt,nt=wt-Nt,Pt=Nt-(wt-nt)+(Mt-nt),Mt=Pt-$t,nt=Pt-Mt,ar[1]=Pt-(Mt+nt)+(nt-$t),Yt=wt+Mt,nt=Yt-wt,ar[2]=wt-(Yt-nt)+(Mt-nt),ar[3]=Yt;const le=mc(4,Js,4,ar,Ug);Nt=ge*ct,vt=ir*ge,ht=vt-(vt-ge),mt=ge-ht,vt=ir*ct,jt=vt-(vt-ct),Ft=ct-jt,ne=mt*Ft-(Nt-ht*jt-mt*jt-ht*Ft),$t=Pe*rt,vt=ir*Pe,ht=vt-(vt-Pe),mt=Pe-ht,vt=ir*rt,jt=vt-(vt-rt),Ft=rt-jt,zt=mt*Ft-($t-ht*jt-mt*jt-ht*Ft),Mt=ne-zt,nt=ne-Mt,ar[0]=ne-(Mt+nt)+(nt-zt),wt=Nt+Mt,nt=wt-Nt,Pt=Nt-(wt-nt)+(Mt-nt),Mt=Pt-$t,nt=Pt-Mt,ar[1]=Pt-(Mt+nt)+(nt-$t),Yt=wt+Mt,nt=Yt-wt,ar[2]=wt-(Yt-nt)+(Mt-nt),ar[3]=Yt;const se=mc(le,Ug,4,ar,kg);Nt=j*ct,vt=ir*j,ht=vt-(vt-j),mt=j-ht,vt=ir*ct,jt=vt-(vt-ct),Ft=ct-jt,ne=mt*Ft-(Nt-ht*jt-mt*jt-ht*Ft),$t=Z*rt,vt=ir*Z,ht=vt-(vt-Z),mt=Z-ht,vt=ir*rt,jt=vt-(vt-rt),Ft=rt-jt,zt=mt*Ft-($t-ht*jt-mt*jt-ht*Ft),Mt=ne-zt,nt=ne-Mt,ar[0]=ne-(Mt+nt)+(nt-zt),wt=Nt+Mt,nt=wt-Nt,Pt=Nt-(wt-nt)+(Mt-nt),Mt=Pt-$t,nt=Pt-Mt,ar[1]=Pt-(Mt+nt)+(nt-$t),Yt=wt+Mt,nt=Yt-wt,ar[2]=wt-(Yt-nt)+(Mt-nt),ar[3]=Yt;const Ie=mc(se,kg,4,ar,Gg);return Gg[Ie-1]}(i,t,e,n,r,o,h)}const Hg=Math.pow(2,-52),uh=new Uint32Array(512);class gc{static from(t,e=qT,n=JT){const r=t.length,o=new Float64Array(2*r);for(let s=0;s<r;s++){const a=t[s];o[2*s]=e(a),o[2*s+1]=n(a)}return new gc(o)}constructor(t){const e=t.length>>1;if(e>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:o}=this,s=t.length>>1;let a=1/0,l=1/0,h=-1/0,u=-1/0;for(let Ft=0;Ft<s;Ft++){const Mt=t[2*Ft],wt=t[2*Ft+1];Mt<a&&(a=Mt),wt<l&&(l=wt),Mt>h&&(h=Mt),wt>u&&(u=wt),this._ids[Ft]=Ft}const p=(a+h)/2,y=(l+u)/2;let x,E,w,C=1/0;for(let Ft=0;Ft<s;Ft++){const Mt=vc(p,y,t[2*Ft],t[2*Ft+1]);Mt<C&&(x=Ft,C=Mt)}const j=t[2*x],Z=t[2*x+1];C=1/0;for(let Ft=0;Ft<s;Ft++){if(Ft===x)continue;const Mt=vc(j,Z,t[2*Ft],t[2*Ft+1]);Mt<C&&Mt>0&&(E=Ft,C=Mt)}let rt=t[2*E],ct=t[2*E+1],nt=1/0;for(let Ft=0;Ft<s;Ft++){if(Ft===x||Ft===E)continue;const Mt=YT(j,Z,rt,ct,t[2*Ft],t[2*Ft+1]);Mt<nt&&(w=Ft,nt=Mt)}let vt=t[2*w],ht=t[2*w+1];if(nt===1/0){for(let wt=0;wt<s;wt++)this._dists[wt]=t[2*wt]-t[0]||t[2*wt+1]-t[1];Ks(this._ids,this._dists,0,s-1);const Ft=new Uint32Array(s);let Mt=0;for(let wt=0,Pt=-1/0;wt<s;wt++){const Nt=this._ids[wt];this._dists[Nt]>Pt&&(Ft[Mt++]=Nt,Pt=this._dists[Nt])}return this.hull=Ft.subarray(0,Mt),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(hh(j,Z,rt,ct,vt,ht)<0){const Ft=E,Mt=rt,wt=ct;E=w,rt=vt,ct=ht,w=Ft,vt=Mt,ht=wt}const mt=function(Ft,Mt,wt,Pt,Nt,ne){const $t=wt-Ft,zt=Pt-Mt,Yt=Nt-Ft,ge=ne-Mt,be=$t*$t+zt*zt,Pe=Yt*Yt+ge*ge,Ct=.5/($t*ge-zt*Yt);return{x:Ft+(ge*be-zt*Pe)*Ct,y:Mt+($t*Pe-Yt*be)*Ct}}(j,Z,rt,ct,vt,ht);this._cx=mt.x,this._cy=mt.y;for(let Ft=0;Ft<s;Ft++)this._dists[Ft]=vc(t[2*Ft],t[2*Ft+1],mt.x,mt.y);Ks(this._ids,this._dists,0,s-1),this._hullStart=x;let jt=3;n[x]=e[w]=E,n[E]=e[x]=w,n[w]=e[E]=x,r[x]=0,r[E]=1,r[w]=2,o.fill(-1),o[this._hashKey(j,Z)]=x,o[this._hashKey(rt,ct)]=E,o[this._hashKey(vt,ht)]=w,this.trianglesLen=0,this._addTriangle(x,E,w,-1,-1,-1);for(let Ft,Mt,wt=0;wt<this._ids.length;wt++){const Pt=this._ids[wt],Nt=t[2*Pt],ne=t[2*Pt+1];if(wt>0&&Math.abs(Nt-Ft)<=Hg&&Math.abs(ne-Mt)<=Hg||(Ft=Nt,Mt=ne,Pt===x||Pt===E||Pt===w))continue;let $t=0;for(let Pe=0,Ct=this._hashKey(Nt,ne);Pe<this._hashSize&&($t=o[(Ct+Pe)%this._hashSize],$t===-1||$t===n[$t]);Pe++);$t=e[$t];let zt,Yt=$t;for(;zt=n[Yt],hh(Nt,ne,t[2*Yt],t[2*Yt+1],t[2*zt],t[2*zt+1])>=0;)if(Yt=zt,Yt===$t){Yt=-1;break}if(Yt===-1)continue;let ge=this._addTriangle(Yt,Pt,n[Yt],-1,-1,r[Yt]);r[Pt]=this._legalize(ge+2),r[Yt]=ge,jt++;let be=n[Yt];for(;zt=n[be],hh(Nt,ne,t[2*be],t[2*be+1],t[2*zt],t[2*zt+1])<0;)ge=this._addTriangle(be,Pt,zt,r[Pt],-1,r[be]),r[Pt]=this._legalize(ge+2),n[be]=be,jt--,be=zt;if(Yt===$t)for(;zt=e[Yt],hh(Nt,ne,t[2*zt],t[2*zt+1],t[2*Yt],t[2*Yt+1])<0;)ge=this._addTriangle(zt,Pt,Yt,-1,r[Yt],r[zt]),this._legalize(ge+2),r[zt]=ge,n[Yt]=Yt,jt--,Yt=zt;this._hullStart=e[Pt]=Yt,n[Yt]=e[be]=Pt,n[Pt]=be,o[this._hashKey(Nt,ne)]=Pt,o[this._hashKey(t[2*Yt],t[2*Yt+1])]=Yt}this.hull=new Uint32Array(jt);for(let Ft=0,Mt=this._hullStart;Ft<jt;Ft++)this.hull[Ft]=Mt,Mt=n[Mt];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(n,r){const o=n/(Math.abs(n)+Math.abs(r));return(r>0?3-o:1+o)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let o=0,s=0;for(;;){const a=n[t],l=t-t%3;if(s=l+(t+2)%3,a===-1){if(o===0)break;t=uh[--o];continue}const h=a-a%3,u=l+(t+1)%3,p=h+(a+2)%3,y=e[s],x=e[t],E=e[u],w=e[p];if(XT(r[2*y],r[2*y+1],r[2*x],r[2*x+1],r[2*E],r[2*E+1],r[2*w],r[2*w+1])){e[t]=w,e[a]=y;const C=n[p];if(C===-1){let Z=this._hullStart;do{if(this._hullTri[Z]===p){this._hullTri[Z]=t;break}Z=this._hullPrev[Z]}while(Z!==this._hullStart)}this._link(t,C),this._link(a,n[s]),this._link(s,p);const j=h+(a+1)%3;o<uh.length&&(uh[o++]=j)}else{if(o===0)break;t=uh[--o]}}return s}_link(t,e){this._halfedges[t]=e,e!==-1&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=e,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function vc(i,t,e,n){const r=i-e,o=t-n;return r*r+o*o}function XT(i,t,e,n,r,o,s,a){const l=i-s,h=t-a,u=e-s,p=n-a,y=r-s,x=o-a,E=u*u+p*p,w=y*y+x*x;return l*(p*w-E*x)-h*(u*w-E*y)+(l*l+h*h)*(u*x-p*y)<0}function YT(i,t,e,n,r,o){const s=e-i,a=n-t,l=r-i,h=o-t,u=s*s+a*a,p=l*l+h*h,y=.5/(s*h-a*l),x=(h*u-a*p)*y,E=(s*p-l*u)*y;return x*x+E*E}function Ks(i,t,e,n){if(n-e<=20)for(let r=e+1;r<=n;r++){const o=i[r],s=t[o];let a=r-1;for(;a>=e&&t[i[a]]>s;)i[a+1]=i[a--];i[a+1]=o}else{let r=e+1,o=n;ja(i,e+n>>1,r),t[i[e]]>t[i[n]]&&ja(i,e,n),t[i[r]]>t[i[n]]&&ja(i,r,n),t[i[e]]>t[i[r]]&&ja(i,e,r);const s=i[r],a=t[s];for(;;){do r++;while(t[i[r]]<a);do o--;while(t[i[o]]>a);if(o<r)break;ja(i,r,o)}i[e+1]=i[o],i[o]=s,n-r+1>=o-e?(Ks(i,t,r,n),Ks(i,t,e,o-1)):(Ks(i,t,e,o-1),Ks(i,t,r,n))}}function ja(i,t,e){const n=i[t];i[t]=i[e],i[e]=n}function qT(i){return i[0]}function JT(i){return i[1]}function KT(i,t,e){let n=null;const r=new Cn.b;if(i.stopList.sort((s,a)=>s.pos-a.pos),!i.stopList.find(s=>s.pos===0)){const s=i.stopList[0];i.stopList.unshift({pos:0,color:s.color})}if(!i.stopList.find(s=>s.pos===1)){const s=i.stopList[i.stopList.length-1];i.stopList.push({pos:1,color:s.color})}const o=s=>{const a=[];for(let l=0,h=s.length;l<h-1;l++){const u=s[l],p=s[l+1],y=u.pos+.5*(p.pos-u.pos),x=Ga(u.color,p.color,.5),E=2*l;a[E]=u,a[E+1]={color:x,pos:y},a[E+2]=p}return a};if(i.stopList=o(i.stopList),i.stopList=o(i.stopList),n=i.line?jg(i,t,e):i.path?function(s,a,l){var h,u,p;const y=[],x={x:0,y:0};if(((h=s.path)===null||h===void 0?void 0:h.path)==="circle"||((u=s.path)===null||u===void 0?void 0:u.path)==="rect"||((p=s.path)===null||p===void 0?void 0:p.path)==="shape"){const E=a/2,w=l/2,C=Math.sqrt(E*E+w*w);s.stopList.forEach(j=>{if(j.pos===0)y.push({point:{x:0,y:0},color:j.color});else{const Z=C*j.pos,rt=new Fs;rt.absellipse(0,0,Z,Z,0,2*Math.PI,!1,0),rt.getPoints(50).forEach(ct=>{y.push({point:{x:ct.x,y:ct.y},color:j.color})})}x.x=E,x.y=w})}return{points:y,position:x}}(i,t,e):jg(i,t,e),n){const s=[],a=[],{position:l,points:h}=n,u=gc.from(h,w=>w.point.x,w=>w.point.y);for(let w=0;w<u.triangles.length;w+=3)s.push(h[u.triangles[w]].point.x,h[u.triangles[w]].point.y),s.push(h[u.triangles[w+1]].point.x,h[u.triangles[w+1]].point.y),s.push(h[u.triangles[w+2]].point.x,h[u.triangles[w+2]].point.y),a.push(...Er(h[u.triangles[w]].color)),a.push(...Er(h[u.triangles[w+1]].color)),a.push(...Er(h[u.triangles[w+2]].color));const p=new ce.l;p.addAttribute("aVertexPosition",s,2),p.addAttribute("aColor",a,4);const y=ce.r.from(`
        precision mediump float;
        attribute vec2 aVertexPosition;
        attribute vec4 aColor;
        uniform mat3 translationMatrix;
        uniform mat3 projectionMatrix;
        varying vec4 vColor;
        void main() {
            vColor = aColor;
            gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
        }`,`precision mediump float;    
        varying vec4 vColor;
        void main() {
            float alpha = vColor.a;
            vec4 color = vColor;
            color.a = 1.0;
            gl_FragColor = color * alpha;
        }
    `),x=new er;x.drawRect(0,0,t+1,e+1),r.mask=x,r.addChild(x);const E=new Vs.a(p,y);E.position.x=l.x,E.position.y=l.y,r.addChild(E)}return r}function jg(i,t,e){const n=t/2,r=e/2,o=[{x:-n,y:r},{x:-n,y:-r},{x:n,y:r},{x:n,y:-r}],s=[Vo.fromPointSlope({x:-n,y:0},Math.PI/2),Vo.fromPointSlope({x:0,y:r},0),Vo.fromPointSlope({x:n,y:0},Math.PI/2),Vo.fromPointSlope({x:0,y:-r},0)],a=[],l=i.stopList.slice(1,i.stopList.length-1).map(E=>{var w,C,j;const Z=2*Math.PI;let rt=(C=(w=i.line)===null||w===void 0?void 0:w.ang)!==null&&C!==void 0?C:0;for(;rt>Z;)rt-=Z;for(;rt<0;)rt+=Z;const ct={x:0,y:0};Tr(rt,Math.PI/2)?(ct.x=0,ct.y=e/2-E.pos*e):Tr(rt,0)?(ct.x=E.pos*t-t/2,ct.y=0):(ct.x=E.pos*t-t/2,ct.y=e/2-E.pos*e),rt>Math.PI/2&&rt<=Math.PI&&(ct.x*=-1),rt>Math.PI&&rt<=2*Math.PI&&(ct.y*=-1);const nt=Vo.fromPointSlope(ct,Math.PI/2-(((j=i.line)===null||j===void 0?void 0:j.ang)||0)),vt=s.map(mt=>nt.crossPoint(mt)).filter(mt=>mt&&mt.x<=n&&mt.x>=-n&&mt.y<=r&&mt.y>=-r).map(mt=>({point:mt,color:E.color})).sort((mt,jt)=>jt.point.y-mt.point.y);a.push(...vt);let ht=Math.abs(vt[1].point.x-vt[0].point.x)/10;for(let mt=20;mt--;){const jt=mt%2==0?1:-1,Ft=ct.x+jt*ht,Mt=nt.resolveY(Ft);Ft<=n&&Ft>=-n&&Mt<=r&&Mt>=-r&&a.push({point:{x:Ft,y:Mt},color:E.color}),ht+=ht}return nt});let h=[],u=[];t:for(let E=0;E<o.length;E++){const w=o[E];for(let ct=0;ct<l.length-1;ct++){const nt=l[ct],vt=l[ct+1],ht=nt.distanceToLinearEquation(vt),mt=nt.distanceToPoint(w),jt=vt.distanceToPoint(w);if(mt<ht&&jt<ht){const Ft=i.stopList.slice(1,i.stopList.length-1)[ct],Mt=i.stopList.slice(1,i.stopList.length-1)[ct+1],wt=Ga(Ft.color,Mt.color,mt/ht);a.splice(ct+1,0,{point:w,color:wt});continue t}}const C=l[0],j=l[l.length-1],Z=C.distanceToPoint(w),rt=j.distanceToPoint(w);Z<=rt?h.push({point:w,dis:Z}):u.push({point:w,dis:rt})}h=h.sort((E,w)=>w.dis-E.dis);const p=h.map((E,w)=>{if(w===0)return{point:E.point,color:i.stopList[0].color};{const C=i.stopList[0].color,j=i.stopList[1].color;return{point:E.point,color:Ga(C,j,1-(h[0].dis===0?1:E.dis/h[0].dis))}}}).sort((E,w)=>w.point.y-E.point.y);u=u.sort((E,w)=>w.dis-E.dis);const y=u.map((E,w)=>{if(w===0)return{point:E.point,color:i.stopList[i.stopList.length-1].color};{const C=i.stopList[i.stopList.length-2].color,j=i.stopList[i.stopList.length-1].color;return{point:E.point,color:Ga(C,j,u[0].dis===0?0:E.dis/u[0].dis)}}}).sort((E,w)=>w.point.y-E.point.y),x=p.concat(...a).concat(y);for(let E=0;E<x.length;E++)x[E].point.x+=n,x[E].point.y=-x[E].point.y+r;return{points:x,position:{x:0,y:0}}}const ch=`
vec3 rgb2hsl(vec3 rgb) {
    float cMax = max(max(rgb.r, rgb.g), rgb.b);
    float cMin = min(min(rgb.r, rgb.g), rgb.b);
    float delta = cMax - cMin;
    
    float h = 0.0;
    if (delta == 0.0) {
        h = 0.0;
    } else if (cMax == rgb.r) {
        h = 60.0 * mod(((rgb.g - rgb.b) / delta), 6.0);
    } else if (cMax == rgb.g ) {
        h = 60.0 * ((rgb.b - rgb.r) / delta + 2.0);
    } else if (cMax == rgb.b) {
        h = 60.0 * ((rgb.r - rgb.g) / delta + 4.0);
    }
    
    float l = (cMax + cMin) / 2.0;
    
    float s = 0.0;
    if (delta == 0.0) {
        s = 0.0;
    } else {
        s = delta / (1.0 - abs(2.0 * l - 1.0));
    }
    
    return vec3(h, s, l);
}
`,ZT=[ch],QT={biLevel:`
vec4 transform(vec4 texColor, float arg) {
    mat3 rgb2yuv = mat3(
        0.2126, 0.7152, 0.0722,
        -0.09991, -0.33609, 0.43600,
        0.615, -0.5586, -0.05639
    );
    vec3 yuv = texColor.rgb * rgb2yuv;
    if (yuv.x >= 0.49 || texColor.a < 0.9) {
        return vec4(1.0, 1.0, 1.0, 1.0) * texColor.a;
    } else {
        return vec4(0.0, 0.0, 0.0, 1.0) * texColor.a;
    }
}
`,alphaModFix:`
vec4 transform(vec4 texColor, float arg) {
   return texColor * arg;
}
`,alphaBiLevel:`
vec4 transform(vec4 texColor, float arg) {
    vec4 result = vec4(texColor);
    result.rgb = result.rgb / texColor.a;
    if (texColor.a < arg) {
        result.a = 0.0;
    } else {
        result.a = 1.0;
    }
    return result;
}
`,alphaCeiling:`
vec4 transform(vec4 texColor, float arg) {
    vec4 result = vec4(texColor);
    result.rgb = result.rgb / texColor.a;
    if (texColor.a > 0.0) {
        result.a = 1.0;
    }
    return result;
}
`,alphaFloor:`
vec4 transform(vec4 texColor, float arg) {
    vec4 result = vec4(texColor);
    result.rgb = result.rgb / texColor.a;
    if (texColor.a < 1.0) {
        result.a = 0.0;
    }
    return result;
}
`,grayscl:`
vec4 transform(vec4 texColor, float arg) {
    float avg = (texColor.r + texColor.g + texColor.b) / 3.0;
    return vec4(avg, avg, avg, texColor.a);
}
`};class $T extends ce.k{constructor(t,e){var n;super(void 0,(n=QT[t],`
varying vec2 vTextureCoord;

uniform float arg;
uniform sampler2D uSampler;

${ZT.map(r=>r+`
`).join(`
`)}

${n}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg);
}
`),{arg:e})}}const tE=[ch],eE={clrChange:`
vec4 transform(vec4 texColor, vec4 arg1, vec4 arg2) {
    float epsilon = 0.001;
    vec3 colorDiff = arg1.rgb - (texColor.rgb / max(texColor.a, 0.0000000001));
    float colorDistance = length(colorDiff);
    if (colorDistance < epsilon) {
        arg2.rgb *= arg2.a;
        return arg2;
    } else {
        return texColor;
    }
}
`,changeBulletColor:`
vec4 transform(vec4 texColor, vec4 arg1, vec4 arg2) {
    if (texColor.a == 0.0) {
        return texColor;
    } else {
        return arg2;
    }
}
`,duotone:`
vec4 transform(vec4 texColor, vec4 arg1, vec4 arg2) {
    float avg = (texColor.r + texColor.g + texColor.b) / 3.0;

    vec3 hsl = rgb2hsl(vec3(avg, avg, avg));

    vec3 result = arg2.rgb * hsl.z + arg1.rgb * (1.0 - hsl.z);

    return vec4(result * texColor.a, texColor.a);
}
`};class nE extends ce.k{constructor(t,e,n){var r;super(void 0,(r=eE[t],`
varying vec2 vTextureCoord;

uniform vec4 arg1;
uniform vec4 arg2;
uniform sampler2D uSampler;

${tE.map(o=>o+`
`).join(`
`)}

${r}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg1, arg2);
}
`),{arg1:Float32Array.from(e),arg2:Float32Array.from(n)})}}const iE=[ch],rE={lum:`
vec4 transform(vec4 texColor, float arg1, float arg2) {
    vec3 rgb = texColor.rgb / texColor.a;

    // \u5BF9\u6BD4\u5EA6
    highp float C = arg2 * 255.0;
    highp float F = (259.0 * (255.0 + C)) / (255.0 * (259.0 - C));
    rgb.rgb = F * (rgb.rgb - 0.5) + 0.5;

    // \u4EAE\u5EA6
    rgb.rgb += arg1;

    rgb.rgb *= texColor.a;
    return vec4(rgb, texColor.a);
}
`};class oE extends ce.k{constructor(t,e,n){var r;super(void 0,(r=rE[t],`
varying vec2 vTextureCoord;

uniform float arg1;
uniform float arg2;
uniform sampler2D uSampler;

${iE.map(o=>o+`
`).join(`
`)}

${r}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg1, arg2);
}
`),{arg1:e,arg2:n})}}const sE=[ch],aE={alphaInv:`
vec4 transform(vec4 texColor, vec4 arg1) {
    float alpha = 1.0 - texColor.a;
    arg1.rgb = arg1.rgb * alpha;
    arg1.a = alpha;
    return arg1;
}
`};class lE extends ce.k{constructor(t,e){var n;super(void 0,(n=aE[t],`
varying vec2 vTextureCoord;

uniform vec4 arg1;
uniform sampler2D uSampler;

${sE.map(r=>r+`
`).join(`
`)}

${n}

void main(void){
    vec4 texColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = transform(texColor, arg1);
}
`),{arg1:Float32Array.from(e)})}}function zg(i,t){const e=[];return i.forEach(n=>{const r=((t==null?void 0:t.filter)||[]).indexOf(n.type)>=0;if(["biLevel","alphaBiLevel","alphaCeiling","alphaModFix","alphaFloor","grayscl"].indexOf(n.type)>=0&&r)e.push(new $T(n.type,n.args[0]||0));else if(["clrChange","changeBulletColor","duotone"].indexOf(n.type)>=0&&r){const o=Er(n.args[0]),s=Er(n.args[1]);e.push(new nE(n.type,o,s))}else if(n.type==="lum"&&r)e.push(new oE(n.type,n.args[0],n.args[1]));else if(n.type==="alphaInv"&&r){const o=Er(n.args[0]);e.push(new lE(n.type,o))}}),e}class mo{constructor(t,e,n,r,o){this.ctx=t,this.fillStyle=e,this.width=n,this.height=r,this.config=o,this.clonedObjects=[],this._displayObject=null,this.gradientHash=sh()(`${JSON.stringify(e)}${Math.ceil(n)}${Math.ceil(r)}`)}get displayObject(){return this._displayObject||(this._displayObject=this.createDisplayObject()),this._displayObject}set displayObject(t){this._displayObject&&this._displayObject.destroy({children:!0,texture:!0}),this._displayObject=t}get hasFill(){return!!this.fillStyle&&this.fillStyle.fillType!=="noFill"}createDisplayObject(){var t;if(!this.fillStyle)return null;if(this.config.useSlideBackgroundFill&&this.ctx.bgTexture){const e=new pi;return e.texture=this.ctx.bgTexture,e}if(this.fillStyle.fillType==="solidFill"||this.fillStyle.fillType==="noFill")return null;if(this.fillStyle.fillType==="gradientFill"){const e=new pi,n=KT(JSON.parse(JSON.stringify(this.fillStyle)),this.width,this.height),r=ce.p.create({width:this.width,height:this.height,resolution:this.ctx.renderer.resolution});return this.ctx.renderer.render(n,{renderTexture:r}),n.destroy({children:!0,texture:!0}),e.texture=r,e}if(this.fillStyle.fillType==="blipFill"){const{src:e,filters:n}=this.fillStyle,r=this.ctx.spriteTexture.getTexture(e),o=this.ctx.spriteTexture.getFrameData(e);if(r){const s=new pi;if(s.texture=r,n.length>0&&this.config.useFilter&&(this.ctx.featureList||{}).filter&&(s.filters=zg(n,this.ctx.featureList)),this.config.fillFloat){const{l:a,t:l,r:h,b:u}=this.config.fillFloat.fillRect,p=this.width*(1-a-h),y=this.height*(1-l-u),x=(t=this.config.shapeRotation)!==null&&t!==void 0?t:0,E=new er;E.drawRect(0,0,p,y),E.pivot.x=p/2,E.pivot.y=y/2,E.rotation=x;const w=E.getBounds(),C=w.width,j=w.height;s.width=C,s.height=j,s.anchor.x=.5,s.anchor.y=.5,s.rotation=-1*x,s.name="math-texture",x===0?(s.position.x=C/2+a*this.width,s.position.y=j/2+l*this.height):(s.position.x=this.width/2,s.position.y=this.height/2)}else s.width=this.width,s.height=this.height,o.rotate&&(s.position.x=this.width/2,s.position.y=this.height/2,s.anchor.x=.5,s.anchor.y=.5,s.rotation=o.rotate/180*Math.PI);return s}}else if(this.fillStyle.fillType==="gifFill"){const{src:e,delays:n,filters:r}=this.fillStyle,o=this.ctx.spriteTexture.getGifFrames(e).map((h,u)=>({texture:h,time:n[u]||20})),s=new lc(o,!0);s.name=cs(),s.width=this.width,s.height=this.height,r.length>0&&this.config.useFilter&&(this.ctx.featureList||{}).filter&&(s.filters=zg(r,this.ctx.featureList));const a=this.fillStyle.loop;let l=1;return s.onLoop=()=>{l+=1,a>0&&l>a&&s.gotoAndStop(s.totalFrames)},s}return null}isSolidFill(){var t;return((t=this.fillStyle)===null||t===void 0?void 0:t.fillType)==="solidFill"}getSolidFillColor(){var t;return((t=this.fillStyle)===null||t===void 0?void 0:t.fillType)==="solidFill"?this.fillStyle.color:"#000000"}getClonedDisplayObject(){const t=this.createDisplayObject();return this.clonedObjects.push(t),t}destroy(){var t;(t=this._displayObject)===null||t===void 0||t.destroy(),this._displayObject=null,this.clonedObjects.forEach(e=>{e==null||e.destroy()}),this.clonedObjects=[]}}class _c extends ce.k{}var hE=v(113),uE=v.n(hE),cE=v(114),dE=v.n(cE);class pE extends _c{constructor(t){super(uE.a,dE.a,{uShapeFilterArea:new Float32Array([0,0,0,0]),uGlowColor:Er(t.color),uSdfSampler:ce.t.WHITE,uSdfReady:0,uSdfMaxDis:0,uRad:t.rad/2,uSdfPosition:new Float32Array([0,0])}),this.priority=3,this.json=t}filterAreaJustify(t){const e=Math.ceil(this.json.rad),n=Math.ceil(t.width+2*e),r=Math.ceil(t.height+2*e);return new De.j(t.x-e,t.y-e,n,r)}sdfBox(t,e){const n=Math.ceil(this.json.rad),r=Math.ceil(t+2*n),o=Math.ceil(e+2*n);return new De.j(n,n,r,o)}}var fE=v(19),dh=v.n(fE),mE=v(115),gE=v.n(mE);class vE extends _c{constructor(t){super(dh.a,gE.a,{uShapeFilterArea:new Float32Array([0,0,0,0]),uRad:t.rad,uSdfSampler:ce.t.WHITE,uSdfReady:0,uSdfMaxDis:1}),this.priority=2,this.json=t}filterAreaJustify(t){return t}sdfBox(t,e){return new De.j(0,0,t,e)}}class Vg{}var _E=v(116),yE=v.n(_E);class xE extends ce.k{constructor(t){super(dh.a,yE.a,{uColor:Er(t)})}}class bE extends Vg{constructor(t,e,n){super(),this.order=1,this.outputTexture=ce.t.WHITE,this.frameTextures=[],this.json=t,this.effectContainer=e,this.outputSprite=new pi,this.targetScale=n,this.outputSprite.scale.x=this.json.sx,this.outputSprite.scale.y=this.json.sy,this.outputSprite.skew.x=(this.targetScale.x>0?1:-1)*this.json.kx,this.outputSprite.skew.y=(this.targetScale.y>0?1:-1)*this.json.ky,this.outputSprite.filters=[new Xs.BlurFilter(this.json.blurRad/2,4),new xE(this.json.color)]}updateFrame(t){const e=this.frameTextures[t];if(e){const n=this.effectContainer.getBounds(),r=(this.effectContainer.width-e.width)/2,o=(this.effectContainer.height-e.height)/2,s=new De.g(n.x,n.y),a=new De.g(n.x,n.y);switch(this.json.align){case"tl":a.x=n.x,a.y=n.y;break;case"t":a.x=n.x+n.width/2,a.y=n.y,s.x+=n.width/2;break;case"tr":a.x=n.x+n.width,a.y=n.y,s.x+=n.width;break;case"l":a.x=n.x,a.y=n.y+n.height/2,s.y+=n.height/2;break;case"ctr":a.x=n.x+n.width/2,a.y=n.y+n.height/2,s.x+=n.width/2,s.y+=n.height/2;break;case"r":a.x=n.x+n.width,a.y=n.y+n.height/2,s.x+=n.width,s.y+=n.height/2;break;case"bl":a.x=n.x,a.y=n.y+n.height,s.y+=n.height;break;case"b":a.x=n.x+n.width/2,a.y=n.y+n.height,s.x+=n.width/2,s.y+=n.height;break;case"br":a.x=n.x+n.width,a.y=n.y+n.height,s.x+=n.width,s.y+=n.height}const l=this.effectContainer.toLocal(a);this.outputSprite.pivot.x=l.x,this.outputSprite.pivot.y=l.y;const h=new De.g(this.json.dist,0),u=new De.d;u.rotate(this.json.dir),u.translate(s.x+r,s.y+o),u.apply({x:h.x,y:h.y},h);const p=this.effectContainer.toLocal(h);this.outputSprite.position.x=p.x,this.outputSprite.position.y=p.y,this.outputSprite.texture=e}}createOutput(t,e){this.frameTextures[e]=t}setFrameOffset(t,e){}}var TE=v(117),EE=v.n(TE);class SE extends ce.k{constructor(t,e){super(dh.a,EE.a,{uStartAlpha:t.startAlpha,uEndAlpha:t.endAlpha,uStartPos:t.startPos,uEndPos:t.endPos,uHeight:e}),console.log(this)}}class wE extends Vg{constructor(t,e,n,r,o){super(),this.order=2,this.outputSprite=new pi,this.outputTexture=ce.t.WHITE,this.frameTextures=[],this.json=t,this.shapeScaleX=r,this.effectContainer=e,this.rotation=n,this.ctx=o,this.outputSprite.anchor.x=.5,this.outputSprite.anchor.y=.5;const s=this.effectContainer.getBounds();this.outputSprite.filters=[new Xs.BlurFilter(this.json.blurRad/2,4),new SE(this.json,s.height)],this.outputSprite.alpha=.5,this.outputSprite.rotation=this.shapeScaleX===-1?Math.PI+2*this.rotation:Math.PI-2*this.rotation,this.outputSprite.scale.x=-1}updateFrame(t){const e=this.frameTextures[t];e&&(this.outputSprite.texture=e)}createOutput(t,e){this.frameTextures[e]=t}setFrameOffset(t,e){const n=this.effectContainer.getBounds(),r=new De.g(n.x+n.width/2,n.y+n.height/2),o=new De.g(r.x,r.y+n.height+this.json.dist),s=this.effectContainer.toLocal(o);this.outputSprite.position.x=s.x+t,this.outputSprite.position.y=s.y+e}}var AE=v(118),ME=v.n(AE);class CE extends _c{constructor(t){super(dh.a,ME.a,{}),this.priority=1,this.json=t}filterAreaJustify(t){return t}sdfBox(){return null}}var Wg=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Xg extends xi.a{constructor(t,e,n,r,o,s){super(),this.effects=[],this.attachs=[],this.frames=new Map,this._targetContainer=new Cn.b,this.frameCount=1,this.ctx=r,this.originWidth=t.width,this.originHeight=t.height,this.cacheKey=n,this.sourceSprite=new pi;for(const x of e)switch(x.type){case"innerShadow":this.effects.push(new CE(x));break;case"softEdge":this.effects.push(new vE(x));break;case"glow":this.effects.push(new pE(x));break;case"reflection":this.attachs.push(new wE(x,t,o,s.x,this.ctx));break;case"outerShadow":this.attachs.push(new bE(x,t,s))}this.effects=this.effects.sort((x,E)=>x.priority-E.priority),this.attachs=this.attachs.sort((x,E)=>x.order-E.order);for(const x of this.attachs)this._targetContainer.addChild(x.outputSprite);this.sourceSprite.name="effect-sprite";const a=new De.j(0,0,this.originWidth,this.originHeight),l=this.effects.map(x=>x.filterAreaJustify(a)),h=l.map(x=>x.x),u=l.map(x=>x.y),p=l.map(x=>x.width),y=l.map(x=>x.height);this.filterArea=new De.j(Math.min(...h,0),Math.min(...u,0),Math.max(...p,this.originWidth),Math.max(...y,this.originHeight)),this.sourceSprite.filters=this.effects,this.sourceSprite.filterArea=new De.j(0,0,this.filterArea.width,this.filterArea.height),this._targetSprite=new pi,this._targetSprite.name="effect-sprite",this._targetContainer.sortableChildren=!0,this._targetSprite.zIndex=999,this._targetContainer.addChild(this._targetSprite)}get container(){return this._targetContainer}getSdfTexture(t,e){return Wg(this,void 0,void 0,function*(){const n=`${this.cacheKey}_${t}`,r=this.effects.map(o=>({sdfRect:o.sdfBox(e.width,e.height)})).reduce((o,s)=>(s.sdfRect&&(o.width<s.sdfRect.width&&(o.width=s.sdfRect.width),o.height<s.sdfRect.height&&(o.height=s.sdfRect.height)),o),new De.j(0,0));return r.width===0||r.height===0?null:this.ctx.sdfManager.getSdf(e,r,n)})}setFrameCount(t){this.frameCount=t}updateFrame(t){const e=this.frames.get(t);if(e){this._targetSprite.texture=e.texture,this._targetSprite.pivot.x=e.pivotX,this._targetSprite.pivot.y=e.pivotY;for(const n of this.attachs)n.updateFrame(t)}}hasFrame(t){return this.frames.has(t)}setFrameOffset(t,e){this._targetContainer.position.x=-1*t,this._targetContainer.position.y=-1*e,this.attachs.forEach(n=>n.setFrameOffset(t,e))}createFrame(t,e){var n,r;return Wg(this,void 0,void 0,function*(){const o=e.width,s=e.height;if(this.frames.has(t))return;const a=yield this.getSdfTexture(t,e),l=(n=a==null?void 0:a.texture.width)!==null&&n!==void 0?n:0,h=(r=a==null?void 0:a.texture.height)!==null&&r!==void 0?r:0;for(const w of this.effects){const C=w.sdfBox(e.width,e.height);C&&a&&(w.uniforms.uSdfSampler=a.texture,w.uniforms.uSdfIsReady=1,w.uniforms.uSdfMaxDis=a.maxDis,w.uniforms.uSdfPosition=new Float32Array([(a.texture.width-C.width)/2/a.texture.width,(a.texture.height-C.height)/2/a.texture.height])),w.uniforms.uShapeFilterArea=new Float32Array([0,0,this.filterArea.width,this.filterArea.height])}this.sourceSprite.texture=e;const u=(this.filterArea.width-this.sourceSprite.width)/2,p=(this.filterArea.height-this.sourceSprite.height)/2;this.sourceSprite.x=u,this.sourceSprite.y=p;const y=Math.max(o,l,this.filterArea.width),x=Math.max(s,h,this.filterArea.height),E=ce.p.create({width:y,height:x,resolution:this.ctx.renderer.resolution});this.ctx.renderer.render(this.sourceSprite,{renderTexture:E}),this.frames.set(t,{texture:E,pivotX:-1*(this.originWidth-y)/2,pivotY:-1*(this.originWidth-y)/2});for(const w of this.attachs)w.createOutput(E,t);Array.from(this.frames.keys()).length===this.frameCount&&this.emit("ready")})}}var Yg=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class RE extends fc{constructor(t,e,n){var r;super(t,e,n),this.textureContainer=new Cn.b,this.underline=null,this.cacheSprite=new pi,this.effectContainer=new Cn.b,this.effectObject=null;const{shapeId:o,paragraphIndex:s,lineIndex:a,unitIndex:l,lineHeight:h,width:u,underLine:p,fill:y,height:x,isHorz:E,lineWidth:w}=t,C=((r=y==null?void 0:y.fill)===null||r===void 0?void 0:r.fillType)==="solidFill"?y.fill.color:null;if(p){const j=E?h/16:w/16;this.underline=new VT(e,p.type,j,u,x,C,E,o,s,a,l)}if(this.textGraphics=this.createTextGraphics(),this.textFill=this.createTextFill(),this.strokeGraphics=this.createStrokeGraphics(),this.strokeFill=this.createStrokeFill(),this.effectContainer.name="effect-container",this.effectContainer.zIndex=1,this.container.addChild(this.effectContainer),t.effectIndexList&&t.effectIndexList.length&&n.effectList){const{effectList:j}=n;this.effectList=t.effectIndexList.map(Z=>{const rt=j[Z];return rt.type==="outerShadow"&&rt.dist>5&&(rt.dist=5),j[Z]}),this.ctx.slideScopeEventHub.once("slide-render",Z=>{if(this.ctx.slideIndex===Z&&this.effectObject){const rt=this.getEffectTexture();if(rt){const{texture:ct,offsetX:nt,offsetY:vt}=rt;this.effectObject.setFrameOffset(nt,vt),this.effectObject.createFrame(1,ct)}}})}}getEffectTexture(){const{lineHeight:t,fillLineHeight:e,isHorz:n,lineWidth:r}=this.json,o=this.effectContainer.getLocalBounds();let s=0,a=0;for(const u of this.effectContainer.children)u.pivot.x>s&&(s=u.pivot.x),u.pivot.y>a&&(a=u.pivot.y);const l=new De.d;l.translate(s,a);const h=ce.p.create({width:n?o.width:r,height:n?Math.max(e,t):o.height,resolution:2});return this.ctx.renderer.render(this.effectContainer,{renderTexture:h,transform:l}),{texture:h,offsetX:s,offsetY:a}}createStrokeFill(){const{stroke:t,lineWidth:e,lineHeight:n}=this.json;return new mo(this.ctx,t==null?void 0:t.fill,e,n,{useFilter:!1,useSlideBackgroundFill:!1})}createStrokeGraphics(){const{stroke:t}=this.json,e=t!=null&&t.key?{fillType:"blipFill",src:t.key,filters:[]}:void 0;return new mo(this.ctx,e,(t==null?void 0:t.width)||0,(t==null?void 0:t.height)||0,{useFilter:!1,useSlideBackgroundFill:!1})}createTextFill(){const{isHorz:t,fill:e,lineWidth:n,lineHeight:r,fillLineHeight:o}=this.json;return t?new mo(this.ctx,e==null?void 0:e.fill,n,Math.max(o,r),{useFilter:!1,useSlideBackgroundFill:!1}):new mo(this.ctx,e==null?void 0:e.fill,o,r,{useFilter:!1,useSlideBackgroundFill:!1})}createTextGraphics(){var t;const{fill:e,content:n}=this.json;let r="#000000";((t=e==null?void 0:e.fill)===null||t===void 0?void 0:t.fillType)==="solidFill"&&(r=e.fill.color);const o=e!=null&&e.key?{fillType:"blipFill",src:e.key,filters:[{type:"changeBulletColor",args:["#000000",r]}]}:void 0;return new mo(this.ctx,o,(e==null?void 0:e.width)||0,(e==null?void 0:e.height)||0,{useFilter:n==="\u25FE",useSlideBackgroundFill:!1})}getIterateEntry(){return null}getBgElement(){return null}updateTransform(t){var e,n,r,o;const{isHorz:s}=this.json;t.position={x:s&&(n=(e=t.position)===null||e===void 0?void 0:e.x)!==null&&n!==void 0?n:0,y:s?0:(o=(r=t.position)===null||r===void 0?void 0:r.y)!==null&&o!==void 0?o:0},t.width=s?this.json.width:this.json.lineWidth,t.height=s?this.json.lineHeight:this.json.height,super.updateTransform(t)}preRender(){var t;(t=this.underline)===null||t===void 0||t.preRender()}render(t){t.addSubMTask(()=>Yg(this,void 0,void 0,function*(){this.doRender()}),"@TextUnitImpl[doRender]"),t.addSubMTask(()=>Yg(this,void 0,void 0,function*(){var e;if(this.effectList&&this.effectList.length>0){const n=`${this.ctx.taskId}_${this.ctx.slideIndex}_${(e=this.json.fill)===null||e===void 0?void 0:e.key}_${this.json.effectIndexList}`;this.effectObject=new Xg(this.effectContainer,this.effectList,n,this.ctx,0,new De.g(1,1)),this.effectObject.on("ready",()=>{var r;this.effectContainer.visible=!1,this.effectObject.container.zIndex=10,this.container.addChild(this.effectObject.container),(r=this.effectObject)===null||r===void 0||r.updateFrame(1)})}}),"@ShapeImpl[post.render]")}doRender(){let t=!1;const{lineWidth:e,lineHeight:n,baseLine:r,isHorz:o,underline:s,height:a,width:l,highlightColor:h,x:u,y:p,content:y,fillLineHeight:x,fill:E}=this.json;let w=this.json.needFill!==!1;if(E&&E.fill&&E.fill.fillType!=="solidFill"&&(w=!0),h){const C=new er,[j,Z]=Og(h);C.beginFill(j,Z),C.drawRect(0,0,o?l:e,o?n:a),C.endFill(),this.textureContainer.addChild(C)}if(this.textGraphics.displayObject){const C=this.textGraphics.displayObject;if(o&&(C.position.y=p>0?p:0),w){const j=this.textFill.displayObject;if(j)j.mask=C,j.addChild(C),j.position.x=-u,C.position.x+=u,t=!0,this.textureContainer.addChild(j);else if(this.textFill.isSolidFill()){const Z=new ds;Z.color=this.textFill.getSolidFillColor(),C.filters=[Z],t=!0,this.textureContainer.addChild(C)}}else this.textureContainer.addChild(C)}if(this.strokeGraphics.displayObject){const C=this.strokeGraphics.displayObject;if(w){const j=this.strokeFill.displayObject;if(j)j.mask=C,j.addChild(C),o?j.position.y=p>0?p:0:j.position.x=u,this.textureContainer.addChild(j);else if(this.strokeFill.isSolidFill()){o?C.position.y=p>0?p:0:C.position.x=u;const Z=new ds;Z.color=this.strokeFill.getSolidFillColor(),C.filters=[Z],t=!0,this.textureContainer.addChild(C)}}else o?C.position.y=p>0?p:0:C.position.x=u,this.textureContainer.addChild(C)}if(this.underline&&(this.underline.render(),this.underline.sprite)){o?(this.underline.sprite.position.y=s?s-n/16:r,this.underline.sprite.position.x=0):(this.underline.sprite.position.x=0,this.underline.sprite.position.y=0);const C=this.textFill.getClonedDisplayObject();C?(C.mask=this.underline.sprite,C.addChild(this.underline.sprite),this.textureContainer.addChild(C)):this.textureContainer.addChild(this.underline.sprite)}if(t){const C=ce.p.create({width:o?l:e,height:o?Math.max(x,n):a,resolution:this.ctx.renderer.resolution});this.ctx.renderer.render(this.textureContainer,{renderTexture:C}),this.cacheSprite.texture=C,o&&p<0&&(this.cacheSprite.position.y=p),this.effectContainer.addChild(this.cacheSprite)}else this.effectContainer.addChild(this.textureContainer);this.container.name=y}destroy(){this.textFill.destroy(),this.textGraphics.destroy(),this.strokeFill.destroy(),this.strokeGraphics.destroy(),this.cacheSprite.texture.destroy(!0),this.cacheSprite.destroy(),this.textureContainer.destroy(),this.container.destroy()}}var qg=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class IE extends fc{constructor(t,e,n){super(t,e,n),this.units=[],this.isHorz=!0,this.hyperLinkMap=new Map,this.hyperLinkContainerMap=new Map,this.effectList=[],n.effectList&&(this.effectList=n.effectList)}getIterateElements(){return this.units}getIterateEntry(t,e,n){return this.units[e]?this.units[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}preRender(){}createUnits(t,e,n,r){for(let o=0,s=this.json.textUnits.length;o<s;o++)r.addSubMTask(()=>qg(this,void 0,void 0,function*(){const a=this.json.textUnits[o],{height:l,width:h,fillHeight:u,baseline:p,y,underline:x}=this.json,E=new RE(Object.assign(Object.assign({},a),{lineHeight:l,lineWidth:h,baseLine:p-y,underline:x,fillLineHeight:u||l,isHorz:this.isHorz,shapeId:t,paragraphIndex:e,lineIndex:n,unitIndex:o}),this.ctx,{parentGlobalPos:this.global,effectList:this.effectList});if(E.preRender(),this.units.push(E),a.hyperlink||a.hlinkHover){const w=new Pg(E.container,this.ctx);a.hyperlink&&w.addAction(a.hyperlink,"click"),a.hlinkHover&&w.addAction(a.hlinkHover,"hover"),this.container.sortableChildren=!0}}),"@TextLineImpl[createUnits]")}render(t){for(const e of this.units.reverse())e.render(t),t.addSubMTask(()=>qg(this,void 0,void 0,function*(){this.container.addChild(e.container)}),"@TextLineImpl[container.addChild]")}destroy(){this.units.forEach(t=>{t.destroy()}),this.container.destroy({children:!1}),this.hyperLinkMap.clear();for(const t of this.hyperLinkContainerMap.values())t.destroy({children:!0,baseTexture:!0,texture:!0});this.hyperLinkContainerMap.clear()}}var Jg=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class PE extends fc{constructor(t,e,n){super(t,e,n),this.iterateElements=[],this.lines=[],this.effectList=[],this.isHorz=!0,n.effectList&&(this.effectList=n.effectList)}getIterateElements(){if(this.iterateElements.length>0)return this.iterateElements;const t=this.lines.reduce((e,n)=>e=e.concat(n.getIterateElements()),[]);return this.iterateElements=t,t}getIterateEntry(t,e,n){const r=this.getIterateElements();return r[e]?r[e]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}preRender(){}createLines(t,e,n){for(let r=0,o=this.json.lines.length;r<o;r++)n.addSubMTask(()=>Jg(this,void 0,void 0,function*(){const s=this.json.lines[r],a=new IE(s,this.ctx,{parentGlobalPos:this.global,effectList:this.effectList});a.isHorz=this.isHorz,a.container.name="line-"+r,a.createUnits(t,e,r,n),this.lines.push(a)}),"@TextParagraphImpl[createLines]")}render(t){for(const e of this.lines)e.render(t),t.addSubMTask(()=>Jg(this,void 0,void 0,function*(){this.container.addChild(e.container)}),"@TextParagraphImpl[container.addChild]")}destroy(){this.lines.forEach(t=>{t.destroy()}),this.container.destroy({children:!1})}}function OE(i,t,e){let n,r;const o=Math.round(i)%360;if(o%180==0)n=Math.cos(o*(Math.PI/180))*t,r=0;else if(o%90==0)n=0,r=-Math.sin(o*(Math.PI/180))*e;else{const s=Math.tan(o*Math.PI/180);n=t*e/Math.sqrt(Math.pow(e,2)+Math.pow(t*s,2)),(o>90&&o<270||o<-90&&o>-270)&&(n=-n),r=-s*n}return{x:n,y:r}}function NE(i,t,e,n,r,o){const s=OE((r=-r)/Math.PI*180,e,n),a=i.x-s.x,l=i.y-s.y;return{centerX:a/9525*t.x,centerY:l/9525*t.y,rx:e/9525*t.x,ry:n/9525*t.y,st:-r,end:-r+o,aClockWise:o<0}}function Kg(i){const t=new Fs,{scale:e}=i;let n={x:0,y:0};const r=i.path.trim().split(" ");for(let o=0;o<r.length;o+=2){const s=r[o],a=r[o+1];if(s==="M"){let[l,h]=a.split(",").map(u=>Number(u));n={x:l,y:h},l=l/9525*e.x,h=h/9525*e.y,t.moveTo(l,h)}else if(s==="A"){const[l,h,u,p]=a.split(",").map(rt=>Number(rt)),{centerX:y,centerY:x,rx:E,ry:w,st:C,end:j,aClockWise:Z}=NE(n,e,l,h,u,p);t.absellipse(y,x,E,w,C,j,Z,0)}else if(s==="L"){let[l,h]=a.split(",").map(u=>Number(u));n={x:l,y:h},l=l/9525*e.x,h=h/9525*e.y,t.lineTo(l,h)}else if(s==="QB"){let[l,h,u,p]=a.split(",").map(y=>Number(y));n={x:u,y:p},l=l/9525*e.x,h=h/9525*e.y,u=u/9525*e.x,p=p/9525*e.y,t.quadraticCurveTo(l,h,u,p)}else if(s==="CB"){let[l,h,u,p,y,x]=a.split(",").map(E=>Number(E));n={x:y,y:x},l=l/9525*e.x,h=h/9525*e.y,u=u/9525*e.x,p=p/9525*e.y,y=y/9525*e.x,x=x/9525*e.y,t.bezierCurveTo(l,h,u,p,y,x)}else if(s==="C")try{t.closePath()}catch{}}return t}function Un(i,t){return i.curves.map(e=>e.getPoints(t)).reduce((e,n)=>e.concat(n),[])}const yc={textCirclePour:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textStop:{top:i=>Un(i,100),bottom:i=>Un(i,100)},textPlain:{top:i=>Un(i,100),bottom:i=>Un(i,100)},textTriangle:{top:i=>Un(i,50),bottom:i=>Un(i,101)},textTriangleInverted:{bottom:i=>Un(i,50),top:i=>Un(i,101)},textChevron:{bottom:i=>Un(i,50),top:i=>Un(i,50)},textChevronInverted:{bottom:i=>Un(i,50),top:i=>Un(i,50)},textRingInside:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textRingOutside:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textArchUpPour:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textArchDownPour:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCurveUp:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCurveDown:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCanUp:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textCanDown:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textWave1:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textWave2:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textDoubleWave1:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textWave4:{top:i=>i.getPoints(360),bottom:i=>i.getPoints(360)},textInflate:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textDeflate:{top:i=>i.getPoints(180),bottom:i=>i.getPoints(180)},textInflateBottom:{top:i=>Un(i,180),bottom:i=>i.getPoints(180)},textDeflateBottom:{top:i=>Un(i,180),bottom:i=>i.getPoints(180)},textInflateTop:{bottom:i=>Un(i,180),top:i=>i.getPoints(180)},textDeflateTop:{bottom:i=>Un(i,180),top:i=>i.getPoints(180)},textFadeRight:{bottom:i=>Un(i,180),top:i=>Un(i,180)},textFadeLeft:{bottom:i=>Un(i,180),top:i=>Un(i,180)},textFadeUp:{bottom:i=>Un(i,180),top:i=>Un(i,180)},textFadeDown:{bottom:i=>Un(i,180),top:i=>Un(i,180)},textSlantUp:{bottom:i=>Un(i,180),top:i=>Un(i,180)},textSlantDown:{bottom:i=>Un(i,180),top:i=>Un(i,180)},textCascadeUp:{bottom:i=>Un(i,180),top:i=>Un(i,180)},textCascadeDown:{bottom:i=>Un(i,180),top:i=>Un(i,180)},textArchUp:{bottom:i=>Un(i,180),top:i=>Un(i,180)},textArchDown:{bottom:i=>Un(i,180),top:i=>Un(i,180)},textCircle:{bottom:i=>Un(i,180),top:i=>Un(i,180)}};function LE(i,t,e,n,r){const o=i.trim().split(" "),[s,a]=o[1].split(",").map(Z=>parseFloat(Z)),[l,h,u,p]=o[3].split(",").map(Z=>parseFloat(Z)),y=function(Z,rt,ct,nt,vt,ht){const mt=Math.abs(ht*Math.sqrt((ct*ct+nt*nt)/2)),jt=Math.ceil(mt/9525/10);let Ft=0,Mt=vt,wt={x:Z+ct*Math.cos(Mt),y:rt+nt*Math.sin(Mt)};for(let Pt=0;Pt<jt;Pt+=1){Mt+=ht/jt;const Nt={x:Z+ct*Math.cos(Mt),y:rt+nt*Math.sin(Mt)};Ft+=Math.sqrt(Math.pow(Nt.x-wt.x,2)+Math.pow(Nt.y-wt.y,2)),wt=Nt}return Ft}(s,a,l,h,u,p);r*=Math.min(1,y/9525/n);const x=new De.d;x.translate(r+t/2,0),x.rotate(2*Math.PI-u);const E=new De.g(0,0),w=x.apply(E);w.x+=t/2,w.y=e/2-w.y;const C=l+9525*r,j=h+9525*r;return`M ${9525*w.x},${9525*w.y} A ${C},${j},${u},${p}`}var za=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class DE{constructor(t,e,n,r,o){var s;this.iterateElements=[],this.paragraphs=[],this.effectList=[],this.container=new Cn.b,this.textContainer=new Cn.b,this.textColorFilter=new ds,this.json=t,this.ctx=e,this.shapeRotation=o,this.parentGlobalPos=r,this.iterateType=n,this.container.name="textBody",this.global={x:this.parentGlobalPos.x+t.position.x,y:this.parentGlobalPos.y+t.position.y},this.container.position.x=t.position.x,this.container.position.y=t.position.y,this.container.scale.x=t.scale.x,this.container.scale.y=t.scale.y;const a=new er;a.drawRect(0,0,t.width,t.height),this.container.addChild(a),this.container.addChild(this.textContainer),this.textColorFilter.currentColor="#000000FF",this.textColorFilter.designColor="#000000FF",this.effectList=(s=t.effectList)!==null&&s!==void 0?s:[]}get width(){return this.json.width}get height(){return this.json.height}get x(){return this.json.position.x}get y(){return this.json.position.y}set color(t){var e;((e=this.container.filters)!==null&&e!==void 0?e:[]).length>0&&(this.textColorFilter.color=t)}get color(){return this.textColorFilter.color}get on(){var t;return((t=this.container.filters)!==null&&t!==void 0?t:[]).length>0?"true":"false"}set on(t){var e;t==="true"?((e=this.container.filters)!==null&&e!==void 0?e:[]).indexOf(this.textColorFilter)<0&&(this.container.filters=[this.textColorFilter]):this.container.filters=[]}getTextElement(t,e){return t==="paragraph"?this.paragraphs[e[0]]:null}getIterateEntry(t,e){return this.iterateElements[t]?this.iterateElements[t]:(this.ctx.eventHub.emit("IterateTimeNodeEnd",e),null)}destroy(){this.paragraphs.forEach(t=>{t.destroy()}),this.textColorFilter.destroy()}createParagraphs(t,e){for(let n=0,r=this.json.paragraphs.length;n<r;n++)e.addSubMTask(()=>za(this,void 0,void 0,function*(){var o;const s=this.json.paragraphs[n],a=new PE(s,this.ctx,{parentGlobalPos:this.global,effectList:this.effectList});a.isHorz=(o=this.json.isHorz)===null||o===void 0||o,a.createLines(t,n,e),e.addSubMTask(()=>za(this,void 0,void 0,function*(){this.iterateElements=this.iterateElements.concat(a.getIterateElements()),a.container.name="\u6BB5\u843D-"+n,this.paragraphs.push(a)}),"@TextBodyImpl[paragraphs.push]")}),"@TextBodyImpl[createParagraphs]")}render(t){for(const e of this.paragraphs)e.render(t),t.addSubMTask(()=>za(this,void 0,void 0,function*(){this.textContainer.addChild(e.container)}),"@TextBodyImpl[container.addChild]");t.addSubMTask(()=>za(this,void 0,void 0,function*(){const{width:e}=this.container;this.container.scale.x<0&&(this.container.x+=-1*e)}),"@TextBodyImpl[reset width]"),t.addSubMTask(()=>za(this,void 0,void 0,function*(){if(this.json.presetTextShape){const e=this.json.paragraphs.map(h=>h.x).reduce((h,u)=>Math.min(h,u)),n=this.json.paragraphs[0].y,r=this.textContainer.getBounds(),{width:o,height:s}=r,{geometry:a,type:l}=this.json.presetTextShape;if(a.paths){const h=ce.p.create({width:o,height:s,resolution:this.ctx.renderer.resolution}),u=new De.d;u.translate(-e,-n),this.ctx.renderer.render(this.textContainer,{renderTexture:h,transform:u});const p=this.json.isHorz!==void 0&&!this.json.isHorz;if(["textCircle","textArchUp","textArchDown"].indexOf(this.json.presetTextShape.type)>=0){const x=LE(a.paths[0].path,this.json.width,this.json.height,o,s);a.paths.unshift(Object.assign(Object.assign({},a.paths[0]),{path:x}))}const y=function(x,E,w,C){if(!yc[w])return null;const j=yc[w].top(Kg(E)),Z=yc[w].bottom(Kg(x));if(j.length!==Z.length)return null;const rt=Math.min(j.length,Z.length),ct=1/(rt-1),nt=[],vt=[],ht=new Array(2*rt).fill("").map((mt,jt)=>jt);for(let mt=0;mt<rt;mt++)nt.push(j[mt].x,j[mt].y),C?vt.push(1,ct*mt):vt.push(ct*mt,0),nt.push(Z[mt].x,Z[mt].y),C?vt.push(0,ct*mt):vt.push(ct*mt,1);return{vertices:new Float32Array(nt),uvs:new Float32Array(vt),drawMode:gn.f.TRIANGLE_STRIP,indices:new Uint16Array(ht)}}(a.paths[1],a.paths[0],l,p);if(y){const x=new gT.b(h,y.vertices,y.uvs,y.indices,y.drawMode);this.textContainer.visible=!1,this.container.addChild(x)}}}}),"presetTextShape")}}class FE{constructor(t){this.scaleX=1,this.scaleY=1,this.pivot={x:0,y:0},this.paths=[],this.hash="",this.width=0,this.height=0,this.graphicsId="",this.textureId="",this.id=t.id,this.type=t.type,this.heightSize=t.heightSize,this.widthSize=t.widthSize,this.fillStyle=t.fillStyle||{fillType:"solidFill",color:"#ffffffff"},this.lineWidth=t.lineWidth||1,this.position=t.position||{x:0,y:0},this.rotate=t.rotation||1,this.path=this.getUnitPath(),this.setScaleFromLineWidth(),this.setScaleFromSize(),this.generatePaths(),this.setPivot()}setPivot(){switch(this.type){case"oval":case"diamond":this.pivot={x:this.width/2,y:this.height/2};break;case"triangle":this.pivot={x:.7*this.width,y:this.height/2};break;case"arrow":case"stealth":default:this.pivot={x:this.width,y:this.height/2}}}generatePaths(){this.hash="arrow-"+sh()(this.path+this.scaleX+this.scaleY),this.paths=[{id:this.id,path:this.path,fill:"norm",hasStroke:!1,hash:this.hash,scale:{x:this.scaleX,y:this.scaleY}}]}getUnitPath(){switch(this.type){case"stealth":return"M 0,0 L 95250,47625 L 0,95250 L 28575,47625 C C";case"oval":return"M 0,47625 A 47625,47625,-3.14159265,6.2831853 C C";case"diamond":return"M 47625,0 L 95250,47625 L 47625,95250 L 0,47625 C C";case"arrow":return"M 9525,0 L 95250,47625 L 9525,95250 L 0,85725 L 68389.5,47625 L 0,9525 C C";case"triangle":return"M 0,0 L 95250,47625 L 0,95250 C C";default:return""}}setScaleFromLineWidth(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=.29*this.lineWidth+.7,this.scaleY*=.29*this.lineWidth+.7;break;default:throw new Error("can't match any arrow type!")}}setScaleFromSize(){switch(this.type){case"stealth":case"oval":case"diamond":case"arrow":case"triangle":this.scaleX*=1,this.scaleY*=1;break;default:throw new Error("can't match any arrow type!")}switch(this.widthSize){case"sm":this.scaleX*=.75;break;case"lg":this.scaleX*=1.25;break;case"med":this.scaleX*=1}switch(this.heightSize){case"sm":this.scaleY*=.75;break;case"lg":this.scaleY*=1.25;break;case"med":this.scaleY*=1}this.width=10*this.scaleX,this.height=10*this.scaleY}}class xc{constructor(t,e,n,r,o,s,a,l,h,u,p){this.id=t,this.ctx=e,this.paths=n,this.hash=r,this.nept=o,this.width=s,this.height=a,this.lineStyle=l,this.shouldFill=h,this.bgColor=u,this.lnColor=p,this.clonedObjects=[],this._displayObject=null,this.isRectangle=!1,this.isPureRect=!1,this.isColoredPureRect=!1,this.isRectangle=this.rectangleDetect(n),this.isRectangle&&h?this.bgColor?this.isColoredPureRect=!0:this.isPureRect=!0:this.ctx.graphicsTexture.addGraphics(this.id,this.paths,this.hash,this.nept,this.width,this.height,this.lineStyle,this.ctx.objectPoolGroup,this.shouldFill,this.bgColor,this.lnColor)}get displayObject(){return this._displayObject}pointDis(t,e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)}isPoint(t){return Number.isNaN(Number(t.x))||Number.isNaN(Number(t.y))}isSquare(t,e){if(t.join("")!=="MLLLC"&&t.join("")!=="MLLLCC")return!1;const n=e.filter(l=>!this.isPoint(l));if(n.length!==4)return!1;const r=Math.min(...n.map(l=>l.x)),o=Math.min(...n.map(l=>l.y)),s=Math.max(...n.map(l=>l.x)),a=Math.max(...n.map(l=>l.y));for(const l of n)if(l.x!==r&&l.x!==s||l.y!==o&&l.y!==a)return!1;return!0}rectangleDetect(t){if(t.length!==1)return!1;const e=t[0].path.trim().split(" ");if(e.length!==10)return!1;const n=[],r=[];for(let l=0;l<e.length;l+=2){const h=e[l],u=e[l+1],[p,y]=u.split(",").map(x=>Number(x)/100);n.push(h),r.push({x:p,y})}if(this.isSquare(n,r))return!1;for(let l=0;l<3;l++){const h=r[l],u=r[l+1];if(h.x!==u.x&&h.y!==u.y)return!1}const o=r.slice(0,4).reduce((l,h)=>l+h.x,0)/4,s=r.slice(0,4).reduce((l,h)=>l+h.y,0)/4;if(Number.isNaN(o)||Number.isNaN(s))return!1;const a={x:o,y:s};return Tr(this.pointDis(a,r[0]),this.pointDis(a,r[1]))&&Tr(this.pointDis(a,r[0]),this.pointDis(a,r[2]))&&Tr(this.pointDis(a,r[0]),this.pointDis(a,r[3]))&&this.pointDis(a,r[0])===this.pointDis(a,r[1])}createDisplayObject(){if(this.isPureRect){const t=new er;return t.beginFill(0,1),t.drawRect(0,0,this.width,this.height),t}if(this.isColoredPureRect&&this.bgColor){const t=new er,[e,n]=Og(this.bgColor);return t.beginFill(e,n),t.drawRect(0,0,this.width,this.height),t}{const t=new pi,e=this.ctx.graphicsTexture.getGraphicsData(this.id);return e?(t.texture=e.texture,t.pivot.x=e.pivot.x,t.pivot.y=e.pivot.y,t.scale.x=e.scale,t.scale.y=e.scale,t):null}}getClonedDisplayObject(){const t=this.createDisplayObject();return this.clonedObjects.push(t),t}render(){this._displayObject=this.createDisplayObject()}isNeedMask(t,e){let n=!1;return this._displayObject&&(n=!(this.isRectangle&&Math.abs(t-this._displayObject.width)<2&&Math.abs(e-this._displayObject.height)<2&&this.shouldFill)),n}addArrows(t){var e;(e=this._displayObject)===null||e===void 0||e.addChild(t)}destroy(){var t;(t=this._displayObject)===null||t===void 0||t.destroy(),this._displayObject=null,this.clonedObjects.forEach(e=>{e==null||e.destroy()}),this.clonedObjects=[]}}var ph=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};const ps={pivot:{x:0,y:0},width:0,height:0};class Zg extends pc{constructor(t,e,n){var r,o,s,a,l,h,u,p,y;super(t,e,n),this.renderContainer=new Cn.b,this.needCacheAsBitMap=!1,this.backgroundGraphics=null,this.effectList=[],this.strokeGraphics=null,this.ghco=null,this.useGroupFill=!1,this.arrowList=[],this.fillColorFilter=new ds,this.strokeColorFilter=new ds,this.pptColorFilter=new ds,this.id="",this.ppt_c=new kT(this),this.fill=new Ig(this),this.stroke=new BT(this),this.effectObject=null,this.effectContainer=new Cn.b,this.effectDisposer=()=>{},this.json=t,this.option=n,this.json.fillStyle&&this.json.fillStyle.fillType==="groupFill"&&n.groupFillStyle&&(this.json.fillStyle=n.groupFillStyle,this.useGroupFill=!0),this.id=t.id;const{fillStyle:x,lineStyle:E}=this.json;this.container.sortableChildren=!0,this.container.name=t.id+"_container_[Shape]",this.effectContainer.name="effect-container",this.effectContainer.zIndex=1,this.container.addChild(this.effectContainer),this.renderContainer.name=t.id+"_render_container_[Shape]",this.generateArrowList(),this.backgroundFill=this.createBackgroundFill(),this.backgroundGraphics=this.createBackgroundGraphics(),this.strokeFill=this.createStrokeFill(),this.strokeGraphics=this.createStrokeGraphics();try{this.ghco=new xc(this.json.id+"-path-graphics-text-wrap",this.ctx,(s=(o=(r=this.json.textBody)===null||r===void 0?void 0:r.presetTextShape)===null||o===void 0?void 0:o.geometry.paths)!==null&&s!==void 0?s:[],(h=(l=(a=this.json.textBody)===null||a===void 0?void 0:a.presetTextShape)===null||l===void 0?void 0:l.geometry.hash)!==null&&h!==void 0?h:"",{x:0,y:0},((u=this.json.textBody)===null||u===void 0?void 0:u.width)||100,((p=this.json.textBody)===null||p===void 0?void 0:p.height)||100,{width:2,fill:{fillType:"solidFill",color:"#FF0000FF"}},!1,null,null)}catch(w){this.ctx.logger.error(w.message,this.ctx.taskId)}this.ctx.timingTargets.addTarget(this.id,this),(x==null?void 0:x.fillType)==="solidFill"&&(this.fillColorFilter.currentColor=x.color,this.fillColorFilter.designColor=x.color),((y=E==null?void 0:E.fill)===null||y===void 0?void 0:y.fillType)==="solidFill"&&(this.strokeColorFilter.currentColor=E.fill.color,this.strokeColorFilter.designColor=E.fill.color),this.updateTransform(this.json),t.textBody&&(this.text=new DE(t.textBody,this.ctx,t.textBody.iterateType,{x:this.designGlobalPosition.x,y:this.designGlobalPosition.y},this.json.rotation||0)),this.container.hitArea=new De.k(1,1,this.json.width,this.json.height),this.ctx.slideScopeEventHub.once("slide-render",w=>{if(this.ctx.slideIndex===w&&this.effectObject){const C=this.getEffectTexture();if(C){const{texture:j,offsetX:Z,offsetY:rt}=C;this.effectObject.setFrameOffset(Z,rt),this.effectObject.createFrame(1,j)}}})}get interactiveContainer(){return this.renderContainer}get strokeActive(){var t,e,n,r,o,s,a;return this.strokeFill.displayObject?((n=(e=(t=this.strokeFill.displayObject)===null||t===void 0?void 0:t.filters)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:-1)>0:((a=(s=(o=(r=this.strokeGraphics)===null||r===void 0?void 0:r.displayObject)===null||o===void 0?void 0:o.filters)===null||s===void 0?void 0:s.length)!==null&&a!==void 0?a:-1)>0}set strokeActive(t){var e,n,r,o,s,a;const{displayObject:l}=this.strokeFill;t?l&&((n=(e=l.filters)===null||e===void 0?void 0:e.indexOf(this.strokeColorFilter))!==null&&n!==void 0?n:-1)<0?l.filters=[this.strokeColorFilter]:((r=this.strokeGraphics)===null||r===void 0?void 0:r.displayObject)&&((s=(o=this.strokeGraphics.displayObject.filters)===null||o===void 0?void 0:o.indexOf(this.strokeColorFilter))!==null&&s!==void 0?s:-1)<0&&(this.strokeGraphics.displayObject.filters=[this.strokeColorFilter]):l?l.filters=[]:!((a=this.strokeGraphics)===null||a===void 0)&&a.displayObject&&(this.strokeGraphics.displayObject.filters=[])}get pptColorActive(){var t,e;return((e=(t=this.renderContainer.filters)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:-1)>0}set pptColorActive(t){this.renderContainer.filters=t?[this.pptColorFilter]:[]}get fillActive(){var t,e,n,r,o,s,a;return this.backgroundFill.displayObject?((n=(e=(t=this.backgroundFill.displayObject)===null||t===void 0?void 0:t.filters)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:-1)>0:((a=(s=(o=(r=this.backgroundGraphics)===null||r===void 0?void 0:r.displayObject)===null||o===void 0?void 0:o.filters)===null||s===void 0?void 0:s.length)!==null&&a!==void 0?a:-1)>0}set fillActive(t){var e,n,r,o,s,a;t?this.backgroundFill.displayObject&&((n=(e=this.backgroundFill.displayObject.filters)===null||e===void 0?void 0:e.indexOf(this.fillColorFilter))!==null&&n!==void 0?n:-1)<0?this.backgroundFill.displayObject.filters=[this.fillColorFilter]:((r=this.backgroundGraphics)===null||r===void 0?void 0:r.displayObject)&&((s=(o=this.backgroundGraphics.displayObject.filters)===null||o===void 0?void 0:o.indexOf(this.fillColorFilter))!==null&&s!==void 0?s:-1)<0&&(this.backgroundGraphics.displayObject.filters=[this.fillColorFilter]):this.backgroundFill.displayObject?this.backgroundFill.displayObject.filters=[]:!((a=this.backgroundGraphics)===null||a===void 0)&&a.displayObject&&(this.backgroundGraphics.displayObject.filters=[])}getTextElement(t,e){var n,r;if(this.json.isMathFallback){if(!this.json.textBody)return this;const o=()=>this.json.textBody.paragraphs[0].lines.length<=1,s=()=>this.json.textBody.paragraphs[0].lines[0].textUnits.length<=1,a=()=>this.json.textBody.paragraphs[0].lines[0].textUnits[0].content.trim()==="";if((()=>this.json.textBody.paragraphs.length<=1)()&&o()&&s()&&a())return this}return(r=(n=this.text)===null||n===void 0?void 0:n.getTextElement(t,e))!==null&&r!==void 0?r:null}getBgElement(){return this}getIterateEntry(t,e,n){return e===0?this:t==="el"?(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null):this.text?this.text.getIterateEntry(e-1,n)||null:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}getEffectTexture(){const t=this.effectContainer.getLocalBounds();let e=0,n=0;for(const s of this.effectContainer.children)s.pivot.x>e&&(e=s.pivot.x),s.pivot.y>n&&(n=s.pivot.y);const r=new De.d;if(r.translate(e,n),this.effectContainer.children.length===0)return null;const o=ce.p.create({width:t.width,height:t.height,resolution:this.ctx.renderer.resolution});return this.ctx.renderer.render(this.effectContainer,{renderTexture:o,transform:r}),{texture:o,offsetX:e,offsetY:n}}createStrokeGraphics(){var t,e,n,r;const{id:o,geometry:s,lineStyle:a}=this.json,{width:l,height:h,pivot:u}=(s==null?void 0:s.lineTransform)||ps,p=l||this.json.width,y=h||this.json.height,x=((t=a==null?void 0:a.fill)===null||t===void 0?void 0:t.fillType)==="solidFill"?a.fill.color:null;return a&&((e=a.fill)===null||e===void 0?void 0:e.fillType)!=="noFill"?new xc(o+"-path-graphics",this.ctx,(n=s==null?void 0:s.paths)!==null&&n!==void 0?n:[],(r=s==null?void 0:s.hash)!==null&&r!==void 0?r:"",u||{x:0,y:0},p,y,a,!1,null,x):null}createStrokeFill(){const[t,e]=this.calculateFillObjectOffset(),{geometry:n,lineStyle:r,width:o,height:s}=this.json,a=(n==null?void 0:n.lineTransform)||ps,l=zo()(r==null?void 0:r.width)?r.width:1;return new mo(this.ctx,r==null?void 0:r.fill,(a.width||o)+l+t,Math.max((a.height||s)+l,e),{useFilter:!0,useSlideBackgroundFill:!1})}createBackgroundGraphics(){var t;const{geometry:e,lineStyle:n,fillStyle:r,id:o}=this.json,{width:s,height:a,pivot:l}=(e==null?void 0:e.lineTransform)||ps,h=s||this.json.width,u=a||this.json.height,p=(r==null?void 0:r.fillType)==="solidFill"?r.color:null;return r&&r.fillType!=="noFill"||this.json.isPicture?new xc(o+"-bg-graphics",this.ctx,(t=e==null?void 0:e.paths)!==null&&t!==void 0?t:[],(e==null?void 0:e.hash)||"",l||{x:0,y:0},h,u,n,!0,p,null):null}createBackgroundFill(){var t,e,n,r;const{fillStyle:o,width:s,height:a,lineStyle:l,geometry:h}=this.json,u=(h==null?void 0:h.fillTransform)||ps,p={useFilter:!0,useSlideBackgroundFill:this.json.useBgFill,fillFloat:this.json.fillFloat,shapeRotation:this.json.rotation},y=this.useGroupFill&&((t=this.option.groupSize)===null||t===void 0?void 0:t.w)?this.option.groupSize.w:u.width||s,x=this.useGroupFill&&((e=this.option.groupSize)===null||e===void 0?void 0:e.h)?this.option.groupSize.h:u.height||a;return new mo(this.ctx,o,y+((n=l==null?void 0:l.width)!==null&&n!==void 0?n:0),x+((r=l==null?void 0:l.width)!==null&&r!==void 0?r:0),p)}createBackground(){var t,e,n,r,o,s,a,l,h,u,p,y;const{pivot:x,width:E,height:w}=((t=this.json.geometry)===null||t===void 0?void 0:t.fillTransform)||ps,{displayObject:C}=this.backgroundFill;C?(this.json.useBgFill&&((n=this.backgroundGraphics)===null||n===void 0?void 0:n.displayObject)?(this.needCacheAsBitMap=!0,C.mask=this.backgroundGraphics.displayObject,C.pivot.x=((r=this.json.position)===null||r===void 0?void 0:r.x)||0,C.pivot.y=((o=this.json.position)===null||o===void 0?void 0:o.y)||0,this.effectContainer.addChild(this.backgroundGraphics.displayObject)):((s=this.json.fillStyle)===null||s===void 0?void 0:s.fillType)==="gifFill"?(C.height=w||this.designHeight,C.width=E||this.designWidth,C instanceof lc&&C.play(),!((a=this.backgroundGraphics)===null||a===void 0)&&a.isNeedMask(C.width,C.height)&&(C.mask=this.backgroundGraphics.displayObject,this.backgroundGraphics.displayObject&&this.effectContainer.addChild(this.backgroundGraphics.displayObject))):!((l=this.backgroundGraphics)===null||l===void 0)&&l.isNeedMask(C.width,C.height)&&(this.json.fillFloat||(this.needCacheAsBitMap=!0,C.mask=this.backgroundGraphics.displayObject,this.backgroundGraphics.displayObject&&this.effectContainer.addChild(this.backgroundGraphics.displayObject))),this.json.fillFloat||(C.x=x.x,C.y=x.y),this.useGroupFill&&(C.x-=(u=(h=this.json.position)===null||h===void 0?void 0:h.x)!==null&&u!==void 0?u:0,C.y-=(y=(p=this.json.position)===null||p===void 0?void 0:p.y)!==null&&y!==void 0?y:0),this.effectContainer.addChild(C)):this.backgroundFill.hasFill&&((e=this.backgroundGraphics)===null||e===void 0?void 0:e.displayObject)&&this.effectContainer.addChild(this.backgroundGraphics.displayObject)}createPathFill(){var t,e,n;const{displayObject:r}=this.strokeFill,o=(t=this.strokeGraphics)===null||t===void 0?void 0:t.displayObject,[s,a]=this.calculateFillObjectOffset();r?(((e=this.strokeGraphics)===null||e===void 0?void 0:e.isNeedMask(r.width,r.height))&&o&&(this.needCacheAsBitMap=!0,r.pivot.x=o.pivot.x,r.pivot.y=o.pivot.y,o.pivot.x=0,o.pivot.y=0,r.mask=o,r.addChild(o),r.position.x=-s/2,r.position.y=-a/2,o.position.x=s/2,o.position.y=a/2),this.effectContainer.addChild(r)):this.strokeFill.hasFill&&((n=this.strokeGraphics)===null||n===void 0?void 0:n.displayObject)&&this.effectContainer.addChild(this.strokeGraphics.displayObject)}createFilledPathMask(){var t,e,n;const r=((e=(t=this.json.geometry)===null||t===void 0?void 0:t.paths)===null||e===void 0?void 0:e.filter(o=>o.fill!=="none"&&o.fill!=="norm"))||[];for(const o of r){const s=this.ctx.graphicsTexture.getGraphicsData(o.id);if(s){const a=new pi(s.texture);a.pivot.x=s.pivot.x,a.pivot.y=s.pivot.y,a.scale.x=s.scale,a.scale.y=s.scale;const l=this.backgroundFill.getClonedDisplayObject(),h=(n=this.backgroundGraphics)===null||n===void 0?void 0:n.getClonedDisplayObject(),u=l||h;u&&(this.backgroundFill.displayObject&&(u.pivot.x=this.backgroundFill.displayObject.pivot.x,u.pivot.y=this.backgroundFill.displayObject.pivot.y),u.mask=a,u.filters=[zT[o.fill]],this.needCacheAsBitMap=!0,this.effectContainer.addChild(u),this.effectContainer.addChild(a))}}}createArrow(){this.arrowList.length&&this.arrowList.forEach(t=>{var e;const n=this.ctx.graphicsTexture.getGraphicsData(t.graphicsId);if(n){const{texture:r}=n,o=new pi(r);o.pivot.x=t.pivot.x,o.pivot.y=t.pivot.y,o.position.x=t.position.x,o.position.y=t.position.y,o.rotation=t.rotate/180*Math.PI,o.scale.x=n.scale,o.scale.y=n.scale,(e=this.backgroundGraphics)===null||e===void 0||e.addArrows(o)}})}generateArrowList(){var t,e;const{lineArrowList:n,lineStyle:r,id:o}=this.json,s=((t=r==null?void 0:r.fill)===null||t===void 0?void 0:t.fillType)==="solidFill"?r.fill.color:null;(e=n||[])===null||e===void 0||e.forEach((a,l)=>{var h,u;const p=new FE(Object.assign(Object.assign({},a),{fillStyle:r==null?void 0:r.fill,lineWidth:(h=r==null?void 0:r.width)!==null&&h!==void 0?h:0}));p.graphicsId=`${o}-arrow-${l}-graphics`,p.textureId=`${o}-arrow-${l}-fill`,this.ctx.graphicsTexture.addGraphics(p.graphicsId,(u=p.paths)!==null&&u!==void 0?u:[],p.hash,{x:0,y:0},p.width,p.height,void 0,this.ctx.objectPoolGroup,!0,s,null),this.arrowList.push(p)})}calculateFillObjectOffset(){let[t,e]=[0,0];return this.arrowList.length&&(t=this.arrowList.reduce((n,r)=>Math.max(n,r.width),0),e=this.arrowList.reduce((n,r)=>Math.max(n,r.height),0)),[t,e]}preRender(t){var e,n,r;const{lineStyle:o,geometry:s}=this.json,{width:a,height:l}=(s==null?void 0:s.lineTransform)||ps,h=a||this.json.width,u=l||this.json.height,p=((e=s==null?void 0:s.paths)===null||e===void 0?void 0:e.filter(x=>x.fill!=="none"&&x.fill!=="norm"))||[],y=((n=o==null?void 0:o.fill)===null||n===void 0?void 0:n.fillType)==="solidFill"?o.fill.color:null;t.addSubMTask(()=>ph(this,void 0,void 0,function*(){for(const x of p)this.ctx.graphicsTexture.addGraphics(x.id,[x],x.hash,((s==null?void 0:s.lineTransform)||ps).pivot,h,u,o,this.ctx.objectPoolGroup,!0,null,y)}),"@ShapeImpl[addGraphics]"),(r=this.text)===null||r===void 0||r.createParagraphs(this.json.id,t)}subClassRender(){return ph(this,void 0,void 0,function*(){})}render(t){t.addSubMTask(()=>ph(this,void 0,void 0,function*(){var e,n;(e=this.strokeGraphics)===null||e===void 0||e.render(),(n=this.backgroundGraphics)===null||n===void 0||n.render(),this.createBackground(),yield this.subClassRender(),this.createFilledPathMask(),this.createPathFill(),this.createArrow()}),"@ShapeImpl[render]"),this.text&&this.text.render(t),t.addSubMTask(()=>ph(this,void 0,void 0,function*(){var e,n,r,o,s,a,l,h,u,p,y,x,E;if(((e=this.json.textBody)===null||e===void 0?void 0:e.iterateType)==="wd"||((n=this.json.textBody)===null||n===void 0?void 0:n.iterateType)==="lt"){if(this.renderContainer.addChild(this.container),this.text){const{x:w,y:C}=(r=this.json.scale)!==null&&r!==void 0?r:{x:1,y:1};this.text.container.scale.x=C<0?-Math.abs(w):Math.abs(w),this.text.container.scale.y=C,this.text.container.position.x=((s=(o=this.json.position)===null||o===void 0?void 0:o.x)!==null&&s!==void 0?s:0)+this.text.x,this.text.container.position.y=((l=(a=this.json.position)===null||a===void 0?void 0:a.y)!==null&&l!==void 0?l:0)+this.text.y,this.text.container.scale.y<0&&(this.text.container.position.y+=this.text.height),this.text.container.scale.x<0&&(this.text.container.position.x+=this.json.width),this.json.textRotation&&(this.text.container.rotation=this.json.textRotation),this.renderContainer.addChild(this.text.container)}}else{if(this.text){if(this.json.textRotation){this.text.container.rotation=this.json.textRotation;const{width:Z,height:rt}=this.text,{x:ct,y:nt}=this.text.container.position;this.text.container.pivot.x=Z/2,this.text.container.pivot.y=rt/2,this.text.container.x=ct+Z/2,this.text.container.y=nt+rt/2}if(jT()(this.json.textRotateWithShape)&&!this.json.textRotateWithShape){const Z=this.json.rotation||0;this.text.container.rotation=-Z;const{width:rt}=this.text;this.text.container.position.x=rt}this.text.container.zIndex=100;const w=(h=this.json.effectList)===null||h===void 0?void 0:h.find(Z=>Z.type==="outerShadow"),C=(u=this.json.effectList)===null||u===void 0?void 0:u.find(Z=>Z.type==="softEdge"),j=(p=this.json.effectList)===null||p===void 0?void 0:p.find(Z=>Z.type==="glow");w&&w.sx!==1||C||j?this.container.addChild(this.text.container):this.effectContainer.addChild(this.text.container)}this.renderContainer.addChild(this.container)}if(this.needCacheAsBitMap,this.json.id==="background"&&this.ctx.hasBackgroundFillShape){const w=ce.p.create({width:this.json.width,height:this.json.height,resolution:Math.ceil(this.ctx.renderer.resolution)});this.ctx.renderer.render(this.renderContainer,{renderTexture:w}),this.ctx.bgTexture=w}this.json.effectList&&this.json.effectList.length>0&&((y=this.ctx.featureList)===null||y===void 0?void 0:y.effect)&&!this.ctx.forceCanvas&&!this.json.media&&(this.effectObject=new Xg(this.effectContainer,this.json.effectList,`${this.ctx.taskId}_${this.ctx.slideIndex}_${this.json.id}`,this.ctx,this.json.rotation||0,new De.g(((x=this.json.scale)===null||x===void 0?void 0:x.x)||1,((E=this.json.scale)===null||E===void 0?void 0:E.y)||1)),function(w){var C,j,Z;return((C=w.fillStyle)===null||C===void 0?void 0:C.fillType)==="gifFill"||((Z=(j=w.lineStyle)===null||j===void 0?void 0:j.fill)===null||Z===void 0?void 0:Z.fillType)==="gifFill"||!!w.picFill&&w.picFill.fillType==="gifFill"}(this.json)&&this.effectObject.setFrameCount(-1),this.effectObject.on("ready",()=>{var w;this.effectContainer.visible=!1,this.effectObject.container.zIndex=10,this.container.addChild(this.effectObject.container),(w=this.effectObject)===null||w===void 0||w.updateFrame(1)}))}),"@ShapeImpl[post.render]")}clearOnSlideChange(){}initOnReuse(){}destroy(){var t,e,n,r;(t=this.text)===null||t===void 0||t.destroy(),this.fillColorFilter.destroy(),this.strokeColorFilter.destroy(),this.backgroundFill.destroy(),(e=this.backgroundGraphics)===null||e===void 0||e.destroy(),this.strokeFill.destroy(),(n=this.strokeGraphics)===null||n===void 0||n.destroy(),this.renderContainer.destroy(),(r=this.arrowRenderTexture)===null||r===void 0||r.destroy(!0),this.arrowList=[],this.effectDisposer()}}var BE=v(119);const bc=new(v.n(BE)).a,UE=bc.getDevice(),kE=bc.getBrowser(),fh=bc.getOS(),fs={isDesktop(){let i=!0;return UE.type==="mobile"&&(i=!1),/Samsung/.test(kE.name||"")&&(i=!1),window.__nativeTags&&window.__nativeTags.platform&&(i=!1),i},isIOS(){let i=!1;return window.__nativeTags&&window.__nativeTags.platform&&/^ios/i.test(window.__nativeTags.platform)&&(i=!0),fh.name&&/iOS/.test(fh.name)&&(i=!0),i},isAndroid(){let i=!1;return window.__nativeTags&&window.__nativeTags.platform&&/^android/i.test(window.__nativeTags.platform)&&(i=!0),fh.name&&/android/i.test(fh.name)&&(i=!0),i},isLowGpuMemory(){var i,t;const e=(t=(i=window.__nativeTags)===null||i===void 0?void 0:i.platform)!==null&&t!==void 0?t:"";if(e){const n=e.split(" ");if(n[1]){if(/^iPad/.test(n[1])){const r=n[1].match(/^iPad(\d+)/);return!(r&&r[1]&&parseInt(r[1],10)>=6)}if(/^iPhone/.test(n[1])){const r=n[1].match(/^iPhone(\d+)/);return!(r&&r[1]&&parseInt(r[1],10)>=9)}return!1}return!1}return!0}};var mh=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};function rr(i,t){for(const e in t)i.style[e]=t[e]}const Wo={medianContainerClass:"median-container",hoverHiddeDelay:1500,portalWidth:300,portalHeight:50,hiddenOpacity:"0",hoverOpacity:"1",opacityAnimationTime:.4};class Va{constructor(t){var e,n;this.progress=document.createElement("div"),this.totalTime=document.createElement("span"),this.playButton=document.createElement("div"),this.pauseButton=document.createElement("div"),this.currentTime=document.createElement("span"),this.mediaController=document.createElement("div"),this.currentProgress=document.createElement("div"),this.fullScreenButton=document.createElement("div"),this.exitFullScreenButton=document.createElement("div"),this.medianIsEnd=!1,this.pickBookmarkIndex=0,this.playCallBackList=[],this.duration=0,this.isVideo=!1,this.start=0,this.end=0,this.fullscreenStatus=!1,this.fadeState={in:!1,out:!1},this.changeMediaProgress=r=>{if(this.ctx.isPlayerPaused())return void this.ctx.logger.info("Media controller prevent seek event with paused state",this.ctx.taskId);r.stopPropagation();const o=r.offsetX/this.progress.clientWidth*this.duration;this.medianIsEnd=!1,this.ctx.mode!=="interactive"&&this.jumpToTime(o),this.ctx.mode!=="local"&&this.ctx.eventHub.emit(Ke.mediaSeek,{id:this.targetId,time:o,isPlaying:this.media.isPlaying}),this.delayHide()},this.jumpToTime=(r=0)=>mh(this,void 0,void 0,function*(){yield ih(()=>!!this.duration,3e3);const o=Math.floor(r)+this.start;this.media.currentTime!==o&&(this.media.currentTime=o,this.changeBookmarkIndex(o,o>this.media.currentTime))}),this.showController=r=>{r.stopPropagation(),this.show()},this.getMediaDuration=()=>{this.duration&&!Number.isNaN(this.duration)||(this.duration=this.media.duration,this.start&&(this.duration-=this.start,this.jumpToTime()),this.end&&(this.duration-=this.end)),this.totalTime.innerText=Va.formatTime(this.duration)},this.playMedia=()=>mh(this,void 0,void 0,function*(){this.playButton.style.display="none",this.pauseButton.style.display="block",yield this.media.play(),this.medianIsEnd&&(this.medianIsEnd=!1,this.jumpToTime()),this.playCallBackList.forEach(r=>{r()}),this.delayHide()}),this.pauseMedia=()=>mh(this,void 0,void 0,function*(){this.playButton.style.display="block",this.pauseButton.style.display="none",yield this.media.pause()}),this.onMouseOut=r=>{r.stopPropagation(),this.hide()},this.mediaTimeUpdate=()=>mh(this,void 0,void 0,function*(){const r=this.media.currentTime-this.start;if(this.duration>0&&(Math.abs(r-this.duration)<.3||r>this.duration)&&(yield this.pauseMedia(),this.medianIsEnd=!0,this.jumpToTime(),this.ctx.eventHub.emit(Ke.mediaStop,{id:this.targetId}),this.onClickCancelFullScreenButtonHandle()),this.currentTime.innerText=Va.formatTime(r),this.currentProgress.style.flex=(r/this.duration).toString(),this.bookmarkList&&this.bookmarkList.length>0){const o=this.bookmarkList[this.pickBookmarkIndex];o&&o.time.toFixed(0)===this.media.currentTime.toFixed(0)&&(this.ctx.timingEventHub.emit(`shape ${this.shapeId} onMediaBookmark ${o.name}`),this.pickBookmarkIndex+=1)}this.fadeHit(r)}),this.onPauseMedia=()=>{this.playButton.style.display="block",this.pauseButton.style.display="none"},this.onPlayMedia=()=>{this.fadeState={in:!1,out:!1},this.fadeHit(0),this.playButton.style.display="none",this.pauseButton.style.display="block",this.playCallBackList.forEach(r=>{r()}),this.media.currentTime<this.start&&this.jumpToTime()},this._playMediaFromCtrl=()=>{this.playMediaFromCtrl(!1)},this._pauseMediaFromCtrl=()=>{this.pauseMediaFromCtrl(!1),this.delayHide()},this.onClickFullScreenButtonHandle=()=>{this.fullscreenPlay()},this.onClickCancelFullScreenButtonHandle=()=>{this.fullscreenStatus=!1,this.media.requestCancelFullscreen(),this.ctx.eventHub.emit(Ke.fullscreenChange,{targetId:this.targetId,state:!1}),this.delayHide()},this.onFullScreenChange=r=>{const{status:o,targetId:s,slideIndex:a}=r;this.changeFullScreenState(o,s,a),this.delayHide()},this.onContainerSizeChange=()=>{this.setControllerPosition()},this.onControllerShowStatusChange=({slideIndex:r,targetId:o,status:s})=>{if(r===this.ctx.slideIndex){if(this.targetId===o){const{hiddenOpacity:a,hoverOpacity:l}=Wo;s?(this.mediaController.style.opacity=l,this.mediaController.style.display="flex"):this.mediaController.style.opacity=a}this.delayHide()}},this.targetId=t.targetId,this.ctx=t.ctx,this.height=t.height,this.width=t.width,this.target=t.target,this.media=t.media,this.info=t.info,this.shapeId=t.shapeId,this.canvasElement=t.canvasElement,this.media.type==="video"&&(this.isVideo=!0),this.getMedianContainer(),this.createMediaController(),this.info.cut&&(this.start=(e=this.info.cut.start)!==null&&e!==void 0?e:0,this.end=(n=this.info.cut.end)!==null&&n!==void 0?n:0),this.info.bookmarkList&&(this.bookmarkList=this.info.bookmarkList.sort((r,o)=>r.time-o.time))}get clippedDuration(){return this.duration}getMedianContainer(){var t;const{medianContainerClass:e}=Wo;let n=(t=this.canvasElement.parentElement)===null||t===void 0?void 0:t.querySelector("."+e);n||(n=document.createElement("div"),n.className=e,this.canvasElement.parentElement.appendChild(n)),this.container=n}static formatTime(t){let e="00:00";if(t){const n=Math.floor(t/60),r=String(n<0?0:n).padStart(2,"0"),o=Math.floor(t%60);e=`${r}:${String(o<0?0:o).padStart(2,"0")}`}return e}generatePlayButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"viewBox","0 0 512 512"),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"width",e.toString());const r=document.createElementNS("http://www.w3.org/2000/svg","polyline");return r.setAttributeNS(null,"points","35 0, 477 256, 35 512"),r.setAttributeNS(null,"fill","#000000"),n.appendChild(r),n}generatePauseButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");rr(n,{height:t+"px"}),n.setAttributeNS(null,"viewBox","0 0 512 512"),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"width",e.toString());const r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttributeNS(null,"x","35"),r.setAttributeNS(null,"y","0"),r.setAttributeNS(null,"width","148"),r.setAttributeNS(null,"height","512");const o=r.cloneNode(!0);return o.setAttributeNS(null,"x","330"),n.append(r,o),n}generateFullScreenButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");rr(n,{height:t+"px",width:e+"px"}),n.setAttributeNS(null,"width",e.toString()),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"viewBox","0 0 1024 1024");const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttributeNS(null,"d","M918.116352 107.409408c10.186752 10.175488 10.186752 26.691584 0 36.87936L653.734912 407.038976c-10.187776 10.187776-26.703872 10.187776-36.891648 0-10.175488-10.187776-10.175488-26.703872 0.013312-36.891648l264.38144-262.73792c10.174464-10.187776 26.69056-10.200064 36.87936-0.013312L918.117376 107.409408zM878.281728 148.096l-161.155072-0.44544c-11.283456 0.279552-20.85888-8.226816-21.90336-19.458048l0-13.421568c0.318464-10.671104 8.889344-19.241984 19.560448-19.560448l187.030528 0.827392c0.1792-0.037888 0.357376-0.0768 0.523264-0.089088l9.549824-0.229376c5.005312-0.152576 9.843712 1.770496 13.372416 5.336064 3.32288 3.629056 4.9664 8.49408 4.545536 13.40928l-1.032192 9.537536c0 0.191488 0.70144 0.318464 0.70144 0.49664l-0.534528 188.279808c-0.54784 9.984-9.092096 17.637376-19.076096 17.089536-0.165888-0.012288-0.319488-0.0256-0.484352-0.037888L896.009216 329.8304c-10.379264-0.0512-18.733056-8.506368-18.681856-18.885632 0.013312-0.191488 0.013312-0.381952 0.013312-0.585728L878.281728 148.096zM105.884672 916.661248c-10.187776-10.175488-10.200064-26.691584-0.013312-36.87936 0 0 0-0.013312 0.013312-0.013312l265.19552-262.73792c10.35264-10.008576 26.86976-9.729024 36.866048 0.636928 9.766912 10.110976 9.766912 26.131456 0 36.242432L143.579136 916.661248C133.072896 926.848 116.3776 926.848 105.884672 916.661248L105.884672 916.661248zM146.533376 875.973632l161.154048 0.433152c11.283456-0.292864 20.85888 8.213504 21.891072 19.458048l0 13.38368c-0.292864 10.672128-8.876032 19.255296-19.560448 19.561472l-187.858944-0.828416c-0.165888 0.037888-0.344064 0.075776-0.509952 0.089088l-9.550848 0.229376c-5.004288 0.152576-9.831424-1.782784-13.35808-5.336064-3.323904-3.629056-4.979712-8.493056-4.54656-13.395968l1.031168-9.537536c0-0.191488-0.712704-0.330752-0.700416-0.509952l0.534528-188.278784c0.534528-9.984 9.066496-17.625088 19.050496-17.089536 0.165888 0.013312 0.330752 0.0256 0.508928 0.037888l14.212096 0c10.365952 0.0512 18.719744 8.507392 18.656256 18.873344 0 0.191488 0 0.395264-0.013312 0.598016L146.533376 875.973632zM918.116352 916.661248c10.186752-10.175488 10.200064-26.691584 0.012288-36.87936 0 0 0-0.013312-0.012288-0.013312l-264.38144-262.73792c-10.365952-10.008576-26.86976-9.729024-36.87936 0.636928-9.766912 10.110976-9.766912 26.131456 0 36.242432L881.22368 916.661248c10.186752 10.186752 26.703872 10.186752 36.891648 0.013312L918.115328 916.661248 918.116352 916.661248zM878.281728 875.973632l-161.168384 0.433152c-11.270144-0.292864-20.845568 8.213504-21.890048 19.458048l0 13.38368c0.306176 10.672128 8.889344 19.241984 19.560448 19.561472l187.030528-0.828416c0.1792 0.037888 0.357376 0.075776 0.523264 0.089088l9.549824 0.229376c5.005312 0.152576 9.843712-1.782784 13.372416-5.336064 3.32288-3.629056 4.978688-8.493056 4.545536-13.395968l-1.032192-9.537536c0-0.191488 0.70144-0.330752 0.70144-0.509952l-0.534528-188.278784c-0.54784-9.984-9.092096-17.637376-19.076096-17.089536-0.165888 0.013312-0.319488 0.0256-0.484352 0.037888L896.009216 694.19008c-10.379264 0.0512-18.733056 8.507392-18.681856 18.885632 0 0.191488 0.013312 0.381952 0.013312 0.584704L878.281728 875.973632zM105.884672 107.409408c-10.187776 10.175488-10.187776 26.691584 0 36.87936l265.19552 262.750208c10.187776 10.187776 26.691584 10.187776 36.87936 0s10.175488-26.703872-0.012288-36.891648l-264.368128-262.73792C133.072896 97.222656 116.3776 97.222656 105.884672 107.409408L105.884672 107.409408zM146.533376 148.096l161.154048-0.44544c11.283456 0.292864 20.85888-8.213504 21.891072-19.458048l0-13.421568c-0.306176-10.671104-8.889344-19.241984-19.560448-19.560448l-187.858944 0.827392c-0.165888-0.0512-0.344064-0.0768-0.509952-0.089088l-9.550848-0.229376c-5.004288-0.152576-9.831424 1.782784-13.35808 5.336064-3.323904 3.629056-4.979712 8.49408-4.54656 13.40928l1.031168 9.537536c0 0.191488-0.712704 0.318464-0.700416 0.49664l0.534528 188.279808c0.534528 9.970688 9.066496 17.624064 19.050496 17.089536 0.165888-0.012288 0.330752-0.0256 0.508928-0.037888l14.212096 0c10.365952-0.0512 18.719744-8.506368 18.656256-18.87232 0-0.191488 0-0.395264-0.013312-0.598016L146.533376 148.096z"),n.appendChild(r),document.body.appendChild(n),n}generateExitFullScreenButton(t=20,e=20){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");rr(n,{height:t+"px",width:e+"px"}),n.setAttributeNS(null,"width",e.toString()),n.setAttributeNS(null,"height",t.toString()),n.setAttributeNS(null,"viewBox","0 0 1024 1024");const r=document.createElementNS("http://www.w3.org/2000/svg","path"),o=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttributeNS(null,"d","M716.8 998.4a25.6 25.6 0 0 1-25.6-25.6v-256a25.6 25.6 0 0 1 25.6-25.6h256a25.6 25.6 0 1 1 0 51.2h-230.4v230.4a25.6 25.6 0 0 1-25.6 25.6zM307.2 998.4a25.6 25.6 0 0 1-25.6-25.6v-230.4H51.2a25.6 25.6 0 1 1 0-51.2h256a25.6 25.6 0 0 1 25.6 25.6v256a25.6 25.6 0 0 1-25.6 25.6zM972.8 332.8h-256a25.6 25.6 0 0 1-25.6-25.6v-256a25.6 25.6 0 1 1 51.2 0v230.4h230.4a25.6 25.6 0 1 1 0 51.2zM307.2 332.8h-256a25.6 25.6 0 1 1 0-51.2h230.4V51.2a25.6 25.6 0 1 1 51.2 0v256a25.6 25.6 0 0 1-25.6 25.6z"),o.setAttributeNS(null,"d","M307.2 332.8a25.6 25.6 0 0 1-18.112-7.488L56.896 93.12a25.6 25.6 0 0 1 36.224-36.224l232.192 232.192A25.6 25.6 0 0 1 307.2 332.8zM716.8 332.8a25.6 25.6 0 0 1-18.112-43.712L930.88 56.896a25.6 25.6 0 0 1 36.224 36.224l-232.192 232.192a25.472 25.472 0 0 1-18.112 7.488zM948.992 974.592a25.6 25.6 0 0 1-18.112-7.488l-232.192-232.192a25.6 25.6 0 0 1 36.224-36.224l232.192 232.192a25.6 25.6 0 0 1-18.112 43.712zM75.008 974.592a25.6 25.6 0 0 1-18.112-43.712l232.192-232.192a25.6 25.6 0 0 1 36.224 36.224l-232.192 232.192a25.472 25.472 0 0 1-18.112 7.488z"),n.appendChild(r),n.appendChild(o),document.body.appendChild(n),n}createButton(){const t={marginLeft:"15px",marginRight:"10px",fontSize:"0",height:"20px",display:"flex",justifyContent:"center",alignItems:"center"};rr(this.playButton,Object.assign(Object.assign({},t),{display:"block"}));const e=this.generatePlayButton();rr(e,{height:"20px"}),this.playButton.appendChild(e),rr(this.pauseButton,Object.assign(Object.assign({},t),{display:"none"}));const n=this.generatePauseButton();if(rr(n,{height:"20px"}),this.pauseButton.appendChild(n),!this.isVideo)return;const r=this.generateFullScreenButton(20,20);this.fullScreenButton.appendChild(r),rr(this.fullScreenButton,Object.assign(Object.assign({},t),{display:"block"}));const o=this.generateExitFullScreenButton(20,20);this.exitFullScreenButton.appendChild(o),rr(this.exitFullScreenButton,Object.assign(Object.assign({},t),{display:"none"}))}createTimer(){const t=document.createElement("div");rr(t,{width:"100px"}),this.currentTime.innerText="00:00";const e=document.createElement("span");return e.innerText="/",t.append(this.currentTime,e,this.totalTime),t}createProgress(){const t={flex:"1",position:"relative"};this.isVideo||(t.marginRight="10px"),rr(this.progress,t);const e=document.createElement("div");rr(e,{background:"#D9D9D9",position:"relative",height:"10px",display:"flex"}),this.progress.appendChild(e),rr(this.currentProgress,{background:"#4F4F4F",top:"0px",left:"0",height:"10px",flex:"0"}),e.appendChild(this.currentProgress)}fadeHit(t){if(!this.info.fade)return;const{start:e,end:n}=this.info.fade;e&&!this.fadeState.in&&t>=0&&(this.fadeState.in=!0,this.media.fadeIn(0,e)),n&&!this.fadeState.out&&t>=this.duration-n/1e3&&(this.fadeState.out=!0,this.media.fadeOut(0,n))}changeBookmarkIndex(t,e){if(this.bookmarkList&&this.bookmarkList.length!==0){if(this.pickBookmarkIndex>0){for(let n=0;n<this.pickBookmarkIndex;n++)if(this.bookmarkList[n].time>t){this.pickBookmarkIndex=n;break}}if(e){let n=this.pickBookmarkIndex-1;for(let r=0;r<this.bookmarkList.length;r++)this.bookmarkList[r].time<t&&(n=r);for(let r=this.pickBookmarkIndex;r<=n;r++){const o=this.bookmarkList[r];o&&this.ctx.timingEventHub.emit(`shape ${this.shapeId} onMediaBookmark ${o.name}`)}this.pickBookmarkIndex=n+1}}}playMediaFromCtrl(t){this.ctx.isPlayerPaused()?this.ctx.logger.info("Media controller prevent play event with paused state",this.ctx.taskId):(this.ctx.mode!=="interactive"&&this.playMedia(),this.ctx.mode!=="local"&&this.ctx.eventHub.emit(Ke.mediaPlay,{id:this.targetId,time:this.media.currentTime-this.start,_stateOnly:t}))}pauseMediaFromCtrl(t){this.ctx.isPlayerPaused()?this.ctx.logger.info("Media controller prevent pause event with paused state",this.ctx.taskId):(this.ctx.mode!=="interactive"&&this.pauseMedia(),this.ctx.mode==="local"||this.ctx.isRendering||this.ctx.eventHub.emit(Ke.mediaPause,{id:this.targetId,time:this.media.currentTime-this.start,_stateOnly:t}))}setControllerPosition(){var t;const{target:e}=this,{portalWidth:n,portalHeight:r}=Wo,{stageWidth:o,stageHeight:s}=this.ctx,a=e.getGlobalPosition(),l=Number((t=this.container)===null||t===void 0?void 0:t.getAttribute("data-scale")),h=o*l,u=1/l*(n>h?h/n:1);a.y=a.y+this.height-r,a.x=Math.max(a.x,0),a.x=Math.min(a.x,o-n*u),a.y=Math.max(a.y,0),a.y=Math.min(a.y,s-r),rr(this.mediaController,{height:r+"px",borderRadius:r/2+"px",width:n+"px",flexDirection:"row",alignItems:"center",position:"absolute",left:a.x+"px",top:a.y+"px",background:"#fff",zIndex:"2",border:"1px solid #ccc",transform:`scale(${u})`,transformOrigin:"0 100%"}),this.fullscreenStatus&&rr(this.mediaController,{left:"0",top:s-r+"px"})}createMediaController(){this.setControllerPosition(),rr(this.mediaController,{display:"none",transition:`opacity ${Wo.opacityAnimationTime}s`}),this.createButton();const t=this.createTimer();this.createProgress(),this.mediaController.append(this.playButton,this.pauseButton,t,this.progress),this.isVideo&&this.mediaController.append(this.fullScreenButton,this.exitFullScreenButton),this.container.appendChild(this.mediaController),this.bindEvent()}addPlayCallBack(t){this.playCallBackList.push(t)}fullscreenPlay(){this.fullscreenStatus=!0,this.ctx.mode!=="interactive"&&this.media.requestFullscreen(),this.ctx.mode!=="local"&&this.ctx.eventHub.emit(Ke.fullscreenChange,{targetId:this.targetId,state:!0}),this.delayHide()}changeFullScreenState(t,e,n){n===this.ctx.slideIndex&&(t&&this.targetId===e?this.fullscreenStatus=t:this.fullscreenStatus=!1,this.fullscreenStatus?(this.fullScreenButton.style.display="none",this.exitFullScreenButton.style.display="block"):(this.fullScreenButton.style.display="block",this.exitFullScreenButton.style.display="none"),this.setControllerPosition())}bindEvent(){fs.isDesktop()&&(this.mediaController.addEventListener("mouseout",this.onMouseOut,!1),this.mediaController.addEventListener("mouseover",this.showController,!1)),this.progress.addEventListener("click",this.changeMediaProgress,!1),this.playButton.addEventListener("click",this._playMediaFromCtrl,!1),this.pauseButton.addEventListener("click",this._pauseMediaFromCtrl,!1),this.media.on("durationchange",this.getMediaDuration,!1),this.media.on("timeupdate",this.mediaTimeUpdate,!1),this.media.on("pause",this.onPauseMedia,!1),this.media.on("play",this.onPlayMedia,!1),this.containerObserver=new MutationObserver(this.onContainerSizeChange),this.container&&this.containerObserver.observe(this.container,{attributes:!0,attributeFilter:["data-scale","style"]}),this.isVideo&&(this.ctx.globalEventHub.on("onFullscreenChange",this.onFullScreenChange),this.ctx.globalEventHub.on("controllerShowStatusChange",this.onControllerShowStatusChange),this.fullScreenButton.addEventListener("click",this.onClickFullScreenButtonHandle,!1),this.exitFullScreenButton.addEventListener("click",this.onClickCancelFullScreenButtonHandle,!1))}unbindEvent(){var t;fs.isDesktop()&&(this.mediaController.removeEventListener("mouseout",this.onMouseOut,!1),this.mediaController.removeEventListener("mouseover",this.showController,!1)),this.progress.removeEventListener("click",this.changeMediaProgress,!1),this.playButton.removeEventListener("click",this._playMediaFromCtrl,!1),this.pauseButton.removeEventListener("click",this._pauseMediaFromCtrl,!1),this.media.removeAllListeners(),(t=this.containerObserver)===null||t===void 0||t.disconnect(),this.isVideo&&(this.ctx.globalEventHub.removeListener("onFullscreenChange",this.onFullScreenChange),this.ctx.globalEventHub.removeListener("controllerShowStatusChange",this.onControllerShowStatusChange),this.fullScreenButton.removeEventListener("click",this.onClickFullScreenButtonHandle,!1),this.exitFullScreenButton.removeEventListener("click",this.onClickCancelFullScreenButtonHandle,!1))}show(){this.setControllerPosition(),this.mediaController.style.opacity=Wo.hoverOpacity,this.fullscreenStatus||(this.mediaController.style.display="flex"),this.delayHide()}hide(){this.fullscreenStatus?this.mediaController.style.opacity=Wo.hiddenOpacity:this.mediaController.style.display="none"}delayHide(){clearTimeout(this.autoHiddenTimer),this.autoHiddenTimer=setTimeout(()=>{this.hide()},Wo.hoverHiddeDelay)}destroy(){var t;this.unbindEvent(),this.playCallBackList=[],(t=this.container)===null||t===void 0||t.removeChild(this.mediaController)}}var GE=v(120);class Tc extends xi.a{constructor(t,e,n){var r,o;super(),this.isGlobalPause=!1,this.lastTime=-1,this.howl=null,this.rctClient=null,this.isHowlEnd=!1,this.isHowlLoadEmit=!1,this.staticEventId=1001,this._catParams=void 0,this.url=t,this.runningAudio=e,n&&(this._catParams=n),lr.RtcAudioClazz?(this.rctClient=new lr.RtcAudioClazz(t,(r=this._catParams)===null||r===void 0?void 0:r.start,(o=this._catParams)===null||o===void 0?void 0:o.end),this.rctClient.on("load",()=>this.emit("load")),this.rctClient.on("pause",()=>this.emit("pause")),this.rctClient.on("play",()=>{this.startTimeChangeEmit(),this.emit("play")}),this.rctClient.on("resumeAllAudioInterruptByAudioSessionChanged",()=>{this.emit("resumeAllAudioInterruptByAudioSessionChanged")})):(this.howl=new GE.Howl({src:[t]}),[this.staticEventId]=this.howl._getSoundIds(),this.howl.load(),this.howl.on("load",()=>{this.isHowlLoadEmit=!0,this.emit("load")}),this.howl.on("pause",()=>this.emit("pause")),this.howl.on("play",()=>{this.isHowlLoadEmit||this.emit("load"),this.isHowlEnd=!1,this.startTimeChangeEmit(),this.emit("play")}),this.howl.on("end",()=>{this.isHowlEnd=!0}))}startTimeChangeEmit(){this.currentTime!==this.lastTime&&(this.lastTime=this.currentTime,this.emit("timeupdate",this.lastTime)),this.isPaused||setTimeout(()=>{this.isPaused||this.startTimeChangeEmit()},300)}play(){var t,e,n;this.runningAudio.has(this.url)&&((t=this.runningAudio.get(this.url))===null||t===void 0||t.stop(),this.runningAudio.delete(this.url)),this.isHowlEnd=!1,this.lastTime=-1,(e=this.howl)===null||e===void 0||e.play(this.staticEventId),(n=this.rctClient)===null||n===void 0||n.play(),this.runningAudio.set(this.url,this)}fade(t,e,n){this.howl&&this.howl.fade(t,e,n)}pause(){var t,e;(t=this.howl)===null||t===void 0||t.pause(this.staticEventId),(e=this.rctClient)===null||e===void 0||e.pause(),this.runningAudio.has(this.url)&&this.runningAudio.delete(this.url)}globalPause(){this.isPaused||(this.isGlobalPause=!0,this.pause())}globalResume(){this.isGlobalPause&&(this.isGlobalPause=!1,this.play())}stop(){var t;(t=this.howl)===null||t===void 0||t.pause(this.staticEventId),this.rctClient&&(this.rctClient.pause(),this.rctClient.currentTime=0),this.runningAudio.has(this.url)&&this.runningAudio.delete(this.url)}destroy(){var t,e,n,r,o,s,a,l;(t=this.howl)===null||t===void 0||t.stop(this.staticEventId),(e=this.howl)===null||e===void 0||e.unload(),(n=this.rctClient)===null||n===void 0||n.pause(),(r=this.rctClient)===null||r===void 0||r.destroy(),(o=this.rctClient)===null||o===void 0||o.removeAllListeners("load"),(s=this.rctClient)===null||s===void 0||s.removeAllListeners("play"),(a=this.rctClient)===null||a===void 0||a.removeAllListeners("pause"),(l=this.rctClient)===null||l===void 0||l.removeAllListeners("resumeAllAudioInterruptByAudioSessionChanged"),this.runningAudio.has(this.url)&&this.runningAudio.delete(this.url)}get currentTime(){return this.rctClient?this.rctClient.currentTime:this.howl?this.howl.seek(this.staticEventId):-1}set currentTime(t){this.rctClient?this.rctClient.currentTime=t:this.howl&&this.howl.seek(t,this.staticEventId)}get duration(){return this.rctClient?this.rctClient.duration:this.howl?this.howl.duration(this.staticEventId):0}get isPaused(){return this.rctClient?this.rctClient.isPaused:!!this.howl&&!this.howl.playing(this.staticEventId)}volume(t){this.rctClient?this.rctClient.volume(t):this.howl&&this.howl.volume(t)}}var Qg=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class HE extends xi.a{constructor(t){var e,n,r,o,s,a,l;super(),this.type="video",this.sprite=new pi,this.isPlaying=!1,this.isGlobalPause=!1,this.fullscreen=!1,this.url="",this.isLoaded=!1,this.onVideoResourceLoaded=()=>{this.isLoaded=!0},this.onVideoStalled=()=>{this.ctx.logger.warn(this.url+", Failed to fetch data, but trying.",this.ctx.taskId)},this.updateVolume=C=>{this.rtcAudio.volume(C)},this.syncFullscreenVideoState=C=>{const{targetId:j,state:Z,slideIndex:rt}=C;rt===this.ctx.slideIndex&&j===this.id&&(Z?(this.requestFullscreen(),this.ctx.latestChangeFullscreenTargetId=j):this.requestCancelFullscreen())},this.id=t.id,this.start=(e=t.video.cut)===null||e===void 0?void 0:e.start,this.end=(n=t.video.cut)===null||n===void 0?void 0:n.end,this.fullscreen=(r=t.video.fullscreen)!==null&&r!==void 0&&r,this.container=t.container,this.ctx=t.ctx,this.ctx.medias[this.id]=this;const h=t.video.src;this.videoResource=new ce.w(h,{autoLoad:!0,autoPlay:!1,updateFPS:30,crossorigin:!0}),(o=this.videoElement)===null||o===void 0||o.addEventListener("stalled",this.onVideoStalled),(s=this.videoElement)===null||s===void 0||s.addEventListener("loadedmetadata",this.onVideoResourceLoaded),this.url=t.video.src;let u=t.video.src.replace(/4$/,"3");this.ctx.loaderDelegate&&(u=this.ctx.loaderDelegate.redirectMedia(u),this.ctx.logger.info(`redirect media url from ${t.video.src.replace(/4$/,"3")} to ${u} by delegate.`,t.ctx.taskId)),this.rtcAudio=new Tc(u,t.ctx.runningAudio,{start:(a=t.video.cut)===null||a===void 0?void 0:a.start,end:(l=t.video.cut)===null||l===void 0?void 0:l.end}),this.rtcAudio.on("timeupdate",C=>{if(this.videoElement){const j=this.videoElement.currentTime;Math.abs(j-C)>.5&&(this.videoElement.currentTime=C)}}),this.rtcAudio.on("resumeAllAudioInterruptByAudioSessionChanged",()=>{var C;(C=this.videoElement)===null||C===void 0||C.pause(),setTimeout(()=>{var j;this.rtcAudio.isPaused||(j=this.videoElement)===null||j===void 0||j.play()},200)});const{video:p,width:y,height:x,target:E}=t;this.controller=new Va({targetId:t.id,shapeId:t.shapeId,ctx:t.ctx,width:y,height:x,target:E,media:this,info:p,canvasElement:t.canvasElement}),this.controller.addPlayCallBack(()=>{this.sprite.width=y,this.sprite.height=x,this.ctx.clock.setTimeout(()=>{this.sprite.visible=!0},50)});const w=new ce.c(null,{height:x,width:y});w.resource=this.videoResource,this.videoResource.bind(w),this.sprite=new pi,this.sprite.visible=!1,this.sprite.texture=new ce.t(w),this.sprite.interactive=!0,this.container.addChild(this.sprite),this.sprite.on("mouseover",C=>{C.stopPropagation(),this.controller.show()}),this.sprite.on("mouseout",C=>{C.stopPropagation(),this.controller.hide()}),["durationchange","timeupdate","pause","play"].forEach(C=>{var j;(j=this.videoElement)===null||j===void 0||j.addEventListener(C,()=>{C==="timeupdate"&&this.isPlaying,this.emit(C)})}),this.ctx.activeMedia.add(this),this.ctx.volumeAdjuster.on("update",this.updateVolume),this.ctx.globalEventHub.on("syncFullscreenVideoState",this.syncFullscreenVideoState)}get videoElement(){return this.videoResource.source}get currentTime(){var t,e;return(e=(t=this.videoElement)===null||t===void 0?void 0:t.currentTime)!==null&&e!==void 0?e:0}set currentTime(t){this.rtcAudio.currentTime=t,this.videoElement&&(this.videoElement.currentTime=t)}get paused(){var t,e;return(e=(t=this.videoElement)===null||t===void 0?void 0:t.paused)===null||e===void 0||e}get duration(){var t,e;return(e=(t=this.videoElement)===null||t===void 0?void 0:t.duration)!==null&&e!==void 0?e:0}get clippedDuration(){return this.controller.clippedDuration}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){return Qg(this,void 0,void 0,function*(){this.isPlaying=!0,this.updateVolume(this.ctx.volumeAdjuster.volume),yield this.load(),yield this.ctx.clock.waitUntil(()=>{const e=this.videoElement;return!!(e&&e.videoWidth>0)},3e3);const t=this.videoElement;t&&t.videoWidth<=0||(this.videoElement&&(this.videoElement.volume=0,this.videoElement.muted=!0),this.rtcAudio.on("play",()=>{var e;(e=this.videoElement)===null||e===void 0||e.play(),this.fullscreen&&this.controller.fullscreenPlay()}),this.rtcAudio.play())})}load(){return this.videoResource.load()}pause(){this.isPlaying=!1,this.ctx.logger.warn(this.url+", pause video manual.",this.ctx.taskId),this.ctx.logger.warn(this.url+", pause rtc audio manual.",this.ctx.taskId),this.rtcAudio.on("pause",()=>{var t;(t=this.videoElement)===null||t===void 0||t.pause()}),this.rtcAudio.pause()}globalPause(){this.isPlaying&&(this.isGlobalPause=!0,this.pause())}globalResume(){this.isGlobalPause&&(this.isGlobalPause=!1,this.play())}togglePause(){this.isPlaying?this.pause():this.play()}seek(t){this.controller.jumpToTime(t)}stop(){this.rtcAudio.stop(),this.seek(0),this.pause(),this.ctx.eventHub.emit(Ke.mediaStop,{id:this.id})}requestFullscreen(){return Qg(this,void 0,void 0,function*(){yield ih(()=>this.isLoaded,5e3);const t=new ce.t(this.sprite.texture.baseTexture);this.ctx.globalEventHub.emit("requestFullscreen",{texture:t,index:this.ctx.slideIndex,targetId:this.id})})}requestCancelFullscreen(){this.ctx.globalEventHub.emit("requestCancelFullscreen",{targetId:this.id,index:this.ctx.slideIndex})}destroy(){var t,e,n;this.ctx.volumeAdjuster.removeListener("update",this.updateVolume),this.ctx.globalEventHub.removeListener("syncFullscreenVideoState",this.syncFullscreenVideoState),(t=this.videoElement)===null||t===void 0||t.removeEventListener("stalled",this.onVideoStalled),(e=this.videoElement)===null||e===void 0||e.removeEventListener("loadedmetadata",this.onVideoResourceLoaded),this.sprite.interactive=!1,this.sprite.destroy({texture:!0,baseTexture:!0}),(n=this.videoResource)===null||n===void 0||n.destroy(),this.rtcAudio.destroy(),this.stop(),this.controller.destroy(),this.ctx.activeMedia.delete(this)}fadeIn(t,e){this.rtcAudio.fade(t,this.ctx.volumeAdjuster.volume,e)}fadeOut(t,e){this.rtcAudio.fade(this.ctx.volumeAdjuster.volume,t,e)}}var jE=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class zE extends xi.a{constructor(t){var e,n;super(),this.type="audio",this.isPlaying=!1,this.isGlobalPause=!1,this.updateVolume=l=>{this.audioPlayer.volume(l)},this.id=t.id;const r=t.audio.src;this.audioPlayer=new Tc(r,t.ctx.runningAudio,{start:(e=t.audio.cut)===null||e===void 0?void 0:e.start,end:(n=t.audio.cut)===null||n===void 0?void 0:n.end}),t.audio.cut&&(this.start=t.audio.cut.start,this.end=t.audio.cut.end),this.ctx=t.ctx,this.ctx.medias[this.id]=this;const{width:o,height:s,target:a}=t;this.controller=new Va({targetId:t.id,shapeId:t.shapeId,ctx:t.ctx,height:s,width:o,target:a,media:this,info:t.audio,canvasElement:t.canvasElement}),this.audioPlayer.on("load",()=>this.emit("durationchange")),this.audioPlayer.on("timeupdate",()=>this.emit("timeupdate")),this.audioPlayer.on("pause",()=>this.emit("pause")),this.audioPlayer.on("play",()=>this.emit("play")),this.ctx.activeMedia.add(this),this.ctx.volumeAdjuster.on("update",this.updateVolume)}get currentTime(){return this.audioPlayer.currentTime}set currentTime(t){this.audioPlayer.currentTime=t}get clippedDuration(){return this.controller.clippedDuration}get paused(){return this.audioPlayer.isPaused}get isPaused(){return this.audioPlayer.isPaused}get duration(){return this.audioPlayer.duration}load(){return Promise.resolve()}showController(){this.controller.show()}hideController(){this.controller.hide()}play(){return jE(this,void 0,void 0,function*(){this.ctx.isPlayerPaused()?this.ctx.logger.info("Audio player prevent play event with paused state",this.ctx.taskId):(this.updateVolume(this.ctx.volumeAdjuster.volume),this.isPlaying=!0,this.audioPlayer.play())})}pause(){this.ctx.isPlayerPaused()?this.ctx.logger.info("Audio player prevent pause event with paused state",this.ctx.taskId):(this.isPlaying=!1,this.audioPlayer.pause())}globalPause(){this.isPlaying&&(this.isGlobalPause=!0,this.pause())}globalResume(){this.isGlobalPause&&(this.isGlobalPause=!1,this.play())}togglePause(){this.isPlaying?this.pause():this.play()}seek(t){this.ctx.isPlayerPaused()?this.ctx.logger.info("Audio player prevent seek event with paused state",this.ctx.taskId):this.controller.jumpToTime(t)}stop(){this.audioPlayer.stop(),this.seek(0),this.pause(),this.ctx.eventHub.emit(Ke.mediaStop,{id:this.id})}requestFullscreen(){}requestCancelFullscreen(){}destroy(){this.ctx.volumeAdjuster.removeListener("update",this.updateVolume),this.stop(),this.controller.destroy(),this.ctx.activeMedia.delete(this),this.audioPlayer.destroy()}fadeIn(t,e){this.audioPlayer.fade(t,this.ctx.volumeAdjuster.volume,e)}fadeOut(t,e){this.audioPlayer.fade(this.ctx.volumeAdjuster.volume,t,e)}}var $g=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class VE extends Zg{constructor(t,e,n){super(Object.assign(Object.assign({},t),{type:"Shape",useBgFill:!1,textRotateWithShape:!0,isPicture:!0}),e,n),this.isInteractiveOutside=!1,this.cmd=new UT(this),this.media=t==null?void 0:t.media,this.container.name=t.id+"_container_[Picture]",this.renderContainer.name=t.id+"_render_container_[Picture]",this.picFill=new mo(this.ctx,t.picFill,t.width,t.height,{useFilter:!0,useSlideBackgroundFill:!1})}applyCommand(t,e){var n,r,o,s;if(e==="call")if(/playFrom\(([0-9.]+)\)/.test(t)){const a=t.match(/playFrom\(([0-9.]+)\)/),l=Number(a[1]||"0");(n=this.mediaPlayer)===null||n===void 0||n.controller.playMediaFromCtrl(!0),Math.abs(l)>.1&&((r=this.mediaPlayer)===null||r===void 0||r.controller.jumpToTime(l))}else t==="custom-pause"?(o=this.mediaPlayer)===null||o===void 0||o.controller.pauseMediaFromCtrl(!0):t==="togglePause"?this.mediaPlayer&&(this.mediaPlayer.isPlaying?this.mediaPlayer.controller.pauseMediaFromCtrl(!0):this.mediaPlayer.controller.playMediaFromCtrl(!0)):t==="stop"&&((s=this.mediaPlayer)===null||s===void 0||s.stop())}renderPic(){var t,e,n,r,o,s;return $g(this,void 0,void 0,function*(){const{displayObject:a}=this.picFill;if(a){a.name=this.json.id+"_pic_fill_[Picture]";const l=(t=this.backgroundGraphics)===null||t===void 0?void 0:t.getClonedDisplayObject();if(((e=this.backgroundGraphics)===null||e===void 0?void 0:e.isNeedMask(a.width,a.height))&&l&&(a.mask=l,this.effectContainer.addChild(l)),a.width=this.designWidth,a.height=this.designHeight,a instanceof lc&&this.ctx.slideScopeEventHub.once("slide-render",h=>{var u;this.ctx.slideIndex===h&&((u=this.effectObject)===null||u===void 0||u.setFrameCount(a.totalFrames),a.play(),a.onFrameChange=p=>{if(this.effectObject)if(this.effectObject.hasFrame(p))this.effectObject.updateFrame(p);else{const y=this.getEffectTexture();y&&(this.effectObject.createFrame(p,y.texture),this.effectObject.setFrameOffset(y.offsetX,y.offsetY))}})}),this.effectContainer.addChild(a),this.media){let h=this.media.src;if(this.media.type==="audio"&&/mp4$/.test(h)&&(h=h.replace(/mp4$/,"mp3")),this.ctx.urlInterrupter){const u=Date.now();h=yield this.ctx.urlInterrupter(h),this.ctx.logger.info("redirect media url by interrupter. time: "+(Date.now()-u),this.ctx.taskId)}this.ctx.loaderDelegate&&(h=this.ctx.loaderDelegate.redirectMedia(h),this.ctx.logger.info(`redirect media url to ${h} by delegate.`,this.ctx.taskId)),this.media.src=h}if(((n=this.media)===null||n===void 0?void 0:n.type)==="video"&&this.media.src){if(this.mediaPlayer=new HE({id:this.json.id+"-video",shapeId:this.json.id,ctx:this.ctx,video:this.media,height:this.designHeight,width:this.designWidth,target:a,container:this.effectContainer,canvasElement:this.ctx.view}),((r=this.mediaPlayer)===null||r===void 0?void 0:r.sprite)&&l){const h=(o=this.backgroundGraphics)===null||o===void 0?void 0:o.getClonedDisplayObject();h&&(this.mediaPlayer.sprite.mask=h,this.container.addChild(h))}}else((s=this.media)===null||s===void 0?void 0:s.type)==="audio"&&this.media.src&&(this.mediaPlayer=new zE({id:this.json.id+"-audio",shapeId:this.json.id,ctx:this.ctx,audio:this.media,height:this.designHeight,width:this.designWidth,target:a,canvasElement:this.ctx.view,fade:this.media.fade}));this.mediaPlayer&&(this.isInteractiveOutside=!!this.container.interactive,this.container.interactive=!0,fs.isDesktop()?(this.container.on("mouseover",()=>{this.mediaPlayer.showController()}),this.container.on("mouseout",()=>{this.mediaPlayer.hideController()},!1)):this.container.on("pointerdown",()=>{this.mediaPlayer.showController()}))}})}preRender(t){super.preRender(t)}subClassRender(){return $g(this,void 0,void 0,function*(){yield this.renderPic()})}clearOnSlideChange(){super.clearOnSlideChange(),this.mediaPlayer&&(this.container.interactive=!1,this.mediaPlayer.stop(),this.mediaPlayer.hideController())}initOnReuse(){super.initOnReuse(),this.mediaPlayer&&(this.container.interactive=!0)}destroy(){this.mediaPlayer&&(this.picFill.displayObject&&!this.isInteractiveOutside&&(this.container.interactive=!1),this.mediaPlayer.destroy(),this.mediaPlayer=void 0),this.picFill.destroy()}}var gh=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Ec extends pc{constructor(t,e,n,r){super(t,e,n),this.children=[],this.cacheSprite=new pi,this.cacheContainer=new Cn.b,this.json=t,this.json.fillStyle&&this.json.fillStyle.fillType==="groupFill"&&n.groupFillStyle&&(this.json.fillStyle=n.groupFillStyle),this.container.name=t.id+"_container_[Container]",this.cacheContainer.name=t.id+"_cache_container_[Container]",this.ctx.timingTargets.addTarget(t.id,this),this.updateTransform(this.json),this.fillObject=new mo(this.ctx,t.fillStyle,t.width,t.height,{useFilter:!1,useSlideBackgroundFill:!1}),this.createChildren(r)}createChildren(t){var e,n,r,o;const s={x:(n=(e=this.json.position)===null||e===void 0?void 0:e.x)!==null&&n!==void 0?n:0,y:(o=(r=this.json.position)===null||r===void 0?void 0:r.y)!==null&&o!==void 0?o:0};for(let a=0,l=this.json.children.length;a<l;a++)t.addSubMTask(()=>gh(this,void 0,void 0,function*(){let h=this.json.children[a],u=null;if(!(!this.ctx.featureList||!this.ctx.featureList.smartArt)&&((h==null?void 0:h.type)==="Shape"||(h==null?void 0:h.type)==="Picture")&&this.ctx.smartArtShapeList){const{id:y}=h,x=this.ctx.smartArtShapeList.find(E=>E.id===y);x&&(h=x)}const p={parentGlobalPos:s,groupFillStyle:this.json.fillStyle,groupSize:{w:this.json.width,h:this.json.height}};(h==null?void 0:h.type)==="Shape"?u=new Zg(h,this.ctx,p):(h==null?void 0:h.type)==="Picture"?u=new VE(h,this.ctx,p):(h==null?void 0:h.type)==="Container"&&(u=new Ec(h,this.ctx,p,t)),u&&this.children.push(u)}),"@ContainerImpl[child.init]")}get interactiveContainer(){return this.container}get renderContainer(){return this.container}preRender(t){for(const e of this.children)t.addSubMTask(()=>gh(this,void 0,void 0,function*(){e.preRender(t)}),"@ContainerImpl[child.preRender]")}getBgElement(){return null}getIterateEntry(t,e,n){return e===0?this:(this.ctx.eventHub.emit("IterateTimeNodeEnd",n),null)}getTextElement(){return null}render(t){for(const e of this.children)e.render(t),t.addSubMTask(()=>gh(this,void 0,void 0,function*(){this.cacheContainer.addChild(e.renderContainer)}),"@ContainerImpl[child.render]");t.addSubMTask(()=>gh(this,void 0,void 0,function*(){this.container.addChild(this.cacheContainer)}),"@ContainerImpl[child.append]")}clearOnSlideChange(){this.children.forEach(t=>t.clearOnSlideChange())}initOnReuse(){this.children.forEach(t=>t.initOnReuse())}isChildrenInteractive(){for(const t of this.json.children)if((t==null?void 0:t.type)==="Container"||(t==null?void 0:t.type)==="Stage"||(t==null?void 0:t.hlinkHover)||(t==null?void 0:t.hlinkClick))return!0;return!1}destroy(){this.cacheSprite&&this.cacheSprite.destroy({texture:!0}),this.children.forEach(t=>t.destroy()),this.container.destroy({children:!0,texture:!0,baseTexture:!0}),this.cacheContainer.destroy({children:!0,texture:!0,baseTexture:!0})}}class Wa extends xi.a{constructor(t,e,n,r){super(),this.cond={},this.timeoutIds=[],this.condHandle=(o,s={})=>{if(o)if(o.delay&&o.delay>0){const a=this.ctx.clock.setTimeout(()=>{o.event&&(this.cond[o.event]=!0,this.detectTrigger(s))},o.delay);this.timeoutIds.push(a)}else this.cond[o.event]=!0,this.detectTrigger(s);else this.detectTrigger(s)},this.id=t,this.ctx=r,this.eventHubs=n,e.forEach(o=>{this.addCond(o)})}setTriggerParams(t){this.triggerParams=t}addCond(t){const e=(...n)=>{this.condHandle(t,n)};t.event&&(/^shape/.test(t.event)||/^time/.test(t.event)?(this.cond[t.event]=!1,this.eventHubs.global.addListener(t.event,e)):/^runtime/.test(t.event)?(this.cond[t.event]=!1,this.eventHubs.runtime.addListener(t.event,e)):/^self/.test(t.event)?t.delay&&t.delay>0&&(this.cond[t.event]=!1,this.eventHubs.runtime.addListener(t.event,e)):this.cond[t.event]=!1)}isTrigger(){return Object.keys(this.cond).every(t=>!!this.cond[t])}isTriggerWithoutParent(){return Object.keys(this.cond).filter(t=>t!=="self").every(t=>!!this.cond[t])}detectTrigger(t){if(Object.keys(this.cond).every(e=>!!this.cond[e])){Object.keys(this.cond).forEach(n=>{this.cond[n]=!1});const e=this.triggerParams;this.triggerParams=void 0,this.emit("active",e,t)}}reset(){Object.keys(this.cond).forEach(t=>{this.cond[t]=!1}),this.timeoutIds.forEach(t=>this.ctx.clock.clearTimeout(t))}}class WE extends xi.a{constructor(t){super(),this.isTimeNodeEndSync=!1,this.interactiveListeners=[],this.runtimeNodeEventHub=new xi.a,this._currentSeqIndex=0,this._currentSeqState="idle",this.isForward=!0,this.autoPlay=!1,this.handlePrev=(y=!1)=>{var x,E,w,C,j,Z;this.hasPrev()||!this.isMainSeq?this.currentSeqState==="idle"?(this.decrSeqIndex(),(x=this.commonTimeNode.children[this.currentSeqIndex])===null||x===void 0||x.commonTimeNode.seekToStart(),(E=this.commonTimeNode.children[this.currentSeqIndex])===null||E===void 0||E.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="running"?((w=this.commonTimeNode.children[this.currentSeqIndex])===null||w===void 0||w.commonTimeNode.seekToStart(),(C=this.commonTimeNode.children[this.currentSeqIndex])===null||C===void 0||C.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.currentSeqState==="end"&&(this.currentSeqIndex>=this.commonTimeNode.children.length&&(this.currentSeqIndex=this.commonTimeNode.children.length-1),(j=this.commonTimeNode.children[this.currentSeqIndex])===null||j===void 0||j.commonTimeNode.seekToStart(),(Z=this.commonTimeNode.children[this.currentSeqIndex])===null||Z===void 0||Z.commonTimeNode.clearSubList(),this.currentSeqState="idle"):this.globalEventHub.emit("c:prev slide",y)},this.handleNext=(y,x)=>{var E,w,C,j;if(this.isTimeNodeEndSync&&(this.isTimeNodeEndSync=!1,this.currentSeqState="idle",this.currentSeqIndex=0),!this.hasNext()&&this.isMainSeq&&x)this.globalEventHub.emit("c:next slide",y);else{if(this.isInteractiveSeq){this.globalEventHub.emit("shape slide onNext"+(this.json.ctn.id||""));const Z={result:null};this.findChildInfiniteRepeat(this.commonTimeNode,Z),this.commonTimeNode.children.length===1&&Z.result&&(Z.result.json.subTnLst||[]).length>0&&this.currentSeqIndex===0&&this.currentSeqState==="running"&&this.commonTimeNode.allChildrenEndHandle()}this.currentSeqState==="idle"?(E=this.commonTimeNode.children[this.currentSeqIndex])===null||E===void 0||E.commonTimeNode.startTimeNodeForce():this.currentSeqState==="running"?((w=this.commonTimeNode.children[this.currentSeqIndex])===null||w===void 0||w.commonTimeNode.seekToEnd(!1,!0),this.currentSeqState="end",this.incrSeqIndex(),(C=this.commonTimeNode.children[this.currentSeqIndex])===null||C===void 0||C.commonTimeNode.startTimeNodeForce()):this.currentSeqState==="end"&&(this.incrSeqIndex(),(j=this.commonTimeNode.children[this.currentSeqIndex])===null||j===void 0||j.commonTimeNode.startTimeNodeForce())}};const{json:e,iterateType:n,isIterate:r,isSub:o,parent:s,ctx:a,eventHub:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p}=t;this.isMainSeq=e.ctn.nodeType==="mainSeq",this.isInteractiveSeq=e.ctn.nodeType==="interactiveSeq",this.id=e.ctn.id,this.isIterate=r,this.json=e,this.ctx=a,this.globalEventHub=l,this.commonTimeNode=new Qs({json:e.ctn,isSub:o,eventHubs:{global:l,runtime:this.runtimeNodeEventHub},ctx:a,parent:s,isIterate:!1,iterateType:n,iterateIndex:h,iterateId:u,isInInteractiveSeq:p||this.isInteractiveSeq,fromSeqId:this.isInteractiveSeq?this.json.ctn.id:""}),this.bindShapeEvent(),this.nextConds=new Wa("mainSeq",e.nextCondLst,{global:l,runtime:this.runtimeNodeEventHub},this.ctx),this.prevConds=new Wa("mainSeq",e.preCondLst,{global:l,runtime:this.runtimeNodeEventHub},this.ctx),this.commonTimeNode.on("timeNodeRestart",()=>{this.currentSeqIndex=0,this.currentSeqState="idle"}),this.commonTimeNode.on("childTimeNodeStart",y=>{const x=this.commonTimeNode.children.findIndex(E=>E.commonTimeNode.uuid===y.id);x>=0&&(this.currentSeqIndex=x),this.currentSeqState="running",this.isMainSeq&&this.ctx.eventHub.emit(Ke.mainSeqStepStart,x)}),this.commonTimeNode.on("childTimeNodeEnd",y=>{const x=this.commonTimeNode.children.findIndex(E=>E.commonTimeNode.uuid===y.id);x>=0&&(this.currentSeqIndex=x),this.currentSeqState="end",this.autoPlay&&this.ctx.clock.setTimeout(()=>{this.handleNext(!1,!0)}),this.isMainSeq&&this.ctx.eventHub.emit(Ke.mainSeqStepEnd,x)}),this.commonTimeNode.on("timeNodeEndSync",()=>{this.isTimeNodeEndSync=!0,this.commonTimeNode.resetForRepeat()}),this.commonTimeNode.on("timeNodeDestroy",()=>{this.interactiveListeners.forEach(([y,x])=>{y&&x&&y.interactiveContainer.removeListener("pointerdown",x)}),this.interactiveListeners=[]}),this.nextConds.on("active",(y,x)=>{Array.isArray(x)?this.handleNext(x[0],x[1]):this.handleNext(x,!0)}),this.prevConds.on("active",(y,x)=>{Array.isArray(x)?this.handlePrev(x[0]):this.handlePrev(x)})}get currentSeqIndex(){return this._currentSeqIndex}set currentSeqIndex(t){this._currentSeqIndex=t,this.isMainSeq?this.ctx.eventHub.emit(Ke.mainSeqStepChange,t):this.isInteractiveSeq&&this.ctx.eventHub.emit(Ke.interactiveSeqStateChange,{id:this.json.ctn.id,state:{step:t,state:this._currentSeqState}})}get currentSeqState(){return this._currentSeqState}set currentSeqState(t){this._currentSeqState=t,this.isMainSeq?this.ctx.eventHub.emit(Ke.mainSeqStateChange,t):this.isInteractiveSeq&&this.ctx.eventHub.emit(Ke.interactiveSeqStateChange,{id:this.json.ctn.id,state:{step:this._currentSeqIndex,state:t}})}get stepLength(){return this.commonTimeNode.children.length}get currentStep(){return this.currentSeqIndex}get currentState(){return this.currentSeqState}startAutoPlay(){this.autoPlay=!0,this.commonTimeNode.children[0].commonTimeNode.startTimeNodeForce()}incrSeqIndex(){this.currentSeqIndex+1<=this.commonTimeNode.children.length&&(this.currentSeqIndex+=1)}decrSeqIndex(){this.currentSeqIndex-1>=-1&&(this.currentSeqIndex-=1)}hasPrev(){return!(this.currentSeqIndex<=0&&this.currentSeqState==="idle")}hasNext(){return!(this.currentSeqIndex>=this.commonTimeNode.children.length||this.currentSeqIndex===this.commonTimeNode.children.length-1&&this.currentSeqState==="end")}findChildInfiniteRepeat(t,e){t.isInfiniteRepeat()?e.result=t:t.children.map(n=>n.commonTimeNode).forEach(n=>this.findChildInfiniteRepeat(n,e))}bindShapeEvent(){this.json.ctn.nodeType==="interactiveSeq"&&this.json.nextCondLst.forEach(t=>{if(/^shape/.test(t.event)){const e=t.event.split(" ")[1];if(e){const n=this.ctx.timingTargets.getTargetById(e);if(n){n.interactiveContainer.interactive=!0,n.interactiveContainer.cursor="pointer";const r=()=>{this.ctx.eventHub.emit(Ke.userInput);const o=`shape ${e} onClick`,{mode:s}=this.ctx;s!=="interactive"&&s!=="sync"||this.ctx.eventHub.emit(Ke.interactiveSeqAction,{action:o,seqId:this.json.ctn.id}),s!=="sync"&&s!=="local"||this.globalEventHub.emit(o)};n.interactiveContainer.on("pointerdown",r),this.interactiveListeners.push([n,r])}}}})}setCurrentStep(t,e){const{length:n}=this.commonTimeNode.children;if(t>n)return;this.isInteractiveSeq&&this.commonTimeNode.applyCount===0&&(this.commonTimeNode.applyCount=1);let r=t;if(this.commonTimeNode.seekToStart(),r===-1&&(r=n-1),r!==0||e!=="start"){if(r>=0&&r<n)for(let o=0;o<=r;o++){const s=this.commonTimeNode.children[o];o!==r?s.commonTimeNode.seekToEnd(!1,!0):e==="start"?s.commonTimeNode.seekToStart():e==="end"&&s.commonTimeNode.seekToEnd(!1,!0)}this.currentSeqIndex=r,this.currentSeqState=e==="start"?"idle":"end"}}}function zr(i,t,e){const n=t.split(".");n.reduce((r,o,s)=>{if(r)return s!==n.length-1?r[o]:void(r[o]=e);console.warn(`${i} not support ${t}`)},i)}function Xa(i,t){return t?t.split(".").reduce((e,n)=>e?e[n]:(console.warn(`${i} not support ${t}`),null),i):null}class Xo{constructor(t){this.timingTarget=null,this.runtimeNodeEventHub=new xi.a,this.basicOnTimeNodeEnd=()=>{if(this.isConflict){const{target:x}=this.json.cBhvr,E=this.getTargetId(x);this.ctx.conflictTimeNodeManager.removeRunningTimeNode(E,this.modifyAttrKey)}},this.basicOnTimeLineStart=()=>{if(this.isConflict){const{target:x}=this.json.cBhvr;if(this.activeWhenConflict==="next"){const E=this.getTargetId(x);this.ctx.conflictTimeNodeManager.addRunningTimeNode(E,this.modifyAttrKey,this.commonTimeNode)}else this.activeWhenConflict==="prev"&&this.commonTimeNode.dispose()}};const{isIterate:e,isSub:n,json:r,ctx:o,parent:s,eventHub:a,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:y}=t;this.json=r,this.id=r.cBhvr.ctn.id,this.ctx=o,this.globalEventHub=a,this.commonTimeNode=new Qs({json:r.cBhvr.ctn,isSub:n,eventHubs:{global:a,runtime:this.runtimeNodeEventHub},ctx:o,parent:s,isIterate:e,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:y}),this.timingTarget=this.ctx.timingTargets.getTarget(r.cBhvr.target,e,{type:l,index:h,id:u}),this.commonTimeNode.on("seekToStart",()=>this.onSeekToStart()),this.commonTimeNode.on("seekToEnd",()=>this.onSeekToEnd()),this.commonTimeNode.on("timelineStart",this.basicOnTimeLineStart),this.commonTimeNode.on("timeNodeEnd",this.basicOnTimeNodeEnd)}getTargetId(t){let e=t.id;return t.type==="shape"&&t.txEl&&(e=`${e}-txEl-${t.txEl.range[0]}`),this.commonTimeNode.isIterate&&(e=`${e}-iterate-${this.commonTimeNode.iterateIndex}`),e}}class Sc extends Xo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.updateStartValue=()=>{this.timingTarget&&(this.startVal=Xa(this.timingTarget,this.json.cBhvr.attrList[0]))},this.onSeekToStart=()=>{const e=this.json.cBhvr.attrList[0];this.startVal!==null&&this.timingTarget&&zr(this.timingTarget,e,this.startVal)},this.onSeekToEnd=()=>{const e=this.json.cBhvr.attrList[0],n=this.json.cBhvr.to||this.json.to;n&&this.timingTarget&&zr(this.timingTarget,e,n)},this.commonTimeNode.on("timeNodeStart",this.updateStartValue),this.commonTimeNode.on("timeNodeCreate",this.updateStartValue),this.commonTimeNode.on("timeUpdate",({duration:e,delta:n})=>{if(n/e>=1){const r=this.json.cBhvr.attrList[0];this.json.cBhvr.attrList.length>1&&console.warn("this.json.cBhvr.attrList.length > 0");const o=this.json.cBhvr.to||this.json.to;o&&this.timingTarget&&zr(this.timingTarget,r,o)}})}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}}var vh=function(i,t,e,n){var r,o=arguments.length,s=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var a=i.length-1;a>=0;a--)(r=i[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};class _h{constructor(t,e){this.math={pi:Math.PI,e:Math.E,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,cosh:Math.cosh,deg:n=>n/Math.PI*180,exp:Math.exp,floor:Math.floor,ln:Math.log,max:Math.max,min:Math.min,rad:n=>n/180*Math.PI,rand:Math.random,sin:Math.sin,sinh:Math.sinh,sqrt:Math.sqrt,tan:Math.tan,tanh:Math.tanh},this.timingTarget=e,this.val=t.val.value,this.time=t.time,t.fmla&&(this.fmla=this.parseFmla(t.fmla))}parseFmla(t){let e=t.replace(/#ppt_h/g,`(${this.timingTarget.design_ppt_h})`);return e=e.replace(/#ppt_w/g,`(${this.timingTarget.design_ppt_w})`),e=e.replace(/#ppt_x/g,`(${this.timingTarget.design_ppt_x})`),e=e.replace(/#ppt_y/g,`(${this.timingTarget.design_ppt_y})`),e=e.replace(/ppt_w/g,"vars.ppt_w"),e=e.replace(/ppt_h/g,"vars.ppt_h"),e=e.replace(/ppt_x/g,"vars.ppt_x"),e=e.replace(/ppt_y/g,"vars.ppt_y"),e=e.replace(/#/g,"vars."),["abs","acos","asin","atan","ceil","cos","cosh","deg","exp","floor","ln","max","min","rad","rand","sin","sinh","sqrt","tan","tanh","pi","e"].forEach(n=>{const r=new RegExp(`([^a-z])${n}([^a-z])`,"g");e=e.replace(r,(o,s,a)=>`${s}math.${n}${a}`)}),new Function("vars","math","$","return "+e)}}class tv extends _h{constructor(t,e,n){super(t,e),this.value=t.val.value,n&&(this.fmla=this.parseFmla(n))}resolveValue(){return this.value}interpolationFrom(t,e,n){const r=t.resolveValue(n),o=r+(this.resolveValue()-r)*e;return t.fmla?t.fmla(n,this.math,o):o}}vh([nh()],tv.prototype,"interpolationFrom",null);class ev extends _h{constructor(t,e){var n;super(t,e),this.value=(n=t.val)===null||n===void 0?void 0:n.value}interpolationFrom(t,e,n){let r=t.resolveValue(n);return e>this.time&&["hidden","visible"].indexOf(r)<0&&(r=this.resolveValue()),r}resolveValue(){return this.value||""}}vh([nh()],ev.prototype,"interpolationFrom",null);class Zs extends _h{constructor(t,e){super(t,e),this.fn=this.parseFmla(this.val)}resolveValue(t){return this.fn(t,this.math,1)}interpolationFrom(t,e,n){const r=t.resolveValue(n),o=r+(this.resolveValue(n)-r)*e;return t.fmla?t.fmla(n,this.math,o):o}}vh([nh()],Zs.prototype,"interpolationFrom",null);class nv extends _h{constructor(t,e){super(t,e),this.value=t.val.value}interpolationFrom(t,e){return Ga(t.resolveValue(),this.value,e)}resolveValue(){return this.value}}vh([nh()],nv.prototype,"interpolationFrom",null);class XE extends Xo{constructor(t){super(t),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.createVal=null,this.vars={ppt_x:0,ppt_y:0,ppt_w:0,ppt_h:0},this.keyFrames=[],this.isColorAnim=!1,this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal=Xa(this.timingTarget,this.json.cBhvr.attrList[0]))},this.updateVars=()=>{var e,n,r,o;!((e=this.timingTarget)===null||e===void 0)&&e.ppt_h&&(this.vars.ppt_h=this.timingTarget.ppt_h),!((n=this.timingTarget)===null||n===void 0)&&n.ppt_w&&(this.vars.ppt_w=this.timingTarget.ppt_w),!((r=this.timingTarget)===null||r===void 0)&&r.ppt_x&&(this.vars.ppt_x=this.timingTarget.ppt_x),!((o=this.timingTarget)===null||o===void 0)&&o.ppt_y&&(this.vars.ppt_y=this.timingTarget.ppt_y),this.isColorAnim},this.onTimeUpdate=({duration:e,delta:n})=>{const r=n/e,o=this.keyFrames.findIndex(y=>r<=y[0]),{attrList:s}=this.json.cBhvr;if(o<0){const y=this.keyFrames[this.keyFrames.length-1];return void(this.timingTarget&&s&&s[0]&&zr(this.timingTarget,s[0],y[1].resolveValue(this.vars)))}const a=o-1,l=this.keyFrames[o],h=this.keyFrames[a]||l,u=l[0]-h[0]==0?1:(r-h[0])/(l[0]-h[0]),p=l[1].interpolationFrom(h[1],u,this.vars);this.timingTarget&&s&&s[0]&&zr(this.timingTarget,s[0],p)},this.onSeekToStart=()=>{this.startVal!==null&&this.timingTarget&&zr(this.timingTarget,this.json.cBhvr.attrList[0],this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.onDestroy=()=>{this.createVal!==null&&this.timingTarget&&zr(this.timingTarget,this.json.cBhvr.attrList[0],this.createVal)},this.initKeyFrames(),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timelineStart",this.updateVars),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeDestroy",this.onDestroy),this.createVal=Xa(this.timingTarget,this.json.cBhvr.attrList[0])}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}initKeyFrames(){var t;const{valueType:e}=this.json;if(this.json.tavLst.length<=0){if(this.json.to){if(this.json.from||this.startVal){const r={time:0,val:{type:"string",value:this.json.from||this.startVal.toString()},fmla:""};if(e==="num"&&this.timingTarget){const o=new Zs(r,this.timingTarget);this.keyFrames.push([r.time,o])}}const n={time:1,val:{type:"string",value:this.json.to},fmla:""};if(e==="num"&&this.timingTarget){const r=new Zs(n,this.timingTarget);this.keyFrames.push([n.time,r])}}else if(this.json.by){const n={time:0,val:{type:"string",value:this.json.cBhvr.attrList[0]},fmla:""};if(e==="num"&&this.timingTarget){const o=new Zs(n,this.timingTarget);this.keyFrames.push([n.time,o])}const r={time:1,val:{type:"string",value:(((t=n.val)===null||t===void 0?void 0:t.value)||"")+"+"+this.json.by},fmla:""};if(e==="num"&&this.timingTarget){const o=new Zs(r,this.timingTarget);this.keyFrames.push([r.time,o])}}}if(this.json.tavLst.length>0){for(const n of this.json.tavLst)if(n.val&&this.timingTarget){let r=null;n.val.type==="string"?e==="num"?r=new Zs(n,this.timingTarget):e==="str"&&(r=new ev(n,this.timingTarget)):n.val.type==="number"?r=new tv(n,this.timingTarget):n.val.type==="color"?(this.isColorAnim=!0,r=new nv(n,this.timingTarget)):n.val.type==="boolean"&&console.warn("not implements"),r&&this.keyFrames.push([n.time,r])}}}}class dr extends ce.k{constructor(t,e,n){super(t,e,n)}set percent(t){this.uniforms.percent=t}set transition(t){this.uniforms.transition=t}}var YE=v(121),qE=v.n(YE),JE=v(122),KE=v.n(JE),ZE=v(123),QE=v.n(ZE),$E=v(124),tS=v.n($E),eS=v(9),Lr=v.n(eS),nS=v(125),iS=v.n(nS),rS=v(126),oS=v.n(rS);const iv="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAr5QTFRFAAAATwAAOQAAZgAAKwAAPAAAPQAA7AAA/wAA/QAAugAA5QAAsQAAwQAAsAAAfwAAawAASQAAZAAAOAAAJwAALAAALQAAqQAAiwAAmgAA5AAA7QAAtQAAhQAALwAAfAAAXwAAYQAAigAAuQAAfgAAswAAcgAArQAAqgAAZwAAaQAAMgAAGAAAiAAAjwAA1gAA6QAA+wAA7wAA2AAAbQAA2gAA3QAAuwAA3wAA2QAAxQAA0QAAzwAA0gAAXQAAYAAADAAADwAAGQAALgAAjgAAcAAAzQAAwgAA+gAA3AAAGwAAoAAAowAAcQAAVwAA1QAAIQAAWQAA5wAAsgAAuAAASwAAbwAARwAAMAAAnAAAUQAAaAAA9wAA4gAAPwAAbAAAOwAAlwAA0wAAjQAAvAAAwwAAkwAAQQAAvgAAnwAAvQAA0AAA2wAAwAAAWwAATQAACwAABwAAQgAAtgAAgwAAvwAAgQAAlgAAEAAAxgAAtwAAmAAARgAAjAAAdwAAqwAArwAAywAAYgAACAAAmwAAHwAApQAA8QAAdAAAbgAAFgAAgAAAogAAewAAXgAA6AAA9gAA/AAAzgAA3gAAkgAAngAAdQAARAAAmQAATgAAUgAAJQAAIgAAqAAARQAAPgAAxwAACQAAAgAAMQAAiQAAhwAA4AAAUAAABQAAeQAAygAA9AAAFQAAVQAAyAAANQAA4wAAKAAAWAAAZQAApwAA4QAAyQAAXAAAkQAArAAAdgAApgAAHgAA8gAA/gAA6gAA8wAAFwAAHQAAhgAArgAAnQAANAAASAAA7gAAlQAAJgAA+AAA8AAANwAAJAAAHAAANgAAkAAAKQAAoQAAzAAABgAAFAAATAAAeAAAAQAADgAAggAA6wAAEQAAfQAAVAAA9QAAIAAADQAAEgAAVgAA5gAAQAAABAAA1wAA+QAAUHExBAAAJDlJREFUeJwlevk/lPv7/2XtOrKNsWcbzGCMJSmSpSxJZtQkjPEOg5mxRWns+xpZyr5ECGmcLIOsdVK2oyJbcVI0J8fp/Bff2+d7/+BhPO6Z1+u+ruf1XF4GAEAGZOXkFRQBTiD+dgKVTiqrqKqpq5M0ZMmaWtoAOrp6+qcMDMFIzdiEYmpmbqJBpVlYWtFJitYMG1sbFTskLvvTDmcQHM+ec3ImXp13uYCubvB/l7sHkC9eAk8jcy9Eb5/LvldQzQ+v+jsw1ZAlfwYDAK5dZ98IvIlBwXRNXVYIJ9TpLJUb9j9LvBVOj4jkRVGj/Y1i8AwiH09eEwhjMU4uXtsiAWLlqInMcLh+28okKRnuhNy945lic0+Uqu7NdErDdB/5DBo7MwuE4J+dw8jIzcsvwEIUFFGEisWQm1ACpcZlxF7vl1c8YMCJyqrqGio+fFRbVw8NjU2uec0isNWhVuq2XMPzmjcRBVHhSWCtXaPR2mZoybHzL0TUfmxPabeR6yg/+6QTY83VQNOkSwkbumsgkgzwtKe8tDdHYM7ts3sW1Q/Pn3PEWaGmYjoje+B3ewx9bM4V0LNfDB5XL3/o5v1hSBi5fzvQkQESOkQOwiiwI++5YBdkDjFIrKEx3cZK4Ti8eAlZpjcnYMSHKG0ygKKVeFSLRpOZNL9p19Ku1Q9enKlp45lZiQGr7hlWS17RKWp03mv8481cQnwBUNTAXwIUeAvsJwCCTnV4FyJC9CrKYDnOT91DpRZSG8Bsn7pAw2Ihd7Hn7R0hynXezjQcvQTyMGgUjV12kiW75XaR7Z9OK9kD0/j6ckfyk/fcPHCkvkz48NG/r3p4FeRpoQa9JA74sJAOcLubirEPqXqTpZ1hNzUN5exoNVbk5RmSOQqcJix5yWvvRZZ9nyay+tqAsb6U76oAwo3wgXvJkK6sCpOYQBTIdT6cg92rSxWh16pdV2c8NnDzfQhveqvND4k6aAB0ssWnHuL2yZQ7AHLzJTgUrreyZeWewhawpw1RMDWYHLP1OcNQgKzwlKVP5JV5crB7cZ+NRJ6AB3wx/x3RsEufEkozLu+g7+zkekfLbFQo8byEubp5ld7Ot2CQKxJ7qguZxF4SB3ozQF2pCEIbcaFxg6eAr0/MbeHb1DCK+vQCA3j4YTcwjNiWyEgcq1dRlfnXsq31K3hhhvNX/CYM0JC+asxk91d+7ahTr6AAaTAn3U2lTBfjIc1pr5VEX94yw8uIZhWQVAHQj66iLErxDLqNmN0wuO9hYf6FN+boQb1FjENYJAiWKrru2ejWzoZX6M9A91p2Sw1TTRT/rdDQsyiOT1f6br4fKm6Fpeb9qocNfvYOLPAuczuA5BTbeVT2O/ghlkYEScGHX0Df3StfyMT4iYHCTEQTLj04iWePVx6aomPYGLc08OXB+drJLqoq42/wXqB5eagtaqR+ZAPsymG8utBxt1rO8zFTPHITA50gCMQ4Gw7tQBZFo0DBsWb5ExlyKoBbvRAO7jdv6U8jMYne4Y+iWXmg53gvbNYsGg+gU3elEnaeXB/ufFUKJiyZdNZemo10NviBxr65KE1k/Rijg8KTan5647eoiJQAYPIL+9fuHPb/VSMucg/bcJHzKt557SPRYF8voq1+2SIWmSgQCZo2ZjhlymMigEZdZQ3MzX6wmmMTECwNWieLpWDlKihSZ2sVVwNX9AmecOXtMHP7C/WwPzvKbZqiJIYFZ7PuZngFJmNi9YatOLLQU77vGbS6PzGdsQVn/Ad7nQyALeZVbm01GA72t5bvR/aWTWVIIEVDwDJanzjqAc8QuFl4Yr9/2WTdPVPmHCtY7ZEZ4mJoDqURsbWcaHwtmIqJWrIXshpck5ilsHlYM34YFFXTG3dGzKrDMBxB8gsDn7G3bW/TDpe51ALDmy5KQW8lUgg4guspE7TN7wCTbFWnf7gBB16vuHtYoXsWo14j1cD9/Z+oyj5GF95jqI9KG0s6YtJ0N0jtISrVAZQcIO251QuKrBIaH7k2hLK/Mw8pyNmCnott3tGm6XjT9DsZUps7H8DCHwjc731hFRtTaF2UQ572Ca4Qp/On0RVdmFD0A219YL4DcFBN/lnfBvNr12E0W2MSZatepyNLVIbbFIg7jaYfoR/4W1VUKqL6zsF4NpNiq4orZEhCEjExd7AQ2j+B6GMOPmekeA7+DsM0IAsIqj31xrtAzvWqBsjmIWC6+uBONItM9R+HA8rGHxptX9JAF/G0L6QEiy3McdFEhp4+YNA0FHNwnW0/RFFEtwHRb/hwQsbzX/heYihsB6nNVJssfHnqQe/acYKMv8LqcRe7aEF7Y6ugtWxKLILeNmlzVF277PqxIg8dSxpo5gsaMBFxfgwvdWBhOvzOHHHzx4JUHLNpyc8LUzkLcfiIv3A2jQxpeQ1iL4IKUJ1dTmigtKLpgi6QjX2d8ISbHl1B8bH0UEbnI2DMVm5h4+6Ko+kTd3VVSVPGkpp4/p+BW7/faCjBhlD7MoDqRpcOJxz6lBe8gWYtBP80qaKf86k0FP9L1ziS+Y1m8MPaWpcD8BXkG2flILIvKvoC/hr8upkS1N2pwbQD5NtZmC6iNb2JUVJTRDoZxTXibAjQDp3w/y5Bhld8zynk7OU1S3S3LPnJLvjhzcfUaKeYeJwtkmPDDbYpWt0gTaf8e/gL32vUwV1i7lHVD65CN0n+CySLiHLZfbSx/XYollUUj09xeL/Cjqg2DUp2eM7igsEZPyXlnve63tfjYjZSbBwtUf7mlAhvX0N/CzxFIKE25lol9uEzuf4B95AK6EAVtXBSn3XGA6bVuISAxQuuFKTClSg4xz/VEivy43BYA1UY4x7aSd/i1RMdwdgzi68x0JEYIfLBbEMag6Kcur0R3WGGtXvT2744+WPE4QaWz1rrbq5fEmwQTMwOLPRNs2jAJiPTPpAjXA48lyGNDo/aEnNyEv39YQtTIKcLY2gVw/SWl2eGCgmvgRKcowIU96xWM6PvyJhk/4dRHbP4A2JaG+uq0xb1J15Gaa++VgngHKhh3L3grVzTsa95kyjw3wgZLYViuASK6smRQA8Ds39GAisCnrN+wiGik1BsIZfpFhk9aVvJNr+pUWJbSmxoOAqRzseBsHsCPJ+9EvFA6HLDuymPuB3VbLuUAeRzs5AnmhdV52drj6JdA/9JE6GEWqDZIrYYlrYCDM7hLcefRsAoFiZc4P3tYx5qFsH9ttFzAL0L/lgSwvjbS4Hlik7xGLuSVfejKzFhvtnHF3039B8VGq1UCpg4+cLt0KMDi46N3M5F9YWHiD/InKc21mDdj2pCGZNgqLihu2j14oFnH9dxycOd1FsVBZ+cMEBkuu0U7wwPJEfc9SWATH9MuG0EvfyJPxuf9enmuy3ipIOtB/Tq8fRSfpzQFs03/H+7yBgpxgsOgaPD69B90NfAH5SMhqmB4xns1ARtQlmao4VcBTRTDeuo6wPwzlIp/AQcGagk6KNOsPIQxV8P+wi/EIUDDVLWFGWvjTzIZnkLRH1UoJhWpXMTjPAjt3UAX17p6WGAJwxrWKi26AC0+gNR2jzhlwfEJrgvQCombOyaY8/bLwB9fMvueMLQvWNkBKGC0lq0Ht3KzP5jCcE4StVpESb3tdp2iHeZtLDMQ26rGa6n0GpULC4tIz4jBBxadsL3wHdFQPwahEAq1xR5rwJkcKwXQrx0f6F7awZw4fPbGa1gUiXJVpYOUgng1Il6/kdwHeGfQlS+PdZEZ/WbBBOmQjvC0LG6wpXRfApSSh5UP+GjCtGd2HwGkHtuvHkJDGvpqBlcXLXap5CKR9eJRzlgZ8W4zK891g7/yQl4SpDRz5B6E6FEUxFv8K/4i/p8Hn1DOZxLx2FQHi3X/cwgM0LCK+TZnTMszAMO3JUIXyO6zOQNiThG4OXOrwJNCE8XwV95JJ175KWLydZwJE882VhaOGyWMiSKcP771g4kaYKUFB2Dmz0JUdUk75Pplh8T7VBZwUY90zTpUDwWxIJNQ4p3+oSPgHVcJUQVskdpHklpVCunu2AMvq7HI2HuekbnizilxbZeVzVwQLUBT133fJUvswkKMu+OHgCDmIJX9+b8TDTiXIyTQUrXPXFm5NsIOF7X6snH0GkbLAqxPlJ9ecWoX5Ywy8Vl/GgAlgE21JAfp4T0F8NwItrDq/BXLuXDsET46eLTOOKK5svMyhZ3Ah1ePwHOvYdijiwWbAEJnbIP5V95SOcbXM43qIJm+5G32UABbhvaNNvRffVynh4jmDDQ3V+XtC1dHWnr5PFwd9Ds2UdVaIEHmECBo9V1OAz0w9Q7ZONc7xXtF+8+ETCmmX+G7+2+flmEDTEww2Dr5eQAbJggPltoLQ9vmismCRLQYIvSsXqDWOIS85DgRSlAhWjGdOxACJXNVdyGoSxA1lu2eETiYQrdn23iL9SxSRCa5LgEX0CruBRSxHIQWrdV/mq5qOUyNgs9QUYv+xsmlhwRichkxSqZko2RwH46USV7CUofNLnT23rewuaB+3Y+8g82zzjibgmdChhbQRFk34o/zPECaRHy7wKj5wlFDE8H30Jva81PwVlVT/UNLeH5C/T9cIDrBy3capubs5y2F7ATbAwpRvThn7BsaBvwbu0BBMDxHEtAsSE3DVOdF+kWWcXsfX3AFYeWSbrZP/TS/H80MGryotBYxj1U8rWXomZeevT+aQ0crFNLeulQLpiCr0J3rB5jTS3MR+wbSYRJirC2/5eEGCMHpzOUFWEplMsWaW0SVaCL8y8rZVI4hiy4qyEC7CW0YwNHTGLxvJ2vW6GNMctZQNF8YFxN+y/di6ENOZNtphmlCkIZsU3uvDqzlidm8vQCrkUfzYk6D4AYr6tk+mccy/i8xBKFQzibM/wWTIysZ6cDt/XhySBb1niUMBJRN+ILdWbj7Z6dnUgLZELPYXWeyXNhzV48NvUbAWzWEC0lD8PwVIGTt6rveS3h3gX3XiVRg1O5poRFvgPCL17nEx324dKJT5AC5OU7RFWXuEp0U1v+MRgY7mxikdoB4lle086YyXrr61aA8eVem+VOaY1TKn/sOxOeRhIcR4AZLNrygau7faIG/T/vTPO010Kbci6K9mAYPE3+D/Q/02VDHhOfPxxTud5MF+8KsrdY8Bw4TELjh26cdDiBfCo2ptEyDRsJrRk1KZcvgta3ckuK5CRPn7AxcptUHMpozoAU68b9ElVYL1uhaVz7RTJwRJ15W+0X8HZs7gUMi9wPAEik099Y6ilYhW7j1KNLmlFXlRwAb+NvU+PbN1AfHY1t+/sN4J1JVfn7FDYLloP1Scsg9GA3s2b6XMPgHYNbve6n3ghsmK0WGyzvNrCU7t0veADh7RGOKA7vXwYQc0uuPZMJMUQMLbBdz+2kFzkStJJNFEvH/f/cT1wnXJfsflkfnn+qJe89nGfU5c6Fpsd3vp8y31fD+eHg8uZSYXdwqcoBT9DS0aTRKoaZrdSqk0KtkFZb4+BBqXAnpKdyVLXBuP5clrK5wxSYyIWrghPCaNnLhJkp/A3x8fsMgMczROQeBhpGULvpU+ZNQqKLZQMr2c5uvEvEMHOemnBn5rN1M88Y+/TkhOxUIBP/2P2jr1+oIelfW2KEQFOnrjfGzrGWUsS6YsjIBTxTDwc64bw+fGhfW5AnvnpxLYAJDBm2lJ6rvaNZZMrsfTANYByHtYSbJahyNwhmaepqjdIPb+zS9jVAgfRHPZEjU1Gd3rhA/5cI2/I7HkyV/yE2rhd7VLRC+6h3nRnBwqHqGw2HNB46i9yPFIYrAbBjbP8Xiw3DuyzbyCf9d4TVDRcSKQussrgoejwBiAjYwZi0qcQK8KuYyotDvMBHuWgDgNhVUXyHsaOlkxmK4H0+NoRd5BhMX9v+E0DX3JzZF4fOt9EZhbDdj5dngkuAUBvofWKvSxgvWN/JXhGtuib/SxfY8KRQCXuP9M9m4RKN/YNl9WjkI76xL/vI3tkUW8UwNyBJ97wf3vZkr8zgZWjt09M51pPhhhhIa5n7iOjQUKxcVfAILZl0T4jc7FxaD1109JL9Ca0sSBbrEuNCQcFBiIv+SZSJPYe/1EYItPw54SrCk2fKxMmvjDJ19ORWT937dR9t2yrEWeJCbBTuaVFvARwhlXYkVrmPmMoeHL//5uHAvRj2Y8axOXO33AUsW/qXsBWn9CxkKIYN1C7xCb9tfTfE+3+m+utf4yM6L/i+ic02U8cQ2F98GKWj7KuD2pLDXkPCLCOzaCvJfwOemmSw+9kphfUY4yI+yj5/MmQxX+dJTNMaPNhkZY4Wbc3tEQKBn08wseAkoa6qqIQUIOD3kPmDGdgoM1ToC4KklkiDUBk4Uk/Fidp8zCJcFBMgHj+etTxbRFeHvwhf80CiSt3z3DIFYl6k1lWLVvRBn0lpMVKj6PITC0tar9jbVAPhHP8k4rhblOqCcOdqrAPy67Z1WL4TfMfVx0GLrHQJyH8iQUus8lkFKuv5kcYrNvW13YfKuZ89ORAmC15BmyKxBFilYKq8dxQRWdqGLLb8Rij6WrIs7/mxVyFptbrarK6uDO1v3yxzOWQjtaz2W/01pTvN/Omyfx8D2VGPK80olW8HfnliYW8J7UjIcIlewB+DJW6whrBEqHlPOAQ8W/xs1Hn5GmuasOM+K9M5T9RYI+PMwnvMsCTG6r+dbVXfMESA2YjneGLq0D1CQv4w2JrzNXBsshiH+QHHQa2Mr/AZ4I3FCYwSF30Bqgti3TOnZKmjAfxUANcv/0JqQQ2HHnOhMOwJodHns6/25Jg743Q1lQ+KbmEPuPq51Bt83snYTH17IxKtNv2roT2epeJDTPX4a0X9SZHNHJqSie0RtRDgKb5JGNRAJr4h2aypQVI68DWseD13hXjPfFQtgcpsWw3+bHWbYNMQ5bN4cjo9d8aBirB8/oJdnePZQoxNeCAZZbotwjOCA0wROeUdcuZjnmA4UdjXjcB5b5xb9AZYmwdFSH2DdhvscW5z5QnIMnYTFRngKajbkSdjvvVyWw6LwIJWxlYhshBPGlg4xDUFZOFLf2UlA4MUe8DA8TIea+IX2smNzuP0vmleE8ArQR+UsNqTqekrljgz0+vhX5+FaB5qs3t9J5cPuwScX+MPS/UkluQXNh5WrJFM9p4CGban0P71P43YKxglb2X+cyKQ94h/diX4v9RaCpnBsnLBEiBNo/0idpiYrznuGrJbXrCBGfcS8UOZNOTvW4hnUTwJkuVcBHodNx3R8t5LtTDmf9/EmsNByWOE4XyHplSzut+ilAlOYAW6FAoMlRP17j9CYvp40MImU7d5GfS2Drx+GW3yciuygcSeJPwW0wzd8Jx7iITtZPchNXC6aPAtKQrB2xa8z53r/+NXr2nhyLPFySAhSY0IYOQBgKT6h3kSWUhtwoeuSh11H23xn6OOue1lRwSZFtnWn9cdSaaEGqWp9dYsa7+ChyZcubQzxJjXzXLk9h89vBXfZGDIlvpsP4QIbmPMjqxhqsBfefv19nkI6ATGqFQsHNSKV1bi5RDhNzYOR3Ckunra8gfjADKT/ll0bAtT+Gyj2d7NLfv1oX/s3Dxbwcs6upK916xmn4Cn9qoUPECeybc02KdxfxGRB0zT8l0Zikliu1neuQQ0TmnzytBG1jCdcA7AUAfwLbEnAjIqNRI/tr3AS3HHzaJJ1AVHLTuHM72nkWqYVDDf+j66wmI+h8Lmvxl4OGEXnX3JOrwBz08R7ELtwHigs810rOj0viiWN/+sC7Ni5oBKQ6bZk8eHN3PYLZzQgVjEb5jNex3lMrEC0EzpQ3faNx4xd523exujDDnuf5ZP5S7v7/UuKqkqW2X94NfxXy7549ho3WWi6n1Vt7ABUIeJc5cdqWkRZrf4aNACabeODzxEINKtnW6CGh5734US98i9pjARiQfrdT+ax6iuaQ68hRSbykUQcJUr4DoFBkm4wgd2hq4tBIt5iGqkmIYjIK97X2Ac+y7Al6Eas2r5VF3EkYVixIGsqzlkm0RXA05xqwaznFZjzk8V80Y+iIDhMyNdfSpEMp3IheR2cbKGSnSfWK1HK5rU73te+Y+mp46Jt6oD3xe3/MKUzoD2UBzNmu3iQW2uCJHd2ne9t/x3h7lnn4kBxCEAK//UgVlyjyz9W5JHgDWu3g3OlGHBZO/680MjgZCrLsuOfLU+5jPl2Pxck02uqzyqmPlhPA0isbdnhRis6Qh/S179zV226tq30IMf1KqJ+bHgSCHhjM64dbIL8GGt21vGOEXP+/AJcER6NjIb286TKSzTCCidNp6Zf3rpsWZnG5dNhuEqU94Fd2sYHaDOgM3A3LO9nxQazFRTOJsT7cD4eScDOsG8UfQGqlmCqM7L0/3ZpnWylRSPqBu/B+eHEfYNZO+0QTaWrYVbLURYIK4TWR8iESRGfHHQWgthnGCFSR6XhpDR2Xtq0uhr2QQvOUVv8Giw6ImYIgOdd8OPo1dxm1hQCQV84zTzso6krY75wTfRjcwV5Geb/tJ4owfFd8kC7FDPX9B9mBYVZ0zuK21vYoVpvazdgKlwKfwFKZSgPgFfDQtTRYNOvy6JNZ7OeYCWEFJq/hygT5KPD9mIbenEBsAvHdzCG/K5iPb4S4aP/YhnMDJHIP/icNM6ztIK9gkRRdA71nyoMef+2jb3neklwx0pHH2SIdKb2jwOWG3JCmYK4Iva+7eEG0a3If9Da4KaFAGMYlTTCfFBFSoyK7YMSwyuICgV8M49c7bf4VqtKi5LOaLKCJlVZ5zBpLrIr9LvsMNctO/oiM3ab/MknNJPPbnirNLPbGflQrRr2aJJYXg/QIsh8k1PXzz+z9w5gIxiXea4P0RlO2OUDqhJdvv8EBpRLy6Z9p8GR+FFKgDHcGsMkkbMnJz0q7hAhDVdF3sCfBM6hj2P4SlE5njIsBmSky6FhkNYd2UfgLt37a35+BEvupCA+Jh5kmC5dWaGeQNmz35EEQvhwZG3qxKo/RZr66hM7IJ5Won7gh78anK172Zt3buKAMKyMDjzdR9ufcCZ0zU4DOA5RKIgkAMTbytB3LQFlT5MH/An6qfRJPjj2dg5WFP3mdlZkwFePrA+3eN2Wu0A+WAFKZrztzJRibcqCweEddxU/PSGWxOnjHtOUDzfDk9lEvDDj39cFH1E9dVeQLGVI3Qgeo0M34dZ6K/3cb9BBZcZf8uS+BivagqBuLW31L60FMADuX1jiTur3n1ZrBrIgpkFO//0OmyT9qWthHcnwzLRswTdDbgUflRNCAvfaODDSX8vQLo7QBDltK42Y/OdFbS1zUYFLv6qSiV43zDiUrcAtbEqoMVBPa37+RMTuT1gmrJVH1qqYsi12cyakNWPLrTGqg9NO1KY2vPwISkCnxobu6FodJWlXUwABhb1LwveepTps6Tt0E8j+tabfLiI+MdLLWSxLqA1cJON1hz8aZkisUWXUMhNOQpLrIR062CCV3Bg0ZwlU9OhbKefT1NjDog/g2q+TAW89zQllayE0d/y9qAdSAucb3iKOXZYzSSmdealQNS1IL3qMUpowYU6uuO7LEqyPD05MgXvXy6frzzrkpBXlAx+J30gur7J4OT/ziwA3fvIcKvLAHet4sqms0BCkZk6CKbyRPu8Xqwsv5KGfYcI4thniGI9nFwFwt1bfZm9racBom20+/R8n0upa1EAueM5b9A7lN3BE9empZqOTj5NkKNeCf630MV2jeKeEP8cImJ5W9l3gYGDg1wPxxZcmBvsZ4qZXUMim6a/M2jKAsHtYvPN1A0FsH3AAbpFvCxA200RpdN9ME2nSQL2g5pg9OIw6KkYT3gKe7QmWrItoXK1c/XBbJQ6pVOca2BzfQfoOCTygsFljpEPDG+tBLrte+jUDP2DcYKLisBjhgtTZnAmgmg8/Aus/awVIZGqScBZ1xa/82qG7rzT0BDLldEs0sP5HS8oNhU3lhDue5NS0TUt0T7YTZvSGH0HEYEs97dJ7xpNO1TKokYmLWenco4PvNEsv2hQ85pcgDjlA29jwVT9IoAcXQGCnhPG8fgYyhJ64NNzBiWf5p1XdoBx+xtXoPiVbK44FcHipEqTaar9/ruKsdneZuJmevOHPOjhmtvwVVX8Nmx+/eftj7gZmxlF3ocI/n5T0byPxzPfMi24AxSQeAGjdI3Q4hc5ffAT7v7F89ZNEgj6fheuHl2hjRQlG4EMMwpiAnsm1HT499a+zKPMejH0uAfnT4JyItDTiDQ4l5DoO/sQZ0HkzGpiM8KQNwaHk0Un9WaO+yuA1ZTV9z8Jm13bqwTlfNHncIi8M/kHQMFhMF7Imo2mUw/Sox7Bh3W6UplqvEiy+g2NvVzFPCtGkHSTLuFSL2CtGzpPY+E5O0PK3HSbUnBzNBZodkNnUAlch2Zk9/9F8JuAYBirgoVpE7QyheJ33WDOysDFYMSXBdm20XfXCWcGzsGyvXE8FJN7EadsGjIDzZ+GtIUEBWuQ6o87kaDvo4eplYs4dz6P06lSSCA0yAvpXKD1djjC8dnWdYtWsLpl4Fplhje74Y6i/M7VMSQnRvD54/CC4LPzx4vghhIOzVo6bLzl7QIHPvVyM/drqBBZ3tW1lYqvXfauRfH5WHe+RcHI+xxeqDECqJ9tdXLyy9L7RqxyUaZKwmlAux+zEzdzITSRlr36YuSm0LBhTpkivodWytR6BNULFxftqF42QqKLmoog9WlYNRb4GtNm93bHuxBvV5VcOUeY6N/9xDutwbqYhaN3rIzpg1M6XfrYctTdA5Msr2v4Aydmb+Nl2/Eqw+jSXYvctmuDHYUAei0pUc6E5N1bULPEjHAr+HI3gwDjpDg0nE2fMkXneCumq9ifZR5IKUOqn0aDIfN64olrhaHfV4msozkdG/3j5HHqsf5Els8kwvDrCaK4/BXb+YzYC00mJEOu8njPsKgB9dG+FjqqeToCsJKLTvHS+iQTnqFquCJ+yCckuDaHLnP4GzroGg7BelrYZWStEFay3j+vkEuXHy3B2zG5xBqSx+/pxoEOv+OfiCfq5QMCCNq26xXC+1DZ+eQdH2jJ9FXSh9yrISZTk56jTzMIzG9+Ye+pumQffxmh2lcvPXjmNWL3PoOgRpkx4o/TZzE2y3IMtEZNxpNUlBqFlnBVXuPS0TIBkF+ZfvW3y2bGWD14zb8Cju5+wiSW1pIIRRtD0DeaxOLIvup5BZ2R2QfQVx6ryHH4H/rls/fRJy6KIdsJ/qVsWrBZaKgKOhP0GOUjA16wS+vlpcmot72SIWJWQDwyiD04TLSU6LyObtnOC2W5QA0OCGXHtlTi9Cyh95AIL8UU6AaQOaDSDfuf3DbxO4065WUdqPZ6Zj9S26jGlhDs/3mX1c4h+to5J2UwvgO3dkFtmKMBF3OuQvskMsOO8R5FnXblT4zMUpkjhs3m1ygag6zQWKfFOQCFM8jmAFtaCpCqDX77xqhE3B99uGU3UT+41SufAp9fQENvgk5lwqneywazIE9IpGT8v23sBPibAHG34mLWiivxnjk8p2S5ofshihnLQd4CU5ABpVcMX/5Hg39Jm55k+hgxugBCGIR5KmY+qz6US5/wKYimBbjTOSBlyD9OiYpWxtoLH6PcoaUdK0dW4vKR121dfMwumvgSBf8g0fsVN0w8jbplh7Df1FVC9wZuTbZStSswGJu6IngHRvBgOFag8F3hwPVNuUYjxNngNURuMvnnOvway+3l+1sK7aILbzdSzAxUCtG9/CaaHsBFIVzMWEH7upNL6Hr6P+oI4i+VqT6NyQrYUMkRXYd2P1ZjEMDaJ1rrurxTBgTfMw9cZe8SHIAz0JA7jpgDmr+InVbg0HrkFNZVhQ2uBKn75tLEZwfMp2azBhkglsAXDPx2BccwTDGmnsjRDh2jHh9ynTQY4vLqcuv/NWRlP8sFHWyxSmm38ikF1UoTywoZL0oFE4I4ujqIcvCuo+0ABPohIMdyq8EqgTcogXcYNCGdgvytDCA/fwt2eG78+OAANOgmKkOI8WdjE3FaFdqW6rx/oOBunJoqMLOwnPtv67Cw7PY8c4jFvek2G/hk1Thivu5Pf2iV8YDA8DyziBPz6MKlF9XQlRt7ZRV09nZrygwo00ME7IpFuOiEsUrd14UcCvNC/DPkbFmqB1uQIg477mFiq2niVADUYnvdjiQPNpFfMTo4yg4X+tDW3rmH2WE9E2rY0ES40wM6QRwaQL5/fepJULkj3Zc6L1ItuWmO6zXbvou399GBCPcQwB2+rRpubsw03qWL2iRyHH9Afl/YHuFYa8v7zEXDEigXJo9RAtTM4BTzElQhSgePv55AmHTo4W9v4SmkPDlLIhOpcXBK4GO2AnyzeN0MaKP7umX9bZAfc5LA84bxj3frYCxezbP9KG7QeJzevIhiAU4p/j+y2OyMV2mxNgAAAABJRU5ErkJggg==";var sS=v(127),aS=v.n(sS),lS=v(128),hS=v.n(lS),uS=v(129),cS=v.n(uS),dS=v(130),pS=v.n(dS),fS=v(131),mS=v.n(fS),gS=v(132),vS=v.n(gS),_S=v(133),yS=v.n(_S),xS=v(134),bS=v.n(xS),TS=v(135),ES=v.n(TS);const rv={wipe:class extends dr{constructor(i){super(KE.a,qE.a,{percent:0,direction:1,transition:0});let t=1;i==="up"?t=1:i==="down"?t=2:i==="left"?t=3:i==="right"&&(t=4),this.uniforms.direction=t}},fade:class extends dr{constructor(i){super(void 0,QE.a,{percent:0,transition:1});let t=1;i==="out"?t=-1:i==="in"&&(t=1),this.uniforms.transition=Math.pow(t,t)}},blinds:class extends dr{constructor(i){super(Lr.a,tS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="vertical"?1:0}},checkerboard:class extends dr{constructor(i){super(Lr.a,iS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="down"?1:0}},dissolve:class extends dr{constructor(i){super(Lr.a,oS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.setTextTure()}setTextTure(){this.uniforms.dissolveSampler=ce.t.from(iv)}},randombar:class extends dr{constructor(i){super(Lr.a,aS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="vertical"?1:0,this.setTextTure()}setTextTure(){this.uniforms.dissolveSampler=ce.t.from(iv)}},circle:class extends dr{constructor(i){super(Lr.a,hS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},box:class extends dr{constructor(i){super(Lr.a,cS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},diamond:class extends dr{constructor(i){super(Lr.a,pS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},plus:class extends dr{constructor(i){super(Lr.a,mS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="out"?1:0}},barn:class extends dr{constructor(i){super(Lr.a,vS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="inHorizontal"?1:i==="outHorizontal"?2:i==="outVertical"?3:0}},strips:class extends dr{constructor(i){super(Lr.a,yS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=i==="upLeft"?1:i==="downRight"?2:i==="upRight"?3:0}},wedge:class extends dr{constructor(i){super(Lr.a,bS.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])})}},wheel:class extends dr{constructor(i){super(Lr.a,ES.a,{percent:0,transition:1,rect:new Float32Array([0,0,0,0])}),this.uniforms.option=Number(i)||1}}};class SS extends Xo{constructor(t){var e;super(t),this.filterType="",this.isConflict=!1,this.activeWhenConflict="prev",this.onTimeUpdate=({duration:o,delta:s})=>{var a;const l=s/o;if(this.filter){this.filter.percent=this.commonTimeNode.applyTimeFilter(l);const h=(a=this.timingTarget)===null||a===void 0?void 0:a.container.getBounds();h&&(this.filter.uniforms.uBoundRect=new Float32Array([h.x,h.y,h.width,h.height]))}l>=1&&this.timingTarget&&this.ctx.clock.setTimeout(()=>{this.removeFilter()},34)},this.onSeekToStart=()=>{this.timingTarget&&this.removeFilter()},this.onSeekToEnd=()=>{this.timingTarget&&this.removeFilter()},this.onDestroy=()=>{this.removeFilter()},this.commonTimeNode.on("timelineStart",()=>{this.filter&&this.timingTarget&&(this.timingTarget.container.filters&&this.timingTarget.container.filters.length!==0?this.timingTarget.container.filters.push(this.filter):this.timingTarget.container.filters=[this.filter])}),this.commonTimeNode.on("timeNodeDestroy",this.onDestroy),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate);let n=1;t.json.transition==="out"&&(n=-1);const r=(e=t.json.filter)===null||e===void 0?void 0:e.match(/^([a-zA-Z]+)(\((.+)\))?/);if(r){const o=r[1],s=r[3];rv[o]&&(this.filter=new rv[o](s),this.filterType=`${o}-${s}`,this.filter&&(this.filter.transition=n))}}get modifyAttrKey(){return this.filterType}removeFilter(){var t;if(!(!((t=this.timingTarget)===null||t===void 0)&&t.container.filters)||!this.filter)return;const e=this.timingTarget.container.filters.findIndex(n=>n===this.filter);e>=0&&this.timingTarget.container.filters.splice(e,1)}}class wS extends Xo{constructor(t){super(t),this.isConflict=!0,this.activeWhenConflict="next",this.startPos=null,this.onTimeNodeStart=()=>{var e,n;this.startPos={x:((e=this.timingTarget)===null||e===void 0?void 0:e.ppt_x)||0,y:((n=this.timingTarget)===null||n===void 0?void 0:n.ppt_y)||0}},this.onTimeUpdate=({duration:e,delta:n})=>{var r;const o=n/e,s=(r=this.path)===null||r===void 0?void 0:r.getPoint(o);this.timingTarget&&s&&(this.timingTarget.ppt_x=s.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=s.y+ +this.timingTarget.design_ppt_y)},this.onSeekToStart=()=>{this.timingTarget&&this.startPos&&(this.timingTarget.ppt_x=this.startPos.x,this.timingTarget.ppt_y=this.startPos.y)},this.onSeekToEnd=()=>{var e,n,r;const o=(n=(e=this.commonTimeNode.json)===null||e===void 0?void 0:e.spd)!==null&&n!==void 0?n:1,s=(r=this.path)===null||r===void 0?void 0:r.getPoint(o>0?1:0);this.timingTarget&&s&&(this.timingTarget.ppt_x=s.x+this.timingTarget.design_ppt_x,this.timingTarget.ppt_y=s.y+this.timingTarget.design_ppt_y)},this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeDestroy",this.onSeekToStart),this.createPath()}get modifyAttrKey(){return"motion"}createPath(){var t;const e=new Fs,n=(t=this.json.path)===null||t===void 0?void 0:t.match(/[MLCmlc][^MLCmlc]+/g);if(n)for(const r of n){const[o,...s]=r.trim().replace(/\s+/g," ").split(" ");if(o==="M"){const[a,l]=s.map(h=>Number(h));e.moveTo(a,l)}else if(o==="L"){const[a,l]=s.map(h=>Number(h));e.lineTo(a,l)}else if(o==="C"){const[a,l,h,u,p,y]=s.map(x=>Number(x));e.bezierCurveTo(a,l,h,u,p,y)}else if(o==="Z")e.closePath();else if(o==="E")console.warn("not implements");else if(o==="c"){const[a,l,h,u,p,y]=s.map(E=>Number(E)),x=e.currentPoint;e.bezierCurveTo(a+x.x,l+x.y,h+x.x,u+x.y,p+x.x,y+x.y)}else if(o==="l"){const a=e.currentPoint,[l,h]=s.map(u=>Number(u));e.lineTo(l+a.x,h+a.y)}else if(o==="m"){const a=e.currentPoint,[l,h]=s.map(u=>Number(u));e.moveTo(l+a.x,h+a.y)}}this.path=e}}class AS extends Xo{constructor(t){var e;super(t),this.isConflict=!0,this.activeWhenConflict="next",this.startVal=null,this.createVal=null,this.onTimelineStart=n=>{n.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:n,delta:r})=>{var o,s,a,l,h;const u=r/n,p={x:1,y:1};if(this.to){const y=(o=this.from)!==null&&o!==void 0?o:{x:(a=(s=this.startVal)===null||s===void 0?void 0:s.x)!==null&&a!==void 0?a:1,y:(h=(l=this.startVal)===null||l===void 0?void 0:l.y)!==null&&h!==void 0?h:1};p.x=y.x+(this.to.x-y.x)*u,p.y=y.y+(this.to.y-y.y)*u}else if(this.by){const y={x:this.by.x,y:this.by.y};p.x=1+(y.x-1)*u,p.y=1+(y.y-1)*u}this.timingTarget&&(this.timingTarget.scale=p)},this.onTimeNodeStart=()=>{this.timingTarget&&(this.startVal={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})},this.onSeekToStart=()=>{this.timingTarget&&this.startVal&&(this.timingTarget.scale=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.onDestroy=()=>{this.createVal!==null&&this.timingTarget&&(this.timingTarget.scale=this.createVal)},this.from=t.json.from,this.to=t.json.to,this.by=t.json.by,this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeDestroy",this.onSeekToStart),!((e=this.timingTarget)===null||e===void 0)&&e.scale.x&&(this.createVal={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})}get modifyAttrKey(){return"scale"}updateCurrentValue(){this.timingTarget&&(this.current={x:this.timingTarget.scale.x,y:this.timingTarget.scale.y})}}class MS extends Xo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.isTimelineStart=!1,this.startColorString=null,this.currentColorString="#FFFFFFFF",this.onTimelineStart=e=>{if(this.isTimelineStart)return;this.isTimelineStart=!0,e.isReverse||this.updateCurrentValue(),this.from.isInit()||this.from.fromHexString(this.currentColorString),this.to.isInit()||this.from.by(this.by,this.to);const n=this.json.cBhvr.attrList[0],[r]=n.split(".");zr(this.timingTarget,r+".on","true")},this.onTimeNodeEnd=()=>{const e=this.json.cBhvr.attrList[0];if(this.json.cBhvr.ctn.fill==="remove"){const[n]=e.split(".");zr(this.timingTarget,n+".on","false")}this.isTimelineStart=!1},this.onSeekToStart=()=>{var e;const n=this.json.cBhvr.attrList[0];if(this.timingTarget){this.onTimeUpdate({duration:1,delta:0});const r=n==="ppt_c.color"||n==="text.color";if(((e=this.timingTarget.fill)===null||e===void 0?void 0:e.designColor.toUpperCase())===this.from.toHexString().toUpperCase()||r){const[o]=n.split(".");zr(this.timingTarget,o+".on","false")}}},this.onTimeNodeStart=()=>{if(this.timingTarget){const e=this.json.cBhvr.attrList[0],n=Xa(this.timingTarget,e);n&&(this.startColorString=n)}},this.onTimeUpdate=({delta:e,duration:n})=>{const r=e/n;if(this.to.interpolationFrom(this.from,r,this.target),this.timingTarget){const o=this.json.cBhvr.attrList[0];zr(this.timingTarget,o,this.target.toHexString())}},this.onSeekToEnd=()=>{this.isTimelineStart||this.onTimelineStart({isReverse:!1,activeCount:0,id:""}),this.onTimeUpdate({duration:1,delta:1})},this.replaceAttrToRelation(),this.json.clrSpc==="rgb"?(this.from=new lh(this.json.from),this.to=new lh(this.json.to),this.by=new lh(this.json.by),this.target=new lh):(this.from=new ah(this.json.from),this.to=new ah(this.json.to),this.by=new ah(this.json.by),this.target=new ah),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeNodeEnd",this.onTimeNodeEnd),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeDestroy",this.onSeekToStart)}replaceAttrToRelation(){const t=this.json.cBhvr.attrList[0];t!=="ppt_c"?t==="style.color"&&(this.json.cBhvr.attrList[0]="text.color"):this.json.cBhvr.attrList[0]="ppt_c.color"}get modifyAttrKey(){return this.json.cBhvr.attrList[0]}updateCurrentValue(){if(this.timingTarget){const t=this.json.cBhvr.attrList[0],e=Xa(this.timingTarget,t);e&&(this.currentColorString=e)}}}class CS extends Xo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.startVal=null,this.createVal=null,this.lastVal=null,this.onTimelineStart=e=>{this.lastVal=null,e.isReverse||this.updateCurrentValue()},this.onTimeUpdate=({duration:e,delta:n})=>{const r=n/e;let o=0,s=0;if(this.from!==void 0&&this.to!==void 0){o=this.from,s=this.to;const a=o+(s-o)*r;this.timingTarget&&(this.timingTarget.r=a)}else if(this.by!==void 0){this.lastVal||(this.lastVal=0);const a=this.by*r-this.lastVal;this.lastVal=this.by*r,this.timingTarget&&(this.timingTarget.r+=a)}},this.onTimeNodeCreate=()=>{var e;zo()((e=this.timingTarget)===null||e===void 0?void 0:e.r)&&(this.createVal=this.timingTarget.r)},this.onTimeNodeStart=()=>{var e;zo()((e=this.timingTarget)===null||e===void 0?void 0:e.r)&&(this.startVal=this.timingTarget.r)},this.onSeekToStart=()=>{this.timingTarget&&this.startVal!==null&&(this.timingTarget.r=this.startVal)},this.onSeekToEnd=()=>{this.onTimeUpdate({duration:1,delta:1,isReverse:!1})},this.onDestroy=()=>{this.timingTarget&&this.createVal!==null&&(this.timingTarget.r=this.createVal),this.startVal=null},this.from=this.json.from,this.to=this.json.to,this.by=this.json.by,this.by?this.isConflict=!1:this.isConflict=!0,this.onTimeNodeCreate(),this.commonTimeNode.on("timeNodeStart",this.onTimeNodeStart),this.commonTimeNode.on("timeNodeCreate",this.onTimeNodeStart),this.commonTimeNode.on("timelineStart",this.onTimelineStart),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("timeNodeDestroy",this.onDestroy)}get modifyAttrKey(){return"rotate"}updateCurrentValue(){var t;this.currentVal=(t=this.timingTarget)===null||t===void 0?void 0:t.r}}class RS extends Xo{constructor(t){super(t),this.isConflict=!1,this.activeWhenConflict="next",this.isApplied=!1,this.onTimeUpdate=()=>{var e,n;const{cmd:r,cmdType:o}=this.json;!this.isApplied&&r&&o&&(this.isApplied=!0,(n=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||n===void 0||n.applyCommand(r,o))},this.onSeekToStart=()=>{var e,n;this.commonTimeNode.isInInteractiveSeq||(n=(e=this.timingTarget)===null||e===void 0?void 0:e.cmd)===null||n===void 0||n.applyCommand("custom-pause","call")},this.onSeekToEnd=()=>{},this.commonTimeNode.on("timeNodeStart",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeNodeEnd",()=>{this.isApplied=!1}),this.commonTimeNode.on("timeUpdate",this.onTimeUpdate),this.commonTimeNode.on("seekToStart",this.onSeekToStart),this.commonTimeNode.on("seekToEnd",this.onSeekToEnd)}get modifyAttrKey(){var t,e,n,r;return((e=(t=this.json)===null||t===void 0?void 0:t.cmd)!==null&&e!==void 0?e:"")+((r=(n=this.json)===null||n===void 0?void 0:n.cmdType)!==null&&r!==void 0?r:"")}}class IS{constructor(t){this.runtimeNodeEventHub=new xi.a,this.onVolumeUpdate=E=>{this.audio.volume(E)},this.stopAudio=()=>{this.audio.stop()},this.destroy=()=>{this.stopAudio(),this.audio.destroy(),this.ctx.activeMedia.delete(this.audio),this.ctx.volumeAdjuster.off("update",this.onVolumeUpdate)};const{json:e,isIterate:n,isSub:r,eventHub:o,ctx:s,parent:a,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:y}=t;this.json=e,this.id=e.cMediaNode.ctn.id,this.commonTimeNode=new Qs({json:e.cMediaNode.ctn,isSub:r,eventHubs:{global:o,runtime:this.runtimeNodeEventHub},ctx:s,parent:a,isIterate:n,iterateType:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:y});let x=e.cMediaNode.tgtEl;s.loaderDelegate&&(x=s.loaderDelegate.redirectMedia(x),s.logger.info(`redirect media url from ${e.cMediaNode.tgtEl} to ${x} by delegate.`,s.taskId)),this.audio=new Tc(x,s.runningAudio),s.activeMedia.add(this.audio),this.commonTimeNode.on("timelineStart",()=>{this.audio.volume(s.volumeAdjuster.volume),this.audio.play()}),this.commonTimeNode.on("seekToStart",this.stopAudio),this.commonTimeNode.on("seekToEnd",this.stopAudio),this.commonTimeNode.on("timeNodeDestroy",this.destroy),this.ctx=s,this.ctx.volumeAdjuster.on("update",this.onVolumeUpdate)}}function wc(i){return function(t){var e;return!!(!((e=t)===null||e===void 0)&&e.cBhvr)}(i)?i.cBhvr.ctn:function(t){var e,n;return!!(!((n=(e=t)===null||e===void 0?void 0:e.cMediaNode)===null||n===void 0)&&n.ctn)}(i)?i.cMediaNode.ctn:i.ctn}var PS=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Qs extends xi.a{constructor(t){var e,n;super(),this.uuid=cs(),this.isSub=!1,this.isShadow=!1,this.startCount=0,this.applyCount=0,this.isReverse=!1,this.isConflictDispose=!1,this.isIterateEnd=!1,this.parentTimeNode=null,this.isActive=!1,this.isDestroy=!1,this.shouldSeekOnStart=!1,this.repeatTimeoutId="",this.iterateShadows=[],this.isEndEventsEmitted=!1,this.tmFilter=[],this.timeDelta=0,this.isIterate=!1,this.iterateType="el",this.iterateIndex=0,this.children=[],this.subList=[],this.duration=0,this.isNegativeSpeed=!1,this.handleEndCond=()=>{this.isActive&&(this.isActive=!1,this.isInfiniteRepeat()?this.repeatTimeNodeEnd():this.seekToEnd(!1,!0))},this.handleActive=(j=!0)=>{if(this.isActive=!0,this.isConflictDispose=!1,this.applyCount+=1,this.json.iterate||this.emit("timeNodeStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startCount>0&&this.json.restart){if(this.json.restart==="never")return;this.json.restart!=="whenNotActive"&&this.json.restart!=="always"||(this.seekToStart(),this.emit("timeNodeRestart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.startTimeLine(j))}else this.startTimeLine(j)},this.updateTimeLine=j=>{const Z=j/(br.b.TARGET_FPMS||.06);this.timeDelta+=Z,this.duration-this.timeDelta<=Z&&(this.timeDelta=this.duration),this.timeDelta<this.duration?this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?this.duration-this.timeDelta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}):(this.emit("timeUpdate",{delta:this.isReverse||this.isNegativeSpeed?0:this.duration,duration:this.duration,isReverse:this.isReverse}),this.onTimeLineEnd())},this.handleEnd=(j=!1)=>{(this.isTimeNodeEnd()||j)&&(this.isActive=!1,this.isSub&&this.destroy(),this.emitEndEvents())};const{isSub:r,isIterate:o,ctx:s,eventHubs:a,parent:l,json:h,iterateType:u,iterateId:p,iterateIndex:y,isInInteractiveSeq:x,fromSeqId:E}=t;this.isSub=r,this.fromSeqId=E,this.isInInteractiveSeq=x,this.isIterate=o,this.parentTimeNode=l,this.json=h,this.ctx=s,this.iterateIndex=y,this.eventHubs=a,this.iterateType=u,this.iterateId=p,this.tmFilter=(n=(e=h.tmFilter)===null||e===void 0?void 0:e.split(";").map(j=>j.split(",").map(Z=>parseFloat(Z.trim()))))!==null&&n!==void 0?n:[];const w=Number(this.json.dur),C=this.json.spd||1;if(this.isNegativeSpeed=C<0,Number.isNaN(w)||(this.duration=w/Math.abs(C)),this.uuid+="--"+this.json.id,this.setPreStyle(),h.childTnLst&&this.createChildren(h.childTnLst),this.startConds=new Wa(this.json.id||"",h.stCondLst,a,this.ctx),this.endConds=new Wa(this.json.id||"",h.endCondLst,a,this.ctx),h.endSync&&(this.endSync=new Wa(this.json.id||"",[h.endSync],a,this.ctx),this.endSync.on("active",()=>{var j;this.json.nodeType==="interactiveSeq"&&(this.isActive=!1,this.shouldSeekOnStart=!0,this.emit("timeNodeEndSync"),(j=this.endSync)===null||j===void 0||j.reset())})),this.startConds.on("active",j=>{this.isActive||(this.shouldSeekOnStart&&(this.shouldSeekOnStart=!1,this.seekToStart()),this.handleActive(j))}),this.endConds.on("active",()=>{this.handleEndCond(),this.children.forEach(j=>j.commonTimeNode.handleEndCond())}),this.parentTimeNode&&this.parentTimeNode.on("timeNodeStart",()=>{this.applyCount=0}),this.isSub&&this.json.masterRel==="nextClick"){const j="shape slide onNext"+this.fromSeqId;this.startConds.addCond({event:j})}this.json.iterate&&this.isIterate===!1&&this.createIterateShadow()}createIterateShadow(){const t=cs();let e=!0,n=0;const r=o=>{o===t&&(e=!1,this.ctx.eventHub.removeListener("IterateTimeNodeEnd",r))};for(this.ctx.eventHub.on("IterateTimeNodeEnd",r);e;){const o=JSON.parse(JSON.stringify(this.json)),s=new Qs({json:o,isSub:!1,eventHubs:this.eventHubs,ctx:this.ctx,parent:null,isIterate:!0,iterateType:o.iterate.type,iterateIndex:n,iterateId:t,isInInteractiveSeq:this.isInInteractiveSeq,fromSeqId:this.fromSeqId});this.iterateShadows[n]=s,n+=1}}isInfiniteRepeat(){return this.json.repeatCount>999999998}getReverse(){return this.isReverse}setReverse(t){this.isReverse=t}createTimeNode(t,e){let n=null;const r={json:t,isSub:e,isIterate:this.isIterate,eventHub:this.eventHubs.global,ctx:this.ctx,parent:this,iterateType:this.iterateType,iterateIndex:this.iterateIndex,iterateId:this.iterateId,isInInteractiveSeq:this.isInInteractiveSeq,fromSeqId:this.fromSeqId};return t.type==="seq"?n=new WE(r):t.type==="par"?n=new ov(r):t.type==="set"?n=new Sc(r):t.type==="anim"?n=new XE(r):t.type==="animEffect"?n=new SS(r):t.type==="animMotion"?n=new wS(r):t.type==="animScale"?n=new AS(r):t.type==="animClr"?n=new MS(r):t.type==="animRot"?n=new CS(r):t.type==="cmd"?n=new RS(r):t.type==="audio"&&(n=new IS(r)),n}createSubList(t){this.subList&&this.subList.forEach(e=>e.commonTimeNode.destroy()),this.subList=[],t.forEach(e=>{const n=this.createTimeNode(e,!0);n&&this.subList.push(n)})}bindCommonTimeNodeEvent(t){t.commonTimeNode.on("timeNodeStart",e=>{this.emit("childTimeNodeStart",e)}),t.commonTimeNode.on("timeNodeEnd",e=>{this.emit("childTimeNodeEnd",e),this.children.every(n=>n.commonTimeNode.isTimeNodeEndWhenDetectEndSync())&&(this.json.iterate||this.allChildrenEndHandle())})}createChildren(t){function e(o){return wc(o).presetOrder}function n(o){return/^slide/.test(o)?"slide":/^layout/.test(o)?"layout":/^master/.test(o)?"master":"unknow"}const r=["master","layout","slide","unknow"];t&&t[0]&&e(t[0])?[...t].sort((o,s)=>{var a,l,h,u;const p=wc(o).id,y=wc(s).id;if(p&&y){const x=n(p),E=n(y);return x===E?((a=e(o))!==null&&a!==void 0?a:0)-((l=e(s))!==null&&l!==void 0?l:0):r.indexOf(x)-r.indexOf(E)}return((h=e(o))!==null&&h!==void 0?h:0)-((u=e(s))!==null&&u!==void 0?u:0)}).forEach(o=>{const s=this.createTimeNode(o,!1);s&&(this.bindCommonTimeNodeEvent(s),this.children.push(s))}):t.forEach(o=>{const s=this.createTimeNode(o,!1);s&&(this.bindCommonTimeNodeEvent(s),this.children.push(s))})}playReverse(){this.isReverse=!0,this.startReverseTimeLine(),this.children.forEach(t=>t.commonTimeNode.playReverse())}allChildrenEndHandle(){if(!this.isDestroy){if(this.json.autoRev&&!this.isReverse)return this.isReverse=!0,void this.playReverse();this.isReverse&&(this.isReverse=!1),this.json.repeatCount&&this.json.repeatCount>this.applyCount?this.repeatTimeoutId=this.ctx.clock.setTimeout(()=>{this.seekToStart(!1),this.resetForRepeat(),this.startTimeNodeRepeat()}):(this.json.iterate&&!this.isIterate&&(this.isIterateEnd=!0),this.eventHubs.runtime.emit("runtime all end"),this.startSubList(),this.handleEnd())}}resetForRepeat(){this.isInInteractiveSeq&&this.isInfiniteRepeat()&&this.repeatTimeNodeEnd(),this.timeDelta=0,this.children.forEach(t=>t.commonTimeNode.resetForRepeat())}startSubList(){this.subList.forEach(t=>t.commonTimeNode.startTimeNode())}startReverseTimeLine(){this.isEndEventsEmitted=!1,this.timeDelta=0;const t=1e3/this.ctx.ticker.maxFPS;this.duration<=t&&this.duration>0?(this.emit("timeUpdate",{delta:this.duration,duration:this.duration,isReverse:this.isReverse}),this.ctx.eventHub.emit(Ke.animateEnd),this.ctx.ticker.remove(this.updateTimeLine)):this.duration>t&&(this.ctx.eventHub.emit(Ke.animateStart),this.ctx.ticker.add(this.updateTimeLine))}startTimeLine(t=!0){if(t&&(this.isEndEventsEmitted=!1,this.eventHubs.global.emit(`time ${this.json.id} begin`),this.eventHubs.global.emit(`time ${this.json.id} onBegin`),this.eventHubs.runtime.emit(`runtime ${this.json.id} begin`)),this.json.iterate)return void this.startIterate();this.timeDelta=0,this.emit("timelineStart",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse});const e=1e3/this.ctx.ticker.maxFPS;this.duration<=e&&this.duration>0?(this.timeDelta=this.isReverse?0:this.duration,this.emit("timeUpdate",{delta:this.timeDelta,duration:this.duration,isReverse:this.isReverse}),this.emit("timelineEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}),this.ctx.ticker.addOnce(()=>{this.onTimeLineEnd()})):this.duration>e&&(this.ctx.eventHub.emit(Ke.animateStart),this.updateTimeLine(0),this.ctx.ticker.add(this.updateTimeLine))}startIterate(){return PS(this,void 0,void 0,function*(){if(this.json.iterate){this.isIterateEnd=!1;for(const t of this.iterateShadows){if(this.isIterateEnd)break;t.children.forEach(e=>{e.commonTimeNode.startTimeNode()}),t.applyCount+=1,yield this.ctx.clock.delay(this.json.iterate.interval)}this.onTimeLineEnd()}})}applyTimeFilter(t){if(!this.tmFilter.every(e=>zo()(e[0])&&zo()(e[1])))return t;for(let e=0;e<this.tmFilter.length;e++){const n=this.tmFilter[e];if(t<n[0]){const r=this.tmFilter[e-1];return(t-r[0])/(n[0]-r[0])*(n[1]-r[1])+r[1]}}return this.tmFilter.length>0?this.tmFilter[this.tmFilter.length-1][1]:t}isNatureTimeEnd(){return this.duration>=0&&this.timeDelta>=this.duration}findTargets(){const t=[],e=n=>{n.forEach(r=>{var o,s,a;r.cBhvr&&r.cBhvr.target&&t.findIndex(l=>l.id===r.cBhvr.target.id)<0&&t.push(r.cBhvr.target),((s=(o=r==null?void 0:r.cBhvr)===null||o===void 0?void 0:o.ctn)===null||s===void 0?void 0:s.childTnLst)&&r.cBhvr.ctn.childTnLst.length>0&&e(r.cBhvr.ctn.childTnLst),((a=r==null?void 0:r.ctn)===null||a===void 0?void 0:a.childTnLst)&&r.ctn.childTnLst.length>0&&e(r.ctn.childTnLst)})};return e(this.json.childTnLst||[]),t}setPreStyle(){this.json.presetClass&&this.findTargets().forEach(t=>{if(this.json.iterate){let e=0,n=!0;for(;n;){const r=this.ctx.timingTargets.getTarget(t,!0,{type:this.json.iterate.type,index:e,id:""});r&&(this.setPreStyleForTarget(r),e+=1),n=!!r}}else{const e=this.ctx.timingTargets.getTarget(t,!1);e&&this.setPreStyleForTarget(e)}})}setPreStyleForTarget(t){var e,n;if(t&&this.json.presetSubtype&&(t.presetSubType=this.json.presetSubtype),t&&!t.hasPreset)if(this.json.presetClass==="entr"){const r=(n=(e=this.json)===null||e===void 0?void 0:e.childTnLst)===null||n===void 0?void 0:n.filter(o=>o.type==="set"&&o.to==="visible");r!=null&&r.length&&(t.hasPreset=!0,t.style.visibility="hidden")}else(this.json.presetClass==="exit"||this.json.presetClass==="path"||this.json.presetClass==="emph")&&(t.hasPreset=!0,t.style.visibility="visible")}startTimeNodeRepeat(){this.timeDelta=0,this.isActive=!0,this.applyCount+=1,this.startTimeLine(!1),this.json.iterate||this.emit("timeNodeRepeat",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse})}startTimeNodeForce(){this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.timeDelta=0,this.isActive=!0,this.handleActive(!1)}startTimeNode(t=!0){if(this.isDestroy)return;this.collectStartValue(),this.timeDelta=0,this.isReverse=!1,this.json.subTnLst&&this.createSubList(this.json.subTnLst),this.startConds.setTriggerParams(t);const e=this.json.stCondLst.filter(r=>/^self/.test(r.event||""))[0];e&&this.startConds.condHandle(e);const n=this.json.endCondLst.filter(r=>/^self/.test(r.event||""))[0];n&&this.endConds.condHandle(n),this.startConds.condHandle()}onTimeLineEnd(){this.dispose(),(this.children.length===0||this.json.iterate)&&this.allChildrenEndHandle()}clearSubList(){this.subList.forEach(t=>t.commonTimeNode.destroy())}seekToStart(t=!0){if(this.isEndEventsEmitted=!1,this.isActive=!1,this.dispose(),this.timeDelta=0,this.emit("seekToStart"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(e=>e.seekToStart(t));if(t)for(let e=this.subList.length-1;e>=0;e--){const n=this.subList[e];n==null||n.commonTimeNode.seekToStart()}for(let e=this.children.length-1;e>=0;e--){const n=this.children[e];n==null||n.commonTimeNode.seekToStart()}if(this.children.length>1)for(let e=this.children.length-1;e>=0;e--){const n=this.children[e];n==null||n.commonTimeNode.seekToStart()}}repeatTimeNodeEnd(){this.dispose(),this.children.forEach(t=>{t.commonTimeNode.isActive=!1,t.commonTimeNode.dispose()})}dispose(t=!1){this.isConflictDispose=t,this.ctx.clock.clearTimeout(this.repeatTimeoutId),this.ctx.eventHub.emit(Ke.animateEnd);try{this.ctx.ticker.remove(this.updateTimeLine)}catch{}this.startConds.reset(),this.endConds.reset()}seekToEnd(t,e=!1){if(this.isInfiniteRepeat())return;!this.isActive&&this.applyCount<=0&&this.collectStartValue(),this.applyCount=this.json.repeatCount,this.json.autoRev&&(this.isReverse=!0),this.timeDelta=this.duration,this.isActive=!1,this.dispose();const n=this.json.autoRev||t;if(n?this.emit("seekToStart"):this.emit("seekToEnd"),this.json.iterate&&!this.isIterate)return this.isIterateEnd=!0,void this.iterateShadows.forEach(r=>r.seekToEnd(n,e));this.children.length===0&&(this.eventHubs.runtime.emit("runtime all end"),this.handleEnd()),this.children.forEach(r=>r.commonTimeNode.seekToEnd(n,e)),e&&this.json.subTnLst&&(this.subList.length<=0&&this.createSubList(this.json.subTnLst),this.subList.forEach(r=>r.commonTimeNode.seekToEnd(!1)),this.clearSubList())}isTimeNodeEndWhenDetectEndSync(){if(this.isInInteractiveSeq&&this.isInfiniteRepeat())return!0;let t=!0;return this.children.length>0&&(t=t&&this.children.every(e=>e.commonTimeNode.isTimeNodeEndWhenDetectEndSync())),this.json.repeatCount&&(t=t&&this.applyCount>=this.json.repeatCount),this.json.autoRev&&(t=t&&!this.isReverse),t=t&&this.isNatureTimeEnd(),!!this.isConflictDispose||!(!this.isIterateEnd||!this.json.iterate)||t}isTimeNodeEnd(){let t=!0;return this.children.length>0&&(t=t&&this.children.every(e=>e.commonTimeNode.isTimeNodeEnd())),this.json.repeatCount&&(t=t&&this.applyCount>=this.json.repeatCount),this.json.autoRev&&(t=t&&!this.isReverse),t=t&&this.isNatureTimeEnd(),!!this.isConflictDispose||!(!this.isIterateEnd||!this.json.iterate)||t}emitEndEvents(){this.isEndEventsEmitted||(this.isEndEventsEmitted=!0,this.eventHubs.global.emit(`time ${this.json.id} end`),this.eventHubs.global.emit(`time ${this.json.id} onEnd`),this.eventHubs.runtime.emit(`runtime ${this.json.id} end`),this.emit("timeNodeEnd",{id:this.uuid,activeCount:this.applyCount,isReverse:this.isReverse}))}collectStartValue(){this.emit("timeNodeCreate"),this.children.forEach(t=>t.commonTimeNode.collectStartValue())}destroy(){this.emit("timeNodeDestroy"),this.isDestroy=!0,this.dispose(),this.startConds.removeAllListeners(),this.endConds.removeAllListeners(),this.children.forEach(t=>t.commonTimeNode.destroy()),this.clearSubList()}}class ov extends xi.a{constructor(t){super(),this.isRunning=!1,this.runtimeNodeEventHub=new xi.a;const{json:e,iterateType:n,isIterate:r,isSub:o,parent:s,ctx:a,eventHub:l,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:y}=t;this.id=e.ctn.id,this.json=e,this.ctx=a,this.isIterate=r,this.globalEventHub=l,this.commonTimeNode=new Qs({json:e.ctn,isSub:o,eventHubs:{global:l,runtime:this.runtimeNodeEventHub},ctx:a,parent:s,isIterate:!1,iterateType:n,iterateIndex:h,iterateId:u,isInInteractiveSeq:p,fromSeqId:y}),this.commonTimeNode.on("timeNodeStart",()=>{this.commonTimeNode.children.forEach(x=>{x.commonTimeNode.setReverse(this.commonTimeNode.getReverse()),x.commonTimeNode.startTimeNode()}),this.isRunning||(this.isRunning=!0,this.globalEventHub.emit(`runtime ${this.id} begin`),this.emit("begin"))}),this.commonTimeNode.on("timeNodeRepeat",()=>{this.commonTimeNode.children.forEach(x=>{x.commonTimeNode.startTimeNode(!1)})}),this.commonTimeNode.on("timeNodeEnd",()=>{this.commonTimeNode.isTimeNodeEnd()&&this.isRunning&&(this.isRunning=!1,this.globalEventHub.emit(`runtime ${this.id} end`),this.emit("end")),this.commonTimeNode.json.presetClass==="exit"&&this.commonTimeNode.children.length>=1&&this.commonTimeNode.children[this.commonTimeNode.children.length-1]instanceof Sc&&this.commonTimeNode.children.forEach(x=>{x instanceof Sc||typeof x.onSeekToStart!="function"||x.onSeekToStart()})})}}var OS=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class NS{constructor(t,e,n){this.json=t,this.ctx=n,this.globalEventHub=e;const r=t.timeNodeList.find(o=>o.type==="par"&&o.ctn.nodeType==="tmRoot");r&&(this.tmRoot=new ov({json:r,isSub:!1,isIterate:!1,eventHub:e,ctx:n,parent:null,iterateType:"el",iterateIndex:0,iterateId:"",isInInteractiveSeq:!1,fromSeqId:""}),this.mainSeq=this.tmRoot.commonTimeNode.children.find(o=>{var s,a,l;return((s=o.json)===null||s===void 0?void 0:s.type)==="seq"&&((l=(a=o.json)===null||a===void 0?void 0:a.ctn)===null||l===void 0?void 0:l.nodeType)==="mainSeq"}))}findSeq(t){var e;return(e=this.tmRoot)===null||e===void 0?void 0:e.commonTimeNode.children.find(n=>{var r,o,s;return((r=n.json)===null||r===void 0?void 0:r.type)==="seq"&&((s=(o=n.json)===null||o===void 0?void 0:o.ctn)===null||s===void 0?void 0:s.id)===t})}start(){var t,e;return OS(this,void 0,void 0,function*(){this.json.autoPlayMainSeq?(yield this.ctx.clock.delay(16),(t=this.mainSeq)===null||t===void 0||t.commonTimeNode.startTimeNode()):(e=this.mainSeq)===null||e===void 0||e.commonTimeNode.startTimeNode()})}setMainSeqApplied(){this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1)}collectMainSeqStartValue(){var t;(t=this.mainSeq)===null||t===void 0||t.commonTimeNode.collectStartValue()}setMainSeqStep(t,e){var n;t===-1&&this.mainSeq&&(this.mainSeq.commonTimeNode.applyCount=1),(n=this.mainSeq)===null||n===void 0||n.setCurrentStep(t,e)}destroy(){var t;this.globalEventHub.removeAllListeners(),(t=this.tmRoot)===null||t===void 0||t.commonTimeNode.destroy()}hasMainSeq(){return!!this.mainSeq&&this.mainSeq.commonTimeNode.children.length>0}currentMainSeqState(){return this.mainSeq?this.mainSeq.currentState:null}currentMainSeqStep(){return this.mainSeq?this.mainSeq.currentStep:0}currentMainSeqLength(){return this.mainSeq?this.mainSeq.stepLength:0}mainSeqHasNextStep(){return!!this.mainSeq&&this.mainSeq.hasNext()}mainSeqHasPrevStep(){return!!this.mainSeq&&this.mainSeq.hasPrev()}seekInteractiveSeqToEnd(t){const e=this.findSeq(t);e&&e.commonTimeNode.seekToEnd(!1,!0)}setInteractiveSeqState(t,e,n){const r=this.findSeq(t);r&&r.setCurrentStep(e,n)}resetAllInteractiveSeq(){var t;(((t=this.tmRoot)===null||t===void 0?void 0:t.commonTimeNode.children.filter(e=>{var n,r,o;return((n=e.json)===null||n===void 0?void 0:n.type)==="seq"&&((o=(r=e.json)===null||r===void 0?void 0:r.ctn)===null||o===void 0?void 0:o.nodeType)==="interactiveSeq"}))||[]).forEach(e=>{e.setCurrentStep(0,"start")})}applyInteractiveAction(t){this.globalEventHub.emit(t)}}var sv=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class LS extends Ec{constructor(t,e,n,r){super({id:"stage",width:t.width,height:t.height,type:"Container",children:t.children},e,{parentGlobalPos:n},r),this.isRendered=!1,this.isTimingStartValueCollected=!1,this.json=t,this.json.smartArtShapeList&&(e.smartArtShapeList=this.json.smartArtShapeList),e.hasBackgroundFillShape=this.detectUseBackgroundFill(this.json),this.container.visible=!1,this.ctx=e;const o=new er;o.beginFill(16777215),o.drawRect(0,0,t.width,t.height),o.endFill(),this.container.addChild(o)}detectUseBackgroundFill(t){return!!t&&(t.type==="Picture"||t.type==="Shape"?t.useBgFill:!(!t.children||!Array.isArray(t.children))&&t.children.some(e=>this.detectUseBackgroundFill(e)))}initOnReuse(){super.initOnReuse(),this.ctx.timingEventHub.on("c:prev slide",t=>{this.ctx.eventHub.emit(Ke.requestPrevSlide,t)}),this.ctx.timingEventHub.on("c:next slide",(t,e)=>{this.ctx.eventHub.emit(Ke.requestNextSlide,t,e)})}get interactiveContainer(){return this.container}render(t){this.isRendered||(this.collectAnimatedIds().forEach(e=>this.ctx.animatedIds.add(e)),this.isRendered=!0,super.render(t),t.addSubMTask(()=>sv(this,void 0,void 0,function*(){this.ctx.eventHub.emit("StageRenderEnd")}),"@StageImpl[emit.StageRenderEnd]"))}isListTimeNode(t){return["excel","seq","par"].indexOf(t.type)>=0}isAnimatedTimeNode(t){return!!t.cBhvr}collectAnimatedIdsForTimeNode(t,e){var n;this.isListTimeNode(t)?(n=t.ctn.childTnLst)===null||n===void 0||n.forEach(r=>{this.collectAnimatedIdsForTimeNode(r,e)}):this.isAnimatedTimeNode(t)&&e.push(t.cBhvr.target.id)}collectAnimatedIds(){const t=[];return this.json.timing&&this.json.timing.timeNodeList.forEach(e=>{this.collectAnimatedIdsForTimeNode(e,t)}),t}createTiming(){this.json.timing&&!this.timing&&(this.timing=new NS(this.json.timing,this.ctx.timingEventHub,this.ctx))}startTiming(){var t;return((t=this.timing)===null||t===void 0?void 0:t.start())||Promise.resolve()}setMainSeqApplied(){var t;(t=this.timing)===null||t===void 0||t.setMainSeqApplied()}setMainSeqStep(t,e){var n;(n=this.timing)===null||n===void 0||n.setMainSeqStep(t,e)}collectMainSeqStartValue(){var t;this.isTimingStartValueCollected||(this.isTimingStartValueCollected=!0,(t=this.timing)===null||t===void 0||t.collectMainSeqStartValue())}hasTiming(){return!!this.timing}clearOnSlideChange(){this.ctx.eventHub.removeAllListeners(),this.ctx.timingEventHub.removeAllListeners(),super.clearOnSlideChange()}clearOnTransactionEnd(){var t,e;this.ctx.timingTargets.getTargets().forEach(n=>{n.hasPreset=!1}),(t=this.timing)===null||t===void 0||t.resetAllInteractiveSeq(),(e=this.timing)===null||e===void 0||e.destroy(),this.timing=void 0}destroy(){var t,e;this.isTimingStartValueCollected=!1,this.isRendered=!1,this.ctx.eventHub.removeAllListeners(),this.ctx.graphicsTexture.destroy(),(t=this.ctx.bgTexture)===null||t===void 0||t.destroy(!0),this.ctx.spriteTexture.destroy(),this.ctx.timingEventHub.removeAllListeners(),(e=this.timing)===null||e===void 0||e.destroy(),this.timing=void 0,super.destroy()}mainSeqStep(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.currentMainSeqStep())!==null&&e!==void 0?e:0}mainSeqLength(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.currentMainSeqLength())!==null&&e!==void 0?e:0}mainSeqHasNextStep(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.mainSeqHasNextStep())!==null&&e!==void 0&&e}mainSeqHasPrevStep(){var t,e;return(e=(t=this.timing)===null||t===void 0?void 0:t.mainSeqHasPrevStep())!==null&&e!==void 0&&e}mainSeqState(){return this.timing?this.timing.currentMainSeqState():null}nextStep(t,e){var n;this.hasTiming()&&((n=this.timing)===null||n===void 0?void 0:n.hasMainSeq())?(this.ctx.timingEventHub.emit("shape slide onStopAudio"),this.ctx.timingEventHub.emit("shape slide onNext",t,e)):this.ctx.eventHub.emit(Ke.requestNextSlide,t,e)}prevStep(t=!1){var e;this.hasTiming()&&((e=this.timing)===null||e===void 0?void 0:e.hasMainSeq())?(this.ctx.timingEventHub.emit("shape slide onStopAudio"),this.ctx.timingEventHub.emit("shape slide onPrev",t)):this.ctx.eventHub.emit(Ke.requestPrevSlide,t)}applyInteractiveAction(t){var e;(e=this.timing)===null||e===void 0||e.applyInteractiveAction(t)}seekInteractiveSeqToEnd(t){var e;(e=this.timing)===null||e===void 0||e.seekInteractiveSeqToEnd(t)}setInteractiveSeqState(t,e,n){var r;(r=this.timing)===null||r===void 0||r.setInteractiveSeqState(t,e,n)}setMediaState(t,e,n){return sv(this,void 0,void 0,function*(){const r=this.ctx.medias[t];r&&(e?n?(yield ih(()=>r.clippedDuration>0,5e3),n<r.clippedDuration&&(r.once("play",()=>{r.seek(n)}),yield r.play())):yield r.play():(n&&r.seek(n),yield r.pause()))})}setMediaCurrentTime(t,e){const n=this.ctx.medias[t];n&&n.seek(e)}}class DS{constructor(t){this.ticker=t,this.tasks=[],this.couldRunning=!1,this.applyNext=()=>{const e=this.tasks[0];e&&e.applyNext()},t.add(this.applyNext)}addTask(t){this.tasks.push(t),t.once("task-finish",()=>{const e=this.tasks.indexOf(t);e>=0&&this.tasks.splice(e,1)}),t.once("task-error",()=>{const e=this.tasks.indexOf(t);e>=0&&this.tasks.splice(e,1)})}start(){this.couldRunning=!0}stop(){this.couldRunning=!1}}var FS=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};const BS=i=>new Promise(t=>setTimeout(t,i));class US extends xi.a{constructor(t,e,n){super(),this.slideIndex=t,this.taskId=e,this.logger=n,this.uuid=cs(),this.isCancel=!1,this.tasks=[]}addMTask(t,e){this.tasks.push({fn:t,state:"wait",sub:[],name:e})}addSubMTask(t,e){let n=this.tasks.findIndex(r=>r.state==="running");n<0&&(n=0),this.tasks[n].sub.push({fn:t,state:"wait",sub:[],name:e})}cancel(){this.tasks=[],this.isCancel=!0}applyNext(){if(this.tasks.some(e=>e.state==="running")||this.tasks.some(e=>e.state==="error"))return;if(this.tasks.every(e=>e.state==="finish"))return void(this.isCancel||this.emit("task-finish"));const t=this.tasks.find(e=>e.state==="wait");t&&(t.state="running",t.fn.apply(null).then(()=>{if(t.state="finish",t.sub.length>0){const e=this.tasks.findIndex(n=>n===t);this.tasks.splice(e+1,0,...t.sub)}}).catch(e=>{t.state="error",this.logger.error(`${e} ${e.stack}`,this.taskId),this.emit("task-error",Ai.transform(e),this.slideIndex)}))}applyAll(){return FS(this,void 0,void 0,function*(){for(;!this.tasks.every(t=>t.state==="finish");)if(this.tasks.some(t=>t.state==="running"))yield BS(16);else{if(this.tasks.some(t=>t.state==="error"))return;{const t=this.tasks.find(e=>e.state==="wait");if(t){t.state="running";try{if((yield Ys(()=>t.fn.apply(null),6e4))===fo)throw new Ai(nr.RuntimeError,`subtask ${t.name} apply timeout`);if(t.state="finish",t.sub.length>0){const e=this.tasks.findIndex(n=>n===t);this.tasks.splice(e+1,0,...t.sub)}}catch(e){let n;n=e!=null&&e.errorType?e:new Ai(nr.RuntimeError,`subtask ${t.name} error. ${e}`),t.state="error",this.logger.error(`${e} ${e.stack}`,this.taskId),this.emit("task-error",Ai.transform(n),this.slideIndex);break}}}}!this.isCancel&&this.tasks.every(t=>t.state==="finish")&&this.emit("task-finish")})}}var kS=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class go{constructor(t,e){if(this.renderer=t,this.localStorage=e,this.outputData=new Map,this.loadingSdfKeys=new Set,!go.worker){const n=new Blob([`
self.onmessage = function(e) {
    var data = e.data.data;
    var key = e.data.key;
    var height = Math.ceil(e.data.height);
    var width = Math.ceil(e.data.width);
    if (!data || !key) {
        return;
    }
    var maxDis = 0;
    var d = [];
    var p = [];
    var maxInt = Number.MAX_SAFE_INTEGER || 255 * 255 * 255;
    var setD = function(x, y, v) { d[y * width + x] = v; };
    var getD = function(x, y) { return d[y * width + x]; };
    var setP = function(x, y, v) { p[y * width + x] = v; };
    var getP = function(x, y) { return p[y * width + x]; };
    var isContains = function(x, y) { return x >= 0 && x < width && y >= 0 && y < height; };
    var isInterior = function(x, y) { return data[(y * width + x) * 4 + 3] > 10; };
    for (var y = 0; y < height; ++ y) {
        for (var x = 0; x < width; ++ x) {
            var c = isInterior(x, y);
            var t = isContains(x, y - 1) ? isInterior(x, y - 1) : false;
            var b = isContains(x, y + 1) ? isInterior(x, y + 1) : false;
            var l = isContains(x - 1, y) ? isInterior(x - 1, y) : false;
            var r = isContains(x + 1, y) ? isInterior(x + 1, y) : false;
            if (c !== t || c !== b || c !== l || c !== r) {
                setD(x, y, 0);
                setP(x, y, [x, y]);
            } else {
                setD(x, y, maxInt);
                setP(x, y, [-1, -1]);
            }
        }
    }
    
    var f = function (x, y, dir) {
        var d1 = 1;
        var d2 = Math.sqrt(2);
        var dx;
        var dy;
        var od;
        switch (dir) {
            case "TL": dx = -1; dy = -1; od = d2; break;
            case "T": dx = 0; dy = -1; od = d1; break;
            case "TR": dx = 1; dy = -1; od = d2; break;
            case "L": dx = -1; dy = 0; od = d1; break;
            case "R": dx = 1; dy = 0; od = d1; break;
            case "BL": dx = -1; dy = 1; od = d2; break;
            case "B": dx = 0; dy = 1; od = d1; break;
            case "BR": dx = 1; dy = 1; od = d2; break;
        }
        var b = isContains(x + dx, y + dy);
        var cb = b ? getD(x + dx, y + dy) : maxInt;
        if (cb + od < getD(x, y)) {
            var p = b ? getP(x + dx, y + dy) : [-1, -1];
            var dis = Math.sqrt(Math.pow(x - p[0], 2) + Math.pow(y - p[1], 2));
            setP(x, y, p);
            setD(x, y, dis);
            if (dis > maxDis) {
                maxDis = dis;
            }
        }
    };
    
    for (var y = 0; y < height; ++ y) {
        for (var x = 0; x < width; ++ x) {
            var dirs = ["TL", "T", "TR", "L"];
            for (var i = 0; i < dirs.length; ++ i) {
                var dir = dirs[i];
                f(x, y, dir);
            }
        }
    }

    for (var y = height - 1; y >= 0; -- y) {
        for (var x = width - 1; x >= 0; -- x) {
            var dirs = ["R", "BL", "B", "BR"];
            for (var i = 0; i < dirs.length; ++ i) {
                var dir = dirs[i];
                f(x, y, dir);
            }
        }
    }

    var outputData = [];
    for (var y = 0; y < height; ++ y) {
        for (var x = 0; x < width; ++ x) {
            outputData.push(isInterior(x, y) ? 255: 0);
            outputData.push(0);
            outputData.push(0);
            outputData.push(Math.ceil(getD(x, y) / maxDis * 255));
        }
    }
    self.postMessage({
        key, outputData, maxDis
    });
};
`],{type:"text/javascript"});go.worker=new Worker(URL.createObjectURL(n)),go.worker.onmessage=r=>{this.outputData.set(r.data.key,{data:r.data.outputData,maxDis:r.data.maxDis})},this.outputData.set("111","222")}}createSdfByWorker(t,e,n,r,o,s,a,l){const h=document.createElement("canvas");h.width=o,h.height=s;const u=h.getContext("2d");if(!u||!go.worker)return;u.drawImage(a,t,e,n,r);const{data:p}=u.getImageData(0,0,o,s);go.worker.postMessage({data:p,key:l,width:o,height:s})}createSdf(t,e,n){const r=document.createElement("canvas");r.width=t,r.height=e;const o=r.getContext("2d");if(!o)return{src:"",maxDis:1};o.drawImage(n,0,0);let s=0;const{data:a}=o.getImageData(0,0,t,e),l=[],h=[],u=function(Z,rt,ct){l[rt*t+Z]=ct},p=function(Z,rt){return l[rt*t+Z]},y=function(Z,rt,ct){h[rt*t+Z]=ct},x=function(Z,rt){return h[rt*t+Z]},E=function(Z,rt){return Z>=0&&Z<t&&rt>=0&&rt<e},w=function(Z,rt){return a[4*(rt*t+Z)+3]>10};for(let Z=0;Z<e;++Z)for(let rt=0;rt<t;++rt){const ct=w(rt,Z),nt=!!E(rt,Z-1)&&w(rt,Z-1),vt=!!E(rt,Z+1)&&w(rt,Z+1),ht=!!E(rt-1,Z)&&w(rt-1,Z),mt=!!E(rt+1,Z)&&w(rt+1,Z);ct!==nt||ct!==vt||ct!==ht||ct!==mt?(u(rt,Z,0),y(rt,Z,[rt,Z])):(u(rt,Z,Number.MAX_SAFE_INTEGER),y(rt,Z,[-1,-1]))}const C=function(Z,rt,ct){const nt=Math.sqrt(2);let vt,ht,mt;switch(ct){case"TL":vt=-1,ht=-1,mt=nt;break;case"T":vt=0,ht=-1,mt=1;break;case"TR":vt=1,ht=-1,mt=nt;break;case"L":vt=-1,ht=0,mt=1;break;case"R":vt=1,ht=0,mt=1;break;case"BL":vt=-1,ht=1,mt=nt;break;case"B":vt=0,ht=1,mt=1;break;case"BR":vt=1,ht=1,mt=nt}const jt=E(Z+vt,rt+ht);if((jt?p(Z+vt,rt+ht):Number.MAX_SAFE_INTEGER)+mt<p(Z,rt)){const Ft=jt?x(Z+vt,rt+ht):[-1,-1],Mt=Math.sqrt(Math.pow(Z-Ft[0],2)+Math.pow(rt-Ft[1],2));y(Z,rt,Ft),u(Z,rt,Mt),Mt>s&&(s=Mt)}};for(let Z=0;Z<e;++Z)for(let rt=0;rt<t;++rt){const ct=["TL","T","TR","L"];for(const nt of ct)C(rt,Z,nt)}for(let Z=e-1;Z>=0;--Z)for(let rt=t-1;rt>=0;--rt){const ct=["R","BL","B","BR"];for(const nt of ct)C(rt,Z,nt)}const j=[];for(let Z=0;Z<e;++Z)for(let rt=0;rt<t;++rt)j.push(0,0,0,Math.ceil(p(rt,Z)/s*255));return o.putImageData(new ImageData(Uint8ClampedArray.from(j),t,e),0,0),{src:r.toDataURL("image/png"),maxDis:s}}getSdf(t,e,n){return kS(this,void 0,void 0,function*(){const r=Math.ceil(e.width),o=Math.ceil(e.height),s=Math.ceil(e.width-t.width)/2,a=Math.ceil(e.height-t.height)/2;let l=yield this.localStorage.getItem(`sdf-${n}-src`),h=yield this.localStorage.getItem(`sdf-${n}-maxDis`);if(!(l&&h||this.loadingSdfKeys.has(n))){this.loadingSdfKeys.add(n);const u=this.renderer.plugins.extract.image(t,"image/png");u.addEventListener("load",()=>{this.createSdfByWorker(s,a,t.width,t.height,r,o,u,n)}),u.addEventListener("error",()=>null),yield ih(()=>!!this.outputData.has(n),2e3),this.loadingSdfKeys.delete(n);const p=this.outputData.get(n);if(p){this.outputData.delete(n);const y=document.createElement("canvas");y.width=r,y.height=o;const x=y.getContext("2d");if(!x)return null;x.putImageData(new ImageData(Uint8ClampedArray.from(p.data),r,o),0,0),l=y.toDataURL("image/png"),h=p.maxDis,this.localStorage.setItem(`sdf-${n}-src`,l).catch(()=>{}),this.localStorage.setItem(`sdf-${n}-maxDis`,h).catch(()=>{})}}return!l||!h?null:(document.createElement("img").src=l,ce.t.fromURL(l).then(u=>({texture:u,maxDis:h})).catch(()=>null))})}}go.worker=null;var Ya=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class GS{constructor(t,e,n,r,o,s,a,l,h,u,p,y,x,E,w,C,j){this.loader=t,this.mode=e,this.renderer=n,this.ticker=r,this.view=o,this.clock=s,this.objPoolGroup=a,this.errorChannel=l,this.localstorage=h,this.logger=u,this.loaderDelegate=p,this.urlInterrupter=y,this.isPlayerPaused=x,this.maxResolution=E,this.volumeAdjuster=w,this.forceCanvas=C,this.globalEventHub=j,this.currentStageIndex=0,this.cacheCount=fs.isDesktop()?2:1,this.stageStates=Object.create(null),this.stageJsons=Object.create(null),this.stageCtxs=Object.create(null),this.stageImpls=Object.create(null),this.taskId="",this.url="",this.runningAudio=new Map,this.activeMedia=new Set,this.microTaskManager=new DS(r),this.sdfManager=new go(n,h)}setResourceData(t,e){this.taskId=t,this.url=e}createCtx(t){const{task:e}=this.stageStates[t];e.addMTask(()=>Ya(this,void 0,void 0,function*(){const n=new RT(this.loader),r=new xi.a,o={taskId:this.taskId,mode:this.mode,renderer:this.renderer,graphicsTexture:new LT(this.maxResolution),stageWidth:0,stageHeight:0,ticker:this.ticker,timingTargets:new FT(r),eventHub:r,view:this.view,medias:Object.create(null),lastViewedIndex:0,conflictTimeNodeManager:new DT,clock:this.clock,spriteTexture:n,slideIndex:t,objectPoolGroup:this.objPoolGroup,hasBackgroundFillShape:!1,slideScopeEventHub:new xi.a,logger:this.logger,sdfManager:this.sdfManager,loaderDelegate:this.loaderDelegate,runningAudio:this.runningAudio,activeMedia:this.activeMedia,isPlayerPaused:this.isPlayerPaused,timingEventHub:new xi.a,maxResolution:this.maxResolution,animatedIds:new Set,volumeAdjuster:this.volumeAdjuster,forceCanvas:this.forceCanvas,globalEventHub:this.globalEventHub,latestChangeFullscreenTargetId:"",isRendering:!1,urlInterrupter:this.urlInterrupter};this.stageCtxs[t]=o}),"@StagePool[createCtx]")}loadStageJson(t){const{task:e}=this.stageStates[t];e.addMTask(()=>Ya(this,void 0,void 0,function*(){const n=yield this.loader.fetchJson(`${this.url}/${this.taskId}/jsonOutput/slide-${t}.json`);this.stageJsons[t]=n,this.stageCtxs[t].stageWidth=n.width,this.stageCtxs[t].stageHeight=n.height,this.stageCtxs[t].featureList=n.featureList}),"@StagePool[loadStageJson]")}loadSpriteSheets(t){const{task:e}=this.stageStates[t];e.addMTask(()=>{const n=this.stageJsons[t],{spriteTexture:r,stageWidth:o,stageHeight:s}=this.stageCtxs[t],{coloredSheets:a,sheets:l}=n,h=a||l;return h&&h.forEach(u=>{e.addSubMTask(()=>{let p=1;if(o>this.maxResolution.x||s>this.maxResolution.y){p=this.maxResolution.x/o;const y=p*s;y>this.maxResolution.y&&(p*=this.maxResolution.y/y)}return r.loadSpriteSheetItem(this.url,this.taskId,u,p)},"@StagePool[spriteTexture.loadSpriteSheetItem]")}),Promise.resolve()},"@StagePool[loadSpriteSheets]")}createStage(t){const{task:e}=this.stageStates[t];e.addMTask(()=>{const n=this.stageJsons[t],r=this.stageCtxs[t],o=new LS(n,r,{x:0,y:0},e);return this.stageImpls[t]=o,Promise.resolve()},"@StagePool[createStage]")}preRenderStage(t){const{task:e}=this.stageStates[t];e.addMTask(()=>(this.stageImpls[t].preRender(e),Promise.resolve()),"@StagePool[preRenderStage]")}createGraphicsTexture(t){const{task:e}=this.stageStates[t];e.addMTask(()=>Ya(this,void 0,void 0,function*(){const n=this.stageCtxs[t];n.graphicsTexture.pack().forEach((r,o)=>{e.addSubMTask(()=>{const{stageWidth:s,stageHeight:a}=this.stageCtxs[t];let l=1;if(s>this.maxResolution.x||a>this.maxResolution.y){l=this.maxResolution.x/s;const h=l*a;h>this.maxResolution.y&&(l*=this.maxResolution.y/h)}return n.graphicsTexture.render(r,o,this.objPoolGroup,l)},"@StagePool[graphicsTexture.render]")})}),"@StagePool[createGraphicsTexture]")}renderStage(t){const{task:e}=this.stageStates[t];e.addMTask(()=>Ya(this,void 0,void 0,function*(){yield this.stageImpls[t].render(e)}),"@StagePool[renderStage]")}destroyStageByIndex(t){this.stageStates[t].state==="load"&&this.stageStates[t].task.cancel(),delete this.stageStates[t],this.stageImpls[t].destroy(),delete this.stageImpls[t],delete this.stageCtxs[t]}destroyStage(){Object.keys(this.stageImpls).forEach(t=>{const e=parseInt(t,10);Math.abs(this.currentStageIndex-e)>this.cacheCount&&this.destroyStageByIndex(e)})}destroyAllStage(){Object.keys(this.stageImpls).forEach(t=>{const e=parseInt(t,10);this.destroyStageByIndex(e)})}preload(t,e=!1){if(this.stageImpls[t]||this.stageStates[t])return Promise.resolve();const n=new US(t,this.taskId,this.logger);return n.on("task-error",(r,o)=>{delete this.stageStates[o],delete this.stageImpls[o],delete this.stageCtxs[o],this.errorChannel.emit("error",r,o)}),this.stageStates[t]={state:"load",task:n},this.createCtx(t),this.loadStageJson(t),this.loadSpriteSheets(t),this.createStage(t),this.preRenderStage(t),this.createGraphicsTexture(t),this.renderStage(t),this.microTaskManager.addTask(n),e?n.applyAll():new Promise(r=>{n.once("task-finish",()=>{this.stageStates[t].state="finish",Object.keys(this.stageStates).length>2*this.cacheCount+1&&this.destroyStage(),r()})})}getStageJson(t){return this.stageJsons[t]||null}getStage(t){return Ya(this,void 0,void 0,function*(){this.currentStageIndex=t;const e=this.stageStates[t];return(e==null?void 0:e.state)==="finish"&&this.stageImpls[t]?this.stageImpls[t]:(e==null?void 0:e.state)==="load"?(yield e.task.applyAll(),this.stageImpls[t]):(yield this.preload(t,!0),this.stageImpls[t])})}destroy(){this.runningAudio.clear()}}var av=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};class Dr{constructor(t){var e;this.logger=t,this.taskId="",this.isIndexDBReady=!1,this.memoryCache=new Map,(e=Dr.localCache)===null||e===void 0||e.ready(n=>{n||(this.isIndexDBReady=!0)}).catch(()=>{t.warn("local storage not ready",this.taskId)})}get couldUseIndexDBCache(){return this.isIndexDBReady&&this.taskId.length>0}attachTaskId(t){this.taskId=t}getItem(t){return av(this,void 0,void 0,function*(){let e=null;if(this.couldUseIndexDBCache&&Dr.localCache)try{e=yield Ys(()=>Dr.localCache.getItem(`${this.taskId}/${t}`),500)}catch{}return e=e===fo?null:e,e||this.memoryCache.get(t)||null})}setItem(t,e,n=!1){return av(this,void 0,void 0,function*(){if(!this.couldUseIndexDBCache)return n&&this.memoryCache.set(t,e),Promise.resolve();if(Dr.localCache){let r=null;try{r=yield Ys(()=>Dr.localCache.setItem(`${this.taskId}/${t}`,e).catch(()=>{n&&this.memoryCache.set(t,e)}),500)}catch{}r!==fo&&r!==null||!n||this.memoryCache.set(t,e)}})}dispose(){var t;this.memoryCache=new Map,this.couldUseIndexDBCache&&((t=Dr.localCache)===null||t===void 0||t.keys().then(e=>{e.filter(n=>n.indexOf(this.taskId)>=0).forEach(n=>{var r;(r=Dr.localCache)===null||r===void 0||r.removeItem(n).catch(()=>{})})}).catch(()=>{}))}}Dr.localCache=null;try{Dr.localCache=I.createInstance({name:"slide_local_cache",driver:I.INDEXEDDB,version:1})}catch{}const HS=new De.j;class Ac{constructor(t){this.localStorage=t}canvas(t,e,n,r){let o,s,a,l=!1,h=!1;t&&(t instanceof ce.p?a=t:(a=e.generateTexture(t),h=!0)),a?(o=a.baseTexture.resolution,s=a.frame,l=!1,e.renderTexture.bind(a)):(o=e.resolution,l=!0,s=HS,s.width=e.width,s.height=e.height,e.renderTexture.bind(null));const u=Math.floor(s.width*o+1e-4),p=Math.floor(s.height*o+1e-4);let y=document.createElement("canvas");y.width=u,y.height=p;const x=y.getContext("2d");if(!x)throw new Error("ctx");if(n)x.putImageData(n,0,0);else{const E=x.getImageData(0,0,u,p),w=new Uint8Array(4*u*p),{gl:C}=e;C.readPixels(s.x*o,s.y*o,u,p,C.RGBA,C.UNSIGNED_BYTE,w),Ac.arrayPostDivide(w,E.data),x.putImageData(E,0,0),r&&this.localStorage.setItem(r,E).catch(()=>{})}if(l){const E=document.createElement("canvas");E.width=u,E.height=p;const w=E.getContext("2d");w.scale(1,-1),w.drawImage(y,0,-p),y=E}return h&&(a==null||a.destroy(!0)),y}static arrayPostDivide(t,e){for(let n=0;n<t.length;n+=4){const r=e[n+3]=t[n+3];r!==0?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}}}class lv extends xi.a{constructor(){super(...arguments),this._volume=.5}get volume(){return this._volume}set volume(t){t<0&&(t=0),t>1&&(t=1),this._volume=t,this.emit("update",this._volume)}}var $s=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})};xn.skipHello();const hv={randomBar:"RandomLines",circle:"Shape",ripple:"Ripples",wipe:"Erase",dissolve:"Dissolve",morph:"Smooth",fade:"FadeInOut",push:"Push",split:"Separation",reveal:"Display",pull:"Uncover",cover:"Cover",flash:"Flash",checker:"Checkerboard",blinds:"WindowShades",curtains:"Curtain",fallOver:"Fall",drape:"Suspension",wheel:"Clock",comb:"Combing",warp:"Scale",peelOff:"PeelOff",flip:"Flip",gallery:"Gallery",switch:"Switch",prism:"Prism",doors:"Doors"},Ke={mainSeqStepChange:"mainSeqStepChange",mainSeqStateChange:"mainSeqStateChange",interactiveSeqStateChange:"interactiveSeqStateChange",interactiveSeqAction:"interactiveSeqAction",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",slideChange:"slideChange",renderStart:"renderStart",renderEnd:"renderEnd",hyperlinkTrigger:"hyperlinkTrigger",animateStart:"animateStart",animateEnd:"animateEnd",mediaSeek:"mediaSeek",mediaPlay:"mediaPlay",mediaPause:"mediaPause",mediaStop:"mediaStop",requestNextSlide:"requestNextSlide",requestPrevSlide:"requestPrevSlide",requestGotoSlide:"requestGotoSlide",requestOpenUrl:"requestOpenUrl",userInput:"userInput",fullscreenChange:"fullscreenChange",changeLocalFullscreenState:"changeLocalFullscreenState"};class lr extends xi.a{constructor(t,e={}){super(),this.errorChannel=new xi.a,this.transactionPlayer=null,this.isForward=!0,this.drawCall=0,this.scale=1,this._isPaused=!1,this.maxResolution=new De.g(0,0),this.isNVIDIA=!1,this.fps=new ET,this.designWidth=0,this.designHeight=0,this.currentIndex=0,this.slideCount=0,this.runtime={drawCall:0,fps:0},this.globalEventHub=new xi.a,this.globalVideoBackground=new er,this.globalVideoSprite=new pi,this.onMousemoveTimeout=null,this.cacheFunctionMap=new Map,this.isPlayerPaused=()=>this._isPaused,this.onWebGLLost=()=>{this.errorChannel.emit("error",new Ai(nr.CanvasCrash,"webgl context lost."))},this.fullscreenOnMousemove=({index:o,targetId:s})=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:o,targetId:s,status:!0}),this.onMousemoveTimeout&&clearTimeout(this.onMousemoveTimeout),this.onMousemoveTimeout=setTimeout(()=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:o,targetId:s,status:!1})},Wo.hoverHiddeDelay)},this.fullscreenOnMouseleave=({index:o,targetId:s})=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:o,targetId:s,status:!1})},this.calculateFullscreenVideoPosition=o=>{const{width:s,height:a}=o,{designWidth:l,designHeight:h}=this,u=Math.min(l/s,h/a);return{x:(l-s*u)/2,y:(h-a*u)/2,width:s*u,height:a*u}},this.onRequestFullscreenVideo=o=>{const{texture:s,index:a,targetId:l}=o;if(a!==this.currentIndex)return void s.destroy(!1);this.onRequestCancelFullscreenVideo(),this.globalVideoBackground.width=this.designWidth,this.globalVideoBackground.height=this.designHeight,this.globalVideoBackground.beginFill(0,1),this.globalVideoBackground.drawRect(0,0,this.designWidth,this.designHeight),this.globalVideoBackground.endFill(),this.globalVideoBackground.interactive=!0,this.app.stage.addChild(this.globalVideoBackground);const{x:h,y:u,width:p,height:y}=this.calculateFullscreenVideoPosition(s);this.globalVideoSprite.texture=s,this.globalVideoSprite.width=p,this.globalVideoSprite.height=y,this.globalVideoSprite.position.x=h,this.globalVideoSprite.position.y=u,this.globalVideoBackground.addChild(this.globalVideoSprite),this.globalEventHub.emit("onFullscreenChange",{status:!0,targetId:l,slideIndex:this.currentIndex}),this.clearFullscreenEventListenersWithAppView();const x={handleEvent:()=>{var E;(E=this.currentStage)===null||E===void 0||E.ctx.eventHub.emit(Ke.userInput)}};if(this.app.view.addEventListener("pointerdown",x,!1),this.cacheFunctionMap.set("pointerdown",x),fs.isDesktop()){const E={handleEvent:()=>{this.fullscreenOnMouseleave({index:a,targetId:l})}};this.app.view.addEventListener("mouseout",E,!1);const w={handleEvent:()=>{this.globalEventHub.emit("controllerShowStatusChange",{slideIndex:a,targetId:l,status:!0})}};this.app.view.addEventListener("mouseover",w,!1);const C={handleEvent:()=>{this.fullscreenOnMousemove({index:a,targetId:l})}};this.app.view.addEventListener("mousemove",C,!1),this.cacheFunctionMap.set("mouseover",w),this.cacheFunctionMap.set("mousemove",C),this.cacheFunctionMap.set("mouseout",E)}else{const E={handleEvent:()=>{this.fullscreenOnMousemove({index:a,targetId:l})}};this.app.view.addEventListener("touchstart",E,!1),this.cacheFunctionMap.set("touchstart",E)}},this.onRequestCancelFullscreenVideo=(o=!1)=>{var s,a;this.globalVideoSprite.texture.destroy(!1),this.globalVideoBackground.removeChild(this.globalVideoSprite),this.app.stage.removeChild(this.globalVideoBackground),this.globalEventHub.emit("onFullscreenChange",{status:!1,slideIndex:this.currentIndex,targetId:(s=this.currentStage)===null||s===void 0?void 0:s.ctx.latestChangeFullscreenTargetId}),this.clearFullscreenEventListenersWithAppView(),o&&this.emit(Ke.changeLocalFullscreenState,{status:!1,slideIndex:this.currentIndex,targetId:(a=this.currentStage)===null||a===void 0?void 0:a.ctx.latestChangeFullscreenTargetId})},this.logger=t.logger,this.tracker=t.tracker,this.mode=t.mode,this.volumeAdjuster=t.volumeAdjuster,this.localStorage=new Dr(this.logger),this.cachedExtract=new Ac(this.localStorage),this.config={minFPS:ji()(e.minFPS)?30:e.minFPS,maxFPS:ji()(e.maxFPS)?40:e.maxFPS,resolution:ji()(e.resolution)?1:e.resolution,autoFPS:!ji()(e.autoFPS)&&e.autoFPS,autoResolution:!ji()(e.autoResolution)&&e.autoResolution,transactionBgColor:ji()(e.transactionBgColor)?0:e.transactionBgColor,maxResolutionLevel:this.getMaxResolution(e.maxResolutionLevel),forceCanvas:!ji()(e.forceCanvas)&&e.forceCanvas,enableNvidiaDetect:!ji()(e.enableNvidiaDetect)&&e.enableNvidiaDetect},this.updateMaxResolutionLevel(this.config.maxResolutionLevel),this.loader=new wT(this.localStorage,t.useLocalCache,this.logger,this.tracker,t.resourceTimeout,t.loadDelegate,t.urlInterrupter);const n=xn.isWebGLSupported();this.app=new jl({antialias:!0,autoDensity:!1,backgroundColor:16777215,forceCanvas:this.config.forceCanvas||!n}),this.tracker({name:"slidePlayerCreate",result:"",reason:"",payload:{webgl:n,resolution:this.config.resolution,minFPS:this.config.minFPS,maxFPS:this.config.maxFPS,maxResolutionLevel:this.config.maxResolutionLevel,forceCanvas:this.config.forceCanvas}}),this.updateConfig(this.config),this.app.ticker.maxFPS=60,this.app.ticker.minFPS=this.config.minFPS,this.app.ticker.maxFPS=this.config.maxFPS,this.app.view.style.zIndex="1",this.app.stage.sortableChildren=!0;const r=this.app.renderer;if(r.gl){const{drawElements:o}=r.gl,s=r.gl.getExtension("WEBGL_debug_renderer_info"),a=r.gl.getParameter(s.UNMASKED_RENDERER_WEBGL);/nvidia/i.test(a)&&this.config.enableNvidiaDetect&&(this.isNVIDIA=!0),r.gl.drawElements=(...l)=>{o.call(r.gl,...l),this.drawCall+=1}}this.fps.on("update",o=>{if(o<this.config.minFPS){if(this.config.autoResolution){const s=.7*this.scale,a=this.app.renderer.resolution,l=Math.max(s,a-.1);l>=s&&this.updateResolution(l)}}else if(o>this.config.maxFPS&&this.config.autoResolution){const s=this.scale*this.config.resolution,a=this.app.renderer.resolution,l=Math.min(s,a+.1);l<=this.config.resolution&&this.updateResolution(l)}}),this.app.ticker.add(()=>{this.runtime.drawCall=this.drawCall,this.runtime.fps=Math.floor(this.app.ticker.minFPS),this.drawCall=0},null,tr.c.LOW),this.clock=new MT(this.app.ticker),this.objPoolGroup=cs(),this.stagePool=new GS(this.loader,this.mode,this.app.renderer,this.app.ticker,this.app.view,this.clock,this.objPoolGroup,this.errorChannel,this.localStorage,this.logger,t.loadDelegate,t.urlInterrupter,this.isPlayerPaused,this.maxResolution,this.volumeAdjuster,this.config.forceCanvas,this.globalEventHub),this.app.view.addEventListener("webglcontextlost",this.onWebGLLost);try{this.config.forceCanvas||(this.transactionPlayer=new Gb)}catch(o){/Error creating WebGL context/.test(o.message)?this.errorChannel.emit("error",new Ai(nr.CanvasCrash,"webgl context lost.")):this.errorChannel.emit("error",new Ai(nr.RuntimeWarn,o.message))}this.globalEventHub.on("requestFullscreen",this.onRequestFullscreenVideo),this.globalEventHub.on("requestCancelFullscreen",this.onRequestCancelFullscreenVideo)}get view(){return this.app.renderer?this.app.view:null}get nextSlideIndex(){var t;return!((t=this.currentStage)===null||t===void 0)&&t.json.nextIndex?this.currentStage.json.nextIndex:this.currentIndex+1}get prevSlideIndex(){var t;return!((t=this.currentStage)===null||t===void 0)&&t.json.prevIndex?this.currentStage.json.prevIndex:this.currentIndex-1}getMaxResolution(t){return!ji()(t)&&Number.isInteger(t)?(t<1&&(t=1),t>4&&(t=4),t):lr.platform.isAndroid()||lr.platform.isIOS()?2:4}updateMaxResolutionLevel(t){t<0&&(t=0),t>4&&(t=4);const e=[640,960,1280,1920,3200][t],n=[360,540,720,1080,1800][t];this.maxResolution.set(e,n)}updateConfig(t){ji()(t.maxFPS)||ji()(t.minFPS)||(this.config.maxFPS=t.maxFPS,this.app.ticker.maxFPS=t.maxFPS,this.config.minFPS=t.minFPS,this.app.ticker.minFPS=t.minFPS),ji()(t.resolution)||(this.config.resolution=t.resolution,this.updateResolution(this.scale*this.config.resolution)),ji()(t.autoFPS)||(this.config.autoFPS=t.autoFPS),ji()(t.autoResolution)||(this.config.autoResolution=t.autoResolution),ji()(t.transactionBgColor)||(this.config.transactionBgColor=t.transactionBgColor),this.taskId&&this.logger.info("ppt player update config: "+JSON.stringify(this.config),this.taskId),ji()(t.maxResolutionLevel)||(this.config.maxResolutionLevel=t.maxResolutionLevel,this.updateMaxResolutionLevel(this.config.maxResolutionLevel))}preload(t){return $s(this,void 0,void 0,function*(){t<1||t>this.slideCount||(this.logger.info(`preload slide ${t} begin`,this.taskId),yield this.stagePool.preload(t),this.logger.info(`preload slide ${t} end`,this.taskId))})}setResourceData(t,e){this.logger.info("ppt player init config: "+JSON.stringify(this.config),t),this.logger.info("set resource to "+e,t),this.taskId=t,this.url=e,this.stagePool.setResourceData(t,e),this.localStorage.attachTaskId(t),this.loader.attachTaskId(t)}setInteractive(t){this.app.stage.interactive=t,this.app.stage.interactiveChildren=t}translateEvent(t,e){e.forEach(n=>{t.on(n,(...r)=>{var o,s,a,l;n===Ke.requestGotoSlide&&r[0]!==this.currentIndex&&((s=(o=this.currentStage)===null||o===void 0?void 0:o.timing)===null||s===void 0||s.setMainSeqStep(0,"start"),(l=(a=this.currentStage)===null||a===void 0?void 0:a.timing)===null||l===void 0||l.destroy()),this.emit(n,...r)})})}renderSlide(t){var e,n,r;return $s(this,void 0,void 0,function*(){if(this._isPaused)return void this.logger.info("ppt play prevent render slide with paused state",this.taskId);const o=this.currentIndex,s=Date.now();this.logger.info("render slide "+t,this.taskId),this.emit(Ke.renderStart,t);const a=yield this.stagePool.getStage(t),l=`snapshot-${t}-${this.isForward?"start":"end"}`,h=yield this.localStorage.getItem(l);if(!a)return;a.ctx.isRendering=!0,this.translateEvent(a.ctx.eventHub,[Ke.mainSeqStepChange,Ke.mainSeqStateChange,Ke.hyperlinkTrigger,Ke.interactiveSeqAction,Ke.mainSeqStepStart,Ke.mainSeqStepEnd,Ke.animateStart,Ke.animateEnd,Ke.mediaPlay,Ke.mediaPause,Ke.mediaSeek,Ke.mediaStop,Ke.requestGotoSlide,Ke.requestOpenUrl,Ke.requestNextSlide,Ke.requestPrevSlide,Ke.interactiveSeqStateChange,Ke.userInput,Ke.fullscreenChange,Ke.changeLocalFullscreenState]),this.currentIndex=Number(t);const{width:u,height:p,slideCount:y}=a.json;this.slideCount=y,this.designWidth=u,this.designHeight=p,(e=this.currentStage)===null||e===void 0||e.clearOnSlideChange();const x=this.currentStage;this.currentStage=a,a.initOnReuse(),a.createTiming(),a.container.visible=!0,a.collectMainSeqStartValue(),this.isForward?a.setMainSeqStep(0,"start"):a.setMainSeqStep(-1,"end"),this.onRequestCancelFullscreenVideo(!0);let E=!1;if(xn.isWebGLSupported()&&!this.config.forceCanvas&&a.json.transition&&a.json.transition.type&&this.app.stage.children.length>0&&this.view&&x){let{transition:w}=a.json;!this.isForward&&(x==null?void 0:x.json.transition)&&(w=x.json.transition);const C=this.getTransactionTexture(x,this.view,null,null);this.initTransactionPlayer(w),(n=this.transactionPlayer)===null||n===void 0||n.setPrevTexture(C),E=!0}if(this.app.stage.addChild(a.container),this.updateResolution(this.config.resolution*this.scale),x&&(x.clearOnTransactionEnd(),this.app.stage.removeChild(x.container)),a.json.transition&&a.json.transition.type&&this.app.stage.children.length>0&&this.view&&this.transactionPlayer&&E){const w=yield this.getTransactionTexture(a,this.view,l,h);this.transactionPlayer.setNextTexture(w),yield this.transactionPlayer.play();const C=this.transactionPlayer.renderer.domElement;if(this.view.parentElement&&C)try{this.view.parentElement.removeChild(C)}catch{}(r=this.transactionPlayer)===null||r===void 0||r.dispose()}this.isForward?yield a.startTiming():a.setMainSeqApplied(),a.ctx.slideScopeEventHub.emit("slide-render",a.ctx.slideIndex),this.emit(Ke.renderEnd,t),this.emit(Ke.slideChange,t),a.ctx.isRendering=!1,this.preload(t+1).catch(w=>{this.errorChannel.emit("error",Ai.transform(w),t+1)}),this.preload(t-1).catch(w=>{this.errorChannel.emit("error",Ai.transform(w),t-1)}),this.logger.info(`render slide ${t} done, time: ${Date.now()-s}ms`,this.taskId),this.tracker({name:"slidePageChange",reason:"",result:"",payload:{duration:Date.now()-s,from:o,to:t}})})}getTransactionTexture(t,e,n,r){const o=ce.p.create({width:t.json.width,height:t.json.height,resolution:1});this.app.renderer.render(t.container,{renderTexture:o});const s=this.cachedExtract.canvas(o,this.app.renderer,r,n);return new tt(s)}renderToBase64(t,e,n){return $s(this,void 0,void 0,function*(){const r=yield this.stagePool.getStage(t);if(r){const{width:o,height:s}=r.json;this.designWidth=o,this.designHeight=s;const a=ce.p.create({width:this.designWidth,height:this.designHeight,resolution:e});r.container.visible=!0,this.app.renderer.render(r.container,{renderTexture:a});const l=this.app.renderer.plugins.extract.base64(a,n);return this.stagePool.destroyStageByIndex(t),l}return"__null__"})}renderMainSeqToBase64(t,e,n){return $s(this,void 0,void 0,function*(){const r=[],o=yield this.stagePool.getStage(t);if(o.createTiming(),o){const{width:s,height:a}=o.json;this.designWidth=s,this.designHeight=a;const l=ce.p.create({width:this.designWidth,height:this.designHeight,resolution:e});o.container.visible=!0;const h=o.mainSeqLength();o.setMainSeqStep(0,"start"),this.app.renderer.render(o.container,{renderTexture:l});const u=this.app.renderer.plugins.extract.base64(l,n);r.push(u);for(let p=0;p<h;p+=1){o.setMainSeqStep(p,"end"),this.app.renderer.render(o.container,{renderTexture:l});const y=this.app.renderer.plugins.extract.base64(l,n);r.push(y)}}return r})}snapshotWithTimingEnd(t){return $s(this,void 0,void 0,function*(){const e=yield this.stagePool.getStage(t);if(e){const{width:n,height:r}=e.json;this.designWidth=n,this.designHeight=r;const o=ce.p.create({width:this.designWidth,height:this.designHeight,resolution:1});e.container.visible=!0,e.initOnReuse(),e.createTiming(),e.collectMainSeqStartValue(),e.setMainSeqStep(-1,"end"),this.app.renderer.render(e.container,{renderTexture:o});const s=this.app.renderer.plugins.extract.base64(o,"image/png");return t!==this.currentIndex&&this.stagePool.destroyStageByIndex(t),s}return null})}getBase64(t){if(!t.container.transform)return null;const e=ce.p.create({width:this.designWidth,height:this.designHeight,resolution:1});this.app.renderer.render(t.container,{renderTexture:e});const n=this.app.renderer.plugins.extract.base64(e,"image/jpeg");return e.destroy(!0),n}initTransactionPlayer(t){var e,n,r,o,s;const a=(e=this.view)===null||e===void 0?void 0:e.parentElement;if(this.view&&a&&hv[t.type]&&this.transactionPlayer){const l=(n=this.transactionPlayer)===null||n===void 0?void 0:n.renderer.domElement;this.transactionPlayer.initPlayer({reverse:!this.isForward,stageWidth:this.view.width,stageHeight:this.view.height,presetType:hv[t.type],duration:(o=(r=this.currentStage)===null||r===void 0?void 0:r.json.transition)===null||o===void 0?void 0:o.dur,delay:0,clearColor:this.config.transactionBgColor,maxFPS:Math.ceil((s=this.config.maxFPS)!==null&&s!==void 0?s:60),options:t.options}),l&&(l.style.position="absolute",l.style.zIndex="9",l.style.left="0",l.style.top="0",l.style.width=this.view.style.width,l.style.height=this.view.style.height),a.appendChild(l)}}scaleView(t,e,n){var r;this.view&&(this.view.style.width=Math.floor(this.designWidth*t)+"px",this.view.style.height=Math.floor(this.designHeight*t)+"px");const o=(r=this.transactionPlayer)===null||r===void 0?void 0:r.renderer.domElement;if(o&&this.view&&(o.style.width=this.view.style.width,o.style.height=this.view.style.height),e){this.scale=t;const s=this.scale*this.config.resolution;this.updateResolution(s,n)}}updateResolution(t,e){this.app.ticker.addOnce(()=>{let n=fs.isDesktop()?t:1;for(;n*this.designWidth>this.maxResolution.x||n*this.designHeight>this.maxResolution.y;)n-=.1;this.app.renderer.resolution=n,this.app.renderer.plugins.interaction.resolution=this.app.renderer.resolution,this.app.renderer.resize(this.designWidth,this.designHeight),gx()(e)&&e()})}nextStep(t,e){var n;if(this._isPaused)this.logger.info("ppt play prevent next step with paused state",this.taskId);else{this.logger.info("ppt play trigger next step",this.taskId);try{this.onRequestCancelFullscreenVideo(!0),(n=this.currentStage)===null||n===void 0||n.nextStep(t,e)}catch(r){this.errorChannel.emit("error",Ai.transform(r),this.currentIndex)}}}prevStep(t=!1){var e;if(this._isPaused)this.logger.info("ppt play prevent prev step with paused state",this.taskId);else{this.logger.info("ppt play trigger prev step",this.taskId);try{this.onRequestCancelFullscreenVideo(!0),(e=this.currentStage)===null||e===void 0||e.prevStep(t)}catch(n){this.errorChannel.emit("error",Ai.transform(n),this.currentIndex)}}}mainSeqLength(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqLength())!==null&&e!==void 0?e:0}mainSeqStep(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqStep())!==null&&e!==void 0?e:0}setMainSeqStep(t,e){var n;(n=this.currentStage)===null||n===void 0||n.setMainSeqStep(t,e)}mainSeqState(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqState())!==null&&e!==void 0?e:null}mainSeqHasNextStep(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqHasNextStep())!==null&&e!==void 0&&e}mainSeqHasPrevStep(){var t,e;return(e=(t=this.currentStage)===null||t===void 0?void 0:t.mainSeqHasPrevStep())!==null&&e!==void 0&&e}nextTick(t){this.app.ticker.addOnce(()=>{t()},tr.c.LOW)}applyInteractiveAction(t){var e;(e=this.currentStage)===null||e===void 0||e.applyInteractiveAction(t)}seekInteractiveSeqToEnd(t){var e;(e=this.currentStage)===null||e===void 0||e.seekInteractiveSeqToEnd(t)}setInteractiveSeqState(t,e,n){var r;(r=this.currentStage)===null||r===void 0||r.setInteractiveSeqState(t,e,n)}setMediaState(t,e,n){var r;return $s(this,void 0,void 0,function*(){yield(r=this.currentStage)===null||r===void 0?void 0:r.setMediaState(t,e,n)})}setMediaCurrentTime(t,e){var n;(n=this.currentStage)===null||n===void 0||n.setMediaCurrentTime(t,e)}pause(){var t;this.app.ticker.stop(),(t=this.currentStage)===null||t===void 0||t.ctx.activeMedia.forEach(e=>{e.globalPause()}),this._isPaused=!0}resume(){var t;this._isPaused=!1,this.app.ticker.start(),(t=this.currentStage)===null||t===void 0||t.ctx.activeMedia.forEach(e=>{e.globalResume()})}getSnapshot(){return this.currentStage&&this.getBase64(this.currentStage)||""}clearLocalCache(){this.localStorage.dispose()}static clearLocalCache(){var t;(t=Dr.localCache)===null||t===void 0||t.clear().catch(()=>{})}clearFullscreenEventListenersWithAppView(){["mousemove","mouseout","mouseover","touchstart","pointerdown"].forEach(t=>{this.cacheFunctionMap.has(t)&&(this.app.view.removeEventListener(t,this.cacheFunctionMap.get(t),!1),this.cacheFunctionMap.delete(t))})}syncFullscreenVideoState(t){this.globalEventHub.emit("syncFullscreenVideoState",t)}destroy(){var t,e;try{this.app.view.removeEventListener("webglcontextlost",this.onWebGLLost),this.app.renderer.filter.texturePool.clear(!0),cc.collectObjectByGroup(this.objPoolGroup),dc.collectObjectByGroup(this.objPoolGroup),(t=this.transactionPlayer)===null||t===void 0||t.destroy(),this.loader.destroy(),this.fps.destroy(),this.stagePool.destroyAllStage(),this.stagePool.destroy(),this.app.renderer.gl.getExtension("WEBGL_lose_context").loseContext(),this.app.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),(e=go.worker)===null||e===void 0||e.terminate(),this.tracker({name:"slidePlayerDestroy",result:"",reason:"",payload:{}})}catch{}}}lr.platform=fs,lr.RtcAudioClazz=null;var Mc=new Map,qa,jS=v(136),zS=v.n(jS),VS=v(49),uv=v.n(VS),WS=v(50),cv=v.n(WS),ms=[],dv="ResizeObserver loop completed with undelivered notifications.";(function(i){i.BORDER_BOX="border-box",i.CONTENT_BOX="content-box",i.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(qa||(qa={}));var Cc,gs=function(i){return Object.freeze(i)},XS=function(i,t){this.inlineSize=i,this.blockSize=t,gs(this)},pv=function(){function i(t,e,n,r){return this.x=t,this.y=e,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,gs(this)}return i.prototype.toJSON=function(){var t=this;return{x:t.x,y:t.y,top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}},i.fromRect=function(t){return new i(t.x,t.y,t.width,t.height)},i}(),Rc=function(i){return i instanceof SVGElement&&"getBBox"in i},fv=function(i){if(Rc(i)){var t=i.getBBox(),e=t.width,n=t.height;return!e&&!n}var r=i,o=r.offsetWidth,s=r.offsetHeight;return!(o||s||i.getClientRects().length)},mv=function(i){var t;if(i instanceof Element)return!0;var e=(t=i==null?void 0:i.ownerDocument)===null||t===void 0?void 0:t.defaultView;return!!(e&&i instanceof e.Element)},Ja=typeof window!="undefined"?window:{},yh=new WeakMap,gv=/auto|scroll/,YS=/^tb|vertical/,qS=/msie|trident/i.test(Ja.navigator&&Ja.navigator.userAgent),eo=function(i){return parseFloat(i||"0")},ta=function(i,t,e){return i===void 0&&(i=0),t===void 0&&(t=0),e===void 0&&(e=!1),new XS((e?t:i)||0,(e?i:t)||0)},vv=gs({devicePixelContentBoxSize:ta(),borderBoxSize:ta(),contentBoxSize:ta(),contentRect:new pv(0,0,0,0)}),_v=function(i,t){if(t===void 0&&(t=!1),yh.has(i)&&!t)return yh.get(i);if(fv(i))return yh.set(i,vv),vv;var e=getComputedStyle(i),n=Rc(i)&&i.ownerSVGElement&&i.getBBox(),r=!qS&&e.boxSizing==="border-box",o=YS.test(e.writingMode||""),s=!n&&gv.test(e.overflowY||""),a=!n&&gv.test(e.overflowX||""),l=n?0:eo(e.paddingTop),h=n?0:eo(e.paddingRight),u=n?0:eo(e.paddingBottom),p=n?0:eo(e.paddingLeft),y=n?0:eo(e.borderTopWidth),x=n?0:eo(e.borderRightWidth),E=n?0:eo(e.borderBottomWidth),w=p+h,C=l+u,j=(n?0:eo(e.borderLeftWidth))+x,Z=y+E,rt=a?i.offsetHeight-Z-i.clientHeight:0,ct=s?i.offsetWidth-j-i.clientWidth:0,nt=r?w+j:0,vt=r?C+Z:0,ht=n?n.width:eo(e.width)-nt-ct,mt=n?n.height:eo(e.height)-vt-rt,jt=ht+w+ct+j,Ft=mt+C+rt+Z,Mt=gs({devicePixelContentBoxSize:ta(Math.round(ht*devicePixelRatio),Math.round(mt*devicePixelRatio),o),borderBoxSize:ta(jt,Ft,o),contentBoxSize:ta(ht,mt,o),contentRect:new pv(p,l,ht,mt)});return yh.set(i,Mt),Mt},yv=function(i,t,e){var n=_v(i,e),r=n.borderBoxSize,o=n.contentBoxSize,s=n.devicePixelContentBoxSize;switch(t){case qa.DEVICE_PIXEL_CONTENT_BOX:return s;case qa.BORDER_BOX:return r;default:return o}},JS=function(i){var t=_v(i);this.target=i,this.contentRect=t.contentRect,this.borderBoxSize=gs([t.borderBoxSize]),this.contentBoxSize=gs([t.contentBoxSize]),this.devicePixelContentBoxSize=gs([t.devicePixelContentBoxSize])},xv=function(i){if(fv(i))return 1/0;for(var t=0,e=i.parentNode;e;)t+=1,e=e.parentNode;return t},KS=function(){var i=1/0,t=[];ms.forEach(function(r){if(r.activeTargets.length!==0){var o=[];r.activeTargets.forEach(function(s){var a=new JS(s.target),l=xv(s.target);o.push(a),s.lastReportedSize=yv(s.target,s.observedBox),l<i&&(i=l)}),t.push(function(){r.callback.call(r.observer,o,r.observer)}),r.activeTargets.splice(0,r.activeTargets.length)}});for(var e=0,n=t;e<n.length;e++)(0,n[e])();return i},bv=function(i){ms.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(e){e.isActive()&&(xv(e.target)>i?t.activeTargets.push(e):t.skippedTargets.push(e))})})},ZS=function(){var i,t=0;for(bv(t);ms.some(function(e){return e.activeTargets.length>0});)t=KS(),bv(t);return ms.some(function(e){return e.skippedTargets.length>0})&&(typeof ErrorEvent=="function"?i=new ErrorEvent("error",{message:dv}):((i=document.createEvent("Event")).initEvent("error",!1,!1),i.message=dv),window.dispatchEvent(i)),t>0},Tv=[],QS=function(i){if(!Cc){var t=0,e=document.createTextNode("");new MutationObserver(function(){return Tv.splice(0).forEach(function(n){return n()})}).observe(e,{characterData:!0}),Cc=function(){e.textContent="".concat(t?t--:t++)}}Tv.push(i),Cc()},Ic=0,$S={attributes:!0,characterData:!0,childList:!0,subtree:!0},Ev=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],Sv=function(i){return i===void 0&&(i=0),Date.now()+i},Pc=!1,Oc=new(function(){function i(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return i.prototype.run=function(t){var e=this;if(t===void 0&&(t=250),!Pc){Pc=!0;var n,r=Sv(t);n=function(){var o=!1;try{o=ZS()}finally{if(Pc=!1,t=r-Sv(),!Ic)return;o?e.run(1e3):t>0?e.run(t):e.start()}},QS(function(){requestAnimationFrame(n)})}},i.prototype.schedule=function(){this.stop(),this.run()},i.prototype.observe=function(){var t=this,e=function(){return t.observer&&t.observer.observe(document.body,$S)};document.body?e():Ja.addEventListener("DOMContentLoaded",e)},i.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),Ev.forEach(function(e){return Ja.addEventListener(e,t.listener,!0)}))},i.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),Ev.forEach(function(e){return Ja.removeEventListener(e,t.listener,!0)}),this.stopped=!0)},i}()),wv=function(i){!Ic&&i>0&&Oc.start(),!(Ic+=i)&&Oc.stop()},tw=function(){function i(t,e){this.target=t,this.observedBox=e||qa.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return i.prototype.isActive=function(){var t,e=yv(this.target,this.observedBox,!0);return t=this.target,Rc(t)||function(n){switch(n.tagName){case"INPUT":if(n.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(t)||getComputedStyle(t).display!=="inline"||(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},i}(),ew=function(i,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=i,this.callback=t},xh=new WeakMap,Av=function(i,t){for(var e=0;e<i.length;e+=1)if(i[e].target===t)return e;return-1},bh=function(){function i(){}return i.connect=function(t,e){var n=new ew(t,e);xh.set(t,n)},i.observe=function(t,e,n){var r=xh.get(t),o=r.observationTargets.length===0;Av(r.observationTargets,e)<0&&(o&&ms.push(r),r.observationTargets.push(new tw(e,n&&n.box)),wv(1),Oc.schedule())},i.unobserve=function(t,e){var n=xh.get(t),r=Av(n.observationTargets,e),o=n.observationTargets.length===1;r>=0&&(o&&ms.splice(ms.indexOf(n),1),n.observationTargets.splice(r,1),wv(-1))},i.disconnect=function(t){var e=this,n=xh.get(t);n.observationTargets.slice().forEach(function(r){return e.unobserve(t,r.target)}),n.activeTargets.splice(0,n.activeTargets.length)},i}(),nw=function(){function i(t){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof t!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");bh.connect(this,t)}return i.prototype.observe=function(t,e){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!mv(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");bh.observe(this,t,e)},i.prototype.unobserve=function(t){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!mv(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");bh.unobserve(this,t)},i.prototype.disconnect=function(){bh.disconnect(this)},i.toString=function(){return"function ResizeObserver () { [polyfill code] }"},i}(),iw=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},rw=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}},ow=function(){function i(t,e,n,r,o){this.state="idle",this.index=-1,this.slideIndex=-1,this.fn=n,this.index=t,this.slideIndex=e,this.eventHub=r,this.id=o}return i.prototype.apply=function(){return iw(this,void 0,void 0,function(){var t;return rw(this,function(e){switch(e.label){case 0:this.eventHub.emit("task-start",this),e.label=1;case 1:return e.trys.push([1,3,,4]),this.state="start",[4,this.fn()];case 2:return e.sent(),this.state="end",this.eventHub.emit("task-end",this),[3,4];case 3:return t=e.sent(),this.eventHub.emit("task-error",{task:this,error:t}),[3,4];case 4:return[2]}})})},i}(),sw=function(){function i(){var t=this;this.eventHub=new xi.a,this.tasks=[],this.index=0,this.eventHub.on("task-end",function(e){var n,r=t.tasks.findIndex(function(s){return s.index===e.index}),o=r+1;o>=0&&((n=t.tasks[o])===null||n===void 0||n.apply()),r>=0&&(t.tasks.splice(r,1),t.replaceIdleTask()),t.eventHub.emit("task-end-"+e.id)}),this.eventHub.on("task-error",function(e){var n=e.task,r=t.tasks.findIndex(function(o){return o.index===n.index});r>=0&&(t.tasks.splice(r,1),t.replaceIdleTask())})}return i.prototype.replaceIdleTask=function(){for(var t,e=this,n=new Set,r=0,o=this.tasks.length;r<o;r++)this.tasks[r].state==="idle"&&((t=this.tasks[r+1])===null||t===void 0?void 0:t.state)==="idle"&&n.add(r);Array.from(n).forEach(function(s){e.tasks.splice(s,1)})},i.prototype.addTask=function(t,e,n){var r=new ow(this.index++,e,t,this.eventHub,n);this.tasks.push(r),this.tasks.sort(function(o,s){return o.index-s.index}),this.replaceIdleTask(),this.tasks.length===1&&r.apply()},i.prototype.hasStartTask=function(){return this.tasks.some(function(t){return t.state==="start"})},i.prototype.destroy=function(){this.eventHub.removeAllListeners()},i}();function ea(i,t){var e=i.__state.conversionName.toString(),n=Math.round(i.r),r=Math.round(i.g),o=Math.round(i.b),s=i.a,a=Math.round(i.h),l=i.s.toFixed(1),h=i.v.toFixed(1);if(t||e==="THREE_CHAR_HEX"||e==="SIX_CHAR_HEX"){for(var u=i.hex.toString(16);u.length<6;)u="0"+u;return"#"+u}return e==="CSS_RGB"?"rgb("+n+","+r+","+o+")":e==="CSS_RGBA"?"rgba("+n+","+r+","+o+","+s+")":e==="HEX"?"0x"+i.hex.toString(16):e==="RGB_ARRAY"?"["+n+","+r+","+o+"]":e==="RGBA_ARRAY"?"["+n+","+r+","+o+","+s+"]":e==="RGB_OBJ"?"{r:"+n+",g:"+r+",b:"+o+"}":e==="RGBA_OBJ"?"{r:"+n+",g:"+r+",b:"+o+",a:"+s+"}":e==="HSV_OBJ"?"{h:"+a+",s:"+l+",v:"+h+"}":e==="HSVA_OBJ"?"{h:"+a+",s:"+l+",v:"+h+",a:"+s+"}":"unknown format"}var Mv=Array.prototype.forEach,Ka=Array.prototype.slice,Ne={BREAK:{},extend:function(i){return this.each(Ka.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(t[e])||(i[e]=t[e])}.bind(this))},this),i},defaults:function(i){return this.each(Ka.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(i[e])&&(i[e]=t[e])}.bind(this))},this),i},compose:function(){var i=Ka.call(arguments);return function(){for(var t=Ka.call(arguments),e=i.length-1;e>=0;e--)t=[i[e].apply(this,t)];return t[0]}},each:function(i,t,e){if(i){if(Mv&&i.forEach&&i.forEach===Mv)i.forEach(t,e);else if(i.length===i.length+0){var n,r=void 0;for(r=0,n=i.length;r<n;r++)if(r in i&&t.call(e,i[r],r)===this.BREAK)return}else for(var o in i)if(t.call(e,i[o],o)===this.BREAK)return}},defer:function(i){setTimeout(i,0)},debounce:function(i,t,e){var n=void 0;return function(){var r=this,o=arguments;function s(){n=null,e||i.apply(r,o)}var a=e||!n;clearTimeout(n),n=setTimeout(s,t),a&&i.apply(r,o)}},toArray:function(i){return i.toArray?i.toArray():Ka.call(i)},isUndefined:function(i){return i===void 0},isNull:function(i){return i===null},isNaN:function(i){function t(e){return i.apply(this,arguments)}return t.toString=function(){return i.toString()},t}(function(i){return isNaN(i)}),isArray:Array.isArray||function(i){return i.constructor===Array},isObject:function(i){return i===Object(i)},isNumber:function(i){return i===i+0},isString:function(i){return i===i+""},isBoolean:function(i){return i===!1||i===!0},isFunction:function(i){return i instanceof Function}},aw=[{litmus:Ne.isString,conversions:{THREE_CHAR_HEX:{read:function(i){var t=i.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t!==null&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:ea},SIX_CHAR_HEX:{read:function(i){var t=i.match(/^#([A-F0-9]{6})$/i);return t!==null&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:ea},CSS_RGB:{read:function(i){var t=i.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t!==null&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:ea},CSS_RGBA:{read:function(i){var t=i.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t!==null&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:ea}}},{litmus:Ne.isNumber,conversions:{HEX:{read:function(i){return{space:"HEX",hex:i,conversionName:"HEX"}},write:function(i){return i.hex}}}},{litmus:Ne.isArray,conversions:{RGB_ARRAY:{read:function(i){return i.length===3&&{space:"RGB",r:i[0],g:i[1],b:i[2]}},write:function(i){return[i.r,i.g,i.b]}},RGBA_ARRAY:{read:function(i){return i.length===4&&{space:"RGB",r:i[0],g:i[1],b:i[2],a:i[3]}},write:function(i){return[i.r,i.g,i.b,i.a]}}}},{litmus:Ne.isObject,conversions:{RGBA_OBJ:{read:function(i){return!!(Ne.isNumber(i.r)&&Ne.isNumber(i.g)&&Ne.isNumber(i.b)&&Ne.isNumber(i.a))&&{space:"RGB",r:i.r,g:i.g,b:i.b,a:i.a}},write:function(i){return{r:i.r,g:i.g,b:i.b,a:i.a}}},RGB_OBJ:{read:function(i){return!!(Ne.isNumber(i.r)&&Ne.isNumber(i.g)&&Ne.isNumber(i.b))&&{space:"RGB",r:i.r,g:i.g,b:i.b}},write:function(i){return{r:i.r,g:i.g,b:i.b}}},HSVA_OBJ:{read:function(i){return!!(Ne.isNumber(i.h)&&Ne.isNumber(i.s)&&Ne.isNumber(i.v)&&Ne.isNumber(i.a))&&{space:"HSV",h:i.h,s:i.s,v:i.v,a:i.a}},write:function(i){return{h:i.h,s:i.s,v:i.v,a:i.a}}},HSV_OBJ:{read:function(i){return!!(Ne.isNumber(i.h)&&Ne.isNumber(i.s)&&Ne.isNumber(i.v))&&{space:"HSV",h:i.h,s:i.s,v:i.v}},write:function(i){return{h:i.h,s:i.s,v:i.v}}}}}],Za=void 0,Th=void 0,Nc=function(){Th=!1;var i=arguments.length>1?Ne.toArray(arguments):arguments[0];return Ne.each(aw,function(t){if(t.litmus(i))return Ne.each(t.conversions,function(e,n){if(Za=e.read(i),Th===!1&&Za!==!1)return Th=Za,Za.conversionName=n,Za.conversion=e,Ne.BREAK}),Ne.BREAK}),Th},Cv=void 0,Eh={hsv_to_rgb:function(i,t,e){var n=Math.floor(i/60)%6,r=i/60-Math.floor(i/60),o=e*(1-t),s=e*(1-r*t),a=e*(1-(1-r)*t),l=[[e,a,o],[s,e,o],[o,e,a],[o,s,e],[a,o,e],[e,o,s]][n];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(i,t,e){var n=Math.min(i,t,e),r=Math.max(i,t,e),o=r-n,s=void 0;return r===0?{h:NaN,s:0,v:0}:(s=i===r?(t-e)/o:t===r?2+(e-i)/o:4+(i-t)/o,(s/=6)<0&&(s+=1),{h:360*s,s:o/r,v:r/255})},rgb_to_hex:function(i,t,e){var n=this.hex_with_component(0,2,i);return n=this.hex_with_component(n,1,t),n=this.hex_with_component(n,0,e)},component_from_hex:function(i,t){return i>>8*t&255},hex_with_component:function(i,t,e){return e<<(Cv=8*t)|i&~(255<<Cv)}},lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Vr=function(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")},Wr=function(){function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),Yo=function i(t,e,n){t===null&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(r===void 0){var o=Object.getPrototypeOf(t);return o===null?void 0:i(o,e,n)}if("value"in r)return r.value;var s=r.get;return s!==void 0?s.call(n):void 0},qo=function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(i,t):i.__proto__=t)},Jo=function(i,t){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?i:t},Wi=function(){function i(){if(Vr(this,i),this.__state=Nc.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Wr(i,[{key:"toString",value:function(){return ea(this)}},{key:"toHexString",value:function(){return ea(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),i}();function Lc(i,t,e){Object.defineProperty(i,t,{get:function(){return this.__state.space==="RGB"||Wi.recalculateRGB(this,t,e),this.__state[t]},set:function(n){this.__state.space!=="RGB"&&(Wi.recalculateRGB(this,t,e),this.__state.space="RGB"),this.__state[t]=n}})}function Dc(i,t){Object.defineProperty(i,t,{get:function(){return this.__state.space==="HSV"||Wi.recalculateHSV(this),this.__state[t]},set:function(e){this.__state.space!=="HSV"&&(Wi.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}Wi.recalculateRGB=function(i,t,e){if(i.__state.space==="HEX")i.__state[t]=Eh.component_from_hex(i.__state.hex,e);else{if(i.__state.space!=="HSV")throw new Error("Corrupted color state");Ne.extend(i.__state,Eh.hsv_to_rgb(i.__state.h,i.__state.s,i.__state.v))}},Wi.recalculateHSV=function(i){var t=Eh.rgb_to_hsv(i.r,i.g,i.b);Ne.extend(i.__state,{s:t.s,v:t.v}),Ne.isNaN(t.h)?Ne.isUndefined(i.__state.h)&&(i.__state.h=0):i.__state.h=t.h},Wi.COMPONENTS=["r","g","b","h","s","v","hex","a"],Lc(Wi.prototype,"r",2),Lc(Wi.prototype,"g",1),Lc(Wi.prototype,"b",0),Dc(Wi.prototype,"h"),Dc(Wi.prototype,"s"),Dc(Wi.prototype,"v"),Object.defineProperty(Wi.prototype,"a",{get:function(){return this.__state.a},set:function(i){this.__state.a=i}}),Object.defineProperty(Wi.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=Eh.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(i){this.__state.space="HEX",this.__state.hex=i}});var vs=function(){function i(t,e){Vr(this,i),this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0}return Wr(i,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),i}(),Rv={};Ne.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(i,t){Ne.each(i,function(e){Rv[e]=t})});var hw=/(\d+(\.\d+)?)px/;function no(i){if(i==="0"||Ne.isUndefined(i))return 0;var t=i.match(hw);return Ne.isNull(t)?0:parseFloat(t[1])}var de={makeSelectable:function(i,t){i!==void 0&&i.style!==void 0&&(i.onselectstart=t?function(){return!1}:function(){},i.style.MozUserSelect=t?"auto":"none",i.style.KhtmlUserSelect=t?"auto":"none",i.unselectable=t?"on":"off")},makeFullscreen:function(i,t,e){var n=e,r=t;Ne.isUndefined(r)&&(r=!0),Ne.isUndefined(n)&&(n=!0),i.style.position="absolute",r&&(i.style.left=0,i.style.right=0),n&&(i.style.top=0,i.style.bottom=0)},fakeEvent:function(i,t,e,n){var r=e||{},o=Rv[t];if(!o)throw new Error("Event type "+t+" not supported.");var s=document.createEvent(o);switch(o){case"MouseEvents":var a=r.x||r.clientX||0,l=r.y||r.clientY||0;s.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,a,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var h=s.initKeyboardEvent||s.initKeyEvent;Ne.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),h(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:s.initEvent(t,r.bubbles||!1,r.cancelable||!0)}Ne.defaults(s,n),i.dispatchEvent(s)},bind:function(i,t,e,n){var r=n||!1;return i.addEventListener?i.addEventListener(t,e,r):i.attachEvent&&i.attachEvent("on"+t,e),de},unbind:function(i,t,e,n){var r=n||!1;return i.removeEventListener?i.removeEventListener(t,e,r):i.detachEvent&&i.detachEvent("on"+t,e),de},addClass:function(i,t){if(i.className===void 0)i.className=t;else if(i.className!==t){var e=i.className.split(/ +/);e.indexOf(t)===-1&&(e.push(t),i.className=e.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return de},removeClass:function(i,t){if(t)if(i.className===t)i.removeAttribute("class");else{var e=i.className.split(/ +/),n=e.indexOf(t);n!==-1&&(e.splice(n,1),i.className=e.join(" "))}else i.className=void 0;return de},hasClass:function(i,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(i.className)||!1},getWidth:function(i){var t=getComputedStyle(i);return no(t["border-left-width"])+no(t["border-right-width"])+no(t["padding-left"])+no(t["padding-right"])+no(t.width)},getHeight:function(i){var t=getComputedStyle(i);return no(t["border-top-width"])+no(t["border-bottom-width"])+no(t["padding-top"])+no(t["padding-bottom"])+no(t.height)},getOffset:function(i){var t=i,e={left:0,top:0};if(t.offsetParent)do e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;while(t);return e},isActive:function(i){return i===document.activeElement&&(i.type||i.href)}},Iv=function(i){function t(e,n){Vr(this,t);var r=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r;return r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox"),de.bind(r.__checkbox,"change",function(){o.setValue(!o.__prev)},!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return qo(t,i),Wr(t,[{key:"setValue",value:function(e){var n=Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(vs),uw=function(i){function t(e,n,r){Vr(this,t);var o=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=r,a=o;if(o.__select=document.createElement("select"),Ne.isArray(s)){var l={};Ne.each(s,function(h){l[h]=h}),s=l}return Ne.each(s,function(h,u){var p=document.createElement("option");p.innerHTML=u,p.setAttribute("value",h),a.__select.appendChild(p)}),o.updateDisplay(),de.bind(o.__select,"change",function(){var h=this.options[this.selectedIndex].value;a.setValue(h)}),o.domElement.appendChild(o.__select),o}return qo(t,i),Wr(t,[{key:"setValue",value:function(e){var n=Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return de.isActive(this.__select)?this:(this.__select.value=this.getValue(),Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(vs),cw=function(i){function t(e,n){Vr(this,t);var r=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r;function s(){o.setValue(o.__input.value)}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),de.bind(r.__input,"keyup",s),de.bind(r.__input,"change",s),de.bind(r.__input,"blur",function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}),de.bind(r.__input,"keydown",function(a){a.keyCode===13&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return qo(t,i),Wr(t,[{key:"updateDisplay",value:function(){return de.isActive(this.__input)||(this.__input.value=this.getValue()),Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(vs);function Pv(i){var t=i.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var Ov=function(i){function t(e,n,r){Vr(this,t);var o=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=r||{};return o.__min=s.min,o.__max=s.max,o.__step=s.step,Ne.isUndefined(o.__step)?o.initialValue===0?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=Pv(o.__impliedStep),o}return qo(t,i),Wr(t,[{key:"setValue",value:function(e){var n=e;return this.__min!==void 0&&n<this.__min?n=this.__min:this.__max!==void 0&&n>this.__max&&(n=this.__max),this.__step!==void 0&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=Pv(e),this}}]),t}(vs),Sh=function(i){function t(e,n,r){Vr(this,t);var o=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));o.__truncationSuspended=!1;var s=o,a=void 0;function l(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function h(p){var y=a-p.clientY;s.setValue(s.getValue()+y*s.__impliedStep),a=p.clientY}function u(){de.unbind(window,"mousemove",h),de.unbind(window,"mouseup",u),l()}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),de.bind(o.__input,"change",function(){var p=parseFloat(s.__input.value);Ne.isNaN(p)||s.setValue(p)}),de.bind(o.__input,"blur",function(){l()}),de.bind(o.__input,"mousedown",function(p){de.bind(window,"mousemove",h),de.bind(window,"mouseup",u),a=p.clientY}),de.bind(o.__input,"keydown",function(p){p.keyCode===13&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,l())}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return qo(t,i),Wr(t,[{key:"updateDisplay",value:function(){var e,n,r;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),n=this.__precision,r=Math.pow(10,n),Math.round(e*r)/r),Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Ov);function Nv(i,t,e,n,r){return n+(i-t)/(e-t)*(r-n)}var Fc=function(i){function t(e,n,r,o,s){Vr(this,t);var a=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:r,max:o,step:s})),l=a;function h(x){x.preventDefault();var E=l.__background.getBoundingClientRect();return l.setValue(Nv(x.clientX,E.left,E.right,l.__min,l.__max)),!1}function u(){de.unbind(window,"mousemove",h),de.unbind(window,"mouseup",u),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}function p(x){var E=x.touches[0].clientX,w=l.__background.getBoundingClientRect();l.setValue(Nv(E,w.left,w.right,l.__min,l.__max))}function y(){de.unbind(window,"touchmove",p),de.unbind(window,"touchend",y),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),de.bind(a.__background,"mousedown",function(x){document.activeElement.blur(),de.bind(window,"mousemove",h),de.bind(window,"mouseup",u),h(x)}),de.bind(a.__background,"touchstart",function(x){x.touches.length===1&&(de.bind(window,"touchmove",p),de.bind(window,"touchend",y),p(x))}),de.addClass(a.__background,"slider"),de.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return qo(t,i),Wr(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",Yo(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Ov),Lv=function(i){function t(e,n,r){Vr(this,t);var o=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),s=o;return o.__button=document.createElement("div"),o.__button.innerHTML=r===void 0?"Fire":r,de.bind(o.__button,"click",function(a){return a.preventDefault(),s.fire(),!1}),de.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return qo(t,i),Wr(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(vs),Bc=function(i){function t(e,n){Vr(this,t);var r=Jo(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.__color=new Wi(r.getValue()),r.__temp=new Wi(0);var o=r;r.domElement=document.createElement("div"),de.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",de.bind(r.__input,"keydown",function(C){C.keyCode===13&&y.call(this)}),de.bind(r.__input,"blur",y),de.bind(r.__selector,"mousedown",function(){de.addClass(this,"drag").bind(window,"mouseup",function(){de.removeClass(o.__selector,"drag")})}),de.bind(r.__selector,"touchstart",function(){de.addClass(this,"drag").bind(window,"touchend",function(){de.removeClass(o.__selector,"drag")})});var s,a=document.createElement("div");function l(C){E(C),de.bind(window,"mousemove",E),de.bind(window,"touchmove",E),de.bind(window,"mouseup",u),de.bind(window,"touchend",u)}function h(C){w(C),de.bind(window,"mousemove",w),de.bind(window,"touchmove",w),de.bind(window,"mouseup",p),de.bind(window,"touchend",p)}function u(){de.unbind(window,"mousemove",E),de.unbind(window,"touchmove",E),de.unbind(window,"mouseup",u),de.unbind(window,"touchend",u),x()}function p(){de.unbind(window,"mousemove",w),de.unbind(window,"touchmove",w),de.unbind(window,"mouseup",p),de.unbind(window,"touchend",p),x()}function y(){var C=Nc(this.value);C!==!1?(o.__color.__state=C,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function x(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function E(C){C.type.indexOf("touch")===-1&&C.preventDefault();var j=o.__saturation_field.getBoundingClientRect(),Z=C.touches&&C.touches[0]||C,rt=Z.clientX,ct=Z.clientY,nt=(rt-j.left)/(j.right-j.left),vt=1-(ct-j.top)/(j.bottom-j.top);return vt>1?vt=1:vt<0&&(vt=0),nt>1?nt=1:nt<0&&(nt=0),o.__color.v=vt,o.__color.s=nt,o.setValue(o.__color.toOriginal()),!1}function w(C){C.type.indexOf("touch")===-1&&C.preventDefault();var j=o.__hue_field.getBoundingClientRect(),Z=1-((C.touches&&C.touches[0]||C).clientY-j.top)/(j.bottom-j.top);return Z>1?Z=1:Z<0&&(Z=0),o.__color.h=360*Z,o.setValue(o.__color.toOriginal()),!1}return Ne.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Ne.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Ne.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Ne.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Ne.extend(a.style,{width:"100%",height:"100%",background:"none"}),Dv(a,"top","rgba(0,0,0,0)","#000"),Ne.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(s=r.__hue_field).style.background="",s.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",s.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Ne.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),de.bind(r.__saturation_field,"mousedown",l),de.bind(r.__saturation_field,"touchstart",l),de.bind(r.__field_knob,"mousedown",l),de.bind(r.__field_knob,"touchstart",l),de.bind(r.__hue_field,"mousedown",h),de.bind(r.__hue_field,"touchstart",h),r.__saturation_field.appendChild(a),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay(),r}return qo(t,i),Wr(t,[{key:"updateDisplay",value:function(){var e=Nc(this.getValue());if(e!==!1){var n=!1;Ne.each(Wi.COMPONENTS,function(s){if(!Ne.isUndefined(e[s])&&!Ne.isUndefined(this.__color.__state[s])&&e[s]!==this.__color.__state[s])return n=!0,{}},this),n&&Ne.extend(this.__color.__state,e)}Ne.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var r=this.__color.v<.5||this.__color.s>.5?255:0,o=255-r;Ne.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+r+","+r+","+r+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,Dv(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Ne.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+r+","+r+","+r+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),t}(vs),dw=["-moz-","-o-","-webkit-","-ms-",""];function Dv(i,t,e,n){i.style.background="",Ne.each(dw,function(r){i.style.cssText+="background: "+r+"linear-gradient("+t+", "+e+" 0%, "+n+" 100%); "})}var pw=function(i,t){var e=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=i;var r=e.getElementsByTagName("head")[0];try{r.appendChild(n)}catch{}},fw=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,mw=function(i,t){var e=i[t];return Ne.isArray(arguments[2])||Ne.isObject(arguments[2])?new uw(i,t,arguments[2]):Ne.isNumber(e)?Ne.isNumber(arguments[2])&&Ne.isNumber(arguments[3])?Ne.isNumber(arguments[4])?new Fc(i,t,arguments[2],arguments[3],arguments[4]):new Fc(i,t,arguments[2],arguments[3]):Ne.isNumber(arguments[4])?new Sh(i,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new Sh(i,t,{min:arguments[2],max:arguments[3]}):Ne.isString(e)?new cw(i,t):Ne.isFunction(e)?new Lv(i,t,""):Ne.isBoolean(e)?new Iv(i,t):null},gw=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(i){setTimeout(i,1e3/60)},vw=function(){function i(){Vr(this,i),this.backgroundElement=document.createElement("div"),Ne.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),de.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Ne.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;de.bind(this.backgroundElement,"click",function(){t.hide()})}return Wr(i,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Ne.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,e=function n(){t.domElement.style.display="none",t.backgroundElement.style.display="none",de.unbind(t.domElement,"webkitTransitionEnd",n),de.unbind(t.domElement,"transitionend",n),de.unbind(t.domElement,"oTransitionEnd",n)};de.bind(this.domElement,"webkitTransitionEnd",e),de.bind(this.domElement,"transitionend",e),de.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-de.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-de.getHeight(this.domElement)/2+"px"}}]),i}();pw(function(i){if(i&&typeof window!="undefined"){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=i,document.head.appendChild(t),i}}(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`));var Qa=function(){try{return!!window.localStorage}catch{return!1}}(),wh=void 0,Fv=!0,na=void 0,Uc=!1,Bv=[],li=function i(t){var e=this,n=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),de.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=Ne.defaults(n,{closeOnTop:!1,autoPlace:!0,width:i.DEFAULT_WIDTH}),n=Ne.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),Ne.isUndefined(n.load)?n.load={preset:"Default"}:n.preset&&(n.load.preset=n.preset),Ne.isUndefined(n.parent)&&n.hideable&&Bv.push(this),n.resizable=Ne.isUndefined(n.parent)&&n.resizable,n.autoPlace&&Ne.isUndefined(n.scrollable)&&(n.scrollable=!0);var r,o=Qa&&localStorage.getItem(ia(this,"isLocal"))==="true",s=void 0,a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return e.parent?e.getRoot().preset:n.load.preset},set:function(u){e.parent?e.getRoot().preset=u:n.load.preset=u,function(p){for(var y=0;y<p.__preset_select.length;y++)p.__preset_select[y].value===p.preset&&(p.__preset_select.selectedIndex=y)}(this),e.revert()}},width:{get:function(){return n.width},set:function(u){n.width=u,jc(e,u)}},name:{get:function(){return n.name},set:function(u){n.name=u,a&&(a.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(u){n.closed=u,n.closed?de.addClass(e.__ul,i.CLASS_CLOSED):de.removeClass(e.__ul,i.CLASS_CLOSED),this.onResize(),e.__closeButton&&(e.__closeButton.innerHTML=u?i.TEXT_OPEN:i.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return o},set:function(u){Qa&&(o=u,u?de.bind(window,"unload",s):de.unbind(window,"unload",s),localStorage.setItem(ia(e,"isLocal"),u))}}}),Ne.isUndefined(n.parent)){if(this.closed=n.closed||!1,de.addClass(this.domElement,i.CLASS_MAIN),de.makeSelectable(this.domElement,!1),Qa&&o){e.useLocalStorage=!0;var l=localStorage.getItem(ia(this,"gui"));l&&(n.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=i.TEXT_CLOSED,de.addClass(this.__closeButton,i.CLASS_CLOSE_BUTTON),n.closeOnTop?(de.addClass(this.__closeButton,i.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(de.addClass(this.__closeButton,i.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),de.bind(this.__closeButton,"click",function(){e.closed=!e.closed})}else{n.closed===void 0&&(n.closed=!0);var h=document.createTextNode(n.name);de.addClass(h,"controller-name"),a=kc(e,h),de.addClass(this.__ul,i.CLASS_CLOSED),de.addClass(a,"title"),de.bind(a,"click",function(u){return u.preventDefault(),e.closed=!e.closed,!1}),n.closed||(this.closed=!1)}n.autoPlace&&(Ne.isUndefined(n.parent)&&(Fv&&(na=document.createElement("div"),de.addClass(na,"dg"),de.addClass(na,i.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(na),Fv=!1),na.appendChild(this.domElement),de.addClass(this.domElement,i.CLASS_AUTO_PLACE)),this.parent||jc(e,n.width)),this.__resizeHandler=function(){e.onResizeDebounced()},de.bind(window,"resize",this.__resizeHandler),de.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),de.bind(this.__ul,"transitionend",this.__resizeHandler),de.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&yw(this),s=function(){Qa&&localStorage.getItem(ia(e,"isLocal"))==="true"&&localStorage.setItem(ia(e,"gui"),JSON.stringify(e.getSaveObject()))},this.saveToLocalStorageIfPossible=s,n.parent||((r=e.getRoot()).width+=1,Ne.defer(function(){r.width-=1}))};function kc(i,t,e){var n=document.createElement("li");return t&&n.appendChild(t),e?i.__ul.insertBefore(n,e):i.__ul.appendChild(n),i.onResize(),n}function Uv(i){de.unbind(window,"resize",i.__resizeHandler),i.saveToLocalStorageIfPossible&&de.unbind(window,"unload",i.saveToLocalStorageIfPossible)}function Gc(i,t){var e=i.__preset_select[i.__preset_select.selectedIndex];e.innerHTML=t?e.value+"*":e.value}function kv(i,t){var e=i.getRoot(),n=e.__rememberedObjects.indexOf(t.object);if(n!==-1){var r=e.__rememberedObjectIndecesToControllers[n];if(r===void 0&&(r={},e.__rememberedObjectIndecesToControllers[n]=r),r[t.property]=t,e.load&&e.load.remembered){var o=e.load.remembered,s=void 0;if(o[i.preset])s=o[i.preset];else{if(!o.Default)return;s=o.Default}if(s[n]&&s[n][t.property]!==void 0){var a=s[n][t.property];t.initialValue=a,t.setValue(a)}}}}function $a(i,t,e,n){if(t[e]===void 0)throw new Error('Object "'+t+'" has no property "'+e+'"');var r=void 0;if(n.color)r=new Bc(t,e);else{var o=[t,e].concat(n.factoryArgs);r=mw.apply(i,o)}n.before instanceof vs&&(n.before=n.before.__li),kv(i,r),de.addClass(r.domElement,"c");var s=document.createElement("span");de.addClass(s,"property-name"),s.innerHTML=r.property;var a=document.createElement("div");a.appendChild(s),a.appendChild(r.domElement);var l=kc(i,a,n.before);return de.addClass(l,li.CLASS_CONTROLLER_ROW),r instanceof Bc?de.addClass(l,"color"):de.addClass(l,lw(r.getValue())),function(h,u,p){if(p.__li=u,p.__gui=h,Ne.extend(p,{options:function(E){if(arguments.length>1){var w=p.__li.nextElementSibling;return p.remove(),$a(h,p.object,p.property,{before:w,factoryArgs:[Ne.toArray(arguments)]})}if(Ne.isArray(E)||Ne.isObject(E)){var C=p.__li.nextElementSibling;return p.remove(),$a(h,p.object,p.property,{before:C,factoryArgs:[E]})}},name:function(E){return p.__li.firstElementChild.firstElementChild.innerHTML=E,p},listen:function(){return p.__gui.listen(p),p},remove:function(){return p.__gui.remove(p),p}}),p instanceof Fc){var y=new Sh(p.object,p.property,{min:p.__min,max:p.__max,step:p.__step});Ne.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(E){var w=p[E],C=y[E];p[E]=y[E]=function(){var j=Array.prototype.slice.call(arguments);return C.apply(y,j),w.apply(p,j)}}),de.addClass(u,"has-slider"),p.domElement.insertBefore(y.domElement,p.domElement.firstElementChild)}else if(p instanceof Sh){var x=function(E){if(Ne.isNumber(p.__min)&&Ne.isNumber(p.__max)){var w=p.__li.firstElementChild.firstElementChild.innerHTML,C=p.__gui.__listening.indexOf(p)>-1;p.remove();var j=$a(h,p.object,p.property,{before:p.__li.nextElementSibling,factoryArgs:[p.__min,p.__max,p.__step]});return j.name(w),C&&j.listen(),j}return E};p.min=Ne.compose(x,p.min),p.max=Ne.compose(x,p.max)}else p instanceof Iv?(de.bind(u,"click",function(){de.fakeEvent(p.__checkbox,"click")}),de.bind(p.__checkbox,"click",function(E){E.stopPropagation()})):p instanceof Lv?(de.bind(u,"click",function(){de.fakeEvent(p.__button,"click")}),de.bind(u,"mouseover",function(){de.addClass(p.__button,"hover")}),de.bind(u,"mouseout",function(){de.removeClass(p.__button,"hover")})):p instanceof Bc&&(de.addClass(u,"color"),p.updateDisplay=Ne.compose(function(E){return u.style.borderLeftColor=p.__color.toString(),E},p.updateDisplay),p.updateDisplay());p.setValue=Ne.compose(function(E){return h.getRoot().__preset_select&&p.isModified()&&Gc(h.getRoot(),!0),E},p.setValue)}(i,l,r),i.__controllers.push(r),r}function ia(i,t){return document.location.href+"."+t}function Hc(i,t,e){var n=document.createElement("option");n.innerHTML=t,n.value=t,i.__preset_select.appendChild(n),e&&(i.__preset_select.selectedIndex=i.__preset_select.length-1)}function Gv(i,t){t.style.display=i.useLocalStorage?"block":"none"}function _w(i){var t=i.__save_row=document.createElement("li");de.addClass(i.domElement,"has-save"),i.__ul.insertBefore(t,i.__ul.firstChild),de.addClass(t,"save-row");var e=document.createElement("span");e.innerHTML="&nbsp;",de.addClass(e,"button gears");var n=document.createElement("span");n.innerHTML="Save",de.addClass(n,"button"),de.addClass(n,"save");var r=document.createElement("span");r.innerHTML="New",de.addClass(r,"button"),de.addClass(r,"save-as");var o=document.createElement("span");o.innerHTML="Revert",de.addClass(o,"button"),de.addClass(o,"revert");var s=i.__preset_select=document.createElement("select");if(i.load&&i.load.remembered?Ne.each(i.load.remembered,function(u,p){Hc(i,p,p===i.preset)}):Hc(i,"Default",!1),de.bind(s,"change",function(){for(var u=0;u<i.__preset_select.length;u++)i.__preset_select[u].innerHTML=i.__preset_select[u].value;i.preset=this.value}),t.appendChild(s),t.appendChild(e),t.appendChild(n),t.appendChild(r),t.appendChild(o),Qa){var a=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block",localStorage.getItem(ia(0,"isLocal"))==="true"&&l.setAttribute("checked","checked"),Gv(i,a),de.bind(l,"change",function(){i.useLocalStorage=!i.useLocalStorage,Gv(i,a)})}var h=document.getElementById("dg-new-constructor");de.bind(h,"keydown",function(u){!u.metaKey||u.which!==67&&u.keyCode!==67||wh.hide()}),de.bind(e,"click",function(){h.innerHTML=JSON.stringify(i.getSaveObject(),void 0,2),wh.show(),h.focus(),h.select()}),de.bind(n,"click",function(){i.save()}),de.bind(r,"click",function(){var u=prompt("Enter a new preset name.");u&&i.saveAs(u)}),de.bind(o,"click",function(){i.revert()})}function yw(i){var t=void 0;function e(o){return o.preventDefault(),i.width+=t-o.clientX,i.onResize(),t=o.clientX,!1}function n(){de.removeClass(i.__closeButton,li.CLASS_DRAG),de.unbind(window,"mousemove",e),de.unbind(window,"mouseup",n)}function r(o){return o.preventDefault(),t=o.clientX,de.addClass(i.__closeButton,li.CLASS_DRAG),de.bind(window,"mousemove",e),de.bind(window,"mouseup",n),!1}i.__resize_handle=document.createElement("div"),Ne.extend(i.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),de.bind(i.__resize_handle,"mousedown",r),de.bind(i.__closeButton,"mousedown",r),i.domElement.insertBefore(i.__resize_handle,i.domElement.firstElementChild)}function jc(i,t){i.domElement.style.width=t+"px",i.__save_row&&i.autoPlace&&(i.__save_row.style.width=t+"px"),i.__closeButton&&(i.__closeButton.style.width=t+"px")}function Ah(i,t){var e={};return Ne.each(i.__rememberedObjects,function(n,r){var o={},s=i.__rememberedObjectIndecesToControllers[r];Ne.each(s,function(a,l){o[l]=t?a.initialValue:a.getValue()}),e[r]=o}),e}li.toggleHide=function(){Uc=!Uc,Ne.each(Bv,function(i){i.domElement.style.display=Uc?"none":""})},li.CLASS_AUTO_PLACE="a",li.CLASS_AUTO_PLACE_CONTAINER="ac",li.CLASS_MAIN="main",li.CLASS_CONTROLLER_ROW="cr",li.CLASS_TOO_TALL="taller-than-window",li.CLASS_CLOSED="closed",li.CLASS_CLOSE_BUTTON="close-button",li.CLASS_CLOSE_TOP="close-top",li.CLASS_CLOSE_BOTTOM="close-bottom",li.CLASS_DRAG="drag",li.DEFAULT_WIDTH=245,li.TEXT_CLOSED="Close Controls",li.TEXT_OPEN="Open Controls",li._keydownHandler=function(i){document.activeElement.type==="text"||i.which!==72&&i.keyCode!==72||li.toggleHide()},de.bind(window,"keydown",li._keydownHandler,!1),Ne.extend(li.prototype,{add:function(i,t){return $a(this,i,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(i,t){return $a(this,i,t,{color:!0})},remove:function(i){this.__ul.removeChild(i.__li),this.__controllers.splice(this.__controllers.indexOf(i),1);var t=this;Ne.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&na.removeChild(this.domElement);var i=this;Ne.each(this.__folders,function(t){i.removeFolder(t)}),de.unbind(window,"keydown",li._keydownHandler,!1),Uv(this)},addFolder:function(i){if(this.__folders[i]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+i+'"');var t={name:i,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[i]&&(t.closed=this.load.folders[i].closed,t.load=this.load.folders[i]);var e=new li(t);this.__folders[i]=e;var n=kc(this,e.domElement);return de.addClass(n,"folder"),e},removeFolder:function(i){this.__ul.removeChild(i.domElement.parentElement),delete this.__folders[i.name],this.load&&this.load.folders&&this.load.folders[i.name]&&delete this.load.folders[i.name],Uv(i);var t=this;Ne.each(i.__folders,function(e){i.removeFolder(e)}),Ne.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var i=this.getRoot();if(i.scrollable){var t=de.getOffset(i.__ul).top,e=0;Ne.each(i.__ul.childNodes,function(n){i.autoPlace&&n===i.__save_row||(e+=de.getHeight(n))}),window.innerHeight-t-20<e?(de.addClass(i.domElement,li.CLASS_TOO_TALL),i.__ul.style.height=window.innerHeight-t-20+"px"):(de.removeClass(i.domElement,li.CLASS_TOO_TALL),i.__ul.style.height="auto")}i.__resize_handle&&Ne.defer(function(){i.__resize_handle.style.height=i.__ul.offsetHeight+"px"}),i.__closeButton&&(i.__closeButton.style.width=i.width+"px")},onResizeDebounced:Ne.debounce(function(){this.onResize()},50),remember:function(){if(Ne.isUndefined(wh)&&((wh=new vw).domElement.innerHTML=fw),this.parent)throw new Error("You can only call remember on a top level GUI.");var i=this;Ne.each(Array.prototype.slice.call(arguments),function(t){i.__rememberedObjects.length===0&&_w(i),i.__rememberedObjects.indexOf(t)===-1&&i.__rememberedObjects.push(t)}),this.autoPlace&&jc(this,this.width)},getRoot:function(){for(var i=this;i.parent;)i=i.parent;return i},getSaveObject:function(){var i=this.load;return i.closed=this.closed,this.__rememberedObjects.length>0&&(i.preset=this.preset,i.remembered||(i.remembered={}),i.remembered[this.preset]=Ah(this)),i.folders={},Ne.each(this.__folders,function(t,e){i.folders[e]=t.getSaveObject()}),i},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=Ah(this),Gc(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(i){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=Ah(this,!0)),this.load.remembered[i]=Ah(this),this.preset=i,Hc(this,i,!0),this.saveToLocalStorageIfPossible()},revert:function(i){Ne.each(this.__controllers,function(t){this.getRoot().load.remembered?kv(i||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),Ne.each(this.__folders,function(t){t.revert(t)}),i||Gc(this.getRoot(),!1)},listen:function(i){var t=this.__listening.length===0;this.__listening.push(i),t&&function e(n){n.length!==0&&gw.call(window,function(){e(n)}),Ne.each(n,function(r){r.updateDisplay()})}(this.__listening)},updateDisplay:function(){Ne.each(this.__controllers,function(i){i.updateDisplay()}),Ne.each(this.__folders,function(i){i.updateDisplay()})}});var xw=li,bw=function(){function i(t){this.player=t}return Object.defineProperty(i.prototype,"frameRate",{get:function(){return this.player.fps.value},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"drawFrames",{get:function(){return this.player.runtime.fps},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"drawCall",{get:function(){return this.player.runtime.drawCall},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"resolution",{get:function(){return this.player.config.resolution},set:function(t){this.player.updateConfig({resolution:t})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){var t,e;return((t=this.player.view)===null||t===void 0?void 0:t.width)+"*"+((e=this.player.view)===null||e===void 0?void 0:e.height)},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"minFPS",{get:function(){return this.player.config.minFPS},set:function(t){this.player.updateConfig({minFPS:t,maxFPS:this.player.config.maxFPS})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"maxFPS",{get:function(){return this.player.config.maxFPS},set:function(t){this.player.updateConfig({maxFPS:t,minFPS:this.player.config.minFPS})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoResolution",{get:function(){return this.player.config.autoResolution},set:function(t){this.player.updateConfig({autoResolution:t})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoFPS",{get:function(){return this.player.config.autoFPS},set:function(t){this.player.updateConfig({autoFPS:t})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"backgroundColor",{get:function(){return this.player.config.transactionBgColor},set:function(t){this.player.updateConfig({transactionBgColor:t})},enumerable:!1,configurable:!0}),i}(),Tw=function(){function i(t,e){var n;this.config=new bw(t),this.anchor=e,n=this.createControllerGUI(),this.gui=n[0],this.controller=n[1],this.createStats()}return i.prototype.createStats=function(){var t=this;this.stateId=setInterval(function(){t.controller.frameRate.updateDisplay(),t.controller.size.updateDisplay(),t.controller.minFPS.updateDisplay(),t.controller.drawFrames.updateDisplay(),t.controller.maxFPS.updateDisplay(),t.controller.resolution.updateDisplay(),t.controller.autoFps.updateDisplay(),t.controller.autoResolution.updateDisplay(),t.controller.drawCall.updateDisplay()},16)},i.prototype.createControllerGUI=function(){var t=new xw({autoPlace:!0,closed:!0});t.domElement.style.opacity=".6",t.domElement.style.transformOrigin="100% 0",t.domElement.style.transform="scale(1)",this.anchor.appendChild(t.domElement),t.domElement.style.position="absolute",t.domElement.style.right="0",t.domElement.style.top="0",t.domElement.style.zIndex="2";var e={frameRate:t.add(this.config,"frameRate"),drawFrames:t.add(this.config,"drawFrames"),drawCall:t.add(this.config,"drawCall"),size:t.add(this.config,"size"),minFPS:t.add(this.config,"minFPS",0,60),maxFPS:t.add(this.config,"maxFPS",0,60),resolution:t.add(this.config,"resolution",.5,8,.5),autoResolution:t.add(this.config,"autoResolution"),autoFps:t.add(this.config,"autoFPS"),transactionBgColor:t.addColor(this.config,"backgroundColor")};return[t,e]},i.prototype.destroy=function(){try{window.clearInterval(this.stateId),this.anchor.removeChild(this.gui.domElement),this.gui.destroy()}catch{}},i}(),Ew=function(){function i(t){var e=this;this.tasks=[],this.isDestroy=!1,this.isScheduling=!1,this.schedule=function(){e.isScheduling=!0;var n=e.tasks.shift();n&&!e.isDestroy&&e.fn(n).then(function(){e.tasks.length>0?window.requestAnimationFrame(e.schedule):e.isScheduling=!1})},this.fn=t}return i.prototype.destroy=function(){this.isDestroy=!0},i.prototype.addTask=function(t){this.tasks.push(t),this.isScheduling||this.schedule()},i}(),Sw=function(){function i(t){this.autoUnlock=Object.create(null),this.locks=Object.create(null),this.available=!1,this.available=t}return i.prototype.addLock=function(t,e){var n=this;this.available&&(this.locks[t]=e,this.autoUnlock[t]=window.setTimeout(function(){delete n.locks[t]},3e3))},i.prototype.unlock=function(t,e){this.available&&e&&this.locks[t]&&this.locks[t]===e&&(window.clearTimeout(this.autoUnlock[t]),delete this.locks[t])},i.prototype.isLocked=function(t){return!!this.available&&!!this.locks[t]},i}(),ww=function(){function i(){var t=this;this.tasks=[],this.isDestroy=!1,this.isScheduling=!1,this.schedule=function(){t.isScheduling=!0;var e=t.tasks.shift();e&&!t.isDestroy&&(e.status="running",e.fn.apply(null).then(function(){t.tasks.length>0?window.requestAnimationFrame(t.schedule):t.isScheduling=!1}).catch(function(){t.tasks.length>0?window.requestAnimationFrame(t.schedule):t.isScheduling=!1}))}}return i.prototype.getRunningTask=function(){return this.tasks[0]&&this.tasks[0].status==="running"?this.tasks[0]:null},i.prototype.addTask=function(t,e){var n={type:t,status:"wait",fn:e},r=this.getRunningTask();r&&t===r.type||(this.tasks=this.tasks.filter(function(o){return o.type!==t}),this.tasks.push(n),this.isScheduling||this.schedule())},i.prototype.destroy=function(){this.isDestroy=!0},i}(),zc=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},Vc=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}},Aw=function(){function i(){var t=this;this.logList=[],this.checkTimer=null,this.retryTimes=0,this.enable=!1,this.uploadLoggerGlobalEvent=function(e){e.data.type==="@slide/_upload_log_"&&t.start()},this.config={checkTime:3e3,buffer:300},window.addEventListener("message",this.uploadLoggerGlobalEvent),this.start()}return i.prototype.start=function(){return zc(this,void 0,void 0,function(){var t=this;return Vc(this,function(e){return clearInterval(this.checkTimer),this.checkTimer=setInterval(function(){return zc(t,void 0,void 0,function(){return Vc(this,function(n){switch(n.label){case 0:return[4,this.uploadLog()];case 1:return n.sent(),[2]}})})},this.config.checkTime),[2]})})},i.prototype.pause=function(){clearInterval(this.checkTimer)},i.prototype.addLog=function(t,e,n,r){this.logList.push({level:e,taskId:n,message:t,randomId:r})},i.prototype.destroy=function(){clearInterval(this.checkTimer),window.removeEventListener("message",this.uploadLoggerGlobalEvent)},i.prototype.uploadLog=function(t){return t===void 0&&(t=!1),zc(this,void 0,void 0,function(){var e,n,r,o=this;return Vc(this,function(s){switch(s.label){case 0:if(!(this.logList.length>=this.config.buffer||t))return[2];e=this.logList.splice(0),n=function(){o.logList=e.concat(o.logList),o.retryTimes>3&&o.pause(),o.retryTimes+=1},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch("https://netless-ppt-plugin-dev.cn-hangzhou.log.aliyuncs.com/logstores/netless-ppt-plugin-dev/track",{method:"POST",headers:{"x-log-apiversion":"0.6.0","Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify({__topic__:"netless-ppt-plugin-dev",__source__:"netless-ppt-plugin-dev",__logs__:e})})];case 2:return s.sent().ok?this.retryTimes=0:n(),[3,4];case 3:return r=s.sent(),console.warn(r),n(),[3,4];case 4:return[2]}})})},i.prototype.setEnable=function(t){this.enable!==t&&(t?this.start():this.pause())},i}(),Mw=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},Cw=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}};function Rw(i,t,e){return Mw(this,void 0,void 0,function(){var n,r,o,s;return Cw(this,function(a){switch(a.label){case 0:return n=document.createElement("div"),(r=new io({anchor:n,renderOptions:{minFPS:1,maxFPS:1,resolution:1},mode:"local",interactive:!1,useLocalCache:!0})).setResource(i,t),[4,r.getSlideCountAsync()];case 1:o=a.sent(),s=1,a.label=2;case 2:return s<=o?[4,r.player.stagePool.preload(s,!0)]:[3,5];case 3:a.sent(),e(Math.round(s/o*100)/100),a.label=4;case 4:return s++,[3,2];case 5:return r.destroy(),[2]}})})}var Iw=function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])})(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),_s=function(){return(_s=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++)for(var r in t=arguments[e])Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r]);return i}).apply(this,arguments)},Pw=function(i,t,e,n){var r,o=arguments.length,s=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var a=i.length-1;a>=0;a--)(r=i[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Ji=function(i,t,e,n){return new(e||(e=Promise))(function(r,o){function s(h){try{l(n.next(h))}catch(u){o(u)}}function a(h){try{l(n.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(p){p(u)})).then(s,a)}l((n=n.apply(i,t||[])).next())})},Ki=function(i,t){var e,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(h){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(u[0]===6&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(i,s)}catch(p){u=[6,p],n=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,h])}}},Ow=window.ResizeObserver||nw,Mh=function(i){return new Promise(function(t){return setTimeout(t,i)})};function Nw(i,t){return Ji(this,void 0,void 0,function(){var e;return Ki(this,function(n){switch(n.label){case 0:e=Date.now(),n.label=1;case 1:return!i()&&Date.now()-e<t?[4,Mh(50)]:[3,3];case 2:return n.sent(),e=Date.now(),[3,1];case 3:return[2]}})})}var hr={syncDispatch:"syncDispatch",syncReceive:"syncReceive",syncEventLag:"syncEventLag",renderStart:"renderStart",renderEnd:"renderEnd",renderError:"renderError",slideChange:"slideChange",mainSeqStepStart:"mainSeqStepStart",mainSeqStepEnd:"mainSeqStepEnd",animateStart:"animateStart",animateEnd:"animateEnd",stateChange:"stateChange",slideStepEnd:"slideEnd",slideStepStart:"slideStart"},Hv={taskId:"",url:"",currentSlideIndex:-1,mainSeqStep:-1,mainSeqState:null,mediaState:Object.create(null),interactiveSeqState:Object.create(null)},Wc="";try{Wc="1.2.1"}catch{Wc="dev -"}var pr=null;try{(pr=I.createInstance({name:"__slide_local_log__",driver:I.INDEXEDDB,version:1})).ready(function(i){}).catch(function(i){})}catch{}var io=function(i){function t(r){var o=i.call(this)||this;return o.iosResetCache=[],o.needClearCacheImage=!1,o.version=Wc,o.__slideState=cv()(Hv),o.userInputTime=0,o.isSyncingSlideState=!1,o.frozenTaskManager=new ww,o.randomId=M(),o.resize=!1,o.isAnimating=!1,o.renderingTaskManager=new sw,o.isLoading=!1,o.interactive=!0,o.renderingIndex=0,o.frameWidth=1,o.frameHeight=1,o.frame=document.createElement("div"),o.canvasContainer=document.createElement("div"),o.medianController=document.createElement("div"),o.frameResizeObserver=new Ow(function(){return o.frameResizeHandler()}),o.timestamp=function(){return Date.now()},o.mode="local",o.enableGlobalClick=!1,o.lastEmitedState=null,o.playerController=null,o.isInitResized=!1,o.cacheImage=document.createElement("img"),o.isTouchStart=!1,o.touchStartId=void 0,o.taskId="",o.volumeAdjuster=new lv,o.designWidth=0,o.designHeight=0,o._slideCount=0,o._dispatchIncrId=0,o._receiveIncrId=0,o._updateVolumeByStaticAdjuster=function(s){o.volumeAdjuster.volume=s},o.recoverHandler=function(s){if(s.data.type==="@slide/_recover_"&&s.data.slideId===o.randomId){var a=s.data,l=a.recoverBy,h=a.payload;if(!h)return;l==="renderOtherPage"&&h.slideIndex?o.doRenderSlide(h.slideIndex).catch(function(u){o.logger.error(u,o.taskId)}):l==="reloadCurrentPage"&&o.doRenderSlide(o.renderingIndex).catch(function(u){o.logger.error(u,o.taskId)})}},o.userInputHandle=function(){o.userInputTime=Date.now()},o.handleViewClick=function(){setTimeout(function(){var s=Date.now();Math.abs(s-o.userInputTime)>500&&o.enableGlobalClick&&o.nextStep()})},o.handleViewTouchStart=function(){window.clearTimeout(o.touchStartId),o.isTouchStart=!0,o.touchStartId=setTimeout(function(){o.isTouchStart=!1},350)},o.handleViewTouchEnd=function(){o.isTouchStart&&(o.isTouchStart=!1,o.handleViewClick())},o.handleSlideRef=function(){console.log(o),window.__slide=o},o.receiveSyncHandler=function(s){return Ji(o,void 0,void 0,function(){var a,l,h,u,p,y=this;return Ki(this,function(x){switch(x.label){case 0:return zo()(s.incrId)&&(s.incrId&&s.incrId-this._receiveIncrId!=1&&this.emit(hr.syncEventLag),this._receiveIncrId=s.incrId||0),this.logger.info("sync receive "+JSON.stringify(s),this.taskId),s.type!=="nextStep"?[3,1]:(this.mainSeqStep!==s.next-1&&this.mainSeqStep+1!==this.mainSeqLength&&this.player?(this.setMainSeqStep(s.next,"start"),this.player.nextTick(function(){y.doNextStep(!0,s.clientId||"")})):this.doNextStep(!0,s.clientId||""),[3,6]);case 1:return s.type!=="prevStep"?[3,2]:(this.mainSeqStep===0&&this.mainSeqState==="idle"||this.mainSeqStep===s.next+1||this.mainSeqStep+1===this.mainSeqLength?this.doPrevStep(!0):(this.setMainSeqStep(s.next+1,"start"),(a=this.player)===null||a===void 0||a.nextTick(function(){y.doPrevStep(!0)})),[3,6]);case 2:return s.type!=="interactiveAnim"?[3,3]:(this.player?this.player.applyInteractiveAction(s.action):this.__slideState.interactiveSeqState[s.seqId]?this.__slideState.interactiveSeqState[s.seqId].step+=1:this.__slideState.interactiveSeqState[s.seqId]={step:0,state:"end"},[3,6]);case 3:return s.type!=="renderSlide"?[3,5]:[4,this.doRenderSlide(s.index,s.isForward)];case 4:return x.sent(),[3,6];case 5:s.type==="mediaPlay"?((l=this.player)===null||l===void 0||l.setMediaState(s.id,!0),this.__slideState.mediaState[s.id]=s.state):s.type==="mediaPause"?((h=this.player)===null||h===void 0||h.setMediaState(s.id,!1),this.__slideState.mediaState[s.id]=s.state):s.type==="mediaSeek"?((u=this.player)===null||u===void 0||u.setMediaCurrentTime(s.id,s.time),this.__slideState.mediaState[s.id]=s.state):s.type==="mediaFullscreen"&&(s.targetId&&this.__slideState.mediaState[s.targetId]?this.__slideState.mediaState[s.targetId].fullscreen=s.state:this.__slideState.mediaState[s.targetId]={fullscreen:s.state,type:"pause",time:0},(p=this.player)===null||p===void 0||p.syncFullscreenVideoState({targetId:s.targetId,state:s.state,slideIndex:s.slideIndex})),x.label=6;case 6:return[2]}})})},o.handlePrevSlide=function(s){return s===void 0&&(s=!1),Ji(o,void 0,void 0,function(){var a,l;return Ki(this,function(h){return this.player?((a=this.player.prevSlideIndex)>=1&&(!((l=this.config.navigatorDelegate)===null||l===void 0)&&l.gotoPage?this.config.navigatorDelegate.gotoPage(a):s?this.doRenderSlide(a,!1):this.renderSlide(a,!1)),[2]):[2]})})},o.handleNextSlide=function(s){return s===void 0&&(s=!1),Ji(o,void 0,void 0,function(){var a,l;return Ki(this,function(h){return this.player?((a=this.player.nextSlideIndex)<=this.slideCount&&(!((l=this.config.navigatorDelegate)===null||l===void 0)&&l.gotoPage?this.config.navigatorDelegate.gotoPage(a):s?this.doRenderSlide(a,!0):this.renderSlide(a,!0)),[2]):[2]})})},o.handleGotoSlide=function(s){if(s<=o.slideCount&&s>=1){var a=o.slideState.currentSlideIndex<=s;o.renderSlide(s,a)}else s===-1&&o.renderSlide(o.slideCount,!0)},t.instances.push(o),o.config=o.initSlideConfig(r),o.tracker=function(s){r.whiteTracker&&r.whiteTracker.commit({name:s.name,reason:s.reason,result:s.result,payload:_s(_s({},s.payload),{slideId:o.randomId,taskId:o.taskId})},{slideVersion:o.version||""})},t.trackLogger.setEnable(!!o.config.enableTracking),o.logger={info:function(s,a){var l;t.appendLogString("INFO - "+new Date().toISOString()+" - {"+o.randomId+"}["+a+"] "+s+`
`),t.trackLogger.addLog(s,"info",a,o.randomId);var h=(l=o.config.logger)===null||l===void 0?void 0:l.info;h&&h("["+a+"] "+s)},warn:function(s,a){var l;t.appendLogString("WARN - "+new Date().toISOString()+" - {"+o.randomId+"}["+a+"] "+s+`
`),t.trackLogger.addLog(s,"warn",a,o.randomId);var h=(l=o.config.logger)===null||l===void 0?void 0:l.warn;h&&h("["+a+"] "+s)},error:function(s,a){var l;t.appendLogString("ERROR - "+new Date().toISOString()+" - {"+o.randomId+"}["+a+"] "+s+`
`),t.trackLogger.addLog(s,"error",a,o.randomId);var h=(l=o.config.logger)===null||l===void 0?void 0:l.error;h&&h("["+a+"] "+s)}},o.logger.info("new slide with clientId: "+o.config.clientId+", version: "+o.version,o.taskId),o.tracker({name:"initSlide",result:"",reason:"",payload:{taskId:o.taskId}}),o.anchor=o.config.anchor,o.syncQueue=new Ew(o.receiveSyncHandler),o.lock=new Sw(o.mode==="interactive"),o.cacheImage.style.position="absolute",o.cacheImage.style.zIndex="100",o.setMedianControllerAttribute(),o.canvasContainer.style.position="relative",o.canvasContainer.style.fontSize="0",o.canvasContainer.appendChild(o.medianController),o.frame.appendChild(o.canvasContainer),o.frameResizeObserver.observe(o.frame),o.on(hr.syncReceive,function(s){o.lock.unlock(s.type,s.uuid),o.syncQueue.addTask(s)}),o.renderingTaskManager.eventHub.on("task-error",function(s){var a=s.error,l=s.task,h=Ai.transform(a);h.errorType===nr.RuntimeWarn?o.logger.warn(h.message,o.taskId):o.logger.error(h.message,o.taskId),o.isLoading=!1,o.reportError(h,l.slideIndex)}),window.addEventListener("__slide_ref__",o.handleSlideRef),o.resizeView=uv()(o.resizeView.bind(o),50),o.player=o.initPlayer(o.config),o.config.controller&&o.createController(),o.player.view&&o.canvasContainer.appendChild(o.player.view),o.handleViewClick=uv()(o.handleViewClick,300),o.player.errorChannel.on("error",function(s,a){var l=Ai.transform(s);l.errorType===nr.RuntimeWarn?o.logger.warn(l.message,o.taskId):o.logger.error(l.message,o.taskId),o.isLoading=!1,o.reportError(s,a),o.tracker({name:"slideError",reason:l.errorMsg,result:"",payload:{code:l.errorType}})}),window.addEventListener("message",o.recoverHandler),t.volumeAdjuster.on("update",o._updateVolumeByStaticAdjuster),o.volumeAdjuster.volume=t.volumeAdjuster.volume,o}var e,n;return Iw(t,i),t.flushLog=function(r){return r===void 0&&(r=!1),Ji(this,void 0,void 0,function(){return Ki(this,function(o){switch(o.label){case 0:if(!(t._tempLog.length>131072||r&&t._tempLog.length>0))return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,pr==null?void 0:pr.setItem("run_time_log_"+t._tempLogIndex,t._tempLog)];case 2:return o.sent(),[3,4];case 3:return o.sent(),[3,4];case 4:t._tempLog="",t._tempLogIndex+=1,o.label=5;case 5:return[2]}})})},t.stopRemoteLog=function(){t.remoteLogAddress=null},t.startRemoteLog=function(r){return Ji(this,void 0,void 0,function(){var o,s,a,l,h;return Ki(this,function(u){switch(u.label){case 0:return t.remoteLogAddress=r,[4,t.flushLog(!0)];case 1:if(u.sent(),!pr)return[3,13];o=[],u.label=2;case 2:return u.trys.push([2,4,,5]),[4,pr.keys()];case 3:return o=(u.sent()||[]).sort(function(p,y){return parseInt(p.replace("run_time_log_",""))-parseInt(y.replace("run_time_log_",""))}),[3,5];case 4:return u.sent(),[3,5];case 5:s=0,a=o,u.label=6;case 6:if(!(s<a.length))return[3,13];l=a[s],l.replace("run_time_log_",""),h="",u.label=7;case 7:return u.trys.push([7,9,,10]),[4,pr.getItem(l)];case 8:return h=u.sent()||"",[3,10];case 9:return u.sent(),[3,10];case 10:return[4,fetch(t.remoteLogAddress+"/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({log:h})})];case 11:u.sent(),u.label=12;case 12:return s++,[3,6];case 13:return[2]}})})},t.appendLogString=function(r){t._tempLog+=r,t.remoteLogAddress&&fetch(t.remoteLogAddress+"/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({log:r})}).catch(function(){})},Object.defineProperty(t.prototype,"dispatchIncrId",{get:function(){return this._dispatchIncrId++},enumerable:!1,configurable:!0}),t.prototype.reportError=function(r,o){this.emit(hr.renderError,{error:r,index:o}),window.postMessage({type:"@slide/_error_",errorType:r.errorType,errorMsg:r.errorMsg,slideId:this.randomId,slideIndex:o,customMessage:"@slide/_error_"},"*"),t.trackLogger.uploadLog(!0)},t.prototype.initSlideConfig=function(r){return r.timestamp&&(this.timestamp=r.timestamp),r.rtcAudio&&(lr.RtcAudioClazz=r.rtcAudio),this.mode=r.mode,this.anchor=r.anchor,this.anchor.appendChild(this.frame),this.enableGlobalClick=!ji()(r.enableGlobalClick)&&r.enableGlobalClick,this.resize=r.resize||!1,this.interactive=r.interactive,this.frame.style.cssText=r.fixedFrameSize?"width:"+r.fixedFrameSize.width+"px;height:"+r.fixedFrameSize.height+"px;":"width:100%;height:100%",this.frame.style.cssText+="display:flex;justify-content:center;align-items:center;visibility:hidden;position:relative;z-index:1;",r.fixedFrameSize&&(this.frameWidth=r.fixedFrameSize.width,this.frameHeight=r.fixedFrameSize.height),r},t.prototype.initPlayer=function(r){var o,s,a,l=this,h=new lr({mode:this.mode,useLocalCache:!!ji()(this.config.useLocalCache)||this.config.useLocalCache,logger:this.logger,resourceTimeout:ji()(this.config.resourceTimeout)?15e3:this.config.resourceTimeout,loadDelegate:this.config.loaderDelegate,volumeAdjuster:this.volumeAdjuster,urlInterrupter:this.config.urlInterrupter,tracker:this.tracker},r.renderOptions);return h.setInteractive(this.interactive),h.updateConfig(r.renderOptions||{}),h.on(Ke.renderStart,function(u){l.isLoading=!0,l.emit(hr.renderStart,u),window.postMessage({type:"@slide/_render_start_",taskId:l.taskId,index:u},"*")}),h.on(Ke.renderEnd,function(u){l.isLoading=!1,l.player&&(l.designHeight=l.player.designHeight,l.designWidth=l.player.designWidth,l.cacheImage.style.width=l.player.designWidth+"px",l.cacheImage.style.height=l.player.designHeight+"px",l._slideCount=l.player.slideCount),l.emit(hr.renderEnd,u),window.postMessage({type:"@slide/_render_end_",taskId:l.taskId,index:u},"*")}),h.on(Ke.slideChange,function(u){l.__slideState.currentSlideIndex=u,l.emitStateChange(),l.emit(hr.slideChange,u)}),h.on(Ke.mainSeqStateChange,function(u){l.__slideState.mainSeqState=u,l.emitStateChange()}),h.on(Ke.mainSeqStepChange,function(u){l.__slideState.mainSeqStep=u,l.emitStateChange()}),h.on(Ke.interactiveSeqStateChange,function(u){var p=u.id,y=u.state;l.__slideState.interactiveSeqState[p]=y,l.emitStateChange()}),h.on(Ke.animateStart,function(){l.isAnimating!==!0&&(l.isAnimating=!0,l.emit(hr.animateStart))}),h.on(Ke.animateEnd,function(){l.isAnimating!==!1&&(l.isAnimating=!1,l.emit(hr.animateEnd))}),h.on(Ke.interactiveSeqAction,function(u){var p=u.action,y=u.seqId;l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"interactiveAnim",action:p,seqId:y}),l.emitStateChange()}),h.on(Ke.mainSeqStepStart,function(u){l.emit(hr.mainSeqStepStart,u)}),h.on(Ke.mainSeqStepEnd,function(u){l.emit(hr.mainSeqStepEnd,u)}),h.on(Ke.mediaPlay,function(u){var p,y=(p=l.__slideState.mediaState[u.id])!==null&&p!==void 0?p:{};y.type="play",y.time=l.timestamp()-1e3*u.time,l.__slideState.mediaState[u.id]=y,u._stateOnly?l.config.mode==="interactive"&&l.receiveSyncHandler({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPlay",id:u.id,state:y}).catch(function(x){l.logger.error(x==null?void 0:x.message,l.taskId)}):l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPlay",id:u.id,state:y}),l.emitStateChange()}),h.on(Ke.mediaStop,function(u){delete l.__slideState.mediaState[u.id],l.emitStateChange()}),h.on(Ke.mediaPause,function(u){var p,y=(p=l.__slideState.mediaState[u.id])!==null&&p!==void 0?p:{};y.type="pause",y.time=u.time,l.__slideState.mediaState[u.id]=y,u._stateOnly?l.config.mode==="interactive"&&l.receiveSyncHandler({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPause",id:u.id,state:y}).catch(function(x){l.logger.error(x==null?void 0:x.message,l.taskId)}):l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaPause",id:u.id,state:y}),l.emitStateChange()}),h.on(Ke.mediaSeek,function(u){var p,y=(p=l.__slideState.mediaState[u.id])!==null&&p!==void 0?p:{};u.isPlaying?(y.type="play",y.time=l.timestamp()-1e3*u.time):(y.type="pause",y.time=u.time),l.__slideState.mediaState[u.id]=y,l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaSeek",id:u.id,time:u.time,state:y}),l.emitStateChange()}),h.on(Ke.requestPrevSlide,function(u){l.handlePrevSlide(u)}),h.on(Ke.requestNextSlide,function(u){l.handleNextSlide(u)}),h.on(Ke.requestGotoSlide,function(u){var p;!((p=l.config.navigatorDelegate)===null||p===void 0)&&p.gotoPage?l.config.navigatorDelegate.gotoPage(u):l.handleGotoSlide(u)}),h.on(Ke.requestOpenUrl,function(u){var p;console.log(l.config.navigatorDelegate),!((p=l.config.navigatorDelegate)===null||p===void 0)&&p.openUrl&&l.config.navigatorDelegate.openUrl(u)}),h.on(Ke.fullscreenChange,function(u){var p,y=u.targetId,x=u.state;l.emitSyncDispatch({slideIndex:l.__slideState.currentSlideIndex,type:"mediaFullscreen",targetId:y,state:x});var E=(p=l.__slideState.mediaState[y])!==null&&p!==void 0?p:{};E.fullscreen=x,l.__slideState.mediaState[y]=E,l.emitStateChange()}),h.on(Ke.changeLocalFullscreenState,function(u){u.slideIndex===l.__slideState.currentSlideIndex?(u.targetId&&l.__slideState.mediaState[u.targetId]&&(l.__slideState.mediaState[u.targetId].fullscreen=u.status),l.emitStateChange()):l.logger.info("event slideIndex: "+u.slideIndex+", current slideIndex: "+l.__slideState.currentSlideIndex,l.taskId)}),(o=h.view)===null||o===void 0||o.addEventListener("touchend",this.handleViewTouchEnd),(s=h.view)===null||s===void 0||s.addEventListener("touchstart",this.handleViewTouchStart),(a=h.view)===null||a===void 0||a.addEventListener("click",this.handleViewClick),h.on(Ke.userInput,this.userInputHandle),h},t.prototype.createController=function(){this.player&&(this.playerController=new Tw(this.player,this.frame))},t.prototype.setMedianControllerAttribute=function(){this.medianController.className="median-container",this.medianController.style.position="absolute",this.medianController.style.left="0",this.medianController.style.top="0",this.medianController.style.zIndex="2",this.medianController.style.fontSize="16px"},t.prototype.frameResizeHandler=function(){if(!this.config.fixedFrameSize){var r=this.frame.getBoundingClientRect(),o=r.width,s=r.height;this.frameWidth=o,this.frameHeight=s,this.resizeView()}},t.prototype.updateFixedFrameSize=function(r,o,s){this.config.fixedFrameSize&&(this.frameWidth=r,this.frameHeight=o,this.frame.style.width=r+"px",this.frame.style.height=o+"px",this.resizeView(s))},t.prototype.resizeView=function(r){var o,s,a=this,l=this.width,h=this.height;if(l>0&&h>0){var u=this.frameWidth/l,p=u*h;p>this.frameHeight&&(u*=this.frameHeight/p),(o=this.player)===null||o===void 0||o.scaleView(u,this.resize,r),this.cacheImage.style.transform="scale("+u+")",this.medianController.style.transform="scale("+u+")",this.medianController.setAttribute("data-scale",u.toString()),this.isInitResized||(this.isInitResized=!0,(s=this.player)===null||s===void 0||s.clock.setTimeout(function(){a.frame.style.visibility="visible"},32))}},t.prototype.setSlideState=function(r){var o,s,a;return Ji(this,void 0,void 0,function(){var l,h=this;return Ki(this,function(u){switch(u.label){case 0:return this.isSyncingSlideState=!0,this.logger.info("stateChange receive "+JSON.stringify(r),this.taskId),r.taskId&&r.taskId!==this.__slideState.taskId&&(this.__slideState.taskId=r.taskId,(o=this.player)===null||o===void 0||o.setResourceData(r.taskId,this.__slideState.url)),r.url&&r.url!==this.__slideState.url&&(this.__slideState.url=r.url,(s=this.player)===null||s===void 0||s.setResourceData(this.__slideState.taskId,r.url)),Number.isInteger(r.currentSlideIndex)&&r.currentSlideIndex!==this.__slideState.currentSlideIndex?(this.__slideState.currentSlideIndex=r.currentSlideIndex,[4,this.doRenderSlide(r.currentSlideIndex)]):[3,2];case 1:u.sent(),u.label=2;case 2:return[4,(a=this.player)===null||a===void 0?void 0:a.clock.waitUntil(function(){var p,y;return((p=h.player)===null||p===void 0?void 0:p.currentIndex)===r.currentSlideIndex&&((y=h.player)===null||y===void 0?void 0:y.currentStage)},3e3)];case 3:return u.sent(),l=!1,Number.isInteger(r.mainSeqStep)&&r.mainSeqStep!==this.__slideState.mainSeqStep&&(l=!0,this.__slideState.mainSeqStep=r.mainSeqStep),r.mainSeqState&&r.mainSeqState!==this.__slideState.mainSeqState&&(l=!0,this.__slideState.mainSeqState=r.mainSeqState),l&&this.setMainSeqStep(this.__slideState.mainSeqStep,this.__slideState.mainSeqState==="idle"?"start":"end"),r.interactiveSeqState&&(this.initInteractiveSeq(r),this.__slideState.interactiveSeqState=r.interactiveSeqState),[4,Mh(1500)];case 4:return u.sent(),r.mediaState&&(this.initMedia(r),this.__slideState.mediaState=r.mediaState),this.isSyncingSlideState=!1,[2]}})})},t.prototype.initInteractiveSeq=function(r){var o;for(var s in r.interactiveSeqState){var a=r.interactiveSeqState[s];(o=this.player)===null||o===void 0||o.setInteractiveSeqState(s,a.step,a.state==="idle"?"start":"end")}},t.prototype.initMedia=function(r){var o,s,a;for(var l in r.mediaState){var h=r.mediaState[l],u=this.__slideState.mediaState[l];if((o=this.player)===null||o===void 0||o.syncFullscreenVideoState({targetId:l,state:!!h.fullscreen,slideIndex:this.slideState.currentSlideIndex}),!u||h.type!==u.type||h.time!==u.time)if(h.type==="play"){var p=(this.timestamp()-h.time)/1e3;(s=this.player)===null||s===void 0||s.setMediaState(l,!0,p)}else(a=this.player)===null||a===void 0||a.setMediaState(l,!1,h.time)}},Object.defineProperty(t.prototype,"slideCount",{get:function(){return this._slideCount},enumerable:!1,configurable:!0}),t.prototype.getSizeAsync=function(){return Ji(this,void 0,void 0,function(){var r;return Ki(this,function(o){switch(o.label){case 0:if(this.width>0&&this.height>0)return[2,[this.width,this.height]];o.label=1;case 1:return o.trys.push([1,4,,5]),[4,fetch(this.__slideState.url+"/"+this.__slideState.taskId+"/jsonOutput/slide-1.json")];case 2:return[4,o.sent().json()];case 3:return[2,[(r=o.sent()).width,r.height]];case 4:return o.sent(),[2,[0,0]];case 5:return[2]}})})},t.prototype.getSlideCountAsync=function(){return Ji(this,void 0,void 0,function(){return Ki(this,function(r){switch(r.label){case 0:if(this._slideCount>0)return[2,this._slideCount];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(this.__slideState.url+"/"+this.__slideState.taskId+"/jsonOutput/slide-1.json")];case 2:return[4,r.sent().json()];case 3:return[2,r.sent().slideCount];case 4:return r.sent(),[2,0];case 5:return[2]}})})},Object.defineProperty(t.prototype,"slideState",{get:function(){return this.__slideState.mainSeqState=this.mainSeqState,this.__slideState.mainSeqStep=this.mainSeqStep,JSON.parse(JSON.stringify(this.__slideState))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainSeqLength",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.mainSeqLength())||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainSeqStep",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.mainSeqStep())||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainSeqState",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.mainSeqState())||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderOptions",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.config)||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"drawCall",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.runtime.drawCall)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderFps",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.runtime.fps)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"runtimeFps",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.fps.value)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"view",{get:function(){var r;return((r=this.player)===null||r===void 0?void 0:r.view)||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.designWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.designHeight},enumerable:!1,configurable:!0}),t.prototype.updateRenderOption=function(r){this.player&&(this.player.updateConfig(r),this.renderOptions&&(this.config.renderOptions=this.renderOptions))},t.prototype.setResource=function(r,o){var s;this.taskId=r,(s=this.player)===null||s===void 0||s.setResourceData(r,o),this.__slideState.taskId=r,this.__slideState.url=o,this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"setResource",taskId:r,url:o})},t.prototype._renderSlide=function(r){var o;return Ji(this,void 0,void 0,function(){var s=this;return Ki(this,function(a){switch(a.label){case 0:return this.renderingIndex=r,this.player&&r===this.player.currentIndex?[2]:((lr.platform.isIOS()||lr.platform.isAndroid())&&this.iosResetCache.indexOf(r)<0&&this.iosResetCache.push(r),[4,(o=this.player)===null||o===void 0?void 0:o.renderSlide(r)]);case 1:return a.sent(),this.__slideState.currentSlideIndex=r,this.resizeView(),this.__slideState.interactiveSeqState={},this.__slideState.mediaState={},this.emitStateChange(),setTimeout(function(){var l,h;if(((h=(l=s.player)===null||l===void 0?void 0:l.view)===null||h===void 0?void 0:h.style.visibility)==="hidden"&&(s.player.view.style.visibility="visible"),s.frame.style.visibility==="hidden"&&(s.frame.style.visibility="visible"),s.needClearCacheImage)try{s.frame.removeChild(s.cacheImage)}catch{}},100),[2]}})})},t.prototype.renderSlide=function(r,o){if(o===void 0&&(o=!0),this.player){var s=Number(r);(s!==this.player.currentIndex||this.renderingTaskManager.hasStartTask())&&(s>this.slideCount&&this.slideCount>0||this.poseRenderSlide(s,o))}},t.prototype.needCreateNewPlayer=function(){var r=lr.platform.isLowGpuMemory()?15:30;return(lr.platform.isIOS()||lr.platform.isAndroid())&&this.iosResetCache.length>r},t.prototype.poseRenderSlide=function(r,o){this.mode==="interactive"?this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"renderSlide",index:r,isForward:o}):this.mode==="sync"?(this.doRenderSlide(r,o),this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"renderSlide",index:r,isForward:o})):this.doRenderSlide(r,o)},t.prototype.doRenderSlide=function(r,o){var s,a,l,h=this;if(o===void 0&&(o=!0),!this.player)return Promise.resolve();if(this.needCreateNewPlayer()&&(this.iosResetCache=[],this.iosNewPlayer=this.initPlayer(this.config),this.iosNewPlayer.setResourceData(this.__slideState.taskId,this.__slideState.url)),this.iosNewPlayer){var u=this.player.getSnapshot();this.cacheImage.src=u,this.frame.appendChild(this.cacheImage),this.player.destroy(),(s=this.playerController)===null||s===void 0||s.destroy(),this.player=this.iosNewPlayer,this.iosNewPlayer=void 0,!((a=this.config)===null||a===void 0)&&a.controller&&this.createController(),this.needClearCacheImage=!0,!((l=this==null?void 0:this.player)===null||l===void 0)&&l.view&&(this.player.view.style.visibility="hidden",this.canvasContainer.appendChild(this.player.view))}var p=Math.random().toString(32).substr(2);return this.player.isForward=o,this.renderingTaskManager.addTask(function(){return h._renderSlide(r)},r,p),new Promise(function(y){h.renderingTaskManager.eventHub.once("task-end-"+p,y)})},t.prototype.getSnapshot=function(){var r,o;return(o=(r=this.player)===null||r===void 0?void 0:r.getSnapshot())!==null&&o!==void 0?o:null},t.prototype.nextStep=function(){!this.isLoading&&this.player&&this.interactive?(this.hasNextStep()||this.emit(hr.slideStepEnd),this.player.mainSeqHasNextStep()?this.mode==="interactive"?this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"nextStep",next:this.player.mainSeqStep()+1}):this.mode==="sync"?(this.doNextStep(!1,""),this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"nextStep",next:this.player.mainSeqStep()})):this.doNextStep(!1,""):this.handleNextSlide()):this.logger.info("prevent nextStep. isLoading: "+this.isLoading+", player: "+!!this.player+", interactive: "+this.interactive,this.taskId)},t.prototype.doNextStep=function(r,o){if(this.player){var s=!this.config.clientId||o===this.config.clientId;this.player.nextStep(r,s);var a=this.player.mainSeqStep();this.__slideState.mainSeqStep=a,this.emitStateChange()}},t.prototype.prevStep=function(){!this.isLoading&&this.player&&this.interactive?(this.hasPrevStep()||this.emit(hr.slideStepStart),this.player.mainSeqHasPrevStep()?this.mode==="interactive"?this.emitSyncDispatch({type:"prevStep",slideIndex:this.__slideState.currentSlideIndex,next:this.player.mainSeqStep()-1}):this.mode==="sync"?(this.doPrevStep(),this.emitSyncDispatch({slideIndex:this.__slideState.currentSlideIndex,type:"prevStep",next:this.player.mainSeqStep()})):this.doPrevStep():this.handlePrevSlide()):this.logger.info("prevent nextStep. isLoading: "+this.isLoading+", player: "+this.player+", interactive: "+this.interactive,this.taskId)},t.prototype.doPrevStep=function(r){if(r===void 0&&(r=!1),this.player){this.player.prevStep(r);var o=this.player.mainSeqStep();this.__slideState.mainSeqStep=o,this.emitStateChange()}},t.prototype.isSlideStateReady=function(r){return r.taskId.length>0&&r.url.length>0&&r.currentSlideIndex>0},t.prototype.emitStateChange=function(){if(this.mode!=="local"&&!this.isSyncingSlideState){var r=this.slideState;!zS()(this.lastEmitedState,r)&&this.isSlideStateReady(r)&&(this.lastEmitedState=r,this.emit(hr.stateChange,r),this.logger.info("stateChange dispatch "+JSON.stringify(this.slideState),this.taskId))}},t.prototype.emitSyncDispatch=function(r){if(!this.lock.isLocked(r.type)){var o=Math.random().toString(32).substr(2);this.lock.addLock(r.type,o);var s=_s(_s({},r),{uuid:o,clientId:this.config.clientId});this.config.mode==="sync"&&(s.incrId=this.dispatchIncrId),this.emit(hr.syncDispatch,s),this.logger.info("sync dispatch "+JSON.stringify(s),this.taskId)}},t.prototype.setMainSeqStep=function(r,o){var s;(s=this.player)===null||s===void 0||s.setMainSeqStep(r,o)},t.prototype.setInteractive=function(r){var o;this.interactive=r,(o=this.player)===null||o===void 0||o.setInteractive(r)},t.prototype.pause=function(){var r;(r=this.player)===null||r===void 0||r.pause()},t.prototype.resume=function(){var r;(r=this.player)===null||r===void 0||r.resume()},t.prototype._doFrozen=function(){var r;return Ji(this,void 0,void 0,function(){var o,s,a,l=this;return Ki(this,function(h){switch(h.label){case 0:return this.logger.info("frozen with player["+!!this.player+"]",this.taskId),this.tracker({name:"frozenSlide",reason:"",result:"",payload:{taskId:this.taskId}}),this.view&&this.player?[4,this.player.clock.waitUntil(function(){return!l.isLoading},6e4)]:[3,2];case 1:for(s in h.sent(),o=this.player.getSnapshot()||"",this.cacheImage.src=o,this.frame.appendChild(this.cacheImage),this.player.destroy(),(r=this.playerController)===null||r===void 0||r.destroy(),this.player=void 0,this.__slideState.mediaState)a=this.__slideState.mediaState[s],this.__slideState.mediaState[s]=_s(_s({},a),{frozenTime:this.timestamp()});h.label=2;case 2:return[2]}})})},t.prototype.frozen=function(){var r=this;this.frozenTaskManager.addTask("frozen",function(){return r._doFrozen()})},t.prototype._doRelease=function(){var r,o;return Ji(this,void 0,void 0,function(){var s,a,l,h;return Ki(this,function(u){switch(u.label){case 0:if(this.logger.info("do release slide",this.taskId),this.tracker({name:"releaseSlide",reason:"",result:"",payload:{taskId:this.taskId}}),this.player)return[2];for(a in this.player=this.initPlayer(this.config),!((r=this.config)===null||r===void 0)&&r.controller&&this.createController(),this.player.view&&(this.canvasContainer.appendChild(this.player.view),this.player.view.style.visibility="hidden"),s=this.__slideState,this.__slideState=cv()(Hv),s.mediaState)(l=s.mediaState[a]).type==="play"&&(h=Math.max((o=l.frozenTime)!==null&&o!==void 0?o:0,l.time),l.time=this.timestamp()-(h-l.time),l.frozenTime=void 0);return[4,this.setSlideState(s)];case 1:return u.sent(),[4,this.player.clock.delay(333)];case 2:u.sent(),this.player.view&&(this.player.view.style.visibility="visible");try{this.frame.removeChild(this.cacheImage)}catch{}return[2]}})})},t.prototype.release=function(){var r=this;this.frozenTaskManager.addTask("release",function(){return r._doRelease()})},t.prototype._doDestroy=function(){var r,o,s,a,l=this;this.logger.info("do destroy slide",this.taskId),this.tracker({name:"destroySlide",reason:"",result:"",payload:{taskId:this.taskId}});var h=t.instances.findIndex(function(u){return u.randomId===l.randomId});h>=0&&t.instances.splice(h,1),this.playerController&&this.playerController.destroy(),this.frameResizeObserver.disconnect(),(r=this.player)===null||r===void 0||r.removeAllListeners(),(o=this.player)===null||o===void 0||o.destroy(),(s=this.player)===null||s===void 0||s.removeAllListeners(),this.logger={warn:function(){return{}},info:function(){return{}},error:function(){return{}}},this.syncQueue.destroy(),this.renderingTaskManager.destroy(),this.frozenTaskManager.destroy(),window.removeEventListener("__slide_ref__",this.handleSlideRef),window.removeEventListener("message",this.recoverHandler),this.removeAllListeners();try{!((a=this.player)===null||a===void 0)&&a.view&&this.anchor.removeChild(this.player.view),this.anchor.removeChild(this.frame)}catch{}t.volumeAdjuster.off("update",this._updateVolumeByStaticAdjuster)},t.prototype.waitLoadEnd=function(){return Ji(this,void 0,void 0,function(){var r;return Ki(this,function(o){switch(o.label){case 0:r=0,o.label=1;case 1:return this.isLoading&&r<10?[4,Mh(100)]:[3,3];case 2:return o.sent(),r+=1,[3,1];case 3:return[2]}})})},t.prototype.preload=function(r){return this.player?this.player.preload(r):Promise.resolve()},t.prototype.destroy=function(){var r=this;this.logger.info("pre destroy slide",""),this.isLoading?this.waitLoadEnd().then(function(){r._doDestroy()}):this._doDestroy()},t.prototype.clearSlideCache=function(){var r;(r=this.player)===null||r===void 0||r.clearLocalCache()},t.prototype.hasNextStep=function(){if(!this.player)return!1;var r=this.player.currentIndex===this.slideCount,o=this.mainSeqLength===0||this.mainSeqStep>=this.mainSeqLength-1,s=this.mainSeqState==="end"||this.mainSeqState==="running"||this.mainSeqState==null;return!(r&&o&&s)},t.prototype.hasPrevStep=function(){if(!this.player)return!1;var r=this.player.currentIndex===1,o=this.mainSeqLength===0||this.mainSeqStep===0,s=this.mainSeqState==="idle"||this.mainSeqState===null;return!(r&&o&&s)},t.prototype.snapshot=function(){return Ji(this,void 0,void 0,function(){return Ki(this,function(r){return this.player?[2,this.player.getSnapshot()]:[2,null]})})},t.prototype.snapshotWithTimingEnd=function(r){return Ji(this,void 0,void 0,function(){return Ki(this,function(o){return this.player?[2,this.player.snapshotWithTimingEnd(r)]:[2,null]})})},t.prototype.updateGlobalVolume=function(r){this.volumeAdjuster.volume=r},t.prototype.getGlobalVolume=function(){return this.volumeAdjuster.volume},t.clearLocalCache=function(){lr.clearLocalCache()},t.disposeLocalCache=function(){},e=t,t.preloadResource=Rw,t.instances=[],t._tempFrozenIds=[],t._tempLog="",t._tempLogIndex=1,t.remoteLogAddress=null,t.usePlugin=function(r){r.context({logger:{info:function(o){t.appendLogString("INFO - "+new Date().toISOString()+" - "+o+`
`)},warn:function(o){t.appendLogString("WARN - "+new Date().toISOString()+" - "+o+`
`)},error:function(o){t.appendLogString("ERROR - "+new Date().toISOString()+" - "+o+`
`)}}}),function(o){var s=Mc.get(o.hookPoint)||[];s.push(o),Mc.set(o.hookPoint,s)}(r)},t.volumeAdjuster=new lv,t.trackLogger=new Aw,t.handleFrozenAllSlide=function(){t.instances.forEach(function(r){r.player&&(t._tempFrozenIds.push(r.randomId),r.frozen())})},t.handleReleaseAllSlide=function(){t._tempFrozenIds.forEach(function(r){var o=t.instances.find(function(s){return s.randomId===r});o&&o.release()}),t._tempFrozenIds=[]},t.handleLogReport=function(r){return Ji(void 0,void 0,void 0,function(){var o,s,a,l,h,u;return Ki(e,function(p){switch(p.label){case 0:return[4,t.flushLog(!0)];case 1:if(p.sent(),!pr)return[3,12];o=[],p.label=2;case 2:return p.trys.push([2,4,,5]),[4,pr.keys()];case 3:return o=(p.sent()||[]).sort(function(y,x){return parseInt(y.replace("run_time_log_",""))-parseInt(x.replace("run_time_log_",""))}),[3,5];case 4:return p.sent(),[3,5];case 5:if(o.length===0)return window.postMessage({type:"@slide/_report_log_",log:"",index:1,total:1,customMessage:"@slide/_report_log_",sessionId:r},"*"),[2];s=0,a=o,p.label=6;case 6:if(!(s<a.length))return[3,12];l=a[s],h=l.replace("run_time_log_",""),u="",p.label=7;case 7:return p.trys.push([7,9,,10]),[4,pr.getItem(l)];case 8:return u=p.sent()||"",[3,10];case 9:return p.sent(),[3,10];case 10:window.postMessage({type:"@slide/_report_log_",log:u,index:parseInt(h,10),total:o.length,customMessage:"@slide/_report_log_",sessionId:r},"*"),p.label=11;case 11:return s++,[3,6];case 12:return[2]}})})},t.handleLogDownload=function(){return Ji(void 0,void 0,void 0,function(){var r,o,s,a,l,h,u;return Ki(e,function(p){switch(p.label){case 0:return p.trys.push([0,7,,8]),[4,t.flushLog(!0)];case 1:return p.sent(),r="",pr?[4,pr.keys()]:[3,6];case 2:o=(p.sent()||[]).sort(function(y,x){return parseInt(y.replace("run_time_log_",""))-parseInt(x.replace("run_time_log_",""))}),s=0,a=o,p.label=3;case 3:return s<a.length?(l=a[s],h=r,[4,pr.getItem(l)]):[3,6];case 4:r=h+(p.sent()||""),p.label=5;case 5:return s++,[3,3];case 6:return(u=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(r)),u.setAttribute("download","slide_log"),u.style.display="none",document.body.appendChild(u),u.click(),document.body.removeChild(u),[3,8];case 7:return p.sent(),[3,8];case 8:return[2]}})})},Pw([(n="Slide.initConfig",function(r,o,s){var a=s.value;s.value=function(){for(var l=[],h=0;h<arguments.length;h++)l[h]=arguments[h];for(var u=Mc.get(n)||[],p=l,y=0,x=u;y<x.length;y++){var E=x[y];try{p=E.before(p)}catch{}if(!Array.isArray(p)||p.length!==l.length)throw new Error("plugin before hook return invalid args")}for(var w=a.bind(this).apply(void 0,p),C=0,j=u.reverse();C<j.length;C++){E=j[C];try{w=E.after(w)}catch{}if(!w)throw new Error("plugin after hook return undefined result")}return w}})],t.prototype,"initSlideConfig",null),t}(xi.a);pr==null||pr.clear().catch(function(){}),window.addEventListener("__slide_log__",io.handleLogDownload),window.addEventListener("message",function(i){if(i.data.type==="@slide/_request_log_")io.handleLogReport(i.data.sessionId).catch(function(){});else if(i.data.type==="@slide/_request_frozen_")io.handleFrozenAllSlide();else if(i.data.type==="@slide/_request_release_")io.handleReleaseAllSlide();else if(i.data.type==="@slide/_update_volume_"){var t=.5;try{t=parseFloat(i.data.volume.toString())}catch{}io.volumeAdjuster.volume=t}else i.data.type==="@slide/_get_volume_"?window.postMessage({type:"@slide/_report_volume_",volume:io.volumeAdjuster.volume,customMessage:"@slide/_report_volume_"},"*"):i.data.type==="@slide/_preload_slide_"&&io.preloadResource(i.data.taskId,i.data.prefix,function(e){window.postMessage({type:"@slide/_preload_slide_progress_",taskId:i.data.taskId,progress:e},"*")}).catch(function(e){window.postMessage({type:"@slide/_preload_slide_error_",taskId:i.data.taskId,error:e},"*")})}),window.setInterval(function(){io.flushLog().catch(function(){})},2e3)}]);const Ar="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e0=87,n0=20,Jc=[],i0=()=>{for(let b=0;b<n0;b++)Jc[b]=Ar.charAt(Math.random()*e0);return Jc.join("")};function Kc(b){try{return b()}catch(A){console.error(A)}}class ra{constructor(){this.push=this.addDisposer,this.disposers=new Map}addDisposer(A,v=this.genUID()){return this.flush(v),this.disposers.set(v,Array.isArray(A)?r0(A):A),v}add(A,v=this.genUID()){const P=A();return P?this.addDisposer(P,v):v}addEventListener(A,v,P,M,I=this.genUID()){return A.addEventListener(v,P,M),this.addDisposer(()=>A.removeEventListener(v,P,M),I),I}setTimeout(A,v,P=this.genUID()){const M=window.setTimeout(()=>{this.remove(P),A()},v);return this.addDisposer(()=>window.clearTimeout(M),P)}setInterval(A,v,P=this.genUID()){const M=window.setInterval(A,v);return this.addDisposer(()=>window.clearInterval(M),P)}remove(A){const v=this.disposers.get(A);return this.disposers.delete(A),v}flush(A){const v=this.remove(A);v&&v()}flushAll(){this.disposers.forEach(Kc),this.disposers.clear()}genUID(){let A;do A=i0();while(this.disposers.has(A));return A}}function r0(b){return()=>b.forEach(Kc)}function Zc(b,A,v){return Math.min(Math.max(b,A),v)}function o0(b){return typeof b=="object"&&b!==null}function s0(b){if(!b)return!1;const A=b.tagName;return A==="INPUT"||A==="TEXTAREA"||A==="SELECT"}var Qc={exports:{}},a0={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},$c={exports:{}},l0=function(A){return!A||typeof A=="string"?!1:A instanceof Array||Array.isArray(A)||A.length>=0&&(A.splice instanceof Function||Object.getOwnPropertyDescriptor(A,A.length-1)&&A.constructor.name!=="String")},h0=l0,u0=Array.prototype.concat,c0=Array.prototype.slice,td=$c.exports=function(A){for(var v=[],P=0,M=A.length;P<M;P++){var I=A[P];h0(I)?v=u0.call(v,c0.call(I)):v.push(I)}return v};td.wrap=function(b){return function(){return b(td(arguments))}};var oa=a0,sa=$c.exports,ed=Object.hasOwnProperty,nd=Object.create(null);for(var Rh in oa)ed.call(oa,Rh)&&(nd[oa[Rh]]=Rh);var gr=Qc.exports={to:{},get:{}};gr.get=function(b){var A=b.substring(0,3).toLowerCase(),v,P;switch(A){case"hsl":v=gr.get.hsl(b),P="hsl";break;case"hwb":v=gr.get.hwb(b),P="hwb";break;default:v=gr.get.rgb(b),P="rgb";break}return v?{model:P,value:v}:null},gr.get.rgb=function(b){if(!b)return null;var A=/^#([a-f0-9]{3,4})$/i,v=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,P=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,M=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,I=/^(\w+)$/,D=[0,0,0,1],k,W,X;if(k=b.match(v)){for(X=k[2],k=k[1],W=0;W<3;W++){var V=W*2;D[W]=parseInt(k.slice(V,V+2),16)}X&&(D[3]=parseInt(X,16)/255)}else if(k=b.match(A)){for(k=k[1],X=k[3],W=0;W<3;W++)D[W]=parseInt(k[W]+k[W],16);X&&(D[3]=parseInt(X+X,16)/255)}else if(k=b.match(P)){for(W=0;W<3;W++)D[W]=parseInt(k[W+1],0);k[4]&&(k[5]?D[3]=parseFloat(k[4])*.01:D[3]=parseFloat(k[4]))}else if(k=b.match(M)){for(W=0;W<3;W++)D[W]=Math.round(parseFloat(k[W+1])*2.55);k[4]&&(k[5]?D[3]=parseFloat(k[4])*.01:D[3]=parseFloat(k[4]))}else return(k=b.match(I))?k[1]==="transparent"?[0,0,0,0]:ed.call(oa,k[1])?(D=oa[k[1]],D[3]=1,D):null:null;for(W=0;W<3;W++)D[W]=vo(D[W],0,255);return D[3]=vo(D[3],0,1),D},gr.get.hsl=function(b){if(!b)return null;var A=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,v=b.match(A);if(v){var P=parseFloat(v[4]),M=(parseFloat(v[1])%360+360)%360,I=vo(parseFloat(v[2]),0,100),D=vo(parseFloat(v[3]),0,100),k=vo(isNaN(P)?1:P,0,1);return[M,I,D,k]}return null},gr.get.hwb=function(b){if(!b)return null;var A=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,v=b.match(A);if(v){var P=parseFloat(v[4]),M=(parseFloat(v[1])%360+360)%360,I=vo(parseFloat(v[2]),0,100),D=vo(parseFloat(v[3]),0,100),k=vo(isNaN(P)?1:P,0,1);return[M,I,D,k]}return null},gr.to.hex=function(){var b=sa(arguments);return"#"+rl(b[0])+rl(b[1])+rl(b[2])+(b[3]<1?rl(Math.round(b[3]*255)):"")},gr.to.rgb=function(){var b=sa(arguments);return b.length<4||b[3]===1?"rgb("+Math.round(b[0])+", "+Math.round(b[1])+", "+Math.round(b[2])+")":"rgba("+Math.round(b[0])+", "+Math.round(b[1])+", "+Math.round(b[2])+", "+b[3]+")"},gr.to.rgb.percent=function(){var b=sa(arguments),A=Math.round(b[0]/255*100),v=Math.round(b[1]/255*100),P=Math.round(b[2]/255*100);return b.length<4||b[3]===1?"rgb("+A+"%, "+v+"%, "+P+"%)":"rgba("+A+"%, "+v+"%, "+P+"%, "+b[3]+")"},gr.to.hsl=function(){var b=sa(arguments);return b.length<4||b[3]===1?"hsl("+b[0]+", "+b[1]+"%, "+b[2]+"%)":"hsla("+b[0]+", "+b[1]+"%, "+b[2]+"%, "+b[3]+")"},gr.to.hwb=function(){var b=sa(arguments),A="";return b.length>=4&&b[3]!==1&&(A=", "+b[3]),"hwb("+b[0]+", "+b[1]+"%, "+b[2]+"%"+A+")"},gr.to.keyword=function(b){return nd[b.slice(0,3)]};function vo(b,A,v){return Math.min(Math.max(A,b),v)}function rl(b){var A=Math.round(b).toString(16).toUpperCase();return A.length<2?"0"+A:A}var d0=Qc.exports;class p0{constructor(A){this.enable=A,this.apps={},this.level="debug",this.roomLogger=null,this._onMessage=v=>{let P;v instanceof CustomEvent?P=v.detail:o0(v.data)&&(P=v.data),P&&(typeof P.slide=="boolean"?this.enable=P.slide:P.slide==="__instance"?console.log(this):P.slide==="__debug"&&Object.values(this.apps).forEach(M=>{var I,D;(D=(I=M.controller)==null?void 0:I.slide)==null||D.createController()}))},this.initialize()}setAppContext(A,v){var P;((P=this.apps)[A]||(P[A]={})).context=v,this.log(`[Slide] new ${A}`)}setAppController(A,v){var P;((P=this.apps)[A]||(P[A]={})).controller=v}deleteApp(A){delete this.apps[A],this.log(`[Slide] delete ${A}`)}initialize(){window.addEventListener("message",this._onMessage)}dispose(){window.removeEventListener("message",this._onMessage)}log(...A){this.roomLogger?this.roomLogger.info(...A):this.enable&&console.log(...A)}verbose(...A){this.roomLogger?this.roomLogger.debug(...A):this.enable&&this.level==="verbose"&&console.log(...A)}warn(...A){this.roomLogger?this.roomLogger.warn(...A):console.warn(...A)}}const Mr=new p0(!1),Di=Mr.log.bind(Mr),Ih=Mr.verbose.bind(Mr),f0=b=>{Mr.roomLogger=b.logger};function id(b){try{const A=window.getComputedStyle(b).backgroundColor;if(A!=="rgba(0, 0, 0, 0)"&&A!=="transparent")return A;if(b.parentElement)return id(b.parentElement)}catch{}return"#ffffff"}function m0(b){const A=d0.get(b);if(A&&A.model==="rgb"){const v=A.value,M=(((Math.round(v[0])&255)<<16)+((Math.round(v[1])&255)<<8)+(Math.round(v[2])&255)).toString(16);return"#"+"000000".substring(M.length)+M}else return b}let ol="";function rd(b){return ol||(ol=m0(id(b)),Di("[Slide] guess bg color",ol)),ol}const g0=b=>b.tracker;function od(b){const{width:A,height:v,slideCount:P,slideState:M}=b,{taskId:I,url:D}=M,k=[];for(let W=1;W<=P;++W)k.push({width:A,height:v,thumbnail:`${D}/${I}/preview/${W}.png`,src:"ppt"});return k}function sd(b,A,v,P){var k;const M=v.slideState.currentSlideIndex;if(!(M>0)||!A.getIsWritable())return;const I=[P,M].join("/");if(b.scenePathType(I)!=="page"){b.removeScenes(P);const W=v.slideCount,X=[];for(let V=1;V<=W;++V)X.push({name:`${V}`});b.putScenes(P,X)}let D;A.getBox().focus?D=b.state.sceneState.scenePath:D=((k=A.getView())==null?void 0:k.focusScenePath)||"",D!==I&&A.setScenePath(I)}const Ph="https://convertcdn.netless.link/dynamicConvert",v0=40,Oh={taskId:"",url:"",state:null};class _0{constructor({context:A,anchor:v,onRenderStart:P,onPageChanged:M,onTransitionStart:I,onTransitionEnd:D,onError:k,onRenderError:W,showRenderError:X}){this.sideEffect=new ra,this.ready=!1,this.readyPromise=new Promise(V=>{this.resolveReady=()=>{this.ready?Di("[Slide] render end"):setTimeout(()=>{this.ready=!0,V()},1e3)}}),this.onSyncDispatch=V=>{if(this.context.getIsWritable()&&this.room){const et={type:Dn.SLIDE_EVENTS.syncDispatch,payload:V};Ih("[Slide] dispatch",JSON.stringify(V)),this.context.dispatchMagixEvent(Dn.SLIDE_EVENTS.syncDispatch,et)}},this.magixEventListener=V=>{const{type:et,payload:pt}=V.payload;et===Dn.SLIDE_EVENTS.syncDispatch&&(this.syncStateOnce(),Ih("[Slide] receive",JSON.stringify(pt)),this.slide.emit(Dn.SLIDE_EVENTS.syncReceive,pt))},this.onStateChange=V=>{this.context.getIsWritable()&&(Ih("[Slide] state change",JSON.stringify(V,null,2)),this.context.storage.setState({state:V}))},this.pollCount=0,this.pollReadyState=()=>{this.ready?this._toFreeze===1?this.freeze():this._toFreeze===-1&&this.unfreeze():this.pollCount<v0?(this.pollCount++,setTimeout(this.pollReadyState,500)):(this.pollCount=0,Di("[Slide] renderSlide 1 (retry after timeout)"),this.slide.renderSlide(1))},this._pageCount=0,this.destroyed=!1,this.timestamp=()=>this.room&&this.room.calibrationTimestamp?this.room.calibrationTimestamp:this.player?this.player.beginTimestamp+this.player.progressTime:Date.now(),this.isFrozen=!1,this._toFreeze=0,this.freeze=()=>{this.isFrozen=!0,this.ready?(Di("[Slide] freeze",this.context.appId),this.slide.frozen()):this._toFreeze=1},this.unfreeze=async()=>{!this.visible||(this.isFrozen=!1,this.ready?(Di("[Slide] unfreeze",this.context.appId),this.slide.release()):this._toFreeze=-1)},this.onVisibilityChange=async()=>{(this.visible=document.visibilityState==="visible")?(Di("[Slide] unfreeze because tab becomes visible",{savedIsFrozen:this.savedIsFrozen}),this.savedIsFrozen||this.unfreeze()):(this.savedIsFrozen=this.isFrozen,Di("[Slide] freeze because tab becomes invisible"),this.freeze())},this.onRenderStart=P,this.onPageChanged=M,this.onTransitionStart=I,this.onTransitionEnd=D,this.onError=k,this.onRenderError=W,this.showRenderError=X!=null?X:!0,this.context=A,this.room=A.getRoom(),this.player=this.room?void 0:A.getDisplayer(),f0(this.room||this.player),this.slide=this.createSlide(v,{whiteTracker:g0(A.getDisplayer())}),this.syncStateOnceFlag=!this.context.isAddApp,this.visible=document.visibilityState==="visible",this.savedIsFrozen=!1,this.initialize()}jumpToPage(A){this.ready&&(A=Zc(A,1,this.pageCount),this.slide.renderSlide(A))}initialize(){this.registerEventListeners(),this.kickStart()}kickStart(){const{context:A,slide:v}=this;A.getIsWritable()&&A.storage.ensureState(Oh);const{taskId:P,url:M,state:I}=A.storage.state;v.setResource(P,M||Ph),I?(Di("[Slide] init with state",JSON.stringify(I)),this.syncStateOnceFlag=!1,v.setSlideState(I)):A.isAddApp&&(Di("[Slide] init by renderSlide",1),v.renderSlide(1)),this.pollReadyState()}registerEventListeners(){const{context:A,slide:v}=this,P=this.sideEffect.addDisposer(A.storage.addStateChangedListener(()=>{A.storage.state.state&&(this.syncStateOnce(),this.sideEffect.flush(P))}));this.sideEffect.add(()=>A.addMagixEventListener(Dn.SLIDE_EVENTS.syncDispatch,this.magixEventListener,{fireSelfEventAfterCommit:!0})),v.on(Dn.SLIDE_EVENTS.renderStart,this.onRenderStart),v.on(Dn.SLIDE_EVENTS.slideChange,this.onPageChanged),v.on(Dn.SLIDE_EVENTS.renderEnd,this.onTransitionEnd),v.on(Dn.SLIDE_EVENTS.mainSeqStepStart,this.onTransitionStart),v.on(Dn.SLIDE_EVENTS.mainSeqStepEnd,this.onTransitionEnd),v.on(Dn.SLIDE_EVENTS.renderError,this.onError),v.on(Dn.SLIDE_EVENTS.stateChange,this.onStateChange),v.on(Dn.SLIDE_EVENTS.syncDispatch,this.onSyncDispatch),v.on(Dn.SLIDE_EVENTS.renderEnd,this.resolveReady),this.sideEffect.add(()=>(document.addEventListener("visibilitychange",this.onVisibilityChange),()=>document.removeEventListener("visibilitychange",this.onVisibilityChange)))}syncStateOnce(){if(this.syncStateOnceFlag){this.context.getIsWritable()&&this.context.storage.ensureState(Oh);const{state:A}=this.context.storage.state;A&&(Di("[Slide] sync with state (once)",JSON.stringify(A)),this.slide.setSlideState(A),this.syncStateOnceFlag=!1)}}get pageCount(){return this._pageCount>0?this._pageCount:(this._pageCount=this.slide.slideCount,this._pageCount)}get page(){return this.slide.slideState.currentSlideIndex}createSlide(A,v={}){var I,D,k;const P=this.context.getAppOptions()||{};return new Dn.Slide({anchor:A,interactive:!0,mode:"interactive",controller:Mr.enable,enableGlobalClick:(I=P.enableGlobalClick)!=null?I:!0,renderOptions:{minFPS:P.minFPS||25,maxFPS:P.maxFPS||30,autoFPS:(D=P.autoFPS)!=null?D:!0,autoResolution:(k=P.autoResolution)!=null?k:!0,resolution:P.resolution,transactionBgColor:P.bgColor||rd(A),maxResolutionLevel:P.maxResolutionLevel,forceCanvas:P.forceCanvas,enableNvidiaDetect:P.enableNvidiaDetect},fixedFrameSize:P.fixedFrameSize,loaderDelegate:P.loaderDelegate,navigatorDelegate:P.navigatorDelegate,urlInterrupter:P.urlInterrupter,resourceTimeout:P.resourceTimeout,rtcAudio:P.rtcAudio,useLocalCache:P.useLocalCache,logger:P.logger,whiteTracker:v.whiteTracker,timestamp:this.timestamp})}destroy(){this.sideEffect.flushAll(),this.destroyed||(Di("[Slide] destroy slide (once)"),this.slide.destroy(),this.destroyed=!0)}}function y0(b){const A="http://www.w3.org/2000/svg",v=document.createElementNS(A,"svg");v.setAttribute("class",`${b}-footer-icon-sidebar`),v.setAttribute("viewBox","0 0 64 64");const P=document.createElementNS(A,"path");return P.setAttribute("fill","currentColor"),P.setAttribute("d","M50 8H14c-3.309 0-6 2.691-6 6v36c0 3.309 2.691 6 6 6h36c3.309 0 6-2.691 6-6V14c0-3.309-2.691-6-6-6zM12 50V14c0-1.103.897-2 2-2h8v40h-8c-1.103 0-2-.897-2-2zm40 0c0 1.103-.897 2-2 2H26V12h24c1.103 0 2 .897 2 2z"),v.appendChild(P),v}function x0(b){const A="http://www.w3.org/2000/svg",v=document.createElementNS(A,"svg");v.setAttribute("class",`${b}-footer-icon-arrow-left`),v.setAttribute("viewBox","0 0 500 500");const P=document.createElementNS(A,"path");return P.setAttribute("fill","currentColor"),P.setAttribute("d","M177.81 249.959L337.473 90.295c2.722-2.865 2.651-7.378-.143-10.1-2.793-2.65-7.163-2.65-9.956 0l-164.75 164.75c-2.793 2.793-2.793 7.306 0 10.1l164.75 164.75c2.865 2.722 7.378 2.65 10.099-.143 2.651-2.794 2.651-7.163 0-9.957L177.809 249.959z"),v.appendChild(P),v}function b0(b){const A="http://www.w3.org/2000/svg",v=document.createElementNS(A,"svg");v.setAttribute("class",`${b}-footer-icon-arrow-right`),v.setAttribute("viewBox","0 0 500 500");const P=document.createElementNS(A,"path");return P.setAttribute("fill","currentColor"),P.setAttribute("d","M322.19 250.041L162.527 409.705c-2.722 2.865-2.651 7.378.143 10.1 2.793 2.65 7.163 2.65 9.956 0l164.75-164.75c2.793-2.793 2.793-7.306 0-10.1l-164.75-164.75c-2.865-2.722-7.378-2.65-10.099.143-2.651 2.794-2.651 7.163 0 9.957l159.664 159.736z"),v.appendChild(P),v}function T0(b){const A="http://www.w3.org/2000/svg",v=document.createElementNS(A,"svg");v.setAttribute("class",`${b}-footer-icon-play`),v.setAttribute("viewBox","0 0 500 500");const P=document.createElementNS(A,"path");return P.setAttribute("fill","currentColor"),P.setAttribute("d","M418.158 257.419L174.663 413.33c-6.017 3.919-15.708 3.772-21.291-.29-2.791-2.018-4.295-4.483-4.295-7.084V94.109c0-5.65 6.883-10.289 15.271-10.289 4.298 0 8.391 1.307 11.181 3.332l242.629 155.484c6.016 3.917 6.451 10.292.649 14.491-.216.154-.432.154-.649.292zM170.621 391.288l223.116-141.301L170.71 107.753l-.089 283.535z"),v.appendChild(P),v}function E0(b){const A="http://www.w3.org/2000/svg",v=document.createElementNS(A,"svg");v.setAttribute("class",`${b}-footer-icon-pause`),v.setAttribute("viewBox","0 0 500 500");const P=document.createElementNS(A,"path");return P.setAttribute("fill","currentColor"),P.setAttribute("d","M312.491 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261zM165.257 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261z"),v.appendChild(P),v}const _o=typeof window!="undefined",ad=_o&&!("onscroll"in window)||typeof navigator!="undefined"&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),ld=_o&&"IntersectionObserver"in window,hd=_o&&"classList"in document.createElement("p"),ud=_o&&window.devicePixelRatio>1,S0={elements_selector:".lazy",container:ad||_o?document:null,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",data_bg_hidpi:"bg-hidpi",data_bg_multi:"bg-multi",data_bg_multi_hidpi:"bg-multi-hidpi",data_bg_set:"bg-set",data_poster:"poster",class_applied:"applied",class_loading:"loading",class_loaded:"loaded",class_error:"error",class_entered:"entered",class_exited:"exited",unobserve_completed:!0,unobserve_entered:!1,cancel_on_exit:!0,callback_enter:null,callback_exit:null,callback_applied:null,callback_loading:null,callback_loaded:null,callback_error:null,callback_finish:null,callback_cancel:null,use_native:!1,restore_on_error:!1},cd=b=>Object.assign({},S0,b),dd=function(b,A){let v;const P="LazyLoad::Initialized",M=new b(A);try{v=new CustomEvent(P,{detail:{instance:M}})}catch{v=document.createEvent("CustomEvent"),v.initCustomEvent(P,!1,!1,{instance:M})}window.dispatchEvent(v)},w0=(b,A)=>{if(!!A)if(!A.length)dd(b,A);else for(let v=0,P;P=A[v];v+=1)dd(b,P)},oo="src",Nh="srcset",Lh="sizes",pd="poster",aa="llOriginalAttrs",fd="data",Dh="loading",md="loaded",gd="applied",A0="entered",Fh="error",vd="native",_d="data-",yd="ll-status",cr=(b,A)=>b.getAttribute(_d+A),M0=(b,A,v)=>{var P=_d+A;if(v===null){b.removeAttribute(P);return}b.setAttribute(P,v)},la=b=>cr(b,yd),Ko=(b,A)=>M0(b,yd,A),sl=b=>Ko(b,null),Bh=b=>la(b)===null,C0=b=>la(b)===Dh,R0=b=>la(b)===Fh,Uh=b=>la(b)===vd,I0=[Dh,md,gd,Fh],P0=b=>I0.indexOf(la(b))>=0,yo=(b,A,v,P)=>{if(!!b){if(P!==void 0){b(A,v,P);return}if(v!==void 0){b(A,v);return}b(A)}},xs=(b,A)=>{if(hd){b.classList.add(A);return}b.className+=(b.className?" ":"")+A},Yr=(b,A)=>{if(hd){b.classList.remove(A);return}b.className=b.className.replace(new RegExp("(^|\\s+)"+A+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},O0=b=>{b.llTempImage=document.createElement("IMG")},N0=b=>{delete b.llTempImage},xd=b=>b.llTempImage,al=(b,A)=>{if(!A)return;const v=A._observer;!v||v.unobserve(b)},L0=b=>{b.disconnect()},D0=(b,A,v)=>{A.unobserve_entered&&al(b,v)},kh=(b,A)=>{!b||(b.loadingCount+=A)},F0=b=>{!b||(b.toLoadCount-=1)},bd=(b,A)=>{!b||(b.toLoadCount=A)},B0=b=>b.loadingCount>0,U0=b=>b.toLoadCount>0,Td=b=>{let A=[];for(let v=0,P;P=b.children[v];v+=1)P.tagName==="SOURCE"&&A.push(P);return A},Gh=(b,A)=>{const v=b.parentNode;if(!v||v.tagName!=="PICTURE")return;Td(v).forEach(A)},Ed=(b,A)=>{Td(b).forEach(A)},ll=[oo],Sd=[oo,pd],ha=[oo,Nh,Lh],wd=[fd],hl=b=>!!b[aa],Ad=b=>b[aa],Md=b=>delete b[aa],bs=(b,A)=>{if(hl(b))return;const v={};A.forEach(P=>{v[P]=b.getAttribute(P)}),b[aa]=v},k0=b=>{hl(b)||(b[aa]={backgroundImage:b.style.backgroundImage})},G0=(b,A,v)=>{if(!v){b.removeAttribute(A);return}b.setAttribute(A,v)},Zo=(b,A)=>{if(!hl(b))return;const v=Ad(b);A.forEach(P=>{G0(b,P,v[P])})},H0=b=>{if(!hl(b))return;const A=Ad(b);b.style.backgroundImage=A.backgroundImage},Cd=(b,A,v)=>{xs(b,A.class_applied),Ko(b,gd),v&&(A.unobserve_completed&&al(b,A),yo(A.callback_applied,b,v))},Rd=(b,A,v)=>{xs(b,A.class_loading),Ko(b,Dh),v&&(kh(v,1),yo(A.callback_loading,b,v))},xo=(b,A,v)=>{!v||b.setAttribute(A,v)},Id=(b,A)=>{xo(b,Lh,cr(b,A.data_sizes)),xo(b,Nh,cr(b,A.data_srcset)),xo(b,oo,cr(b,A.data_src))},j0=(b,A)=>{Gh(b,v=>{bs(v,ha),Id(v,A)}),bs(b,ha),Id(b,A)},z0=(b,A)=>{bs(b,ll),xo(b,oo,cr(b,A.data_src))},V0=(b,A)=>{Ed(b,v=>{bs(v,ll),xo(v,oo,cr(v,A.data_src))}),bs(b,Sd),xo(b,pd,cr(b,A.data_poster)),xo(b,oo,cr(b,A.data_src)),b.load()},W0=(b,A)=>{bs(b,wd),xo(b,fd,cr(b,A.data_src))},X0=(b,A,v)=>{const P=cr(b,A.data_bg),M=cr(b,A.data_bg_hidpi),I=ud&&M?M:P;!I||(b.style.backgroundImage=`url("${I}")`,xd(b).setAttribute(oo,I),Rd(b,A,v))},Y0=(b,A,v)=>{const P=cr(b,A.data_bg_multi),M=cr(b,A.data_bg_multi_hidpi),I=ud&&M?M:P;!I||(b.style.backgroundImage=I,Cd(b,A,v))},q0=(b,A,v)=>{const P=cr(b,A.data_bg_set);if(!P)return;const M=P.split("|");let I=M.map(D=>`image-set(${D})`);b.style.backgroundImage=I.join(),b.style.backgroundImage===""&&(I=M.map(D=>`-webkit-image-set(${D})`),b.style.backgroundImage=I.join()),Cd(b,A,v)},Pd={IMG:j0,IFRAME:z0,VIDEO:V0,OBJECT:W0},J0=(b,A)=>{const v=Pd[b.tagName];!v||v(b,A)},K0=(b,A,v)=>{const P=Pd[b.tagName];!P||(P(b,A),Rd(b,A,v))},Z0=["IMG","IFRAME","VIDEO","OBJECT"],Q0=b=>Z0.indexOf(b.tagName)>-1,Od=(b,A)=>{A&&!B0(A)&&!U0(A)&&yo(b.callback_finish,A)},Nd=(b,A,v)=>{b.addEventListener(A,v),b.llEvLisnrs[A]=v},$0=(b,A,v)=>{b.removeEventListener(A,v)},Hh=b=>!!b.llEvLisnrs,t_=(b,A,v)=>{Hh(b)||(b.llEvLisnrs={});const P=b.tagName==="VIDEO"?"loadeddata":"load";Nd(b,P,A),Nd(b,"error",v)},jh=b=>{if(!Hh(b))return;const A=b.llEvLisnrs;for(let v in A){const P=A[v];$0(b,v,P)}delete b.llEvLisnrs},Ld=(b,A,v)=>{N0(b),kh(v,-1),F0(v),Yr(b,A.class_loading),A.unobserve_completed&&al(b,v)},e_=(b,A,v,P)=>{const M=Uh(A);Ld(A,v,P),xs(A,v.class_loaded),Ko(A,md),yo(v.callback_loaded,A,P),M||Od(v,P)},n_=(b,A,v,P)=>{const M=Uh(A);Ld(A,v,P),xs(A,v.class_error),Ko(A,Fh),yo(v.callback_error,A,P),v.restore_on_error&&Zo(A,ha),M||Od(v,P)},zh=(b,A,v)=>{const P=xd(b)||b;if(Hh(P))return;t_(P,D=>{e_(D,b,A,v),jh(P)},D=>{n_(D,b,A,v),jh(P)})},i_=(b,A,v)=>{O0(b),zh(b,A,v),k0(b),X0(b,A,v),Y0(b,A,v),q0(b,A,v)},r_=(b,A,v)=>{zh(b,A,v),K0(b,A,v)},Vh=(b,A,v)=>{Q0(b)?r_(b,A,v):i_(b,A,v)},o_=(b,A,v)=>{b.setAttribute("loading","lazy"),zh(b,A,v),J0(b,A),Ko(b,vd)},Dd=b=>{b.removeAttribute(oo),b.removeAttribute(Nh),b.removeAttribute(Lh)},s_=b=>{Gh(b,A=>{Dd(A)}),Dd(b)},Fd=b=>{Gh(b,A=>{Zo(A,ha)}),Zo(b,ha)},a_={IMG:Fd,IFRAME:b=>{Zo(b,ll)},VIDEO:b=>{Ed(b,A=>{Zo(A,ll)}),Zo(b,Sd),b.load()},OBJECT:b=>{Zo(b,wd)}},l_=b=>{const A=a_[b.tagName];if(!A){H0(b);return}A(b)},h_=(b,A)=>{Bh(b)||Uh(b)||(Yr(b,A.class_entered),Yr(b,A.class_exited),Yr(b,A.class_applied),Yr(b,A.class_loading),Yr(b,A.class_loaded),Yr(b,A.class_error))},u_=(b,A)=>{l_(b),h_(b,A),sl(b),Md(b)},c_=(b,A,v,P)=>{!v.cancel_on_exit||!C0(b)||b.tagName==="IMG"&&(jh(b),s_(b),Fd(b),Yr(b,v.class_loading),kh(P,-1),sl(b),yo(v.callback_cancel,b,A,P))},d_=(b,A,v,P)=>{const M=P0(b);Ko(b,A0),xs(b,v.class_entered),Yr(b,v.class_exited),D0(b,v,P),yo(v.callback_enter,b,A,P),!M&&Vh(b,v,P)},p_=(b,A,v,P)=>{Bh(b)||(xs(b,v.class_exited),c_(b,A,v,P),yo(v.callback_exit,b,A,P))},f_=["IMG","IFRAME","VIDEO"],Bd=b=>b.use_native&&"loading"in HTMLImageElement.prototype,m_=(b,A,v)=>{b.forEach(P=>{f_.indexOf(P.tagName)!==-1&&o_(P,A,v)}),bd(v,0)},g_=b=>b.isIntersecting||b.intersectionRatio>0,v_=b=>({root:b.container===document?null:b.container,rootMargin:b.thresholds||b.threshold+"px"}),__=(b,A,v)=>{b.forEach(P=>g_(P)?d_(P.target,P,A,v):p_(P.target,P,A,v))},y_=(b,A)=>{A.forEach(v=>{b.observe(v)})},x_=(b,A)=>{L0(b),y_(b,A)},b_=(b,A)=>{!ld||Bd(b)||(A._observer=new IntersectionObserver(v=>{__(v,b,A)},v_(b)))},Ud=b=>Array.prototype.slice.call(b),ul=b=>b.container.querySelectorAll(b.elements_selector),T_=b=>Ud(b).filter(Bh),E_=b=>R0(b),S_=b=>Ud(b).filter(E_),kd=(b,A)=>T_(b||ul(A)),w_=(b,A)=>{S_(ul(b)).forEach(P=>{Yr(P,b.class_error),sl(P)}),A.update()},A_=(b,A)=>{!_o||(A._onlineHandler=()=>{w_(b,A)},window.addEventListener("online",A._onlineHandler))},M_=b=>{!_o||window.removeEventListener("online",b._onlineHandler)},ua=function(b,A){const v=cd(b);this._settings=v,this.loadingCount=0,b_(v,this),A_(v,this),this.update(A)};ua.prototype={update:function(b){const A=this._settings,v=kd(b,A);if(bd(this,v.length),ad||!ld){this.loadAll(v);return}if(Bd(A)){m_(v,A,this);return}x_(this._observer,v)},destroy:function(){this._observer&&this._observer.disconnect(),M_(this),ul(this._settings).forEach(b=>{Md(b)}),delete this._observer,delete this._settings,delete this._onlineHandler,delete this.loadingCount,delete this.toLoadCount},loadAll:function(b){const A=this._settings;kd(b,A).forEach(P=>{al(P,this),Vh(P,A,this)})},restoreAll:function(){const b=this._settings;ul(b).forEach(A=>{u_(A,b)})}},ua.load=(b,A)=>{const v=cd(A);Vh(b,v)},ua.resetStatus=b=>{sl(b)},_o&&w0(ua,window.lazyLoadOptions);class Gd{constructor({readonly:A,onNewPageIndex:v,onPlay:P,onPagesReady:M,urlInterrupter:I}){this._pages=[],this.pageIndex=0,this.setPaused=()=>{this.$btnPlay.classList.toggle(this.wrapClassName("footer-btn-playing"),!1)},this.setPlaying=()=>{this.$btnPlay.classList.toggle(this.wrapClassName("footer-btn-playing"),!0)},this.namespace="netless-app-slide",this.isShowPreview=!1,this.isSmallBox=!1,this.sideEffect=new ra,this.readonly=A,this.onNewPageIndex=v,this.onPlay=P,this.onPagesReady=M,this.urlInterrupter=I||(D=>D),this.render()}set pages(A){this._pages=A,this.refreshPreview().then(this.refreshBtnSidebar.bind(this)),this.refreshTotalPage(),this.onPagesReady&&this.onPagesReady(A)}get pages(){return this._pages}unmount(){this.$content.remove(),this.$footer.remove()}setReadonly(A){this.readonly=A,this.$content.classList.toggle(this.wrapClassName("readonly"),A),this.$footer.classList.toggle(this.wrapClassName("readonly"),A),this.$pageNumberInput.disabled=A}destroy(){var A;(A=this.previewLazyLoad)==null||A.destroy(),this.sideEffect.flushAll(),this.unmount()}setPageIndex(A){Number.isNaN(A)||(this.pageIndex=A,this.$pageNumberInput.value=String(A+1))}refreshTotalPage(){this.pages.length?this.$totalPage.textContent=" / "+this.pages.length:this.$totalPage.textContent=""}setSmallBox(A){this.isSmallBox!==A&&(this.isSmallBox=A,this.$footer.classList.toggle(this.wrapClassName("float-footer"),A))}render(){return this.renderContent(),this.renderFooter(),this.$content}renderContent(){if(!this.$content){const A=document.createElement("div");A.className=this.wrapClassName("content"),this.$content=A,this.readonly&&A.classList.add(this.wrapClassName("readonly")),A.appendChild(this.renderPreviewMask()),A.appendChild(this.renderPreview())}return this.$content}renderPreview(){if(!this.$preview){const A=document.createElement("div");A.className=this.wrapClassName("preview")+" tele-fancy-scrollbar",this.$preview=A,this.refreshPreview(),this.sideEffect.addEventListener(A,"click",v=>{var M;if(this.readonly)return;const P=(M=v.target.dataset)==null?void 0:M.pageIndex;P&&(v.preventDefault(),v.stopPropagation(),v.stopImmediatePropagation(),this.onNewPageIndex(Number(P)),this.togglePreview(!1))})}return this.$preview}async refreshPreview(){var I,D;const{$preview:A}=this,v=this.wrapClassName("preview-page"),P=this.wrapClassName("preview-page-name");for(;A.firstChild;)A.firstChild.remove();const M=[];for(let k=0,W=this.pages.length;k<W;k++){const X=this.pages[k],V=(I=X.thumbnail)!=null?I:X.src.startsWith("ppt")?void 0:X.src;V&&(M[k]=this.urlInterrupter(V))}for(let k=0,W=this.pages.length;k<W;k++)M[k]=await M[k];this.pages.forEach((k,W)=>{const X=M[W];if(!X)return;const V=String(W),et=document.createElement("a");et.className=v+" "+this.wrapClassName(`preview-page-${W}`),et.setAttribute("href","#"),et.dataset.pageIndex=V;const pt=document.createElement("span");pt.className=P,pt.textContent=String(W+1),pt.dataset.pageIndex=V;const Dt=document.createElement("img");Dt.width=k.width,Dt.height=k.height,Dt.dataset.src=X,Dt.dataset.pageIndex=V,et.appendChild(Dt),et.appendChild(pt),A.appendChild(et)}),(D=this.previewLazyLoad)==null||D.update()}renderPreviewMask(){return this.$previewMask||(this.$previewMask=document.createElement("div"),this.$previewMask.className=this.wrapClassName("preview-mask"),this.sideEffect.addEventListener(this.$previewMask,"click",A=>{this.readonly||A.target===this.$previewMask&&this.togglePreview(!1)})),this.$previewMask}refreshBtnSidebar(){this.$btnSidebar.style.display=this.pages.length>0?"":"none"}renderFooter(){if(!this.$footer){const A=document.createElement("div");A.className=this.wrapClassName("footer"),this.$footer=A,this.readonly&&A.classList.add(this.wrapClassName("readonly")),this.isSmallBox&&A.classList.add(this.wrapClassName("float-footer"));const v=this.renderFooterBtn("btn-sidebar",y0(this.namespace));this.sideEffect.addEventListener(v,"click",()=>{this.readonly||this.togglePreview()}),this.$btnSidebar=v,this.$btnSidebar.style.display="none",this.$footer.appendChild(v);const P=document.createElement("div");P.className=this.wrapClassName("page-jumps");const M=this.renderFooterBtn("btn-page-back",x0(this.namespace));if(this.sideEffect.addEventListener(M,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex-1)}),P.appendChild(M),this.onPlay){const X=this.renderFooterBtn("btn-page-play",T0(this.namespace),E0(this.namespace));this.$btnPlay=X,this.sideEffect.addEventListener(X,"click",()=>{this.readonly||(this.setPlaying(),this.onPlay&&this.onPlay())}),P.appendChild(X)}const I=this.renderFooterBtn("btn-page-next",b0(this.namespace));this.sideEffect.addEventListener(I,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex+1)}),P.appendChild(I);const D=document.createElement("div");D.className=this.wrapClassName("page-number");const k=document.createElement("input");k.className=this.wrapClassName("page-number-input"),k.value=String(this.pageIndex+1),this.readonly&&(k.disabled=!0),this.$pageNumberInput=k,this.sideEffect.addEventListener(k,"focus",()=>{k.select()}),this.sideEffect.addEventListener(k,"change",()=>{this.readonly||k.value&&this.onNewPageIndex(Number(k.value)-1)});const W=document.createElement("span");this.$totalPage=W,D.appendChild(k),D.appendChild(W),this.$footer.appendChild(P),this.$footer.appendChild(D)}return this.$footer}renderFooterBtn(A,v,P){const M=document.createElement("button");return M.className=this.wrapClassName("footer-btn")+" "+this.wrapClassName(A),M.appendChild(v),P&&M.appendChild(P),M}togglePreview(A){if(this.isShowPreview=A!=null?A:!this.isShowPreview,this.$content.classList.toggle(this.wrapClassName("preview-active"),this.isShowPreview),this.isShowPreview){const v=this.$preview.querySelector("."+this.wrapClassName(`preview-page-${this.pageIndex}`));v&&(this.previewLazyLoad||(this.previewLazyLoad=new ua({container:this.$preview,elements_selector:`.${this.wrapClassName("preview-page>img")}`})),this.$preview.scrollTo({top:v.offsetTop-16}))}}wrapClassName(A){return`${this.namespace}-${A}`}}const C_=new Set(["clicker"]);class R_{constructor({box:A,view:v,mountSlideController:P,mountWhiteboard:M,baseScenePath:I,appId:D,urlInterrupter:k,onPagesReady:W}){this.slideController=null,this.isViewMounted=!1,this.onError=({error:X,index:V})=>{var et,pt;this.viewer.setPaused(),(et=this.slideController)!=null&&et.showRenderError&&(this.$overlay.textContent=`Error on slide[page=${this.slideController.page}]: ${X.message}`,this.$overlay.style.opacity="1"),(pt=this.slideController)!=null&&pt.onRenderError&&this.slideController.onRenderError(X,V),Mr.warn("[Slide] render error",X)},this.onRenderStart=()=>{this.$whiteboardView.classList.add(this.wrapClassName("wb-view-hidden")),this.viewer.setPlaying()},this.onRenderEnd=()=>{},this.onPageChanged=()=>{clearTimeout(this._onPageChangedTimer),this._onPageChangedTimer=setTimeout(this._onPageChanged,200)},this._onPageChangedTimer=0,this._onPageChanged=()=>{this.$overlay.style.opacity="",this.$whiteboardView.classList.remove(this.wrapClassName("wb-view-hidden"))},this.refreshPages=()=>{this.slideController&&(this.viewer.pages=od(this.slideController.slide),this.viewer.setPageIndex(this.getPageIndex(this.slideController.page)),this.scaleDocsToFit())},this.scaleDocsToFit=()=>{if(this.slideController){const{width:X,height:V}=this.slideController.slide;X&&V&&(this.whiteboardView.moveCameraToContain({originX:-X/2,originY:-V/2,width:X,height:V,animationMode:"immediately"}),this.whiteboardView.setCameraBound({damping:1,maxContentMode:()=>this.whiteboardView.camera.scale,minContentMode:()=>this.whiteboardView.camera.scale,centerX:0,centerY:0,width:X,height:V}),this.isViewMounted||(this.isViewMounted=!0,console.log("[Slide] mount whiteboard view"),this.mountWhiteboard(this.$whiteboardView)))}},this.onPlay=()=>{this.slideController&&this.slideController.slide.nextStep()},this.onNewPageIndex=X=>{this.slideController&&this.slideController.jumpToPage(X+1)},this.sideEffect=new ra,this.namespace="netless-app-slide",this.toPdf=async()=>{if(!this.slideController){this.reportProgress(100,null);return}const{slide:X}=this.slideController,V=1920,et=document.createElement("canvas"),pt=et.getContext("2d"),{slideCount:Dt,width:At,height:L}=X;let R=Math.floor(At),F=Math.floor(L);R>V&&(R=V,F=Math.floor(L*R/At)),F>V&&(F=V,R=Math.floor(At*F/L)),et.width=R,et.height=F;const Y=document.createElement("canvas");Y.width=R,Y.height=F;const O=Y.getContext("2d");if(!O||!this.getWhiteSnapshot||!pt)return this.reportProgress(100,null),null;const H=R>F?"l":"p",{jsPDF:tt}=await import("jspdf"),G=new tt({format:[R,F],orientation:H,compress:!0});for(let st=1;st<=Dt;st++){let z=null;try{z=await this.slideController.slide.snapshotWithTimingEnd(st)}catch{}if(z){const $=document.createElement("img");$.src=z,await new Promise(gt=>$.onload=gt),pt.drawImage($,0,0,R,F)}O.clearRect(0,0,R,F),this.getWhiteSnapshot(st,Y,O,At,L);try{const $=Y.toDataURL("image/png"),gt=document.createElement("img");gt.src=$,await new Promise(Lt=>gt.onload=Lt),pt.drawImage(gt,0,0,R,F)}catch{}const U=et.toDataURL("image/jpeg",.6);st>1&&G.addPage(),G.addImage(U,"JPEG",0,0,R,F,"","FAST"),pt.clearRect(0,0,R,F),Math.ceil(st/Dt*100)<100&&this.reportProgress(Math.ceil(st/Dt*100),null)}const Ot=G.output("arraybuffer"),Vt=this.box.title;this.reportProgress(100,{pdf:Ot,title:Vt})},this.box=A,this.whiteboardView=v,this.mountSlideController=P,this.mountWhiteboard=M,this.baseScenePath=I,this.appId=D,this.viewer=new Gd({readonly:A.readonly,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlay,urlInterrupter:k,onPagesReady:W}),this.sideEffect.add(()=>{const X=V=>{this.setReadonly(V)};return A.events.on("readonly",X),()=>A.events.off("readonly",X)}),this.sideEffect.add(()=>{const X=V=>{V.data.type==="@netless/_request_save_pdf_"&&V.data.appId===this.appId&&this.toPdf().catch(()=>this.reportProgress(100,null))};return window.addEventListener("message",X),()=>{window.removeEventListener("message",X)}}),this.render()}render(){this.viewer.$content.appendChild(this.renderSlideContainer()),this.viewer.$content.appendChild(this.renderWhiteboardView()),this.viewer.$content.appendChild(this.renderOverlay()),this.sideEffect.addEventListener(window,"keydown",A=>{if(this.box.focus&&this.slideController&&!s0(A.target))switch(A.key){case"ArrowUp":case"ArrowLeft":{this.slideController.slide.prevStep();break}case"ArrowRight":case"ArrowDown":{this.slideController.slide.nextStep();break}}})}renderOverlay(){if(!this.$overlay){const A=document.createElement("div");A.className=this.wrapClassName("overlay"),this.$overlay=A}return this.$overlay}renderSlideContainer(){if(!this.$slide){const A=document.createElement("div");A.className=this.wrapClassName("slide"),A.dataset.appKind="Slide",this.$slide=A}return this.$slide}renderWhiteboardView(){return this.$whiteboardView||(this.$whiteboardView=document.createElement("div"),this.$whiteboardView.className=this.wrapClassName("wb-view")),this.$whiteboardView}mount(){return this.box.mountContent(this.viewer.$content),this.box.mountFooter(this.viewer.$footer),this.slideController=this.mountSlideController({anchor:this.$slide,onRenderStart:this.onRenderStart,onRenderEnd:this.onRenderEnd,onTransitionStart:this.viewer.setPlaying,onTransitionEnd:this.viewer.setPaused,onReady:this.refreshPages,onError:this.onError}),this.scaleDocsToFit(),this.sideEffect.add(()=>(this.whiteboardView.callbacks.on("onSizeUpdated",this.scaleDocsToFit),()=>this.whiteboardView.callbacks.off("onSizeUpdated",this.scaleDocsToFit))),this}getPageIndex(A){return(A>0?A:1)-1}unmount(){return this.slideController&&(this.slideController.destroy(),this.slideController=null),this.viewer.unmount(),this}setReadonly(A){this.viewer.setReadonly(A)}destroy(){this.sideEffect.flushAll(),this.unmount(),this.viewer.destroy()}toggleClickThrough(A){this.$whiteboardView.style.pointerEvents=!A||C_.has(A)?"none":"auto"}wrapClassName(A){return`${this.namespace}-${A}`}getWhiteSnapshot(A,v,P,M,I){this.whiteboardView.screenshotToCanvas(P,`${this.baseScenePath}/${A}`,v.width,v.height,{centerX:0,centerY:0,scale:Math.min(v.width/M,v.height/I)})}reportProgress(A,v){window.postMessage({type:"@netless/_result_save_pdf_",appId:this.appId,progress:A,result:v})}}let Wh=!1;Zn.FreezerLength=2;function I_(){return Zn.FreezerLength}function P_(b){Zn.FreezerLength=b<1?1/0:b}const ca=b=>"["+b+"]",cl={map:new Map,boxes:new Map,queue:[],validateQueue(){for(this.queue.sort((b,A)=>{var M,I,D,k;const v=(I=(M=this.boxes.get(b))==null?void 0:M.zIndex)!=null?I:0,P=(k=(D=this.boxes.get(A))==null?void 0:D.zIndex)!=null?k:0;return-(v-P)}),Di("[Slide] freezer: validate",ca(this.queue));this.queue.length>Zn.FreezerLength;){const b=this.queue.pop(),A=this.map.get(b);A&&(Di("[Slide] freezer: validate-freeze",b,ca(this.queue)),A.freeze())}},set(b,A,v){Di("[Slide] freezer: add",b,ca(this.queue)),this.map.set(b,A),this.boxes.set(b,v),this.queue.includes(b)||this.queue.unshift(b),this.validateQueue()},delete(b){this.map.delete(b),this.boxes.delete(b),this.queue=this.queue.filter(A=>A!==b),Di("[Slide] freezer: delete",b,ca(this.queue))},focus(b){const A=this.map.get(b),v=this.queue.indexOf(b);v>-1&&this.queue.splice(v,1),this.queue.unshift(b),this.validateQueue(),Di("[Slide] freezer: focus",b,ca(this.queue)),A&&A.unfreeze()}},Xh=new Set;function O_(b){return Xh.add(b),()=>Xh.delete(b)}const Yh=new Set;function N_(b){return Yh.add(b),()=>Yh.delete(b)}const L_=b=>{Wh=!0,b.on("focus",({appId:A})=>{cl.focus(A)}),b.on("created",({appId:A})=>{Xh.forEach(v=>v(A))}),b.on("destroy",({appId:A})=>{Yh.forEach(v=>v(A))})};var Hd=(()=>`.netless-app-slide-content{position:relative;height:100%;overflow:hidden}.netless-app-slide-preview-mask{display:none;position:absolute;z-index:200;top:0;left:0;width:100%;height:100%}.netless-app-slide-preview{display:flex;flex-direction:column;align-items:center;position:absolute;z-index:300;top:0;left:0;width:33%;max-width:200px;height:100%;padding-top:10px;transform:translate(-100%);background:rgba(237,237,240,.9);box-shadow:inset -1px 0 #0000001c;transition:transform .4s}.netless-app-slide-preview-active .netless-app-slide-preview-mask{display:block}.netless-app-slide-preview-active .netless-app-slide-preview{transform:translate(0)}.netless-app-slide-preview-page{position:relative;display:block;width:55%;margin-bottom:10px;font-size:0;color:transparent;outline:none;border:7px solid transparent;border-radius:4px;transition:border-color .3s;user-select:none}.netless-app-slide-preview-page:hover,.netless-app-slide-preview-page.netless-app-slide-preview-page-active{border-color:#444e601a}.netless-app-slide-preview-page>img{width:100%;height:auto;box-sizing:border-box;border:1px solid rgba(0,0,0,.5);border-radius:1px;background-color:#fff;box-shadow:0 2px 8px #0000004d}.netless-app-slide-preview-page-name{position:absolute;top:1px;left:-10px;transform:translate(-100%);text-align:right;font-size:12px;color:#5f5f5f;user-select:none}.netless-app-slide-footer{box-sizing:border-box;height:26px;display:flex;align-items:center;padding:0 16px;border-top:1px solid #eeeef7;color:#191919}.netless-app-slide-float-footer{width:100%;min-height:26px;position:absolute;left:0;bottom:0;z-index:2000;background:rgba(249,249,252,.9);transition:opacity .4s}.netless-app-slide-footer-btn{box-sizing:border-box;width:26px;height:26px;font-size:0;margin:0;padding:3px;border:none;border-radius:1px;outline:none;color:currentColor;background:transparent;transition:background .4s;cursor:pointer;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.netless-app-slide-footer-btn:hover{background:rgba(237,237,240,.9)}@media (hover: none){.netless-app-slide-footer-btn:hover{background:transparent!important}}.netless-app-slide-footer-btn>svg{width:100%;height:100%}.netless-app-slide-footer-btn>svg:nth-of-type(2){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(1){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(2){display:initial}.netless-app-slide-footer-btn~.netless-app-slide-footer-btn{margin-left:15px}.netless-app-slide-page-jumps{flex:1;display:flex;justify-content:center;align-items:center}.netless-app-slide-page-number{margin-left:auto;font-size:13px;user-select:none;white-space:nowrap;word-break:keep-all}.netless-app-slide-page-number-input{border:none;outline:none;width:3em;margin:0;padding:0 2px;text-align:right;font-size:13px;line-height:1;font-weight:400;font-family:inherit;border-radius:2px;color:currentColor;background:transparent;transition:background .4s;user-select:text;-webkit-tap-highlight-color:rgba(0,0,0,0)}.netless-app-slide-page-number-input:hover,.netless-app-slide-page-number-input:focus,.netless-app-slide-page-number-input:active{background:#fff;box-shadow:#63636333 0 2px 8px}.netless-app-slide-readonly.netless-app-slide-footer{display:none}.telebox-color-scheme-dark .netless-app-slide-page-number-input{color:#a6a6a8}.telebox-color-scheme-dark .netless-app-slide-page-number-input:active,.telebox-color-scheme-dark .netless-app-slide-page-number-input:focus,.telebox-color-scheme-dark .netless-app-slide-page-number-input:hover{color:#222}.telebox-color-scheme-dark .netless-app-slide-footer{color:#a6a6a8;background:#2d2d33;border-top:none}.telebox-color-scheme-dark .netless-app-slide-footer-btn:hover{background:#212126}.telebox-color-scheme-dark .netless-app-slide-preview{background:rgba(50,50,50,.9)}.netless-app-slide-wb-view{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;overflow:hidden;transition:opacity .2s}.netless-app-slide-wb-view-hidden{opacity:0}.netless-app-slide-overlay{display:flex;align-items:center;justify-content:center;position:absolute;z-index:200;top:0;left:0;width:100%;height:100%;padding:8px;background:rgba(255,0,0,.25);transition:opacity .3s;opacity:0;pointer-events:none}.netless-app-slide-slide{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.netless-app-slide-slide canvas{transform:scale(var(--netless-app-slide-scale, 1))}
`)();function D_({container:b,taskId:A,url:v=Ph,debug:P=!1}){if(!A)throw new Error("[Slide] taskId is required");b.style.cssText+="display:flex;flex-direction:column";const M=new jd({target:b});return M.debug=!!P,M.mount(A,v),M}class jd{constructor(A){this.slide=null,this.debug=!1,this.sideEffect=new ra,this.ready=!1,this.readyPromise=new Promise(v=>{this.resolveReady=()=>{this.ready=!0,v()}}),this.hotkeyListener=v=>{if(this.slide)switch(v.key){case"ArrowUp":case"ArrowLeft":{this.slide.prevStep();break}case"ArrowRight":case"ArrowDown":{this.slide.nextStep();break}}},this.onPageChanged=v=>{this.viewer.setPageIndex(v-1)},this.onTransitionStart=()=>{this.viewer.setPlaying()},this.onTransitionEnd=()=>{this.viewer.setPaused()},this.onError=({error:v})=>{this.viewer.setPaused(),console.warn("[Slide] render error",v)},this.destroyed=!1,this.refreshPages=()=>{this.slide&&(this.viewer.pages=od(this.slide),this.viewer.setPageIndex(this.getPageIndex(this.slide.slideState.currentSlideIndex)))},this.onPlay=()=>{this.slide&&this.slide.nextStep()},this.onNewPageIndex=v=>{this.slide&&this.slide.slideCount>0&&this.slide.renderSlide(Zc(v+1,1,this.slide.slideCount))},this.namespace="netless-app-slide",this.target=A.target,this.bgColor=rd(this.target),this.viewer=new Gd({readonly:!1,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlay}),this.render()}render(){this.viewer.$content.appendChild(this.renderSlideContainer()),this.registerHotKeys(window)}registerHotKeys(A){this.sideEffect.addEventListener(A,"keydown",this.hotkeyListener,void 0,"hotkey")}mount(A,v){this.target.appendChild(this.renderStyle()),this.target.appendChild(this.viewer.$content),this.target.appendChild(this.viewer.$footer),this.slide=new Dn.Slide({anchor:this.$slide,interactive:!0,mode:"local",controller:this.debug,enableGlobalClick:!0,renderOptions:{minFPS:25,maxFPS:30,autoFPS:!0,autoResolution:!0,transactionBgColor:this.bgColor}}),this.registerEventListeners(),this.slide.setResource(A,v),this.slide.renderSlide(1)}renderStyle(){const A=document.createElement("style");return A.appendChild(document.createTextNode(Hd)),A}registerEventListeners(){if(!this.slide)return;const{slide:A}=this;A.on(Dn.SLIDE_EVENTS.slideChange,this.onPageChanged),A.on(Dn.SLIDE_EVENTS.renderStart,this.onTransitionStart),A.on(Dn.SLIDE_EVENTS.renderEnd,this.onTransitionEnd),A.on(Dn.SLIDE_EVENTS.mainSeqStepStart,this.onTransitionStart),A.on(Dn.SLIDE_EVENTS.mainSeqStepEnd,this.onTransitionEnd),A.on(Dn.SLIDE_EVENTS.renderError,this.onError),A.on(Dn.SLIDE_EVENTS.renderEnd,this.resolveReady),this.readyPromise.then(this.refreshPages)}destroy(){this.sideEffect.flushAll(),this.slide&&!this.destroyed&&(this.slide.destroy(),this.destroyed=!0),this.viewer.destroy()}getPageIndex(A){return(A>0?A:1)-1}renderSlideContainer(){if(!this.$slide){const A=document.createElement("div");A.className=this.wrapClassName("slide"),A.dataset.appKind="Slide",this.$slide=A}return this.$slide}wrapClassName(A){return`${this.namespace}-${A}`}}const F_=Dn.Slide.usePlugin.bind(Dn.Slide),qh="0.2.51",B_={kind:"Slide",setup(b){var X;if(console.log("[Slide] setup @ "+qh),b.getIsWritable()&&b.storage.ensureState(Oh),!b.storage.state.taskId)throw new Error("[Slide] no taskId");const A=b.getView();if(!A)throw new Error("[Slide] no view, please set scenePath on addApp()");A.disableCameraTransform=!0;const v=b.getBox();v.mountStyles(Hd);try{v.$content.dataset.appSlideVersion=qh}catch{}const P=b.getInitScenePath();let M=null;const I=V=>{const et=b.getRoom();if(M&&M.slideController){let pt=!1;et&&b.getIsWritable()&&(sd(et,b,M.slideController.slide,P),pt=!0),Di("[Slide] page to",V,pt?"(synced)":""),M.viewer.setPageIndex(V-1),M.viewer.setPaused(),M.onPageChanged();const Dt=M.viewer.pages.length;Dt>0&&b.dispatchAppEvent("pageStateChange",{index:V-1,length:Dt})}},D=V=>{const et=b.getAppOptions()||{},pt=new _0(t0(qc({context:b},V),{onPageChanged:I,onRenderError:et.onRenderError,showRenderError:et.showRenderError}));return Wh&&cl.set(b.appId,pt,v),Mr.setAppController(b.appId,pt),pt.readyPromise.then(V.onReady).then(()=>{const Dt=b.getRoom();let At=!1;Dt&&b.getIsWritable()&&(sd(Dt,b,pt.slide,P),At=!0);const L=pt.slide.slideState.currentSlideIndex;Di("[Slide] page to",L,At?"(synced)":"","(on ready)"),pt.slide.on("renderEnd",V.onRenderEnd)}),pt};M=new R_({box:v,view:A,mountSlideController:D,mountWhiteboard:b.mountView.bind(b),baseScenePath:P,appId:b.appId,urlInterrupter:(X=b.getAppOptions())==null?void 0:X.urlInterrupter,onPagesReady:({length:V})=>{const et=(M==null?void 0:M.viewer.pageIndex)||0;b.dispatchAppEvent("pageStateChange",{index:et,length:V})}});const k=b.getRoom(),W=new ra;return W.add(()=>{var V;return Mr.setAppContext(b.appId,b),Mr.enable=((V=b.getAppOptions())==null?void 0:V.debug)||!1,Mr.level="debug",()=>Mr.deleteApp(b.appId)}),k&&(M.toggleClickThrough(k.state.memberState.currentApplianceName),W.add(()=>{const V=et=>{et.memberState&&M&&M.toggleClickThrough(et.memberState.currentApplianceName)};return k.callbacks.on("onRoomStateChanged",V),()=>k.callbacks.off("onRoomStateChanged",V)})),b.emitter.on("destroy",()=>{Di("[Slide] destroy",b.appId),Wh&&cl.delete(b.appId),W.flushAll(),M&&(M.destroy(),M=null)}),M.mount(),{viewer:()=>M,controller:()=>M==null?void 0:M.slideController,slide:()=>{var V;return(V=M==null?void 0:M.slideController)==null?void 0:V.slide},nextStep:()=>{var V;return M&&M.slideController?((V=M==null?void 0:M.slideController)==null||V.slide.nextStep(),!0):!1},prevStep:()=>{var V;return M&&M.slideController?((V=M==null?void 0:M.slideController)==null||V.slide.prevStep(),!0):!1},position:()=>{const V=M==null?void 0:M.slideController;if(V)return[V.page,V.pageCount]},nextPage:()=>{const V=M==null?void 0:M.slideController;if(V){const{page:et,pageCount:pt}=V;if(pt>0&&et<pt)return V.jumpToPage(et+1),!0}return!1},prevPage:()=>{const V=M==null?void 0:M.slideController;if(V){const{page:et,pageCount:pt}=V;if(pt>0&&et>1)return V.jumpToPage(et-1),!0}return!1},jumpToPage:V=>{const et=M==null?void 0:M.slideController;if(et){const{page:pt,pageCount:Dt}=et;if(Dt>0&&pt>0&&pt<=Dt)return et.jumpToPage(V),!0}return!1}}}};return Zn.DefaultUrl=Ph,Zn.Slide=Dn.Slide,Zn.SlidePreviewer=jd,Zn.addHooks=L_,Zn.apps=cl,Zn.default=B_,Zn.getFreezerLength=I_,Zn.onCreated=O_,Zn.onDestroyed=N_,Zn.previewSlide=D_,Zn.setFreezerLength=P_,Zn.usePlugin=F_,Zn.version=qh,Object.defineProperties(Zn,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),Zn}({});
//# sourceMappingURL=main.iife.js.map
